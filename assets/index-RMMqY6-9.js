function yA(i,e){for(var t=0;t<e.length;t++){const r=e[t];if(typeof r!="string"&&!Array.isArray(r)){for(const a in r)if(a!=="default"&&!(a in i)){const l=Object.getOwnPropertyDescriptor(r,a);l&&Object.defineProperty(i,a,l.get?l:{enumerable:!0,get:()=>r[a]})}}}return Object.freeze(Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const u of l.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&r(u)}).observe(document,{childList:!0,subtree:!0});function t(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(a){if(a.ep)return;a.ep=!0;const l=t(a);fetch(a.href,l)}})();function vA(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var Yp={exports:{}},jc={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kb;function _A(){if(kb)return jc;kb=1;var i=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(r,a,l){var u=null;if(l!==void 0&&(u=""+l),a.key!==void 0&&(u=""+a.key),"key"in a){l={};for(var h in a)h!=="key"&&(l[h]=a[h])}else l=a;return a=l.ref,{$$typeof:i,type:r,key:u,ref:a!==void 0?a:null,props:l}}return jc.Fragment=e,jc.jsx=t,jc.jsxs=t,jc}var Lb;function bA(){return Lb||(Lb=1,Yp.exports=_A()),Yp.exports}var p=bA(),$p={exports:{}},Me={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Fb;function xA(){if(Fb)return Me;Fb=1;var i=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),u=Symbol.for("react.context"),h=Symbol.for("react.forward_ref"),m=Symbol.for("react.suspense"),y=Symbol.for("react.memo"),_=Symbol.for("react.lazy"),b=Symbol.iterator;function T(C){return C===null||typeof C!="object"?null:(C=b&&C[b]||C["@@iterator"],typeof C=="function"?C:null)}var I={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},V=Object.assign,L={};function O(C,U,ee){this.props=C,this.context=U,this.refs=L,this.updater=ee||I}O.prototype.isReactComponent={},O.prototype.setState=function(C,U){if(typeof C!="object"&&typeof C!="function"&&C!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,C,U,"setState")},O.prototype.forceUpdate=function(C){this.updater.enqueueForceUpdate(this,C,"forceUpdate")};function Z(){}Z.prototype=O.prototype;function se(C,U,ee){this.props=C,this.context=U,this.refs=L,this.updater=ee||I}var G=se.prototype=new Z;G.constructor=se,V(G,O.prototype),G.isPureReactComponent=!0;var ne=Array.isArray,B={H:null,A:null,T:null,S:null,V:null},re=Object.prototype.hasOwnProperty;function P(C,U,ee,ie,ge,xe){return ee=xe.ref,{$$typeof:i,type:C,key:U,ref:ee!==void 0?ee:null,props:xe}}function S(C,U){return P(C.type,U,void 0,void 0,void 0,C.props)}function A(C){return typeof C=="object"&&C!==null&&C.$$typeof===i}function M(C){var U={"=":"=0",":":"=2"};return"$"+C.replace(/[=:]/g,function(ee){return U[ee]})}var D=/\/+/g;function k(C,U){return typeof C=="object"&&C!==null&&C.key!=null?M(""+C.key):U.toString(36)}function N(){}function ue(C){switch(C.status){case"fulfilled":return C.value;case"rejected":throw C.reason;default:switch(typeof C.status=="string"?C.then(N,N):(C.status="pending",C.then(function(U){C.status==="pending"&&(C.status="fulfilled",C.value=U)},function(U){C.status==="pending"&&(C.status="rejected",C.reason=U)})),C.status){case"fulfilled":return C.value;case"rejected":throw C.reason}}throw C}function de(C,U,ee,ie,ge){var xe=typeof C;(xe==="undefined"||xe==="boolean")&&(C=null);var be=!1;if(C===null)be=!0;else switch(xe){case"bigint":case"string":case"number":be=!0;break;case"object":switch(C.$$typeof){case i:case e:be=!0;break;case _:return be=C._init,de(be(C._payload),U,ee,ie,ge)}}if(be)return ge=ge(C),be=ie===""?"."+k(C,0):ie,ne(ge)?(ee="",be!=null&&(ee=be.replace(D,"$&/")+"/"),de(ge,U,ee,"",function(Ne){return Ne})):ge!=null&&(A(ge)&&(ge=S(ge,ee+(ge.key==null||C&&C.key===ge.key?"":(""+ge.key).replace(D,"$&/")+"/")+be)),U.push(ge)),1;be=0;var $e=ie===""?".":ie+":";if(ne(C))for(var ve=0;ve<C.length;ve++)ie=C[ve],xe=$e+k(ie,ve),be+=de(ie,U,ee,xe,ge);else if(ve=T(C),typeof ve=="function")for(C=ve.call(C),ve=0;!(ie=C.next()).done;)ie=ie.value,xe=$e+k(ie,ve++),be+=de(ie,U,ee,xe,ge);else if(xe==="object"){if(typeof C.then=="function")return de(ue(C),U,ee,ie,ge);throw U=String(C),Error("Objects are not valid as a React child (found: "+(U==="[object Object]"?"object with keys {"+Object.keys(C).join(", ")+"}":U)+"). If you meant to render a collection of children, use an array instead.")}return be}function z(C,U,ee){if(C==null)return C;var ie=[],ge=0;return de(C,ie,"","",function(xe){return U.call(ee,xe,ge++)}),ie}function X(C){if(C._status===-1){var U=C._result;U=U(),U.then(function(ee){(C._status===0||C._status===-1)&&(C._status=1,C._result=ee)},function(ee){(C._status===0||C._status===-1)&&(C._status=2,C._result=ee)}),C._status===-1&&(C._status=0,C._result=U)}if(C._status===1)return C._result.default;throw C._result}var ae=typeof reportError=="function"?reportError:function(C){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var U=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof C=="object"&&C!==null&&typeof C.message=="string"?String(C.message):String(C),error:C});if(!window.dispatchEvent(U))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",C);return}console.error(C)};function me(){}return Me.Children={map:z,forEach:function(C,U,ee){z(C,function(){U.apply(this,arguments)},ee)},count:function(C){var U=0;return z(C,function(){U++}),U},toArray:function(C){return z(C,function(U){return U})||[]},only:function(C){if(!A(C))throw Error("React.Children.only expected to receive a single React element child.");return C}},Me.Component=O,Me.Fragment=t,Me.Profiler=a,Me.PureComponent=se,Me.StrictMode=r,Me.Suspense=m,Me.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=B,Me.__COMPILER_RUNTIME={__proto__:null,c:function(C){return B.H.useMemoCache(C)}},Me.cache=function(C){return function(){return C.apply(null,arguments)}},Me.cloneElement=function(C,U,ee){if(C==null)throw Error("The argument must be a React element, but you passed "+C+".");var ie=V({},C.props),ge=C.key,xe=void 0;if(U!=null)for(be in U.ref!==void 0&&(xe=void 0),U.key!==void 0&&(ge=""+U.key),U)!re.call(U,be)||be==="key"||be==="__self"||be==="__source"||be==="ref"&&U.ref===void 0||(ie[be]=U[be]);var be=arguments.length-2;if(be===1)ie.children=ee;else if(1<be){for(var $e=Array(be),ve=0;ve<be;ve++)$e[ve]=arguments[ve+2];ie.children=$e}return P(C.type,ge,void 0,void 0,xe,ie)},Me.createContext=function(C){return C={$$typeof:u,_currentValue:C,_currentValue2:C,_threadCount:0,Provider:null,Consumer:null},C.Provider=C,C.Consumer={$$typeof:l,_context:C},C},Me.createElement=function(C,U,ee){var ie,ge={},xe=null;if(U!=null)for(ie in U.key!==void 0&&(xe=""+U.key),U)re.call(U,ie)&&ie!=="key"&&ie!=="__self"&&ie!=="__source"&&(ge[ie]=U[ie]);var be=arguments.length-2;if(be===1)ge.children=ee;else if(1<be){for(var $e=Array(be),ve=0;ve<be;ve++)$e[ve]=arguments[ve+2];ge.children=$e}if(C&&C.defaultProps)for(ie in be=C.defaultProps,be)ge[ie]===void 0&&(ge[ie]=be[ie]);return P(C,xe,void 0,void 0,null,ge)},Me.createRef=function(){return{current:null}},Me.forwardRef=function(C){return{$$typeof:h,render:C}},Me.isValidElement=A,Me.lazy=function(C){return{$$typeof:_,_payload:{_status:-1,_result:C},_init:X}},Me.memo=function(C,U){return{$$typeof:y,type:C,compare:U===void 0?null:U}},Me.startTransition=function(C){var U=B.T,ee={};B.T=ee;try{var ie=C(),ge=B.S;ge!==null&&ge(ee,ie),typeof ie=="object"&&ie!==null&&typeof ie.then=="function"&&ie.then(me,ae)}catch(xe){ae(xe)}finally{B.T=U}},Me.unstable_useCacheRefresh=function(){return B.H.useCacheRefresh()},Me.use=function(C){return B.H.use(C)},Me.useActionState=function(C,U,ee){return B.H.useActionState(C,U,ee)},Me.useCallback=function(C,U){return B.H.useCallback(C,U)},Me.useContext=function(C){return B.H.useContext(C)},Me.useDebugValue=function(){},Me.useDeferredValue=function(C,U){return B.H.useDeferredValue(C,U)},Me.useEffect=function(C,U,ee){var ie=B.H;if(typeof ee=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return ie.useEffect(C,U)},Me.useId=function(){return B.H.useId()},Me.useImperativeHandle=function(C,U,ee){return B.H.useImperativeHandle(C,U,ee)},Me.useInsertionEffect=function(C,U){return B.H.useInsertionEffect(C,U)},Me.useLayoutEffect=function(C,U){return B.H.useLayoutEffect(C,U)},Me.useMemo=function(C,U){return B.H.useMemo(C,U)},Me.useOptimistic=function(C,U){return B.H.useOptimistic(C,U)},Me.useReducer=function(C,U,ee){return B.H.useReducer(C,U,ee)},Me.useRef=function(C){return B.H.useRef(C)},Me.useState=function(C){return B.H.useState(C)},Me.useSyncExternalStore=function(C,U,ee){return B.H.useSyncExternalStore(C,U,ee)},Me.useTransition=function(){return B.H.useTransition()},Me.version="19.1.1",Me}var Ub;function ay(){return Ub||(Ub=1,$p.exports=xA()),$p.exports}var q=ay();const EA=vA(q),TA=yA({__proto__:null,default:EA},[q]);var Qp={exports:{}},kc={},Xp={exports:{}},Wp={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var zb;function wA(){return zb||(zb=1,function(i){function e(z,X){var ae=z.length;z.push(X);e:for(;0<ae;){var me=ae-1>>>1,C=z[me];if(0<a(C,X))z[me]=X,z[ae]=C,ae=me;else break e}}function t(z){return z.length===0?null:z[0]}function r(z){if(z.length===0)return null;var X=z[0],ae=z.pop();if(ae!==X){z[0]=ae;e:for(var me=0,C=z.length,U=C>>>1;me<U;){var ee=2*(me+1)-1,ie=z[ee],ge=ee+1,xe=z[ge];if(0>a(ie,ae))ge<C&&0>a(xe,ie)?(z[me]=xe,z[ge]=ae,me=ge):(z[me]=ie,z[ee]=ae,me=ee);else if(ge<C&&0>a(xe,ae))z[me]=xe,z[ge]=ae,me=ge;else break e}}return X}function a(z,X){var ae=z.sortIndex-X.sortIndex;return ae!==0?ae:z.id-X.id}if(i.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;i.unstable_now=function(){return l.now()}}else{var u=Date,h=u.now();i.unstable_now=function(){return u.now()-h}}var m=[],y=[],_=1,b=null,T=3,I=!1,V=!1,L=!1,O=!1,Z=typeof setTimeout=="function"?setTimeout:null,se=typeof clearTimeout=="function"?clearTimeout:null,G=typeof setImmediate<"u"?setImmediate:null;function ne(z){for(var X=t(y);X!==null;){if(X.callback===null)r(y);else if(X.startTime<=z)r(y),X.sortIndex=X.expirationTime,e(m,X);else break;X=t(y)}}function B(z){if(L=!1,ne(z),!V)if(t(m)!==null)V=!0,re||(re=!0,k());else{var X=t(y);X!==null&&de(B,X.startTime-z)}}var re=!1,P=-1,S=5,A=-1;function M(){return O?!0:!(i.unstable_now()-A<S)}function D(){if(O=!1,re){var z=i.unstable_now();A=z;var X=!0;try{e:{V=!1,L&&(L=!1,se(P),P=-1),I=!0;var ae=T;try{t:{for(ne(z),b=t(m);b!==null&&!(b.expirationTime>z&&M());){var me=b.callback;if(typeof me=="function"){b.callback=null,T=b.priorityLevel;var C=me(b.expirationTime<=z);if(z=i.unstable_now(),typeof C=="function"){b.callback=C,ne(z),X=!0;break t}b===t(m)&&r(m),ne(z)}else r(m);b=t(m)}if(b!==null)X=!0;else{var U=t(y);U!==null&&de(B,U.startTime-z),X=!1}}break e}finally{b=null,T=ae,I=!1}X=void 0}}finally{X?k():re=!1}}}var k;if(typeof G=="function")k=function(){G(D)};else if(typeof MessageChannel<"u"){var N=new MessageChannel,ue=N.port2;N.port1.onmessage=D,k=function(){ue.postMessage(null)}}else k=function(){Z(D,0)};function de(z,X){P=Z(function(){z(i.unstable_now())},X)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function(z){z.callback=null},i.unstable_forceFrameRate=function(z){0>z||125<z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):S=0<z?Math.floor(1e3/z):5},i.unstable_getCurrentPriorityLevel=function(){return T},i.unstable_next=function(z){switch(T){case 1:case 2:case 3:var X=3;break;default:X=T}var ae=T;T=X;try{return z()}finally{T=ae}},i.unstable_requestPaint=function(){O=!0},i.unstable_runWithPriority=function(z,X){switch(z){case 1:case 2:case 3:case 4:case 5:break;default:z=3}var ae=T;T=z;try{return X()}finally{T=ae}},i.unstable_scheduleCallback=function(z,X,ae){var me=i.unstable_now();switch(typeof ae=="object"&&ae!==null?(ae=ae.delay,ae=typeof ae=="number"&&0<ae?me+ae:me):ae=me,z){case 1:var C=-1;break;case 2:C=250;break;case 5:C=1073741823;break;case 4:C=1e4;break;default:C=5e3}return C=ae+C,z={id:_++,callback:X,priorityLevel:z,startTime:ae,expirationTime:C,sortIndex:-1},ae>me?(z.sortIndex=ae,e(y,z),t(m)===null&&z===t(y)&&(L?(se(P),P=-1):L=!0,de(B,ae-me))):(z.sortIndex=C,e(m,z),V||I||(V=!0,re||(re=!0,k()))),z},i.unstable_shouldYield=M,i.unstable_wrapCallback=function(z){var X=T;return function(){var ae=T;T=X;try{return z.apply(this,arguments)}finally{T=ae}}}}(Wp)),Wp}var qb;function RA(){return qb||(qb=1,Xp.exports=wA()),Xp.exports}var Jp={exports:{}},vn={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Bb;function SA(){if(Bb)return vn;Bb=1;var i=ay();function e(m){var y="https://react.dev/errors/"+m;if(1<arguments.length){y+="?args[]="+encodeURIComponent(arguments[1]);for(var _=2;_<arguments.length;_++)y+="&args[]="+encodeURIComponent(arguments[_])}return"Minified React error #"+m+"; visit "+y+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var r={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},a=Symbol.for("react.portal");function l(m,y,_){var b=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:b==null?null:""+b,children:m,containerInfo:y,implementation:_}}var u=i.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function h(m,y){if(m==="font")return"";if(typeof y=="string")return y==="use-credentials"?y:""}return vn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,vn.createPortal=function(m,y){var _=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!y||y.nodeType!==1&&y.nodeType!==9&&y.nodeType!==11)throw Error(e(299));return l(m,y,null,_)},vn.flushSync=function(m){var y=u.T,_=r.p;try{if(u.T=null,r.p=2,m)return m()}finally{u.T=y,r.p=_,r.d.f()}},vn.preconnect=function(m,y){typeof m=="string"&&(y?(y=y.crossOrigin,y=typeof y=="string"?y==="use-credentials"?y:"":void 0):y=null,r.d.C(m,y))},vn.prefetchDNS=function(m){typeof m=="string"&&r.d.D(m)},vn.preinit=function(m,y){if(typeof m=="string"&&y&&typeof y.as=="string"){var _=y.as,b=h(_,y.crossOrigin),T=typeof y.integrity=="string"?y.integrity:void 0,I=typeof y.fetchPriority=="string"?y.fetchPriority:void 0;_==="style"?r.d.S(m,typeof y.precedence=="string"?y.precedence:void 0,{crossOrigin:b,integrity:T,fetchPriority:I}):_==="script"&&r.d.X(m,{crossOrigin:b,integrity:T,fetchPriority:I,nonce:typeof y.nonce=="string"?y.nonce:void 0})}},vn.preinitModule=function(m,y){if(typeof m=="string")if(typeof y=="object"&&y!==null){if(y.as==null||y.as==="script"){var _=h(y.as,y.crossOrigin);r.d.M(m,{crossOrigin:_,integrity:typeof y.integrity=="string"?y.integrity:void 0,nonce:typeof y.nonce=="string"?y.nonce:void 0})}}else y==null&&r.d.M(m)},vn.preload=function(m,y){if(typeof m=="string"&&typeof y=="object"&&y!==null&&typeof y.as=="string"){var _=y.as,b=h(_,y.crossOrigin);r.d.L(m,_,{crossOrigin:b,integrity:typeof y.integrity=="string"?y.integrity:void 0,nonce:typeof y.nonce=="string"?y.nonce:void 0,type:typeof y.type=="string"?y.type:void 0,fetchPriority:typeof y.fetchPriority=="string"?y.fetchPriority:void 0,referrerPolicy:typeof y.referrerPolicy=="string"?y.referrerPolicy:void 0,imageSrcSet:typeof y.imageSrcSet=="string"?y.imageSrcSet:void 0,imageSizes:typeof y.imageSizes=="string"?y.imageSizes:void 0,media:typeof y.media=="string"?y.media:void 0})}},vn.preloadModule=function(m,y){if(typeof m=="string")if(y){var _=h(y.as,y.crossOrigin);r.d.m(m,{as:typeof y.as=="string"&&y.as!=="script"?y.as:void 0,crossOrigin:_,integrity:typeof y.integrity=="string"?y.integrity:void 0})}else r.d.m(m)},vn.requestFormReset=function(m){r.d.r(m)},vn.unstable_batchedUpdates=function(m,y){return m(y)},vn.useFormState=function(m,y,_){return u.H.useFormState(m,y,_)},vn.useFormStatus=function(){return u.H.useHostTransitionStatus()},vn.version="19.1.1",vn}var Hb;function lT(){if(Hb)return Jp.exports;Hb=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(e){console.error(e)}}return i(),Jp.exports=SA(),Jp.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Gb;function AA(){if(Gb)return kc;Gb=1;var i=RA(),e=ay(),t=lT();function r(n){var s="https://react.dev/errors/"+n;if(1<arguments.length){s+="?args[]="+encodeURIComponent(arguments[1]);for(var o=2;o<arguments.length;o++)s+="&args[]="+encodeURIComponent(arguments[o])}return"Minified React error #"+n+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function l(n){var s=n,o=n;if(n.alternate)for(;s.return;)s=s.return;else{n=s;do s=n,(s.flags&4098)!==0&&(o=s.return),n=s.return;while(n)}return s.tag===3?o:null}function u(n){if(n.tag===13){var s=n.memoizedState;if(s===null&&(n=n.alternate,n!==null&&(s=n.memoizedState)),s!==null)return s.dehydrated}return null}function h(n){if(l(n)!==n)throw Error(r(188))}function m(n){var s=n.alternate;if(!s){if(s=l(n),s===null)throw Error(r(188));return s!==n?null:n}for(var o=n,c=s;;){var f=o.return;if(f===null)break;var g=f.alternate;if(g===null){if(c=f.return,c!==null){o=c;continue}break}if(f.child===g.child){for(g=f.child;g;){if(g===o)return h(f),n;if(g===c)return h(f),s;g=g.sibling}throw Error(r(188))}if(o.return!==c.return)o=f,c=g;else{for(var E=!1,w=f.child;w;){if(w===o){E=!0,o=f,c=g;break}if(w===c){E=!0,c=f,o=g;break}w=w.sibling}if(!E){for(w=g.child;w;){if(w===o){E=!0,o=g,c=f;break}if(w===c){E=!0,c=g,o=f;break}w=w.sibling}if(!E)throw Error(r(189))}}if(o.alternate!==c)throw Error(r(190))}if(o.tag!==3)throw Error(r(188));return o.stateNode.current===o?n:s}function y(n){var s=n.tag;if(s===5||s===26||s===27||s===6)return n;for(n=n.child;n!==null;){if(s=y(n),s!==null)return s;n=n.sibling}return null}var _=Object.assign,b=Symbol.for("react.element"),T=Symbol.for("react.transitional.element"),I=Symbol.for("react.portal"),V=Symbol.for("react.fragment"),L=Symbol.for("react.strict_mode"),O=Symbol.for("react.profiler"),Z=Symbol.for("react.provider"),se=Symbol.for("react.consumer"),G=Symbol.for("react.context"),ne=Symbol.for("react.forward_ref"),B=Symbol.for("react.suspense"),re=Symbol.for("react.suspense_list"),P=Symbol.for("react.memo"),S=Symbol.for("react.lazy"),A=Symbol.for("react.activity"),M=Symbol.for("react.memo_cache_sentinel"),D=Symbol.iterator;function k(n){return n===null||typeof n!="object"?null:(n=D&&n[D]||n["@@iterator"],typeof n=="function"?n:null)}var N=Symbol.for("react.client.reference");function ue(n){if(n==null)return null;if(typeof n=="function")return n.$$typeof===N?null:n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case V:return"Fragment";case O:return"Profiler";case L:return"StrictMode";case B:return"Suspense";case re:return"SuspenseList";case A:return"Activity"}if(typeof n=="object")switch(n.$$typeof){case I:return"Portal";case G:return(n.displayName||"Context")+".Provider";case se:return(n._context.displayName||"Context")+".Consumer";case ne:var s=n.render;return n=n.displayName,n||(n=s.displayName||s.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case P:return s=n.displayName||null,s!==null?s:ue(n.type)||"Memo";case S:s=n._payload,n=n._init;try{return ue(n(s))}catch{}}return null}var de=Array.isArray,z=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,X=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ae={pending:!1,data:null,method:null,action:null},me=[],C=-1;function U(n){return{current:n}}function ee(n){0>C||(n.current=me[C],me[C]=null,C--)}function ie(n,s){C++,me[C]=n.current,n.current=s}var ge=U(null),xe=U(null),be=U(null),$e=U(null);function ve(n,s){switch(ie(be,s),ie(xe,n),ie(ge,null),s.nodeType){case 9:case 11:n=(n=s.documentElement)&&(n=n.namespaceURI)?hb(n):0;break;default:if(n=s.tagName,s=s.namespaceURI)s=hb(s),n=db(s,n);else switch(n){case"svg":n=1;break;case"math":n=2;break;default:n=0}}ee(ge),ie(ge,n)}function Ne(){ee(ge),ee(xe),ee(be)}function je(n){n.memoizedState!==null&&ie($e,n);var s=ge.current,o=db(s,n.type);s!==o&&(ie(xe,n),ie(ge,o))}function De(n){xe.current===n&&(ee(ge),ee(xe)),$e.current===n&&(ee($e),Pc._currentValue=ae)}var Ue=Object.prototype.hasOwnProperty,He=i.unstable_scheduleCallback,nt=i.unstable_cancelCallback,Yt=i.unstable_shouldYield,cn=i.unstable_requestPaint,Et=i.unstable_now,Vn=i.unstable_getCurrentPriorityLevel,On=i.unstable_ImmediatePriority,Xe=i.unstable_UserBlockingPriority,ke=i.unstable_NormalPriority,tt=i.unstable_LowPriority,Qe=i.unstable_IdlePriority,ni=i.log,Tn=i.unstable_setDisableYieldValue,mt=null,rt=null;function wn(n){if(typeof ni=="function"&&Tn(n),rt&&typeof rt.setStrictMode=="function")try{rt.setStrictMode(mt,n)}catch{}}var $t=Math.clz32?Math.clz32:Zi,Ji=Math.log,Hs=Math.LN2;function Zi(n){return n>>>=0,n===0?32:31-(Ji(n)/Hs|0)|0}var Fn=256,qr=4194304;function Un(n){var s=n&42;if(s!==0)return s;switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return n&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return n}}function Za(n,s,o){var c=n.pendingLanes;if(c===0)return 0;var f=0,g=n.suspendedLanes,E=n.pingedLanes;n=n.warmLanes;var w=c&134217727;return w!==0?(c=w&~g,c!==0?f=Un(c):(E&=w,E!==0?f=Un(E):o||(o=w&~n,o!==0&&(f=Un(o))))):(w=c&~g,w!==0?f=Un(w):E!==0?f=Un(E):o||(o=c&~n,o!==0&&(f=Un(o)))),f===0?0:s!==0&&s!==f&&(s&g)===0&&(g=f&-f,o=s&-s,g>=o||g===32&&(o&4194048)!==0)?s:f}function Gs(n,s){return(n.pendingLanes&~(n.suspendedLanes&~n.pingedLanes)&s)===0}function Pl(n,s){switch(n){case 1:case 2:case 4:case 8:case 64:return s+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Dl(){var n=Fn;return Fn<<=1,(Fn&4194048)===0&&(Fn=256),n}function Vl(){var n=qr;return qr<<=1,(qr&62914560)===0&&(qr=4194304),n}function er(n){for(var s=[],o=0;31>o;o++)s.push(n);return s}function tr(n,s){n.pendingLanes|=s,s!==268435456&&(n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0)}function Ol(n,s,o,c,f,g){var E=n.pendingLanes;n.pendingLanes=o,n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0,n.expiredLanes&=o,n.entangledLanes&=o,n.errorRecoveryDisabledLanes&=o,n.shellSuspendCounter=0;var w=n.entanglements,j=n.expirationTimes,Q=n.hiddenUpdates;for(o=E&~o;0<o;){var le=31-$t(o),he=1<<le;w[le]=0,j[le]=-1;var W=Q[le];if(W!==null)for(Q[le]=null,le=0;le<W.length;le++){var J=W[le];J!==null&&(J.lane&=-536870913)}o&=~he}c!==0&&Ai(n,c,0),g!==0&&f===0&&n.tag!==0&&(n.suspendedLanes|=g&~(E&~s))}function Ai(n,s,o){n.pendingLanes|=s,n.suspendedLanes&=~s;var c=31-$t(s);n.entangledLanes|=s,n.entanglements[c]=n.entanglements[c]|1073741824|o&4194090}function Ml(n,s){var o=n.entangledLanes|=s;for(n=n.entanglements;o;){var c=31-$t(o),f=1<<c;f&s|n[c]&s&&(n[c]|=s),o&=~f}}function Br(n){switch(n){case 2:n=1;break;case 8:n=4;break;case 32:n=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:n=128;break;case 268435456:n=134217728;break;default:n=0}return n}function eo(n){return n&=-n,2<n?8<n?(n&134217727)!==0?32:268435456:8:2}function Hr(){var n=X.p;return n!==0?n:(n=window.event,n===void 0?32:Pb(n.type))}function $u(n,s){var o=X.p;try{return X.p=n,s()}finally{X.p=o}}var Tt=Math.random().toString(36).slice(2),Qt="__reactFiber$"+Tt,Ft="__reactProps$"+Tt,ii="__reactContainer$"+Tt,jl="__reactEvents$"+Tt,Xf="__reactListeners$"+Tt,Gr="__reactHandles$"+Tt,Qu="__reactResources$"+Tt,Ks="__reactMarker$"+Tt;function Kr(n){delete n[Qt],delete n[Ft],delete n[jl],delete n[Xf],delete n[Gr]}function nr(n){var s=n[Qt];if(s)return s;for(var o=n.parentNode;o;){if(s=o[ii]||o[Qt]){if(o=s.alternate,s.child!==null||o!==null&&o.child!==null)for(n=gb(n);n!==null;){if(o=n[Qt])return o;n=gb(n)}return s}n=o,o=n.parentNode}return null}function Ii(n){if(n=n[Qt]||n[ii]){var s=n.tag;if(s===5||s===6||s===13||s===26||s===27||s===3)return n}return null}function Ni(n){var s=n.tag;if(s===5||s===26||s===27||s===6)return n.stateNode;throw Error(r(33))}function Rn(n){var s=n[Qu];return s||(s=n[Qu]={hoistableStyles:new Map,hoistableScripts:new Map}),s}function Ot(n){n[Ks]=!0}var kl=new Set,to={};function _i(n,s){ir(n,s),ir(n+"Capture",s)}function ir(n,s){for(to[n]=s,n=0;n<s.length;n++)kl.add(s[n])}var Xu=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Wu={},Ys={};function Ju(n){return Ue.call(Ys,n)?!0:Ue.call(Wu,n)?!1:Xu.test(n)?Ys[n]=!0:(Wu[n]=!0,!1)}function Yr(n,s,o){if(Ju(s))if(o===null)n.removeAttribute(s);else{switch(typeof o){case"undefined":case"function":case"symbol":n.removeAttribute(s);return;case"boolean":var c=s.toLowerCase().slice(0,5);if(c!=="data-"&&c!=="aria-"){n.removeAttribute(s);return}}n.setAttribute(s,""+o)}}function Ci(n,s,o){if(o===null)n.removeAttribute(s);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(s);return}n.setAttribute(s,""+o)}}function un(n,s,o,c){if(c===null)n.removeAttribute(o);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(o);return}n.setAttributeNS(s,o,""+c)}}var $s,Zu;function rr(n){if($s===void 0)try{throw Error()}catch(o){var s=o.stack.trim().match(/\n( *(at )?)/);$s=s&&s[1]||"",Zu=-1<o.stack.indexOf(`
    at`)?" (<anonymous>)":-1<o.stack.indexOf("@")?"@unknown:0:0":""}return`
`+$s+n+Zu}var no=!1;function io(n,s){if(!n||no)return"";no=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var c={DetermineComponentFrameRoot:function(){try{if(s){var he=function(){throw Error()};if(Object.defineProperty(he.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(he,[])}catch(J){var W=J}Reflect.construct(n,[],he)}else{try{he.call()}catch(J){W=J}n.call(he.prototype)}}else{try{throw Error()}catch(J){W=J}(he=n())&&typeof he.catch=="function"&&he.catch(function(){})}}catch(J){if(J&&W&&typeof J.stack=="string")return[J.stack,W.stack]}return[null,null]}};c.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var f=Object.getOwnPropertyDescriptor(c.DetermineComponentFrameRoot,"name");f&&f.configurable&&Object.defineProperty(c.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var g=c.DetermineComponentFrameRoot(),E=g[0],w=g[1];if(E&&w){var j=E.split(`
`),Q=w.split(`
`);for(f=c=0;c<j.length&&!j[c].includes("DetermineComponentFrameRoot");)c++;for(;f<Q.length&&!Q[f].includes("DetermineComponentFrameRoot");)f++;if(c===j.length||f===Q.length)for(c=j.length-1,f=Q.length-1;1<=c&&0<=f&&j[c]!==Q[f];)f--;for(;1<=c&&0<=f;c--,f--)if(j[c]!==Q[f]){if(c!==1||f!==1)do if(c--,f--,0>f||j[c]!==Q[f]){var le=`
`+j[c].replace(" at new "," at ");return n.displayName&&le.includes("<anonymous>")&&(le=le.replace("<anonymous>",n.displayName)),le}while(1<=c&&0<=f);break}}}finally{no=!1,Error.prepareStackTrace=o}return(o=n?n.displayName||n.name:"")?rr(o):""}function Ll(n){switch(n.tag){case 26:case 27:case 5:return rr(n.type);case 16:return rr("Lazy");case 13:return rr("Suspense");case 19:return rr("SuspenseList");case 0:case 15:return io(n.type,!1);case 11:return io(n.type.render,!1);case 1:return io(n.type,!0);case 31:return rr("Activity");default:return""}}function ro(n){try{var s="";do s+=Ll(n),n=n.return;while(n);return s}catch(o){return`
Error generating stack: `+o.message+`
`+o.stack}}function Sn(n){switch(typeof n){case"bigint":case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function Fl(n){var s=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function Wf(n){var s=Fl(n)?"checked":"value",o=Object.getOwnPropertyDescriptor(n.constructor.prototype,s),c=""+n[s];if(!n.hasOwnProperty(s)&&typeof o<"u"&&typeof o.get=="function"&&typeof o.set=="function"){var f=o.get,g=o.set;return Object.defineProperty(n,s,{configurable:!0,get:function(){return f.call(this)},set:function(E){c=""+E,g.call(this,E)}}),Object.defineProperty(n,s,{enumerable:o.enumerable}),{getValue:function(){return c},setValue:function(E){c=""+E},stopTracking:function(){n._valueTracker=null,delete n[s]}}}}function so(n){n._valueTracker||(n._valueTracker=Wf(n))}function Ul(n){if(!n)return!1;var s=n._valueTracker;if(!s)return!0;var o=s.getValue(),c="";return n&&(c=Fl(n)?n.checked?"true":"false":n.value),n=c,n!==o?(s.setValue(n),!0):!1}function Qs(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}var Jf=/[\n"\\]/g;function Ut(n){return n.replace(Jf,function(s){return"\\"+s.charCodeAt(0).toString(16)+" "})}function zn(n,s,o,c,f,g,E,w){n.name="",E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"?n.type=E:n.removeAttribute("type"),s!=null?E==="number"?(s===0&&n.value===""||n.value!=s)&&(n.value=""+Sn(s)):n.value!==""+Sn(s)&&(n.value=""+Sn(s)):E!=="submit"&&E!=="reset"||n.removeAttribute("value"),s!=null?$r(n,E,Sn(s)):o!=null?$r(n,E,Sn(o)):c!=null&&n.removeAttribute("value"),f==null&&g!=null&&(n.defaultChecked=!!g),f!=null&&(n.checked=f&&typeof f!="function"&&typeof f!="symbol"),w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"?n.name=""+Sn(w):n.removeAttribute("name")}function Xs(n,s,o,c,f,g,E,w){if(g!=null&&typeof g!="function"&&typeof g!="symbol"&&typeof g!="boolean"&&(n.type=g),s!=null||o!=null){if(!(g!=="submit"&&g!=="reset"||s!=null))return;o=o!=null?""+Sn(o):"",s=s!=null?""+Sn(s):o,w||s===n.value||(n.value=s),n.defaultValue=s}c=c??f,c=typeof c!="function"&&typeof c!="symbol"&&!!c,n.checked=w?n.checked:!!c,n.defaultChecked=!!c,E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"&&(n.name=E)}function $r(n,s,o){s==="number"&&Qs(n.ownerDocument)===n||n.defaultValue===""+o||(n.defaultValue=""+o)}function sr(n,s,o,c){if(n=n.options,s){s={};for(var f=0;f<o.length;f++)s["$"+o[f]]=!0;for(o=0;o<n.length;o++)f=s.hasOwnProperty("$"+n[o].value),n[o].selected!==f&&(n[o].selected=f),f&&c&&(n[o].defaultSelected=!0)}else{for(o=""+Sn(o),s=null,f=0;f<n.length;f++){if(n[f].value===o){n[f].selected=!0,c&&(n[f].defaultSelected=!0);return}s!==null||n[f].disabled||(s=n[f])}s!==null&&(s.selected=!0)}}function pt(n,s,o){if(s!=null&&(s=""+Sn(s),s!==n.value&&(n.value=s),o==null)){n.defaultValue!==s&&(n.defaultValue=s);return}n.defaultValue=o!=null?""+Sn(o):""}function Ws(n,s,o,c){if(s==null){if(c!=null){if(o!=null)throw Error(r(92));if(de(c)){if(1<c.length)throw Error(r(93));c=c[0]}o=c}o==null&&(o=""),s=o}o=Sn(s),n.defaultValue=o,c=n.textContent,c===o&&c!==""&&c!==null&&(n.value=c)}function ri(n,s){if(s){var o=n.firstChild;if(o&&o===n.lastChild&&o.nodeType===3){o.nodeValue=s;return}}n.textContent=s}var Js=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function eh(n,s,o){var c=s.indexOf("--")===0;o==null||typeof o=="boolean"||o===""?c?n.setProperty(s,""):s==="float"?n.cssFloat="":n[s]="":c?n.setProperty(s,o):typeof o!="number"||o===0||Js.has(s)?s==="float"?n.cssFloat=o:n[s]=(""+o).trim():n[s]=o+"px"}function zl(n,s,o){if(s!=null&&typeof s!="object")throw Error(r(62));if(n=n.style,o!=null){for(var c in o)!o.hasOwnProperty(c)||s!=null&&s.hasOwnProperty(c)||(c.indexOf("--")===0?n.setProperty(c,""):c==="float"?n.cssFloat="":n[c]="");for(var f in s)c=s[f],s.hasOwnProperty(f)&&o[f]!==c&&eh(n,f,c)}else for(var g in s)s.hasOwnProperty(g)&&eh(n,g,s[g])}function ql(n){if(n.indexOf("-")===-1)return!1;switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Zf=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),em=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function ao(n){return em.test(""+n)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":n}var ar=null;function si(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var or=null,lr=null;function Bl(n){var s=Ii(n);if(s&&(n=s.stateNode)){var o=n[Ft]||null;e:switch(n=s.stateNode,s.type){case"input":if(zn(n,o.value,o.defaultValue,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name),s=o.name,o.type==="radio"&&s!=null){for(o=n;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll('input[name="'+Ut(""+s)+'"][type="radio"]'),s=0;s<o.length;s++){var c=o[s];if(c!==n&&c.form===n.form){var f=c[Ft]||null;if(!f)throw Error(r(90));zn(c,f.value,f.defaultValue,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name)}}for(s=0;s<o.length;s++)c=o[s],c.form===n.form&&Ul(c)}break e;case"textarea":pt(n,o.value,o.defaultValue);break e;case"select":s=o.value,s!=null&&sr(n,!!o.multiple,s,!1)}}}var Pi=!1;function th(n,s,o){if(Pi)return n(s,o);Pi=!0;try{var c=n(s);return c}finally{if(Pi=!1,(or!==null||lr!==null)&&($h(),or&&(s=or,n=lr,lr=or=null,Bl(s),n)))for(s=0;s<n.length;s++)Bl(n[s])}}function Zs(n,s){var o=n.stateNode;if(o===null)return null;var c=o[Ft]||null;if(c===null)return null;o=c[s];e:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(n=n.type,c=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!c;break e;default:n=!1}if(n)return null;if(o&&typeof o!="function")throw Error(r(231,s,typeof o));return o}var bi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ai=!1;if(bi)try{var ea={};Object.defineProperty(ea,"passive",{get:function(){ai=!0}}),window.addEventListener("test",ea,ea),window.removeEventListener("test",ea,ea)}catch{ai=!1}var Di=null,Qr=null,cr=null;function Hl(){if(cr)return cr;var n,s=Qr,o=s.length,c,f="value"in Di?Di.value:Di.textContent,g=f.length;for(n=0;n<o&&s[n]===f[n];n++);var E=o-n;for(c=1;c<=E&&s[o-c]===f[g-c];c++);return cr=f.slice(n,1<c?1-c:void 0)}function Vi(n){var s=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&s===13&&(n=13)):n=s,n===10&&(n=13),32<=n||n===13?n:0}function Oi(){return!0}function Gl(){return!1}function nn(n){function s(o,c,f,g,E){this._reactName=o,this._targetInst=f,this.type=c,this.nativeEvent=g,this.target=E,this.currentTarget=null;for(var w in n)n.hasOwnProperty(w)&&(o=n[w],this[w]=o?o(g):g[w]);return this.isDefaultPrevented=(g.defaultPrevented!=null?g.defaultPrevented:g.returnValue===!1)?Oi:Gl,this.isPropagationStopped=Gl,this}return _(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=Oi)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=Oi)},persist:function(){},isPersistent:Oi}),s}var ot={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},oo=nn(ot),ta=_({},ot,{view:0,detail:0}),nh=nn(ta),lo,co,Mi,na=_({},ta,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:sa,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==Mi&&(Mi&&n.type==="mousemove"?(lo=n.screenX-Mi.screenX,co=n.screenY-Mi.screenY):co=lo=0,Mi=n),lo)},movementY:function(n){return"movementY"in n?n.movementY:co}}),oi=nn(na),ih=_({},na,{dataTransfer:0}),tm=nn(ih),ia=_({},ta,{relatedTarget:0}),uo=nn(ia),Kl=_({},ot,{animationName:0,elapsedTime:0,pseudoElement:0}),ho=nn(Kl),rh=_({},ot,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),fo=nn(rh),nm=_({},ot,{data:0}),Yl=nn(nm),ra={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},sh={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ah={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function $l(n){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(n):(n=ah[n])?!!s[n]:!1}function sa(){return $l}var oh=_({},ta,{key:function(n){if(n.key){var s=ra[n.key]||n.key;if(s!=="Unidentified")return s}return n.type==="keypress"?(n=Vi(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?sh[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:sa,charCode:function(n){return n.type==="keypress"?Vi(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?Vi(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),mo=nn(oh),lh=_({},na,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ql=nn(lh),ur=_({},ta,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:sa}),ch=nn(ur),uh=_({},ot,{propertyName:0,elapsedTime:0,pseudoElement:0}),hh=nn(uh),dh=_({},na,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),po=nn(dh),An=_({},ot,{newState:0,oldState:0}),fh=nn(An),mh=[9,13,27,32],ji=bi&&"CompositionEvent"in window,d=null;bi&&"documentMode"in document&&(d=document.documentMode);var v=bi&&"TextEvent"in window&&!d,x=bi&&(!ji||d&&8<d&&11>=d),R=" ",K=!1;function te(n,s){switch(n){case"keyup":return mh.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function pe(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var We=!1;function Xt(n,s){switch(n){case"compositionend":return pe(s);case"keypress":return s.which!==32?null:(K=!0,R);case"textInput":return n=s.data,n===R&&K?null:n;default:return null}}function Je(n,s){if(We)return n==="compositionend"||!ji&&te(n,s)?(n=Hl(),cr=Qr=Di=null,We=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return x&&s.locale!=="ko"?null:s.data;default:return null}}var rn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Wt(n){var s=n&&n.nodeName&&n.nodeName.toLowerCase();return s==="input"?!!rn[n.type]:s==="textarea"}function hr(n,s,o,c){or?lr?lr.push(c):lr=[c]:or=c,s=ed(s,"onChange"),0<s.length&&(o=new oo("onChange","change",null,o,c),n.push({event:o,listeners:s}))}var hn=null,ki=null;function Xl(n){ab(n,0)}function ph(n){var s=Ni(n);if(Ul(s))return n}function Av(n,s){if(n==="change")return s}var Iv=!1;if(bi){var im;if(bi){var rm="oninput"in document;if(!rm){var Nv=document.createElement("div");Nv.setAttribute("oninput","return;"),rm=typeof Nv.oninput=="function"}im=rm}else im=!1;Iv=im&&(!document.documentMode||9<document.documentMode)}function Cv(){hn&&(hn.detachEvent("onpropertychange",Pv),ki=hn=null)}function Pv(n){if(n.propertyName==="value"&&ph(ki)){var s=[];hr(s,ki,n,si(n)),th(Xl,s)}}function YR(n,s,o){n==="focusin"?(Cv(),hn=s,ki=o,hn.attachEvent("onpropertychange",Pv)):n==="focusout"&&Cv()}function $R(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return ph(ki)}function QR(n,s){if(n==="click")return ph(s)}function XR(n,s){if(n==="input"||n==="change")return ph(s)}function WR(n,s){return n===s&&(n!==0||1/n===1/s)||n!==n&&s!==s}var qn=typeof Object.is=="function"?Object.is:WR;function Wl(n,s){if(qn(n,s))return!0;if(typeof n!="object"||n===null||typeof s!="object"||s===null)return!1;var o=Object.keys(n),c=Object.keys(s);if(o.length!==c.length)return!1;for(c=0;c<o.length;c++){var f=o[c];if(!Ue.call(s,f)||!qn(n[f],s[f]))return!1}return!0}function Dv(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function Vv(n,s){var o=Dv(n);n=0;for(var c;o;){if(o.nodeType===3){if(c=n+o.textContent.length,n<=s&&c>=s)return{node:o,offset:s-n};n=c}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=Dv(o)}}function Ov(n,s){return n&&s?n===s?!0:n&&n.nodeType===3?!1:s&&s.nodeType===3?Ov(n,s.parentNode):"contains"in n?n.contains(s):n.compareDocumentPosition?!!(n.compareDocumentPosition(s)&16):!1:!1}function Mv(n){n=n!=null&&n.ownerDocument!=null&&n.ownerDocument.defaultView!=null?n.ownerDocument.defaultView:window;for(var s=Qs(n.document);s instanceof n.HTMLIFrameElement;){try{var o=typeof s.contentWindow.location.href=="string"}catch{o=!1}if(o)n=s.contentWindow;else break;s=Qs(n.document)}return s}function sm(n){var s=n&&n.nodeName&&n.nodeName.toLowerCase();return s&&(s==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||s==="textarea"||n.contentEditable==="true")}var JR=bi&&"documentMode"in document&&11>=document.documentMode,go=null,am=null,Jl=null,om=!1;function jv(n,s,o){var c=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;om||go==null||go!==Qs(c)||(c=go,"selectionStart"in c&&sm(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),Jl&&Wl(Jl,c)||(Jl=c,c=ed(am,"onSelect"),0<c.length&&(s=new oo("onSelect","select",null,s,o),n.push({event:s,listeners:c}),s.target=go)))}function aa(n,s){var o={};return o[n.toLowerCase()]=s.toLowerCase(),o["Webkit"+n]="webkit"+s,o["Moz"+n]="moz"+s,o}var yo={animationend:aa("Animation","AnimationEnd"),animationiteration:aa("Animation","AnimationIteration"),animationstart:aa("Animation","AnimationStart"),transitionrun:aa("Transition","TransitionRun"),transitionstart:aa("Transition","TransitionStart"),transitioncancel:aa("Transition","TransitionCancel"),transitionend:aa("Transition","TransitionEnd")},lm={},kv={};bi&&(kv=document.createElement("div").style,"AnimationEvent"in window||(delete yo.animationend.animation,delete yo.animationiteration.animation,delete yo.animationstart.animation),"TransitionEvent"in window||delete yo.transitionend.transition);function oa(n){if(lm[n])return lm[n];if(!yo[n])return n;var s=yo[n],o;for(o in s)if(s.hasOwnProperty(o)&&o in kv)return lm[n]=s[o];return n}var Lv=oa("animationend"),Fv=oa("animationiteration"),Uv=oa("animationstart"),ZR=oa("transitionrun"),eS=oa("transitionstart"),tS=oa("transitioncancel"),zv=oa("transitionend"),qv=new Map,cm="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");cm.push("scrollEnd");function xi(n,s){qv.set(n,s),_i(s,[n])}var Bv=new WeakMap;function li(n,s){if(typeof n=="object"&&n!==null){var o=Bv.get(n);return o!==void 0?o:(s={value:n,source:s,stack:ro(s)},Bv.set(n,s),s)}return{value:n,source:s,stack:ro(s)}}var ci=[],vo=0,um=0;function gh(){for(var n=vo,s=um=vo=0;s<n;){var o=ci[s];ci[s++]=null;var c=ci[s];ci[s++]=null;var f=ci[s];ci[s++]=null;var g=ci[s];if(ci[s++]=null,c!==null&&f!==null){var E=c.pending;E===null?f.next=f:(f.next=E.next,E.next=f),c.pending=f}g!==0&&Hv(o,f,g)}}function yh(n,s,o,c){ci[vo++]=n,ci[vo++]=s,ci[vo++]=o,ci[vo++]=c,um|=c,n.lanes|=c,n=n.alternate,n!==null&&(n.lanes|=c)}function hm(n,s,o,c){return yh(n,s,o,c),vh(n)}function _o(n,s){return yh(n,null,null,s),vh(n)}function Hv(n,s,o){n.lanes|=o;var c=n.alternate;c!==null&&(c.lanes|=o);for(var f=!1,g=n.return;g!==null;)g.childLanes|=o,c=g.alternate,c!==null&&(c.childLanes|=o),g.tag===22&&(n=g.stateNode,n===null||n._visibility&1||(f=!0)),n=g,g=g.return;return n.tag===3?(g=n.stateNode,f&&s!==null&&(f=31-$t(o),n=g.hiddenUpdates,c=n[f],c===null?n[f]=[s]:c.push(s),s.lane=o|536870912),g):null}function vh(n){if(50<Tc)throw Tc=0,yp=null,Error(r(185));for(var s=n.return;s!==null;)n=s,s=n.return;return n.tag===3?n.stateNode:null}var bo={};function nS(n,s,o,c){this.tag=n,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Bn(n,s,o,c){return new nS(n,s,o,c)}function dm(n){return n=n.prototype,!(!n||!n.isReactComponent)}function dr(n,s){var o=n.alternate;return o===null?(o=Bn(n.tag,s,n.key,n.mode),o.elementType=n.elementType,o.type=n.type,o.stateNode=n.stateNode,o.alternate=n,n.alternate=o):(o.pendingProps=s,o.type=n.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=n.flags&65011712,o.childLanes=n.childLanes,o.lanes=n.lanes,o.child=n.child,o.memoizedProps=n.memoizedProps,o.memoizedState=n.memoizedState,o.updateQueue=n.updateQueue,s=n.dependencies,o.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},o.sibling=n.sibling,o.index=n.index,o.ref=n.ref,o.refCleanup=n.refCleanup,o}function Gv(n,s){n.flags&=65011714;var o=n.alternate;return o===null?(n.childLanes=0,n.lanes=s,n.child=null,n.subtreeFlags=0,n.memoizedProps=null,n.memoizedState=null,n.updateQueue=null,n.dependencies=null,n.stateNode=null):(n.childLanes=o.childLanes,n.lanes=o.lanes,n.child=o.child,n.subtreeFlags=0,n.deletions=null,n.memoizedProps=o.memoizedProps,n.memoizedState=o.memoizedState,n.updateQueue=o.updateQueue,n.type=o.type,s=o.dependencies,n.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),n}function _h(n,s,o,c,f,g){var E=0;if(c=n,typeof n=="function")dm(n)&&(E=1);else if(typeof n=="string")E=rA(n,o,ge.current)?26:n==="html"||n==="head"||n==="body"?27:5;else e:switch(n){case A:return n=Bn(31,o,s,f),n.elementType=A,n.lanes=g,n;case V:return la(o.children,f,g,s);case L:E=8,f|=24;break;case O:return n=Bn(12,o,s,f|2),n.elementType=O,n.lanes=g,n;case B:return n=Bn(13,o,s,f),n.elementType=B,n.lanes=g,n;case re:return n=Bn(19,o,s,f),n.elementType=re,n.lanes=g,n;default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case Z:case G:E=10;break e;case se:E=9;break e;case ne:E=11;break e;case P:E=14;break e;case S:E=16,c=null;break e}E=29,o=Error(r(130,n===null?"null":typeof n,"")),c=null}return s=Bn(E,o,s,f),s.elementType=n,s.type=c,s.lanes=g,s}function la(n,s,o,c){return n=Bn(7,n,c,s),n.lanes=o,n}function fm(n,s,o){return n=Bn(6,n,null,s),n.lanes=o,n}function mm(n,s,o){return s=Bn(4,n.children!==null?n.children:[],n.key,s),s.lanes=o,s.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},s}var xo=[],Eo=0,bh=null,xh=0,ui=[],hi=0,ca=null,fr=1,mr="";function ua(n,s){xo[Eo++]=xh,xo[Eo++]=bh,bh=n,xh=s}function Kv(n,s,o){ui[hi++]=fr,ui[hi++]=mr,ui[hi++]=ca,ca=n;var c=fr;n=mr;var f=32-$t(c)-1;c&=~(1<<f),o+=1;var g=32-$t(s)+f;if(30<g){var E=f-f%5;g=(c&(1<<E)-1).toString(32),c>>=E,f-=E,fr=1<<32-$t(s)+f|o<<f|c,mr=g+n}else fr=1<<g|o<<f|c,mr=n}function pm(n){n.return!==null&&(ua(n,1),Kv(n,1,0))}function gm(n){for(;n===bh;)bh=xo[--Eo],xo[Eo]=null,xh=xo[--Eo],xo[Eo]=null;for(;n===ca;)ca=ui[--hi],ui[hi]=null,mr=ui[--hi],ui[hi]=null,fr=ui[--hi],ui[hi]=null}var In=null,Ct=null,st=!1,ha=null,Li=!1,ym=Error(r(519));function da(n){var s=Error(r(418,""));throw tc(li(s,n)),ym}function Yv(n){var s=n.stateNode,o=n.type,c=n.memoizedProps;switch(s[Qt]=n,s[Ft]=c,o){case"dialog":Be("cancel",s),Be("close",s);break;case"iframe":case"object":case"embed":Be("load",s);break;case"video":case"audio":for(o=0;o<Rc.length;o++)Be(Rc[o],s);break;case"source":Be("error",s);break;case"img":case"image":case"link":Be("error",s),Be("load",s);break;case"details":Be("toggle",s);break;case"input":Be("invalid",s),Xs(s,c.value,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name,!0),so(s);break;case"select":Be("invalid",s);break;case"textarea":Be("invalid",s),Ws(s,c.value,c.defaultValue,c.children),so(s)}o=c.children,typeof o!="string"&&typeof o!="number"&&typeof o!="bigint"||s.textContent===""+o||c.suppressHydrationWarning===!0||ub(s.textContent,o)?(c.popover!=null&&(Be("beforetoggle",s),Be("toggle",s)),c.onScroll!=null&&Be("scroll",s),c.onScrollEnd!=null&&Be("scrollend",s),c.onClick!=null&&(s.onclick=td),s=!0):s=!1,s||da(n)}function $v(n){for(In=n.return;In;)switch(In.tag){case 5:case 13:Li=!1;return;case 27:case 3:Li=!0;return;default:In=In.return}}function Zl(n){if(n!==In)return!1;if(!st)return $v(n),st=!0,!1;var s=n.tag,o;if((o=s!==3&&s!==27)&&((o=s===5)&&(o=n.type,o=!(o!=="form"&&o!=="button")||Vp(n.type,n.memoizedProps)),o=!o),o&&Ct&&da(n),$v(n),s===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(r(317));e:{for(n=n.nextSibling,s=0;n;){if(n.nodeType===8)if(o=n.data,o==="/$"){if(s===0){Ct=Ti(n.nextSibling);break e}s--}else o!=="$"&&o!=="$!"&&o!=="$?"||s++;n=n.nextSibling}Ct=null}}else s===27?(s=Ct,hs(n.type)?(n=kp,kp=null,Ct=n):Ct=s):Ct=In?Ti(n.stateNode.nextSibling):null;return!0}function ec(){Ct=In=null,st=!1}function Qv(){var n=ha;return n!==null&&(kn===null?kn=n:kn.push.apply(kn,n),ha=null),n}function tc(n){ha===null?ha=[n]:ha.push(n)}var vm=U(null),fa=null,pr=null;function Xr(n,s,o){ie(vm,s._currentValue),s._currentValue=o}function gr(n){n._currentValue=vm.current,ee(vm)}function _m(n,s,o){for(;n!==null;){var c=n.alternate;if((n.childLanes&s)!==s?(n.childLanes|=s,c!==null&&(c.childLanes|=s)):c!==null&&(c.childLanes&s)!==s&&(c.childLanes|=s),n===o)break;n=n.return}}function bm(n,s,o,c){var f=n.child;for(f!==null&&(f.return=n);f!==null;){var g=f.dependencies;if(g!==null){var E=f.child;g=g.firstContext;e:for(;g!==null;){var w=g;g=f;for(var j=0;j<s.length;j++)if(w.context===s[j]){g.lanes|=o,w=g.alternate,w!==null&&(w.lanes|=o),_m(g.return,o,n),c||(E=null);break e}g=w.next}}else if(f.tag===18){if(E=f.return,E===null)throw Error(r(341));E.lanes|=o,g=E.alternate,g!==null&&(g.lanes|=o),_m(E,o,n),E=null}else E=f.child;if(E!==null)E.return=f;else for(E=f;E!==null;){if(E===n){E=null;break}if(f=E.sibling,f!==null){f.return=E.return,E=f;break}E=E.return}f=E}}function nc(n,s,o,c){n=null;for(var f=s,g=!1;f!==null;){if(!g){if((f.flags&524288)!==0)g=!0;else if((f.flags&262144)!==0)break}if(f.tag===10){var E=f.alternate;if(E===null)throw Error(r(387));if(E=E.memoizedProps,E!==null){var w=f.type;qn(f.pendingProps.value,E.value)||(n!==null?n.push(w):n=[w])}}else if(f===$e.current){if(E=f.alternate,E===null)throw Error(r(387));E.memoizedState.memoizedState!==f.memoizedState.memoizedState&&(n!==null?n.push(Pc):n=[Pc])}f=f.return}n!==null&&bm(s,n,o,c),s.flags|=262144}function Eh(n){for(n=n.firstContext;n!==null;){if(!qn(n.context._currentValue,n.memoizedValue))return!0;n=n.next}return!1}function ma(n){fa=n,pr=null,n=n.dependencies,n!==null&&(n.firstContext=null)}function yn(n){return Xv(fa,n)}function Th(n,s){return fa===null&&ma(n),Xv(n,s)}function Xv(n,s){var o=s._currentValue;if(s={context:s,memoizedValue:o,next:null},pr===null){if(n===null)throw Error(r(308));pr=s,n.dependencies={lanes:0,firstContext:s},n.flags|=524288}else pr=pr.next=s;return o}var iS=typeof AbortController<"u"?AbortController:function(){var n=[],s=this.signal={aborted:!1,addEventListener:function(o,c){n.push(c)}};this.abort=function(){s.aborted=!0,n.forEach(function(o){return o()})}},rS=i.unstable_scheduleCallback,sS=i.unstable_NormalPriority,Jt={$$typeof:G,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function xm(){return{controller:new iS,data:new Map,refCount:0}}function ic(n){n.refCount--,n.refCount===0&&rS(sS,function(){n.controller.abort()})}var rc=null,Em=0,To=0,wo=null;function aS(n,s){if(rc===null){var o=rc=[];Em=0,To=wp(),wo={status:"pending",value:void 0,then:function(c){o.push(c)}}}return Em++,s.then(Wv,Wv),s}function Wv(){if(--Em===0&&rc!==null){wo!==null&&(wo.status="fulfilled");var n=rc;rc=null,To=0,wo=null;for(var s=0;s<n.length;s++)(0,n[s])()}}function oS(n,s){var o=[],c={status:"pending",value:null,reason:null,then:function(f){o.push(f)}};return n.then(function(){c.status="fulfilled",c.value=s;for(var f=0;f<o.length;f++)(0,o[f])(s)},function(f){for(c.status="rejected",c.reason=f,f=0;f<o.length;f++)(0,o[f])(void 0)}),c}var Jv=z.S;z.S=function(n,s){typeof s=="object"&&s!==null&&typeof s.then=="function"&&aS(n,s),Jv!==null&&Jv(n,s)};var pa=U(null);function Tm(){var n=pa.current;return n!==null?n:bt.pooledCache}function wh(n,s){s===null?ie(pa,pa.current):ie(pa,s.pool)}function Zv(){var n=Tm();return n===null?null:{parent:Jt._currentValue,pool:n}}var sc=Error(r(460)),e0=Error(r(474)),Rh=Error(r(542)),wm={then:function(){}};function t0(n){return n=n.status,n==="fulfilled"||n==="rejected"}function Sh(){}function n0(n,s,o){switch(o=n[o],o===void 0?n.push(s):o!==s&&(s.then(Sh,Sh),s=o),s.status){case"fulfilled":return s.value;case"rejected":throw n=s.reason,r0(n),n;default:if(typeof s.status=="string")s.then(Sh,Sh);else{if(n=bt,n!==null&&100<n.shellSuspendCounter)throw Error(r(482));n=s,n.status="pending",n.then(function(c){if(s.status==="pending"){var f=s;f.status="fulfilled",f.value=c}},function(c){if(s.status==="pending"){var f=s;f.status="rejected",f.reason=c}})}switch(s.status){case"fulfilled":return s.value;case"rejected":throw n=s.reason,r0(n),n}throw ac=s,sc}}var ac=null;function i0(){if(ac===null)throw Error(r(459));var n=ac;return ac=null,n}function r0(n){if(n===sc||n===Rh)throw Error(r(483))}var Wr=!1;function Rm(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Sm(n,s){n=n.updateQueue,s.updateQueue===n&&(s.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,callbacks:null})}function Jr(n){return{lane:n,tag:0,payload:null,callback:null,next:null}}function Zr(n,s,o){var c=n.updateQueue;if(c===null)return null;if(c=c.shared,(lt&2)!==0){var f=c.pending;return f===null?s.next=s:(s.next=f.next,f.next=s),c.pending=s,s=vh(n),Hv(n,null,o),s}return yh(n,c,s,o),vh(n)}function oc(n,s,o){if(s=s.updateQueue,s!==null&&(s=s.shared,(o&4194048)!==0)){var c=s.lanes;c&=n.pendingLanes,o|=c,s.lanes=o,Ml(n,o)}}function Am(n,s){var o=n.updateQueue,c=n.alternate;if(c!==null&&(c=c.updateQueue,o===c)){var f=null,g=null;if(o=o.firstBaseUpdate,o!==null){do{var E={lane:o.lane,tag:o.tag,payload:o.payload,callback:null,next:null};g===null?f=g=E:g=g.next=E,o=o.next}while(o!==null);g===null?f=g=s:g=g.next=s}else f=g=s;o={baseState:c.baseState,firstBaseUpdate:f,lastBaseUpdate:g,shared:c.shared,callbacks:c.callbacks},n.updateQueue=o;return}n=o.lastBaseUpdate,n===null?o.firstBaseUpdate=s:n.next=s,o.lastBaseUpdate=s}var Im=!1;function lc(){if(Im){var n=wo;if(n!==null)throw n}}function cc(n,s,o,c){Im=!1;var f=n.updateQueue;Wr=!1;var g=f.firstBaseUpdate,E=f.lastBaseUpdate,w=f.shared.pending;if(w!==null){f.shared.pending=null;var j=w,Q=j.next;j.next=null,E===null?g=Q:E.next=Q,E=j;var le=n.alternate;le!==null&&(le=le.updateQueue,w=le.lastBaseUpdate,w!==E&&(w===null?le.firstBaseUpdate=Q:w.next=Q,le.lastBaseUpdate=j))}if(g!==null){var he=f.baseState;E=0,le=Q=j=null,w=g;do{var W=w.lane&-536870913,J=W!==w.lane;if(J?(Ze&W)===W:(c&W)===W){W!==0&&W===To&&(Im=!0),le!==null&&(le=le.next={lane:0,tag:w.tag,payload:w.payload,callback:null,next:null});e:{var Pe=n,Ae=w;W=s;var vt=o;switch(Ae.tag){case 1:if(Pe=Ae.payload,typeof Pe=="function"){he=Pe.call(vt,he,W);break e}he=Pe;break e;case 3:Pe.flags=Pe.flags&-65537|128;case 0:if(Pe=Ae.payload,W=typeof Pe=="function"?Pe.call(vt,he,W):Pe,W==null)break e;he=_({},he,W);break e;case 2:Wr=!0}}W=w.callback,W!==null&&(n.flags|=64,J&&(n.flags|=8192),J=f.callbacks,J===null?f.callbacks=[W]:J.push(W))}else J={lane:W,tag:w.tag,payload:w.payload,callback:w.callback,next:null},le===null?(Q=le=J,j=he):le=le.next=J,E|=W;if(w=w.next,w===null){if(w=f.shared.pending,w===null)break;J=w,w=J.next,J.next=null,f.lastBaseUpdate=J,f.shared.pending=null}}while(!0);le===null&&(j=he),f.baseState=j,f.firstBaseUpdate=Q,f.lastBaseUpdate=le,g===null&&(f.shared.lanes=0),os|=E,n.lanes=E,n.memoizedState=he}}function s0(n,s){if(typeof n!="function")throw Error(r(191,n));n.call(s)}function a0(n,s){var o=n.callbacks;if(o!==null)for(n.callbacks=null,n=0;n<o.length;n++)s0(o[n],s)}var Ro=U(null),Ah=U(0);function o0(n,s){n=Tr,ie(Ah,n),ie(Ro,s),Tr=n|s.baseLanes}function Nm(){ie(Ah,Tr),ie(Ro,Ro.current)}function Cm(){Tr=Ah.current,ee(Ro),ee(Ah)}var es=0,Le=null,gt=null,zt=null,Ih=!1,So=!1,ga=!1,Nh=0,uc=0,Ao=null,lS=0;function Mt(){throw Error(r(321))}function Pm(n,s){if(s===null)return!1;for(var o=0;o<s.length&&o<n.length;o++)if(!qn(n[o],s[o]))return!1;return!0}function Dm(n,s,o,c,f,g){return es=g,Le=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,z.H=n===null||n.memoizedState===null?H0:G0,ga=!1,g=o(c,f),ga=!1,So&&(g=c0(s,o,c,f)),l0(n),g}function l0(n){z.H=Mh;var s=gt!==null&&gt.next!==null;if(es=0,zt=gt=Le=null,Ih=!1,uc=0,Ao=null,s)throw Error(r(300));n===null||sn||(n=n.dependencies,n!==null&&Eh(n)&&(sn=!0))}function c0(n,s,o,c){Le=n;var f=0;do{if(So&&(Ao=null),uc=0,So=!1,25<=f)throw Error(r(301));if(f+=1,zt=gt=null,n.updateQueue!=null){var g=n.updateQueue;g.lastEffect=null,g.events=null,g.stores=null,g.memoCache!=null&&(g.memoCache.index=0)}z.H=pS,g=s(o,c)}while(So);return g}function cS(){var n=z.H,s=n.useState()[0];return s=typeof s.then=="function"?hc(s):s,n=n.useState()[0],(gt!==null?gt.memoizedState:null)!==n&&(Le.flags|=1024),s}function Vm(){var n=Nh!==0;return Nh=0,n}function Om(n,s,o){s.updateQueue=n.updateQueue,s.flags&=-2053,n.lanes&=~o}function Mm(n){if(Ih){for(n=n.memoizedState;n!==null;){var s=n.queue;s!==null&&(s.pending=null),n=n.next}Ih=!1}es=0,zt=gt=Le=null,So=!1,uc=Nh=0,Ao=null}function Mn(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return zt===null?Le.memoizedState=zt=n:zt=zt.next=n,zt}function qt(){if(gt===null){var n=Le.alternate;n=n!==null?n.memoizedState:null}else n=gt.next;var s=zt===null?Le.memoizedState:zt.next;if(s!==null)zt=s,gt=n;else{if(n===null)throw Le.alternate===null?Error(r(467)):Error(r(310));gt=n,n={memoizedState:gt.memoizedState,baseState:gt.baseState,baseQueue:gt.baseQueue,queue:gt.queue,next:null},zt===null?Le.memoizedState=zt=n:zt=zt.next=n}return zt}function jm(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function hc(n){var s=uc;return uc+=1,Ao===null&&(Ao=[]),n=n0(Ao,n,s),s=Le,(zt===null?s.memoizedState:zt.next)===null&&(s=s.alternate,z.H=s===null||s.memoizedState===null?H0:G0),n}function Ch(n){if(n!==null&&typeof n=="object"){if(typeof n.then=="function")return hc(n);if(n.$$typeof===G)return yn(n)}throw Error(r(438,String(n)))}function km(n){var s=null,o=Le.updateQueue;if(o!==null&&(s=o.memoCache),s==null){var c=Le.alternate;c!==null&&(c=c.updateQueue,c!==null&&(c=c.memoCache,c!=null&&(s={data:c.data.map(function(f){return f.slice()}),index:0})))}if(s==null&&(s={data:[],index:0}),o===null&&(o=jm(),Le.updateQueue=o),o.memoCache=s,o=s.data[s.index],o===void 0)for(o=s.data[s.index]=Array(n),c=0;c<n;c++)o[c]=M;return s.index++,o}function yr(n,s){return typeof s=="function"?s(n):s}function Ph(n){var s=qt();return Lm(s,gt,n)}function Lm(n,s,o){var c=n.queue;if(c===null)throw Error(r(311));c.lastRenderedReducer=o;var f=n.baseQueue,g=c.pending;if(g!==null){if(f!==null){var E=f.next;f.next=g.next,g.next=E}s.baseQueue=f=g,c.pending=null}if(g=n.baseState,f===null)n.memoizedState=g;else{s=f.next;var w=E=null,j=null,Q=s,le=!1;do{var he=Q.lane&-536870913;if(he!==Q.lane?(Ze&he)===he:(es&he)===he){var W=Q.revertLane;if(W===0)j!==null&&(j=j.next={lane:0,revertLane:0,action:Q.action,hasEagerState:Q.hasEagerState,eagerState:Q.eagerState,next:null}),he===To&&(le=!0);else if((es&W)===W){Q=Q.next,W===To&&(le=!0);continue}else he={lane:0,revertLane:Q.revertLane,action:Q.action,hasEagerState:Q.hasEagerState,eagerState:Q.eagerState,next:null},j===null?(w=j=he,E=g):j=j.next=he,Le.lanes|=W,os|=W;he=Q.action,ga&&o(g,he),g=Q.hasEagerState?Q.eagerState:o(g,he)}else W={lane:he,revertLane:Q.revertLane,action:Q.action,hasEagerState:Q.hasEagerState,eagerState:Q.eagerState,next:null},j===null?(w=j=W,E=g):j=j.next=W,Le.lanes|=he,os|=he;Q=Q.next}while(Q!==null&&Q!==s);if(j===null?E=g:j.next=w,!qn(g,n.memoizedState)&&(sn=!0,le&&(o=wo,o!==null)))throw o;n.memoizedState=g,n.baseState=E,n.baseQueue=j,c.lastRenderedState=g}return f===null&&(c.lanes=0),[n.memoizedState,c.dispatch]}function Fm(n){var s=qt(),o=s.queue;if(o===null)throw Error(r(311));o.lastRenderedReducer=n;var c=o.dispatch,f=o.pending,g=s.memoizedState;if(f!==null){o.pending=null;var E=f=f.next;do g=n(g,E.action),E=E.next;while(E!==f);qn(g,s.memoizedState)||(sn=!0),s.memoizedState=g,s.baseQueue===null&&(s.baseState=g),o.lastRenderedState=g}return[g,c]}function u0(n,s,o){var c=Le,f=qt(),g=st;if(g){if(o===void 0)throw Error(r(407));o=o()}else o=s();var E=!qn((gt||f).memoizedState,o);E&&(f.memoizedState=o,sn=!0),f=f.queue;var w=f0.bind(null,c,f,n);if(dc(2048,8,w,[n]),f.getSnapshot!==s||E||zt!==null&&zt.memoizedState.tag&1){if(c.flags|=2048,Io(9,Dh(),d0.bind(null,c,f,o,s),null),bt===null)throw Error(r(349));g||(es&124)!==0||h0(c,s,o)}return o}function h0(n,s,o){n.flags|=16384,n={getSnapshot:s,value:o},s=Le.updateQueue,s===null?(s=jm(),Le.updateQueue=s,s.stores=[n]):(o=s.stores,o===null?s.stores=[n]:o.push(n))}function d0(n,s,o,c){s.value=o,s.getSnapshot=c,m0(s)&&p0(n)}function f0(n,s,o){return o(function(){m0(s)&&p0(n)})}function m0(n){var s=n.getSnapshot;n=n.value;try{var o=s();return!qn(n,o)}catch{return!0}}function p0(n){var s=_o(n,2);s!==null&&$n(s,n,2)}function Um(n){var s=Mn();if(typeof n=="function"){var o=n;if(n=o(),ga){wn(!0);try{o()}finally{wn(!1)}}}return s.memoizedState=s.baseState=n,s.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:yr,lastRenderedState:n},s}function g0(n,s,o,c){return n.baseState=o,Lm(n,gt,typeof c=="function"?c:yr)}function uS(n,s,o,c,f){if(Oh(n))throw Error(r(485));if(n=s.action,n!==null){var g={payload:f,action:n,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(E){g.listeners.push(E)}};z.T!==null?o(!0):g.isTransition=!1,c(g),o=s.pending,o===null?(g.next=s.pending=g,y0(s,g)):(g.next=o.next,s.pending=o.next=g)}}function y0(n,s){var o=s.action,c=s.payload,f=n.state;if(s.isTransition){var g=z.T,E={};z.T=E;try{var w=o(f,c),j=z.S;j!==null&&j(E,w),v0(n,s,w)}catch(Q){zm(n,s,Q)}finally{z.T=g}}else try{g=o(f,c),v0(n,s,g)}catch(Q){zm(n,s,Q)}}function v0(n,s,o){o!==null&&typeof o=="object"&&typeof o.then=="function"?o.then(function(c){_0(n,s,c)},function(c){return zm(n,s,c)}):_0(n,s,o)}function _0(n,s,o){s.status="fulfilled",s.value=o,b0(s),n.state=o,s=n.pending,s!==null&&(o=s.next,o===s?n.pending=null:(o=o.next,s.next=o,y0(n,o)))}function zm(n,s,o){var c=n.pending;if(n.pending=null,c!==null){c=c.next;do s.status="rejected",s.reason=o,b0(s),s=s.next;while(s!==c)}n.action=null}function b0(n){n=n.listeners;for(var s=0;s<n.length;s++)(0,n[s])()}function x0(n,s){return s}function E0(n,s){if(st){var o=bt.formState;if(o!==null){e:{var c=Le;if(st){if(Ct){t:{for(var f=Ct,g=Li;f.nodeType!==8;){if(!g){f=null;break t}if(f=Ti(f.nextSibling),f===null){f=null;break t}}g=f.data,f=g==="F!"||g==="F"?f:null}if(f){Ct=Ti(f.nextSibling),c=f.data==="F!";break e}}da(c)}c=!1}c&&(s=o[0])}}return o=Mn(),o.memoizedState=o.baseState=s,c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:x0,lastRenderedState:s},o.queue=c,o=z0.bind(null,Le,c),c.dispatch=o,c=Um(!1),g=Km.bind(null,Le,!1,c.queue),c=Mn(),f={state:s,dispatch:null,action:n,pending:null},c.queue=f,o=uS.bind(null,Le,f,g,o),f.dispatch=o,c.memoizedState=n,[s,o,!1]}function T0(n){var s=qt();return w0(s,gt,n)}function w0(n,s,o){if(s=Lm(n,s,x0)[0],n=Ph(yr)[0],typeof s=="object"&&s!==null&&typeof s.then=="function")try{var c=hc(s)}catch(E){throw E===sc?Rh:E}else c=s;s=qt();var f=s.queue,g=f.dispatch;return o!==s.memoizedState&&(Le.flags|=2048,Io(9,Dh(),hS.bind(null,f,o),null)),[c,g,n]}function hS(n,s){n.action=s}function R0(n){var s=qt(),o=gt;if(o!==null)return w0(s,o,n);qt(),s=s.memoizedState,o=qt();var c=o.queue.dispatch;return o.memoizedState=n,[s,c,!1]}function Io(n,s,o,c){return n={tag:n,create:o,deps:c,inst:s,next:null},s=Le.updateQueue,s===null&&(s=jm(),Le.updateQueue=s),o=s.lastEffect,o===null?s.lastEffect=n.next=n:(c=o.next,o.next=n,n.next=c,s.lastEffect=n),n}function Dh(){return{destroy:void 0,resource:void 0}}function S0(){return qt().memoizedState}function Vh(n,s,o,c){var f=Mn();c=c===void 0?null:c,Le.flags|=n,f.memoizedState=Io(1|s,Dh(),o,c)}function dc(n,s,o,c){var f=qt();c=c===void 0?null:c;var g=f.memoizedState.inst;gt!==null&&c!==null&&Pm(c,gt.memoizedState.deps)?f.memoizedState=Io(s,g,o,c):(Le.flags|=n,f.memoizedState=Io(1|s,g,o,c))}function A0(n,s){Vh(8390656,8,n,s)}function I0(n,s){dc(2048,8,n,s)}function N0(n,s){return dc(4,2,n,s)}function C0(n,s){return dc(4,4,n,s)}function P0(n,s){if(typeof s=="function"){n=n();var o=s(n);return function(){typeof o=="function"?o():s(null)}}if(s!=null)return n=n(),s.current=n,function(){s.current=null}}function D0(n,s,o){o=o!=null?o.concat([n]):null,dc(4,4,P0.bind(null,s,n),o)}function qm(){}function V0(n,s){var o=qt();s=s===void 0?null:s;var c=o.memoizedState;return s!==null&&Pm(s,c[1])?c[0]:(o.memoizedState=[n,s],n)}function O0(n,s){var o=qt();s=s===void 0?null:s;var c=o.memoizedState;if(s!==null&&Pm(s,c[1]))return c[0];if(c=n(),ga){wn(!0);try{n()}finally{wn(!1)}}return o.memoizedState=[c,s],c}function Bm(n,s,o){return o===void 0||(es&1073741824)!==0?n.memoizedState=s:(n.memoizedState=o,n=k_(),Le.lanes|=n,os|=n,o)}function M0(n,s,o,c){return qn(o,s)?o:Ro.current!==null?(n=Bm(n,o,c),qn(n,s)||(sn=!0),n):(es&42)===0?(sn=!0,n.memoizedState=o):(n=k_(),Le.lanes|=n,os|=n,s)}function j0(n,s,o,c,f){var g=X.p;X.p=g!==0&&8>g?g:8;var E=z.T,w={};z.T=w,Km(n,!1,s,o);try{var j=f(),Q=z.S;if(Q!==null&&Q(w,j),j!==null&&typeof j=="object"&&typeof j.then=="function"){var le=oS(j,c);fc(n,s,le,Yn(n))}else fc(n,s,c,Yn(n))}catch(he){fc(n,s,{then:function(){},status:"rejected",reason:he},Yn())}finally{X.p=g,z.T=E}}function dS(){}function Hm(n,s,o,c){if(n.tag!==5)throw Error(r(476));var f=k0(n).queue;j0(n,f,s,ae,o===null?dS:function(){return L0(n),o(c)})}function k0(n){var s=n.memoizedState;if(s!==null)return s;s={memoizedState:ae,baseState:ae,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:yr,lastRenderedState:ae},next:null};var o={};return s.next={memoizedState:o,baseState:o,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:yr,lastRenderedState:o},next:null},n.memoizedState=s,n=n.alternate,n!==null&&(n.memoizedState=s),s}function L0(n){var s=k0(n).next.queue;fc(n,s,{},Yn())}function Gm(){return yn(Pc)}function F0(){return qt().memoizedState}function U0(){return qt().memoizedState}function fS(n){for(var s=n.return;s!==null;){switch(s.tag){case 24:case 3:var o=Yn();n=Jr(o);var c=Zr(s,n,o);c!==null&&($n(c,s,o),oc(c,s,o)),s={cache:xm()},n.payload=s;return}s=s.return}}function mS(n,s,o){var c=Yn();o={lane:c,revertLane:0,action:o,hasEagerState:!1,eagerState:null,next:null},Oh(n)?q0(s,o):(o=hm(n,s,o,c),o!==null&&($n(o,n,c),B0(o,s,c)))}function z0(n,s,o){var c=Yn();fc(n,s,o,c)}function fc(n,s,o,c){var f={lane:c,revertLane:0,action:o,hasEagerState:!1,eagerState:null,next:null};if(Oh(n))q0(s,f);else{var g=n.alternate;if(n.lanes===0&&(g===null||g.lanes===0)&&(g=s.lastRenderedReducer,g!==null))try{var E=s.lastRenderedState,w=g(E,o);if(f.hasEagerState=!0,f.eagerState=w,qn(w,E))return yh(n,s,f,0),bt===null&&gh(),!1}catch{}finally{}if(o=hm(n,s,f,c),o!==null)return $n(o,n,c),B0(o,s,c),!0}return!1}function Km(n,s,o,c){if(c={lane:2,revertLane:wp(),action:c,hasEagerState:!1,eagerState:null,next:null},Oh(n)){if(s)throw Error(r(479))}else s=hm(n,o,c,2),s!==null&&$n(s,n,2)}function Oh(n){var s=n.alternate;return n===Le||s!==null&&s===Le}function q0(n,s){So=Ih=!0;var o=n.pending;o===null?s.next=s:(s.next=o.next,o.next=s),n.pending=s}function B0(n,s,o){if((o&4194048)!==0){var c=s.lanes;c&=n.pendingLanes,o|=c,s.lanes=o,Ml(n,o)}}var Mh={readContext:yn,use:Ch,useCallback:Mt,useContext:Mt,useEffect:Mt,useImperativeHandle:Mt,useLayoutEffect:Mt,useInsertionEffect:Mt,useMemo:Mt,useReducer:Mt,useRef:Mt,useState:Mt,useDebugValue:Mt,useDeferredValue:Mt,useTransition:Mt,useSyncExternalStore:Mt,useId:Mt,useHostTransitionStatus:Mt,useFormState:Mt,useActionState:Mt,useOptimistic:Mt,useMemoCache:Mt,useCacheRefresh:Mt},H0={readContext:yn,use:Ch,useCallback:function(n,s){return Mn().memoizedState=[n,s===void 0?null:s],n},useContext:yn,useEffect:A0,useImperativeHandle:function(n,s,o){o=o!=null?o.concat([n]):null,Vh(4194308,4,P0.bind(null,s,n),o)},useLayoutEffect:function(n,s){return Vh(4194308,4,n,s)},useInsertionEffect:function(n,s){Vh(4,2,n,s)},useMemo:function(n,s){var o=Mn();s=s===void 0?null:s;var c=n();if(ga){wn(!0);try{n()}finally{wn(!1)}}return o.memoizedState=[c,s],c},useReducer:function(n,s,o){var c=Mn();if(o!==void 0){var f=o(s);if(ga){wn(!0);try{o(s)}finally{wn(!1)}}}else f=s;return c.memoizedState=c.baseState=f,n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:f},c.queue=n,n=n.dispatch=mS.bind(null,Le,n),[c.memoizedState,n]},useRef:function(n){var s=Mn();return n={current:n},s.memoizedState=n},useState:function(n){n=Um(n);var s=n.queue,o=z0.bind(null,Le,s);return s.dispatch=o,[n.memoizedState,o]},useDebugValue:qm,useDeferredValue:function(n,s){var o=Mn();return Bm(o,n,s)},useTransition:function(){var n=Um(!1);return n=j0.bind(null,Le,n.queue,!0,!1),Mn().memoizedState=n,[!1,n]},useSyncExternalStore:function(n,s,o){var c=Le,f=Mn();if(st){if(o===void 0)throw Error(r(407));o=o()}else{if(o=s(),bt===null)throw Error(r(349));(Ze&124)!==0||h0(c,s,o)}f.memoizedState=o;var g={value:o,getSnapshot:s};return f.queue=g,A0(f0.bind(null,c,g,n),[n]),c.flags|=2048,Io(9,Dh(),d0.bind(null,c,g,o,s),null),o},useId:function(){var n=Mn(),s=bt.identifierPrefix;if(st){var o=mr,c=fr;o=(c&~(1<<32-$t(c)-1)).toString(32)+o,s="«"+s+"R"+o,o=Nh++,0<o&&(s+="H"+o.toString(32)),s+="»"}else o=lS++,s="«"+s+"r"+o.toString(32)+"»";return n.memoizedState=s},useHostTransitionStatus:Gm,useFormState:E0,useActionState:E0,useOptimistic:function(n){var s=Mn();s.memoizedState=s.baseState=n;var o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return s.queue=o,s=Km.bind(null,Le,!0,o),o.dispatch=s,[n,s]},useMemoCache:km,useCacheRefresh:function(){return Mn().memoizedState=fS.bind(null,Le)}},G0={readContext:yn,use:Ch,useCallback:V0,useContext:yn,useEffect:I0,useImperativeHandle:D0,useInsertionEffect:N0,useLayoutEffect:C0,useMemo:O0,useReducer:Ph,useRef:S0,useState:function(){return Ph(yr)},useDebugValue:qm,useDeferredValue:function(n,s){var o=qt();return M0(o,gt.memoizedState,n,s)},useTransition:function(){var n=Ph(yr)[0],s=qt().memoizedState;return[typeof n=="boolean"?n:hc(n),s]},useSyncExternalStore:u0,useId:F0,useHostTransitionStatus:Gm,useFormState:T0,useActionState:T0,useOptimistic:function(n,s){var o=qt();return g0(o,gt,n,s)},useMemoCache:km,useCacheRefresh:U0},pS={readContext:yn,use:Ch,useCallback:V0,useContext:yn,useEffect:I0,useImperativeHandle:D0,useInsertionEffect:N0,useLayoutEffect:C0,useMemo:O0,useReducer:Fm,useRef:S0,useState:function(){return Fm(yr)},useDebugValue:qm,useDeferredValue:function(n,s){var o=qt();return gt===null?Bm(o,n,s):M0(o,gt.memoizedState,n,s)},useTransition:function(){var n=Fm(yr)[0],s=qt().memoizedState;return[typeof n=="boolean"?n:hc(n),s]},useSyncExternalStore:u0,useId:F0,useHostTransitionStatus:Gm,useFormState:R0,useActionState:R0,useOptimistic:function(n,s){var o=qt();return gt!==null?g0(o,gt,n,s):(o.baseState=n,[n,o.queue.dispatch])},useMemoCache:km,useCacheRefresh:U0},No=null,mc=0;function jh(n){var s=mc;return mc+=1,No===null&&(No=[]),n0(No,n,s)}function pc(n,s){s=s.props.ref,n.ref=s!==void 0?s:null}function kh(n,s){throw s.$$typeof===b?Error(r(525)):(n=Object.prototype.toString.call(s),Error(r(31,n==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":n)))}function K0(n){var s=n._init;return s(n._payload)}function Y0(n){function s(H,F){if(n){var $=H.deletions;$===null?(H.deletions=[F],H.flags|=16):$.push(F)}}function o(H,F){if(!n)return null;for(;F!==null;)s(H,F),F=F.sibling;return null}function c(H){for(var F=new Map;H!==null;)H.key!==null?F.set(H.key,H):F.set(H.index,H),H=H.sibling;return F}function f(H,F){return H=dr(H,F),H.index=0,H.sibling=null,H}function g(H,F,$){return H.index=$,n?($=H.alternate,$!==null?($=$.index,$<F?(H.flags|=67108866,F):$):(H.flags|=67108866,F)):(H.flags|=1048576,F)}function E(H){return n&&H.alternate===null&&(H.flags|=67108866),H}function w(H,F,$,ce){return F===null||F.tag!==6?(F=fm($,H.mode,ce),F.return=H,F):(F=f(F,$),F.return=H,F)}function j(H,F,$,ce){var Ee=$.type;return Ee===V?le(H,F,$.props.children,ce,$.key):F!==null&&(F.elementType===Ee||typeof Ee=="object"&&Ee!==null&&Ee.$$typeof===S&&K0(Ee)===F.type)?(F=f(F,$.props),pc(F,$),F.return=H,F):(F=_h($.type,$.key,$.props,null,H.mode,ce),pc(F,$),F.return=H,F)}function Q(H,F,$,ce){return F===null||F.tag!==4||F.stateNode.containerInfo!==$.containerInfo||F.stateNode.implementation!==$.implementation?(F=mm($,H.mode,ce),F.return=H,F):(F=f(F,$.children||[]),F.return=H,F)}function le(H,F,$,ce,Ee){return F===null||F.tag!==7?(F=la($,H.mode,ce,Ee),F.return=H,F):(F=f(F,$),F.return=H,F)}function he(H,F,$){if(typeof F=="string"&&F!==""||typeof F=="number"||typeof F=="bigint")return F=fm(""+F,H.mode,$),F.return=H,F;if(typeof F=="object"&&F!==null){switch(F.$$typeof){case T:return $=_h(F.type,F.key,F.props,null,H.mode,$),pc($,F),$.return=H,$;case I:return F=mm(F,H.mode,$),F.return=H,F;case S:var ce=F._init;return F=ce(F._payload),he(H,F,$)}if(de(F)||k(F))return F=la(F,H.mode,$,null),F.return=H,F;if(typeof F.then=="function")return he(H,jh(F),$);if(F.$$typeof===G)return he(H,Th(H,F),$);kh(H,F)}return null}function W(H,F,$,ce){var Ee=F!==null?F.key:null;if(typeof $=="string"&&$!==""||typeof $=="number"||typeof $=="bigint")return Ee!==null?null:w(H,F,""+$,ce);if(typeof $=="object"&&$!==null){switch($.$$typeof){case T:return $.key===Ee?j(H,F,$,ce):null;case I:return $.key===Ee?Q(H,F,$,ce):null;case S:return Ee=$._init,$=Ee($._payload),W(H,F,$,ce)}if(de($)||k($))return Ee!==null?null:le(H,F,$,ce,null);if(typeof $.then=="function")return W(H,F,jh($),ce);if($.$$typeof===G)return W(H,F,Th(H,$),ce);kh(H,$)}return null}function J(H,F,$,ce,Ee){if(typeof ce=="string"&&ce!==""||typeof ce=="number"||typeof ce=="bigint")return H=H.get($)||null,w(F,H,""+ce,Ee);if(typeof ce=="object"&&ce!==null){switch(ce.$$typeof){case T:return H=H.get(ce.key===null?$:ce.key)||null,j(F,H,ce,Ee);case I:return H=H.get(ce.key===null?$:ce.key)||null,Q(F,H,ce,Ee);case S:var ze=ce._init;return ce=ze(ce._payload),J(H,F,$,ce,Ee)}if(de(ce)||k(ce))return H=H.get($)||null,le(F,H,ce,Ee,null);if(typeof ce.then=="function")return J(H,F,$,jh(ce),Ee);if(ce.$$typeof===G)return J(H,F,$,Th(F,ce),Ee);kh(F,ce)}return null}function Pe(H,F,$,ce){for(var Ee=null,ze=null,Re=F,Ie=F=0,on=null;Re!==null&&Ie<$.length;Ie++){Re.index>Ie?(on=Re,Re=null):on=Re.sibling;var it=W(H,Re,$[Ie],ce);if(it===null){Re===null&&(Re=on);break}n&&Re&&it.alternate===null&&s(H,Re),F=g(it,F,Ie),ze===null?Ee=it:ze.sibling=it,ze=it,Re=on}if(Ie===$.length)return o(H,Re),st&&ua(H,Ie),Ee;if(Re===null){for(;Ie<$.length;Ie++)Re=he(H,$[Ie],ce),Re!==null&&(F=g(Re,F,Ie),ze===null?Ee=Re:ze.sibling=Re,ze=Re);return st&&ua(H,Ie),Ee}for(Re=c(Re);Ie<$.length;Ie++)on=J(Re,H,Ie,$[Ie],ce),on!==null&&(n&&on.alternate!==null&&Re.delete(on.key===null?Ie:on.key),F=g(on,F,Ie),ze===null?Ee=on:ze.sibling=on,ze=on);return n&&Re.forEach(function(gs){return s(H,gs)}),st&&ua(H,Ie),Ee}function Ae(H,F,$,ce){if($==null)throw Error(r(151));for(var Ee=null,ze=null,Re=F,Ie=F=0,on=null,it=$.next();Re!==null&&!it.done;Ie++,it=$.next()){Re.index>Ie?(on=Re,Re=null):on=Re.sibling;var gs=W(H,Re,it.value,ce);if(gs===null){Re===null&&(Re=on);break}n&&Re&&gs.alternate===null&&s(H,Re),F=g(gs,F,Ie),ze===null?Ee=gs:ze.sibling=gs,ze=gs,Re=on}if(it.done)return o(H,Re),st&&ua(H,Ie),Ee;if(Re===null){for(;!it.done;Ie++,it=$.next())it=he(H,it.value,ce),it!==null&&(F=g(it,F,Ie),ze===null?Ee=it:ze.sibling=it,ze=it);return st&&ua(H,Ie),Ee}for(Re=c(Re);!it.done;Ie++,it=$.next())it=J(Re,H,Ie,it.value,ce),it!==null&&(n&&it.alternate!==null&&Re.delete(it.key===null?Ie:it.key),F=g(it,F,Ie),ze===null?Ee=it:ze.sibling=it,ze=it);return n&&Re.forEach(function(gA){return s(H,gA)}),st&&ua(H,Ie),Ee}function vt(H,F,$,ce){if(typeof $=="object"&&$!==null&&$.type===V&&$.key===null&&($=$.props.children),typeof $=="object"&&$!==null){switch($.$$typeof){case T:e:{for(var Ee=$.key;F!==null;){if(F.key===Ee){if(Ee=$.type,Ee===V){if(F.tag===7){o(H,F.sibling),ce=f(F,$.props.children),ce.return=H,H=ce;break e}}else if(F.elementType===Ee||typeof Ee=="object"&&Ee!==null&&Ee.$$typeof===S&&K0(Ee)===F.type){o(H,F.sibling),ce=f(F,$.props),pc(ce,$),ce.return=H,H=ce;break e}o(H,F);break}else s(H,F);F=F.sibling}$.type===V?(ce=la($.props.children,H.mode,ce,$.key),ce.return=H,H=ce):(ce=_h($.type,$.key,$.props,null,H.mode,ce),pc(ce,$),ce.return=H,H=ce)}return E(H);case I:e:{for(Ee=$.key;F!==null;){if(F.key===Ee)if(F.tag===4&&F.stateNode.containerInfo===$.containerInfo&&F.stateNode.implementation===$.implementation){o(H,F.sibling),ce=f(F,$.children||[]),ce.return=H,H=ce;break e}else{o(H,F);break}else s(H,F);F=F.sibling}ce=mm($,H.mode,ce),ce.return=H,H=ce}return E(H);case S:return Ee=$._init,$=Ee($._payload),vt(H,F,$,ce)}if(de($))return Pe(H,F,$,ce);if(k($)){if(Ee=k($),typeof Ee!="function")throw Error(r(150));return $=Ee.call($),Ae(H,F,$,ce)}if(typeof $.then=="function")return vt(H,F,jh($),ce);if($.$$typeof===G)return vt(H,F,Th(H,$),ce);kh(H,$)}return typeof $=="string"&&$!==""||typeof $=="number"||typeof $=="bigint"?($=""+$,F!==null&&F.tag===6?(o(H,F.sibling),ce=f(F,$),ce.return=H,H=ce):(o(H,F),ce=fm($,H.mode,ce),ce.return=H,H=ce),E(H)):o(H,F)}return function(H,F,$,ce){try{mc=0;var Ee=vt(H,F,$,ce);return No=null,Ee}catch(Re){if(Re===sc||Re===Rh)throw Re;var ze=Bn(29,Re,null,H.mode);return ze.lanes=ce,ze.return=H,ze}finally{}}}var Co=Y0(!0),$0=Y0(!1),di=U(null),Fi=null;function ts(n){var s=n.alternate;ie(Zt,Zt.current&1),ie(di,n),Fi===null&&(s===null||Ro.current!==null||s.memoizedState!==null)&&(Fi=n)}function Q0(n){if(n.tag===22){if(ie(Zt,Zt.current),ie(di,n),Fi===null){var s=n.alternate;s!==null&&s.memoizedState!==null&&(Fi=n)}}else ns()}function ns(){ie(Zt,Zt.current),ie(di,di.current)}function vr(n){ee(di),Fi===n&&(Fi=null),ee(Zt)}var Zt=U(0);function Lh(n){for(var s=n;s!==null;){if(s.tag===13){var o=s.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||o.data==="$?"||jp(o)))return s}else if(s.tag===19&&s.memoizedProps.revealOrder!==void 0){if((s.flags&128)!==0)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===n)break;for(;s.sibling===null;){if(s.return===null||s.return===n)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}function Ym(n,s,o,c){s=n.memoizedState,o=o(c,s),o=o==null?s:_({},s,o),n.memoizedState=o,n.lanes===0&&(n.updateQueue.baseState=o)}var $m={enqueueSetState:function(n,s,o){n=n._reactInternals;var c=Yn(),f=Jr(c);f.payload=s,o!=null&&(f.callback=o),s=Zr(n,f,c),s!==null&&($n(s,n,c),oc(s,n,c))},enqueueReplaceState:function(n,s,o){n=n._reactInternals;var c=Yn(),f=Jr(c);f.tag=1,f.payload=s,o!=null&&(f.callback=o),s=Zr(n,f,c),s!==null&&($n(s,n,c),oc(s,n,c))},enqueueForceUpdate:function(n,s){n=n._reactInternals;var o=Yn(),c=Jr(o);c.tag=2,s!=null&&(c.callback=s),s=Zr(n,c,o),s!==null&&($n(s,n,o),oc(s,n,o))}};function X0(n,s,o,c,f,g,E){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(c,g,E):s.prototype&&s.prototype.isPureReactComponent?!Wl(o,c)||!Wl(f,g):!0}function W0(n,s,o,c){n=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(o,c),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(o,c),s.state!==n&&$m.enqueueReplaceState(s,s.state,null)}function ya(n,s){var o=s;if("ref"in s){o={};for(var c in s)c!=="ref"&&(o[c]=s[c])}if(n=n.defaultProps){o===s&&(o=_({},o));for(var f in n)o[f]===void 0&&(o[f]=n[f])}return o}var Fh=typeof reportError=="function"?reportError:function(n){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var s=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof n=="object"&&n!==null&&typeof n.message=="string"?String(n.message):String(n),error:n});if(!window.dispatchEvent(s))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",n);return}console.error(n)};function J0(n){Fh(n)}function Z0(n){console.error(n)}function e_(n){Fh(n)}function Uh(n,s){try{var o=n.onUncaughtError;o(s.value,{componentStack:s.stack})}catch(c){setTimeout(function(){throw c})}}function t_(n,s,o){try{var c=n.onCaughtError;c(o.value,{componentStack:o.stack,errorBoundary:s.tag===1?s.stateNode:null})}catch(f){setTimeout(function(){throw f})}}function Qm(n,s,o){return o=Jr(o),o.tag=3,o.payload={element:null},o.callback=function(){Uh(n,s)},o}function n_(n){return n=Jr(n),n.tag=3,n}function i_(n,s,o,c){var f=o.type.getDerivedStateFromError;if(typeof f=="function"){var g=c.value;n.payload=function(){return f(g)},n.callback=function(){t_(s,o,c)}}var E=o.stateNode;E!==null&&typeof E.componentDidCatch=="function"&&(n.callback=function(){t_(s,o,c),typeof f!="function"&&(ls===null?ls=new Set([this]):ls.add(this));var w=c.stack;this.componentDidCatch(c.value,{componentStack:w!==null?w:""})})}function gS(n,s,o,c,f){if(o.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){if(s=o.alternate,s!==null&&nc(s,o,f,!0),o=di.current,o!==null){switch(o.tag){case 13:return Fi===null?_p():o.alternate===null&&Pt===0&&(Pt=3),o.flags&=-257,o.flags|=65536,o.lanes=f,c===wm?o.flags|=16384:(s=o.updateQueue,s===null?o.updateQueue=new Set([c]):s.add(c),xp(n,c,f)),!1;case 22:return o.flags|=65536,c===wm?o.flags|=16384:(s=o.updateQueue,s===null?(s={transitions:null,markerInstances:null,retryQueue:new Set([c])},o.updateQueue=s):(o=s.retryQueue,o===null?s.retryQueue=new Set([c]):o.add(c)),xp(n,c,f)),!1}throw Error(r(435,o.tag))}return xp(n,c,f),_p(),!1}if(st)return s=di.current,s!==null?((s.flags&65536)===0&&(s.flags|=256),s.flags|=65536,s.lanes=f,c!==ym&&(n=Error(r(422),{cause:c}),tc(li(n,o)))):(c!==ym&&(s=Error(r(423),{cause:c}),tc(li(s,o))),n=n.current.alternate,n.flags|=65536,f&=-f,n.lanes|=f,c=li(c,o),f=Qm(n.stateNode,c,f),Am(n,f),Pt!==4&&(Pt=2)),!1;var g=Error(r(520),{cause:c});if(g=li(g,o),Ec===null?Ec=[g]:Ec.push(g),Pt!==4&&(Pt=2),s===null)return!0;c=li(c,o),o=s;do{switch(o.tag){case 3:return o.flags|=65536,n=f&-f,o.lanes|=n,n=Qm(o.stateNode,c,n),Am(o,n),!1;case 1:if(s=o.type,g=o.stateNode,(o.flags&128)===0&&(typeof s.getDerivedStateFromError=="function"||g!==null&&typeof g.componentDidCatch=="function"&&(ls===null||!ls.has(g))))return o.flags|=65536,f&=-f,o.lanes|=f,f=n_(f),i_(f,n,o,c),Am(o,f),!1}o=o.return}while(o!==null);return!1}var r_=Error(r(461)),sn=!1;function dn(n,s,o,c){s.child=n===null?$0(s,null,o,c):Co(s,n.child,o,c)}function s_(n,s,o,c,f){o=o.render;var g=s.ref;if("ref"in c){var E={};for(var w in c)w!=="ref"&&(E[w]=c[w])}else E=c;return ma(s),c=Dm(n,s,o,E,g,f),w=Vm(),n!==null&&!sn?(Om(n,s,f),_r(n,s,f)):(st&&w&&pm(s),s.flags|=1,dn(n,s,c,f),s.child)}function a_(n,s,o,c,f){if(n===null){var g=o.type;return typeof g=="function"&&!dm(g)&&g.defaultProps===void 0&&o.compare===null?(s.tag=15,s.type=g,o_(n,s,g,c,f)):(n=_h(o.type,null,c,s,s.mode,f),n.ref=s.ref,n.return=s,s.child=n)}if(g=n.child,!ip(n,f)){var E=g.memoizedProps;if(o=o.compare,o=o!==null?o:Wl,o(E,c)&&n.ref===s.ref)return _r(n,s,f)}return s.flags|=1,n=dr(g,c),n.ref=s.ref,n.return=s,s.child=n}function o_(n,s,o,c,f){if(n!==null){var g=n.memoizedProps;if(Wl(g,c)&&n.ref===s.ref)if(sn=!1,s.pendingProps=c=g,ip(n,f))(n.flags&131072)!==0&&(sn=!0);else return s.lanes=n.lanes,_r(n,s,f)}return Xm(n,s,o,c,f)}function l_(n,s,o){var c=s.pendingProps,f=c.children,g=n!==null?n.memoizedState:null;if(c.mode==="hidden"){if((s.flags&128)!==0){if(c=g!==null?g.baseLanes|o:o,n!==null){for(f=s.child=n.child,g=0;f!==null;)g=g|f.lanes|f.childLanes,f=f.sibling;s.childLanes=g&~c}else s.childLanes=0,s.child=null;return c_(n,s,c,o)}if((o&536870912)!==0)s.memoizedState={baseLanes:0,cachePool:null},n!==null&&wh(s,g!==null?g.cachePool:null),g!==null?o0(s,g):Nm(),Q0(s);else return s.lanes=s.childLanes=536870912,c_(n,s,g!==null?g.baseLanes|o:o,o)}else g!==null?(wh(s,g.cachePool),o0(s,g),ns(),s.memoizedState=null):(n!==null&&wh(s,null),Nm(),ns());return dn(n,s,f,o),s.child}function c_(n,s,o,c){var f=Tm();return f=f===null?null:{parent:Jt._currentValue,pool:f},s.memoizedState={baseLanes:o,cachePool:f},n!==null&&wh(s,null),Nm(),Q0(s),n!==null&&nc(n,s,c,!0),null}function zh(n,s){var o=s.ref;if(o===null)n!==null&&n.ref!==null&&(s.flags|=4194816);else{if(typeof o!="function"&&typeof o!="object")throw Error(r(284));(n===null||n.ref!==o)&&(s.flags|=4194816)}}function Xm(n,s,o,c,f){return ma(s),o=Dm(n,s,o,c,void 0,f),c=Vm(),n!==null&&!sn?(Om(n,s,f),_r(n,s,f)):(st&&c&&pm(s),s.flags|=1,dn(n,s,o,f),s.child)}function u_(n,s,o,c,f,g){return ma(s),s.updateQueue=null,o=c0(s,c,o,f),l0(n),c=Vm(),n!==null&&!sn?(Om(n,s,g),_r(n,s,g)):(st&&c&&pm(s),s.flags|=1,dn(n,s,o,g),s.child)}function h_(n,s,o,c,f){if(ma(s),s.stateNode===null){var g=bo,E=o.contextType;typeof E=="object"&&E!==null&&(g=yn(E)),g=new o(c,g),s.memoizedState=g.state!==null&&g.state!==void 0?g.state:null,g.updater=$m,s.stateNode=g,g._reactInternals=s,g=s.stateNode,g.props=c,g.state=s.memoizedState,g.refs={},Rm(s),E=o.contextType,g.context=typeof E=="object"&&E!==null?yn(E):bo,g.state=s.memoizedState,E=o.getDerivedStateFromProps,typeof E=="function"&&(Ym(s,o,E,c),g.state=s.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof g.getSnapshotBeforeUpdate=="function"||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(E=g.state,typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount(),E!==g.state&&$m.enqueueReplaceState(g,g.state,null),cc(s,c,g,f),lc(),g.state=s.memoizedState),typeof g.componentDidMount=="function"&&(s.flags|=4194308),c=!0}else if(n===null){g=s.stateNode;var w=s.memoizedProps,j=ya(o,w);g.props=j;var Q=g.context,le=o.contextType;E=bo,typeof le=="object"&&le!==null&&(E=yn(le));var he=o.getDerivedStateFromProps;le=typeof he=="function"||typeof g.getSnapshotBeforeUpdate=="function",w=s.pendingProps!==w,le||typeof g.UNSAFE_componentWillReceiveProps!="function"&&typeof g.componentWillReceiveProps!="function"||(w||Q!==E)&&W0(s,g,c,E),Wr=!1;var W=s.memoizedState;g.state=W,cc(s,c,g,f),lc(),Q=s.memoizedState,w||W!==Q||Wr?(typeof he=="function"&&(Ym(s,o,he,c),Q=s.memoizedState),(j=Wr||X0(s,o,j,c,W,Q,E))?(le||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount()),typeof g.componentDidMount=="function"&&(s.flags|=4194308)):(typeof g.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=c,s.memoizedState=Q),g.props=c,g.state=Q,g.context=E,c=j):(typeof g.componentDidMount=="function"&&(s.flags|=4194308),c=!1)}else{g=s.stateNode,Sm(n,s),E=s.memoizedProps,le=ya(o,E),g.props=le,he=s.pendingProps,W=g.context,Q=o.contextType,j=bo,typeof Q=="object"&&Q!==null&&(j=yn(Q)),w=o.getDerivedStateFromProps,(Q=typeof w=="function"||typeof g.getSnapshotBeforeUpdate=="function")||typeof g.UNSAFE_componentWillReceiveProps!="function"&&typeof g.componentWillReceiveProps!="function"||(E!==he||W!==j)&&W0(s,g,c,j),Wr=!1,W=s.memoizedState,g.state=W,cc(s,c,g,f),lc();var J=s.memoizedState;E!==he||W!==J||Wr||n!==null&&n.dependencies!==null&&Eh(n.dependencies)?(typeof w=="function"&&(Ym(s,o,w,c),J=s.memoizedState),(le=Wr||X0(s,o,le,c,W,J,j)||n!==null&&n.dependencies!==null&&Eh(n.dependencies))?(Q||typeof g.UNSAFE_componentWillUpdate!="function"&&typeof g.componentWillUpdate!="function"||(typeof g.componentWillUpdate=="function"&&g.componentWillUpdate(c,J,j),typeof g.UNSAFE_componentWillUpdate=="function"&&g.UNSAFE_componentWillUpdate(c,J,j)),typeof g.componentDidUpdate=="function"&&(s.flags|=4),typeof g.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof g.componentDidUpdate!="function"||E===n.memoizedProps&&W===n.memoizedState||(s.flags|=4),typeof g.getSnapshotBeforeUpdate!="function"||E===n.memoizedProps&&W===n.memoizedState||(s.flags|=1024),s.memoizedProps=c,s.memoizedState=J),g.props=c,g.state=J,g.context=j,c=le):(typeof g.componentDidUpdate!="function"||E===n.memoizedProps&&W===n.memoizedState||(s.flags|=4),typeof g.getSnapshotBeforeUpdate!="function"||E===n.memoizedProps&&W===n.memoizedState||(s.flags|=1024),c=!1)}return g=c,zh(n,s),c=(s.flags&128)!==0,g||c?(g=s.stateNode,o=c&&typeof o.getDerivedStateFromError!="function"?null:g.render(),s.flags|=1,n!==null&&c?(s.child=Co(s,n.child,null,f),s.child=Co(s,null,o,f)):dn(n,s,o,f),s.memoizedState=g.state,n=s.child):n=_r(n,s,f),n}function d_(n,s,o,c){return ec(),s.flags|=256,dn(n,s,o,c),s.child}var Wm={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Jm(n){return{baseLanes:n,cachePool:Zv()}}function Zm(n,s,o){return n=n!==null?n.childLanes&~o:0,s&&(n|=fi),n}function f_(n,s,o){var c=s.pendingProps,f=!1,g=(s.flags&128)!==0,E;if((E=g)||(E=n!==null&&n.memoizedState===null?!1:(Zt.current&2)!==0),E&&(f=!0,s.flags&=-129),E=(s.flags&32)!==0,s.flags&=-33,n===null){if(st){if(f?ts(s):ns(),st){var w=Ct,j;if(j=w){e:{for(j=w,w=Li;j.nodeType!==8;){if(!w){w=null;break e}if(j=Ti(j.nextSibling),j===null){w=null;break e}}w=j}w!==null?(s.memoizedState={dehydrated:w,treeContext:ca!==null?{id:fr,overflow:mr}:null,retryLane:536870912,hydrationErrors:null},j=Bn(18,null,null,0),j.stateNode=w,j.return=s,s.child=j,In=s,Ct=null,j=!0):j=!1}j||da(s)}if(w=s.memoizedState,w!==null&&(w=w.dehydrated,w!==null))return jp(w)?s.lanes=32:s.lanes=536870912,null;vr(s)}return w=c.children,c=c.fallback,f?(ns(),f=s.mode,w=qh({mode:"hidden",children:w},f),c=la(c,f,o,null),w.return=s,c.return=s,w.sibling=c,s.child=w,f=s.child,f.memoizedState=Jm(o),f.childLanes=Zm(n,E,o),s.memoizedState=Wm,c):(ts(s),ep(s,w))}if(j=n.memoizedState,j!==null&&(w=j.dehydrated,w!==null)){if(g)s.flags&256?(ts(s),s.flags&=-257,s=tp(n,s,o)):s.memoizedState!==null?(ns(),s.child=n.child,s.flags|=128,s=null):(ns(),f=c.fallback,w=s.mode,c=qh({mode:"visible",children:c.children},w),f=la(f,w,o,null),f.flags|=2,c.return=s,f.return=s,c.sibling=f,s.child=c,Co(s,n.child,null,o),c=s.child,c.memoizedState=Jm(o),c.childLanes=Zm(n,E,o),s.memoizedState=Wm,s=f);else if(ts(s),jp(w)){if(E=w.nextSibling&&w.nextSibling.dataset,E)var Q=E.dgst;E=Q,c=Error(r(419)),c.stack="",c.digest=E,tc({value:c,source:null,stack:null}),s=tp(n,s,o)}else if(sn||nc(n,s,o,!1),E=(o&n.childLanes)!==0,sn||E){if(E=bt,E!==null&&(c=o&-o,c=(c&42)!==0?1:Br(c),c=(c&(E.suspendedLanes|o))!==0?0:c,c!==0&&c!==j.retryLane))throw j.retryLane=c,_o(n,c),$n(E,n,c),r_;w.data==="$?"||_p(),s=tp(n,s,o)}else w.data==="$?"?(s.flags|=192,s.child=n.child,s=null):(n=j.treeContext,Ct=Ti(w.nextSibling),In=s,st=!0,ha=null,Li=!1,n!==null&&(ui[hi++]=fr,ui[hi++]=mr,ui[hi++]=ca,fr=n.id,mr=n.overflow,ca=s),s=ep(s,c.children),s.flags|=4096);return s}return f?(ns(),f=c.fallback,w=s.mode,j=n.child,Q=j.sibling,c=dr(j,{mode:"hidden",children:c.children}),c.subtreeFlags=j.subtreeFlags&65011712,Q!==null?f=dr(Q,f):(f=la(f,w,o,null),f.flags|=2),f.return=s,c.return=s,c.sibling=f,s.child=c,c=f,f=s.child,w=n.child.memoizedState,w===null?w=Jm(o):(j=w.cachePool,j!==null?(Q=Jt._currentValue,j=j.parent!==Q?{parent:Q,pool:Q}:j):j=Zv(),w={baseLanes:w.baseLanes|o,cachePool:j}),f.memoizedState=w,f.childLanes=Zm(n,E,o),s.memoizedState=Wm,c):(ts(s),o=n.child,n=o.sibling,o=dr(o,{mode:"visible",children:c.children}),o.return=s,o.sibling=null,n!==null&&(E=s.deletions,E===null?(s.deletions=[n],s.flags|=16):E.push(n)),s.child=o,s.memoizedState=null,o)}function ep(n,s){return s=qh({mode:"visible",children:s},n.mode),s.return=n,n.child=s}function qh(n,s){return n=Bn(22,n,null,s),n.lanes=0,n.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},n}function tp(n,s,o){return Co(s,n.child,null,o),n=ep(s,s.pendingProps.children),n.flags|=2,s.memoizedState=null,n}function m_(n,s,o){n.lanes|=s;var c=n.alternate;c!==null&&(c.lanes|=s),_m(n.return,s,o)}function np(n,s,o,c,f){var g=n.memoizedState;g===null?n.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:c,tail:o,tailMode:f}:(g.isBackwards=s,g.rendering=null,g.renderingStartTime=0,g.last=c,g.tail=o,g.tailMode=f)}function p_(n,s,o){var c=s.pendingProps,f=c.revealOrder,g=c.tail;if(dn(n,s,c.children,o),c=Zt.current,(c&2)!==0)c=c&1|2,s.flags|=128;else{if(n!==null&&(n.flags&128)!==0)e:for(n=s.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&m_(n,o,s);else if(n.tag===19)m_(n,o,s);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===s)break e;for(;n.sibling===null;){if(n.return===null||n.return===s)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}c&=1}switch(ie(Zt,c),f){case"forwards":for(o=s.child,f=null;o!==null;)n=o.alternate,n!==null&&Lh(n)===null&&(f=o),o=o.sibling;o=f,o===null?(f=s.child,s.child=null):(f=o.sibling,o.sibling=null),np(s,!1,f,o,g);break;case"backwards":for(o=null,f=s.child,s.child=null;f!==null;){if(n=f.alternate,n!==null&&Lh(n)===null){s.child=f;break}n=f.sibling,f.sibling=o,o=f,f=n}np(s,!0,o,null,g);break;case"together":np(s,!1,null,null,void 0);break;default:s.memoizedState=null}return s.child}function _r(n,s,o){if(n!==null&&(s.dependencies=n.dependencies),os|=s.lanes,(o&s.childLanes)===0)if(n!==null){if(nc(n,s,o,!1),(o&s.childLanes)===0)return null}else return null;if(n!==null&&s.child!==n.child)throw Error(r(153));if(s.child!==null){for(n=s.child,o=dr(n,n.pendingProps),s.child=o,o.return=s;n.sibling!==null;)n=n.sibling,o=o.sibling=dr(n,n.pendingProps),o.return=s;o.sibling=null}return s.child}function ip(n,s){return(n.lanes&s)!==0?!0:(n=n.dependencies,!!(n!==null&&Eh(n)))}function yS(n,s,o){switch(s.tag){case 3:ve(s,s.stateNode.containerInfo),Xr(s,Jt,n.memoizedState.cache),ec();break;case 27:case 5:je(s);break;case 4:ve(s,s.stateNode.containerInfo);break;case 10:Xr(s,s.type,s.memoizedProps.value);break;case 13:var c=s.memoizedState;if(c!==null)return c.dehydrated!==null?(ts(s),s.flags|=128,null):(o&s.child.childLanes)!==0?f_(n,s,o):(ts(s),n=_r(n,s,o),n!==null?n.sibling:null);ts(s);break;case 19:var f=(n.flags&128)!==0;if(c=(o&s.childLanes)!==0,c||(nc(n,s,o,!1),c=(o&s.childLanes)!==0),f){if(c)return p_(n,s,o);s.flags|=128}if(f=s.memoizedState,f!==null&&(f.rendering=null,f.tail=null,f.lastEffect=null),ie(Zt,Zt.current),c)break;return null;case 22:case 23:return s.lanes=0,l_(n,s,o);case 24:Xr(s,Jt,n.memoizedState.cache)}return _r(n,s,o)}function g_(n,s,o){if(n!==null)if(n.memoizedProps!==s.pendingProps)sn=!0;else{if(!ip(n,o)&&(s.flags&128)===0)return sn=!1,yS(n,s,o);sn=(n.flags&131072)!==0}else sn=!1,st&&(s.flags&1048576)!==0&&Kv(s,xh,s.index);switch(s.lanes=0,s.tag){case 16:e:{n=s.pendingProps;var c=s.elementType,f=c._init;if(c=f(c._payload),s.type=c,typeof c=="function")dm(c)?(n=ya(c,n),s.tag=1,s=h_(null,s,c,n,o)):(s.tag=0,s=Xm(null,s,c,n,o));else{if(c!=null){if(f=c.$$typeof,f===ne){s.tag=11,s=s_(null,s,c,n,o);break e}else if(f===P){s.tag=14,s=a_(null,s,c,n,o);break e}}throw s=ue(c)||c,Error(r(306,s,""))}}return s;case 0:return Xm(n,s,s.type,s.pendingProps,o);case 1:return c=s.type,f=ya(c,s.pendingProps),h_(n,s,c,f,o);case 3:e:{if(ve(s,s.stateNode.containerInfo),n===null)throw Error(r(387));c=s.pendingProps;var g=s.memoizedState;f=g.element,Sm(n,s),cc(s,c,null,o);var E=s.memoizedState;if(c=E.cache,Xr(s,Jt,c),c!==g.cache&&bm(s,[Jt],o,!0),lc(),c=E.element,g.isDehydrated)if(g={element:c,isDehydrated:!1,cache:E.cache},s.updateQueue.baseState=g,s.memoizedState=g,s.flags&256){s=d_(n,s,c,o);break e}else if(c!==f){f=li(Error(r(424)),s),tc(f),s=d_(n,s,c,o);break e}else{switch(n=s.stateNode.containerInfo,n.nodeType){case 9:n=n.body;break;default:n=n.nodeName==="HTML"?n.ownerDocument.body:n}for(Ct=Ti(n.firstChild),In=s,st=!0,ha=null,Li=!0,o=$0(s,null,c,o),s.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling}else{if(ec(),c===f){s=_r(n,s,o);break e}dn(n,s,c,o)}s=s.child}return s;case 26:return zh(n,s),n===null?(o=bb(s.type,null,s.pendingProps,null))?s.memoizedState=o:st||(o=s.type,n=s.pendingProps,c=nd(be.current).createElement(o),c[Qt]=s,c[Ft]=n,mn(c,o,n),Ot(c),s.stateNode=c):s.memoizedState=bb(s.type,n.memoizedProps,s.pendingProps,n.memoizedState),null;case 27:return je(s),n===null&&st&&(c=s.stateNode=yb(s.type,s.pendingProps,be.current),In=s,Li=!0,f=Ct,hs(s.type)?(kp=f,Ct=Ti(c.firstChild)):Ct=f),dn(n,s,s.pendingProps.children,o),zh(n,s),n===null&&(s.flags|=4194304),s.child;case 5:return n===null&&st&&((f=c=Ct)&&(c=GS(c,s.type,s.pendingProps,Li),c!==null?(s.stateNode=c,In=s,Ct=Ti(c.firstChild),Li=!1,f=!0):f=!1),f||da(s)),je(s),f=s.type,g=s.pendingProps,E=n!==null?n.memoizedProps:null,c=g.children,Vp(f,g)?c=null:E!==null&&Vp(f,E)&&(s.flags|=32),s.memoizedState!==null&&(f=Dm(n,s,cS,null,null,o),Pc._currentValue=f),zh(n,s),dn(n,s,c,o),s.child;case 6:return n===null&&st&&((n=o=Ct)&&(o=KS(o,s.pendingProps,Li),o!==null?(s.stateNode=o,In=s,Ct=null,n=!0):n=!1),n||da(s)),null;case 13:return f_(n,s,o);case 4:return ve(s,s.stateNode.containerInfo),c=s.pendingProps,n===null?s.child=Co(s,null,c,o):dn(n,s,c,o),s.child;case 11:return s_(n,s,s.type,s.pendingProps,o);case 7:return dn(n,s,s.pendingProps,o),s.child;case 8:return dn(n,s,s.pendingProps.children,o),s.child;case 12:return dn(n,s,s.pendingProps.children,o),s.child;case 10:return c=s.pendingProps,Xr(s,s.type,c.value),dn(n,s,c.children,o),s.child;case 9:return f=s.type._context,c=s.pendingProps.children,ma(s),f=yn(f),c=c(f),s.flags|=1,dn(n,s,c,o),s.child;case 14:return a_(n,s,s.type,s.pendingProps,o);case 15:return o_(n,s,s.type,s.pendingProps,o);case 19:return p_(n,s,o);case 31:return c=s.pendingProps,o=s.mode,c={mode:c.mode,children:c.children},n===null?(o=qh(c,o),o.ref=s.ref,s.child=o,o.return=s,s=o):(o=dr(n.child,c),o.ref=s.ref,s.child=o,o.return=s,s=o),s;case 22:return l_(n,s,o);case 24:return ma(s),c=yn(Jt),n===null?(f=Tm(),f===null&&(f=bt,g=xm(),f.pooledCache=g,g.refCount++,g!==null&&(f.pooledCacheLanes|=o),f=g),s.memoizedState={parent:c,cache:f},Rm(s),Xr(s,Jt,f)):((n.lanes&o)!==0&&(Sm(n,s),cc(s,null,null,o),lc()),f=n.memoizedState,g=s.memoizedState,f.parent!==c?(f={parent:c,cache:c},s.memoizedState=f,s.lanes===0&&(s.memoizedState=s.updateQueue.baseState=f),Xr(s,Jt,c)):(c=g.cache,Xr(s,Jt,c),c!==f.cache&&bm(s,[Jt],o,!0))),dn(n,s,s.pendingProps.children,o),s.child;case 29:throw s.pendingProps}throw Error(r(156,s.tag))}function br(n){n.flags|=4}function y_(n,s){if(s.type!=="stylesheet"||(s.state.loading&4)!==0)n.flags&=-16777217;else if(n.flags|=16777216,!Rb(s)){if(s=di.current,s!==null&&((Ze&4194048)===Ze?Fi!==null:(Ze&62914560)!==Ze&&(Ze&536870912)===0||s!==Fi))throw ac=wm,e0;n.flags|=8192}}function Bh(n,s){s!==null&&(n.flags|=4),n.flags&16384&&(s=n.tag!==22?Vl():536870912,n.lanes|=s,Oo|=s)}function gc(n,s){if(!st)switch(n.tailMode){case"hidden":s=n.tail;for(var o=null;s!==null;)s.alternate!==null&&(o=s),s=s.sibling;o===null?n.tail=null:o.sibling=null;break;case"collapsed":o=n.tail;for(var c=null;o!==null;)o.alternate!==null&&(c=o),o=o.sibling;c===null?s||n.tail===null?n.tail=null:n.tail.sibling=null:c.sibling=null}}function At(n){var s=n.alternate!==null&&n.alternate.child===n.child,o=0,c=0;if(s)for(var f=n.child;f!==null;)o|=f.lanes|f.childLanes,c|=f.subtreeFlags&65011712,c|=f.flags&65011712,f.return=n,f=f.sibling;else for(f=n.child;f!==null;)o|=f.lanes|f.childLanes,c|=f.subtreeFlags,c|=f.flags,f.return=n,f=f.sibling;return n.subtreeFlags|=c,n.childLanes=o,s}function vS(n,s,o){var c=s.pendingProps;switch(gm(s),s.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return At(s),null;case 1:return At(s),null;case 3:return o=s.stateNode,c=null,n!==null&&(c=n.memoizedState.cache),s.memoizedState.cache!==c&&(s.flags|=2048),gr(Jt),Ne(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(n===null||n.child===null)&&(Zl(s)?br(s):n===null||n.memoizedState.isDehydrated&&(s.flags&256)===0||(s.flags|=1024,Qv())),At(s),null;case 26:return o=s.memoizedState,n===null?(br(s),o!==null?(At(s),y_(s,o)):(At(s),s.flags&=-16777217)):o?o!==n.memoizedState?(br(s),At(s),y_(s,o)):(At(s),s.flags&=-16777217):(n.memoizedProps!==c&&br(s),At(s),s.flags&=-16777217),null;case 27:De(s),o=be.current;var f=s.type;if(n!==null&&s.stateNode!=null)n.memoizedProps!==c&&br(s);else{if(!c){if(s.stateNode===null)throw Error(r(166));return At(s),null}n=ge.current,Zl(s)?Yv(s):(n=yb(f,c,o),s.stateNode=n,br(s))}return At(s),null;case 5:if(De(s),o=s.type,n!==null&&s.stateNode!=null)n.memoizedProps!==c&&br(s);else{if(!c){if(s.stateNode===null)throw Error(r(166));return At(s),null}if(n=ge.current,Zl(s))Yv(s);else{switch(f=nd(be.current),n){case 1:n=f.createElementNS("http://www.w3.org/2000/svg",o);break;case 2:n=f.createElementNS("http://www.w3.org/1998/Math/MathML",o);break;default:switch(o){case"svg":n=f.createElementNS("http://www.w3.org/2000/svg",o);break;case"math":n=f.createElementNS("http://www.w3.org/1998/Math/MathML",o);break;case"script":n=f.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild);break;case"select":n=typeof c.is=="string"?f.createElement("select",{is:c.is}):f.createElement("select"),c.multiple?n.multiple=!0:c.size&&(n.size=c.size);break;default:n=typeof c.is=="string"?f.createElement(o,{is:c.is}):f.createElement(o)}}n[Qt]=s,n[Ft]=c;e:for(f=s.child;f!==null;){if(f.tag===5||f.tag===6)n.appendChild(f.stateNode);else if(f.tag!==4&&f.tag!==27&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===s)break e;for(;f.sibling===null;){if(f.return===null||f.return===s)break e;f=f.return}f.sibling.return=f.return,f=f.sibling}s.stateNode=n;e:switch(mn(n,o,c),o){case"button":case"input":case"select":case"textarea":n=!!c.autoFocus;break e;case"img":n=!0;break e;default:n=!1}n&&br(s)}}return At(s),s.flags&=-16777217,null;case 6:if(n&&s.stateNode!=null)n.memoizedProps!==c&&br(s);else{if(typeof c!="string"&&s.stateNode===null)throw Error(r(166));if(n=be.current,Zl(s)){if(n=s.stateNode,o=s.memoizedProps,c=null,f=In,f!==null)switch(f.tag){case 27:case 5:c=f.memoizedProps}n[Qt]=s,n=!!(n.nodeValue===o||c!==null&&c.suppressHydrationWarning===!0||ub(n.nodeValue,o)),n||da(s)}else n=nd(n).createTextNode(c),n[Qt]=s,s.stateNode=n}return At(s),null;case 13:if(c=s.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(f=Zl(s),c!==null&&c.dehydrated!==null){if(n===null){if(!f)throw Error(r(318));if(f=s.memoizedState,f=f!==null?f.dehydrated:null,!f)throw Error(r(317));f[Qt]=s}else ec(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;At(s),f=!1}else f=Qv(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=f),f=!0;if(!f)return s.flags&256?(vr(s),s):(vr(s),null)}if(vr(s),(s.flags&128)!==0)return s.lanes=o,s;if(o=c!==null,n=n!==null&&n.memoizedState!==null,o){c=s.child,f=null,c.alternate!==null&&c.alternate.memoizedState!==null&&c.alternate.memoizedState.cachePool!==null&&(f=c.alternate.memoizedState.cachePool.pool);var g=null;c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(g=c.memoizedState.cachePool.pool),g!==f&&(c.flags|=2048)}return o!==n&&o&&(s.child.flags|=8192),Bh(s,s.updateQueue),At(s),null;case 4:return Ne(),n===null&&Ip(s.stateNode.containerInfo),At(s),null;case 10:return gr(s.type),At(s),null;case 19:if(ee(Zt),f=s.memoizedState,f===null)return At(s),null;if(c=(s.flags&128)!==0,g=f.rendering,g===null)if(c)gc(f,!1);else{if(Pt!==0||n!==null&&(n.flags&128)!==0)for(n=s.child;n!==null;){if(g=Lh(n),g!==null){for(s.flags|=128,gc(f,!1),n=g.updateQueue,s.updateQueue=n,Bh(s,n),s.subtreeFlags=0,n=o,o=s.child;o!==null;)Gv(o,n),o=o.sibling;return ie(Zt,Zt.current&1|2),s.child}n=n.sibling}f.tail!==null&&Et()>Kh&&(s.flags|=128,c=!0,gc(f,!1),s.lanes=4194304)}else{if(!c)if(n=Lh(g),n!==null){if(s.flags|=128,c=!0,n=n.updateQueue,s.updateQueue=n,Bh(s,n),gc(f,!0),f.tail===null&&f.tailMode==="hidden"&&!g.alternate&&!st)return At(s),null}else 2*Et()-f.renderingStartTime>Kh&&o!==536870912&&(s.flags|=128,c=!0,gc(f,!1),s.lanes=4194304);f.isBackwards?(g.sibling=s.child,s.child=g):(n=f.last,n!==null?n.sibling=g:s.child=g,f.last=g)}return f.tail!==null?(s=f.tail,f.rendering=s,f.tail=s.sibling,f.renderingStartTime=Et(),s.sibling=null,n=Zt.current,ie(Zt,c?n&1|2:n&1),s):(At(s),null);case 22:case 23:return vr(s),Cm(),c=s.memoizedState!==null,n!==null?n.memoizedState!==null!==c&&(s.flags|=8192):c&&(s.flags|=8192),c?(o&536870912)!==0&&(s.flags&128)===0&&(At(s),s.subtreeFlags&6&&(s.flags|=8192)):At(s),o=s.updateQueue,o!==null&&Bh(s,o.retryQueue),o=null,n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(o=n.memoizedState.cachePool.pool),c=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(c=s.memoizedState.cachePool.pool),c!==o&&(s.flags|=2048),n!==null&&ee(pa),null;case 24:return o=null,n!==null&&(o=n.memoizedState.cache),s.memoizedState.cache!==o&&(s.flags|=2048),gr(Jt),At(s),null;case 25:return null;case 30:return null}throw Error(r(156,s.tag))}function _S(n,s){switch(gm(s),s.tag){case 1:return n=s.flags,n&65536?(s.flags=n&-65537|128,s):null;case 3:return gr(Jt),Ne(),n=s.flags,(n&65536)!==0&&(n&128)===0?(s.flags=n&-65537|128,s):null;case 26:case 27:case 5:return De(s),null;case 13:if(vr(s),n=s.memoizedState,n!==null&&n.dehydrated!==null){if(s.alternate===null)throw Error(r(340));ec()}return n=s.flags,n&65536?(s.flags=n&-65537|128,s):null;case 19:return ee(Zt),null;case 4:return Ne(),null;case 10:return gr(s.type),null;case 22:case 23:return vr(s),Cm(),n!==null&&ee(pa),n=s.flags,n&65536?(s.flags=n&-65537|128,s):null;case 24:return gr(Jt),null;case 25:return null;default:return null}}function v_(n,s){switch(gm(s),s.tag){case 3:gr(Jt),Ne();break;case 26:case 27:case 5:De(s);break;case 4:Ne();break;case 13:vr(s);break;case 19:ee(Zt);break;case 10:gr(s.type);break;case 22:case 23:vr(s),Cm(),n!==null&&ee(pa);break;case 24:gr(Jt)}}function yc(n,s){try{var o=s.updateQueue,c=o!==null?o.lastEffect:null;if(c!==null){var f=c.next;o=f;do{if((o.tag&n)===n){c=void 0;var g=o.create,E=o.inst;c=g(),E.destroy=c}o=o.next}while(o!==f)}}catch(w){_t(s,s.return,w)}}function is(n,s,o){try{var c=s.updateQueue,f=c!==null?c.lastEffect:null;if(f!==null){var g=f.next;c=g;do{if((c.tag&n)===n){var E=c.inst,w=E.destroy;if(w!==void 0){E.destroy=void 0,f=s;var j=o,Q=w;try{Q()}catch(le){_t(f,j,le)}}}c=c.next}while(c!==g)}}catch(le){_t(s,s.return,le)}}function __(n){var s=n.updateQueue;if(s!==null){var o=n.stateNode;try{a0(s,o)}catch(c){_t(n,n.return,c)}}}function b_(n,s,o){o.props=ya(n.type,n.memoizedProps),o.state=n.memoizedState;try{o.componentWillUnmount()}catch(c){_t(n,s,c)}}function vc(n,s){try{var o=n.ref;if(o!==null){switch(n.tag){case 26:case 27:case 5:var c=n.stateNode;break;case 30:c=n.stateNode;break;default:c=n.stateNode}typeof o=="function"?n.refCleanup=o(c):o.current=c}}catch(f){_t(n,s,f)}}function Ui(n,s){var o=n.ref,c=n.refCleanup;if(o!==null)if(typeof c=="function")try{c()}catch(f){_t(n,s,f)}finally{n.refCleanup=null,n=n.alternate,n!=null&&(n.refCleanup=null)}else if(typeof o=="function")try{o(null)}catch(f){_t(n,s,f)}else o.current=null}function x_(n){var s=n.type,o=n.memoizedProps,c=n.stateNode;try{e:switch(s){case"button":case"input":case"select":case"textarea":o.autoFocus&&c.focus();break e;case"img":o.src?c.src=o.src:o.srcSet&&(c.srcset=o.srcSet)}}catch(f){_t(n,n.return,f)}}function rp(n,s,o){try{var c=n.stateNode;US(c,n.type,o,s),c[Ft]=s}catch(f){_t(n,n.return,f)}}function E_(n){return n.tag===5||n.tag===3||n.tag===26||n.tag===27&&hs(n.type)||n.tag===4}function sp(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||E_(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.tag===27&&hs(n.type)||n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function ap(n,s,o){var c=n.tag;if(c===5||c===6)n=n.stateNode,s?(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o).insertBefore(n,s):(s=o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,s.appendChild(n),o=o._reactRootContainer,o!=null||s.onclick!==null||(s.onclick=td));else if(c!==4&&(c===27&&hs(n.type)&&(o=n.stateNode,s=null),n=n.child,n!==null))for(ap(n,s,o),n=n.sibling;n!==null;)ap(n,s,o),n=n.sibling}function Hh(n,s,o){var c=n.tag;if(c===5||c===6)n=n.stateNode,s?o.insertBefore(n,s):o.appendChild(n);else if(c!==4&&(c===27&&hs(n.type)&&(o=n.stateNode),n=n.child,n!==null))for(Hh(n,s,o),n=n.sibling;n!==null;)Hh(n,s,o),n=n.sibling}function T_(n){var s=n.stateNode,o=n.memoizedProps;try{for(var c=n.type,f=s.attributes;f.length;)s.removeAttributeNode(f[0]);mn(s,c,o),s[Qt]=n,s[Ft]=o}catch(g){_t(n,n.return,g)}}var xr=!1,jt=!1,op=!1,w_=typeof WeakSet=="function"?WeakSet:Set,an=null;function bS(n,s){if(n=n.containerInfo,Pp=ld,n=Mv(n),sm(n)){if("selectionStart"in n)var o={start:n.selectionStart,end:n.selectionEnd};else e:{o=(o=n.ownerDocument)&&o.defaultView||window;var c=o.getSelection&&o.getSelection();if(c&&c.rangeCount!==0){o=c.anchorNode;var f=c.anchorOffset,g=c.focusNode;c=c.focusOffset;try{o.nodeType,g.nodeType}catch{o=null;break e}var E=0,w=-1,j=-1,Q=0,le=0,he=n,W=null;t:for(;;){for(var J;he!==o||f!==0&&he.nodeType!==3||(w=E+f),he!==g||c!==0&&he.nodeType!==3||(j=E+c),he.nodeType===3&&(E+=he.nodeValue.length),(J=he.firstChild)!==null;)W=he,he=J;for(;;){if(he===n)break t;if(W===o&&++Q===f&&(w=E),W===g&&++le===c&&(j=E),(J=he.nextSibling)!==null)break;he=W,W=he.parentNode}he=J}o=w===-1||j===-1?null:{start:w,end:j}}else o=null}o=o||{start:0,end:0}}else o=null;for(Dp={focusedElem:n,selectionRange:o},ld=!1,an=s;an!==null;)if(s=an,n=s.child,(s.subtreeFlags&1024)!==0&&n!==null)n.return=s,an=n;else for(;an!==null;){switch(s=an,g=s.alternate,n=s.flags,s.tag){case 0:break;case 11:case 15:break;case 1:if((n&1024)!==0&&g!==null){n=void 0,o=s,f=g.memoizedProps,g=g.memoizedState,c=o.stateNode;try{var Pe=ya(o.type,f,o.elementType===o.type);n=c.getSnapshotBeforeUpdate(Pe,g),c.__reactInternalSnapshotBeforeUpdate=n}catch(Ae){_t(o,o.return,Ae)}}break;case 3:if((n&1024)!==0){if(n=s.stateNode.containerInfo,o=n.nodeType,o===9)Mp(n);else if(o===1)switch(n.nodeName){case"HEAD":case"HTML":case"BODY":Mp(n);break;default:n.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((n&1024)!==0)throw Error(r(163))}if(n=s.sibling,n!==null){n.return=s.return,an=n;break}an=s.return}}function R_(n,s,o){var c=o.flags;switch(o.tag){case 0:case 11:case 15:rs(n,o),c&4&&yc(5,o);break;case 1:if(rs(n,o),c&4)if(n=o.stateNode,s===null)try{n.componentDidMount()}catch(E){_t(o,o.return,E)}else{var f=ya(o.type,s.memoizedProps);s=s.memoizedState;try{n.componentDidUpdate(f,s,n.__reactInternalSnapshotBeforeUpdate)}catch(E){_t(o,o.return,E)}}c&64&&__(o),c&512&&vc(o,o.return);break;case 3:if(rs(n,o),c&64&&(n=o.updateQueue,n!==null)){if(s=null,o.child!==null)switch(o.child.tag){case 27:case 5:s=o.child.stateNode;break;case 1:s=o.child.stateNode}try{a0(n,s)}catch(E){_t(o,o.return,E)}}break;case 27:s===null&&c&4&&T_(o);case 26:case 5:rs(n,o),s===null&&c&4&&x_(o),c&512&&vc(o,o.return);break;case 12:rs(n,o);break;case 13:rs(n,o),c&4&&I_(n,o),c&64&&(n=o.memoizedState,n!==null&&(n=n.dehydrated,n!==null&&(o=NS.bind(null,o),YS(n,o))));break;case 22:if(c=o.memoizedState!==null||xr,!c){s=s!==null&&s.memoizedState!==null||jt,f=xr;var g=jt;xr=c,(jt=s)&&!g?ss(n,o,(o.subtreeFlags&8772)!==0):rs(n,o),xr=f,jt=g}break;case 30:break;default:rs(n,o)}}function S_(n){var s=n.alternate;s!==null&&(n.alternate=null,S_(s)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(s=n.stateNode,s!==null&&Kr(s)),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}var wt=null,jn=!1;function Er(n,s,o){for(o=o.child;o!==null;)A_(n,s,o),o=o.sibling}function A_(n,s,o){if(rt&&typeof rt.onCommitFiberUnmount=="function")try{rt.onCommitFiberUnmount(mt,o)}catch{}switch(o.tag){case 26:jt||Ui(o,s),Er(n,s,o),o.memoizedState?o.memoizedState.count--:o.stateNode&&(o=o.stateNode,o.parentNode.removeChild(o));break;case 27:jt||Ui(o,s);var c=wt,f=jn;hs(o.type)&&(wt=o.stateNode,jn=!1),Er(n,s,o),Ac(o.stateNode),wt=c,jn=f;break;case 5:jt||Ui(o,s);case 6:if(c=wt,f=jn,wt=null,Er(n,s,o),wt=c,jn=f,wt!==null)if(jn)try{(wt.nodeType===9?wt.body:wt.nodeName==="HTML"?wt.ownerDocument.body:wt).removeChild(o.stateNode)}catch(g){_t(o,s,g)}else try{wt.removeChild(o.stateNode)}catch(g){_t(o,s,g)}break;case 18:wt!==null&&(jn?(n=wt,pb(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,o.stateNode),Mc(n)):pb(wt,o.stateNode));break;case 4:c=wt,f=jn,wt=o.stateNode.containerInfo,jn=!0,Er(n,s,o),wt=c,jn=f;break;case 0:case 11:case 14:case 15:jt||is(2,o,s),jt||is(4,o,s),Er(n,s,o);break;case 1:jt||(Ui(o,s),c=o.stateNode,typeof c.componentWillUnmount=="function"&&b_(o,s,c)),Er(n,s,o);break;case 21:Er(n,s,o);break;case 22:jt=(c=jt)||o.memoizedState!==null,Er(n,s,o),jt=c;break;default:Er(n,s,o)}}function I_(n,s){if(s.memoizedState===null&&(n=s.alternate,n!==null&&(n=n.memoizedState,n!==null&&(n=n.dehydrated,n!==null))))try{Mc(n)}catch(o){_t(s,s.return,o)}}function xS(n){switch(n.tag){case 13:case 19:var s=n.stateNode;return s===null&&(s=n.stateNode=new w_),s;case 22:return n=n.stateNode,s=n._retryCache,s===null&&(s=n._retryCache=new w_),s;default:throw Error(r(435,n.tag))}}function lp(n,s){var o=xS(n);s.forEach(function(c){var f=CS.bind(null,n,c);o.has(c)||(o.add(c),c.then(f,f))})}function Hn(n,s){var o=s.deletions;if(o!==null)for(var c=0;c<o.length;c++){var f=o[c],g=n,E=s,w=E;e:for(;w!==null;){switch(w.tag){case 27:if(hs(w.type)){wt=w.stateNode,jn=!1;break e}break;case 5:wt=w.stateNode,jn=!1;break e;case 3:case 4:wt=w.stateNode.containerInfo,jn=!0;break e}w=w.return}if(wt===null)throw Error(r(160));A_(g,E,f),wt=null,jn=!1,g=f.alternate,g!==null&&(g.return=null),f.return=null}if(s.subtreeFlags&13878)for(s=s.child;s!==null;)N_(s,n),s=s.sibling}var Ei=null;function N_(n,s){var o=n.alternate,c=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:Hn(s,n),Gn(n),c&4&&(is(3,n,n.return),yc(3,n),is(5,n,n.return));break;case 1:Hn(s,n),Gn(n),c&512&&(jt||o===null||Ui(o,o.return)),c&64&&xr&&(n=n.updateQueue,n!==null&&(c=n.callbacks,c!==null&&(o=n.shared.hiddenCallbacks,n.shared.hiddenCallbacks=o===null?c:o.concat(c))));break;case 26:var f=Ei;if(Hn(s,n),Gn(n),c&512&&(jt||o===null||Ui(o,o.return)),c&4){var g=o!==null?o.memoizedState:null;if(c=n.memoizedState,o===null)if(c===null)if(n.stateNode===null){e:{c=n.type,o=n.memoizedProps,f=f.ownerDocument||f;t:switch(c){case"title":g=f.getElementsByTagName("title")[0],(!g||g[Ks]||g[Qt]||g.namespaceURI==="http://www.w3.org/2000/svg"||g.hasAttribute("itemprop"))&&(g=f.createElement(c),f.head.insertBefore(g,f.querySelector("head > title"))),mn(g,c,o),g[Qt]=n,Ot(g),c=g;break e;case"link":var E=Tb("link","href",f).get(c+(o.href||""));if(E){for(var w=0;w<E.length;w++)if(g=E[w],g.getAttribute("href")===(o.href==null||o.href===""?null:o.href)&&g.getAttribute("rel")===(o.rel==null?null:o.rel)&&g.getAttribute("title")===(o.title==null?null:o.title)&&g.getAttribute("crossorigin")===(o.crossOrigin==null?null:o.crossOrigin)){E.splice(w,1);break t}}g=f.createElement(c),mn(g,c,o),f.head.appendChild(g);break;case"meta":if(E=Tb("meta","content",f).get(c+(o.content||""))){for(w=0;w<E.length;w++)if(g=E[w],g.getAttribute("content")===(o.content==null?null:""+o.content)&&g.getAttribute("name")===(o.name==null?null:o.name)&&g.getAttribute("property")===(o.property==null?null:o.property)&&g.getAttribute("http-equiv")===(o.httpEquiv==null?null:o.httpEquiv)&&g.getAttribute("charset")===(o.charSet==null?null:o.charSet)){E.splice(w,1);break t}}g=f.createElement(c),mn(g,c,o),f.head.appendChild(g);break;default:throw Error(r(468,c))}g[Qt]=n,Ot(g),c=g}n.stateNode=c}else wb(f,n.type,n.stateNode);else n.stateNode=Eb(f,c,n.memoizedProps);else g!==c?(g===null?o.stateNode!==null&&(o=o.stateNode,o.parentNode.removeChild(o)):g.count--,c===null?wb(f,n.type,n.stateNode):Eb(f,c,n.memoizedProps)):c===null&&n.stateNode!==null&&rp(n,n.memoizedProps,o.memoizedProps)}break;case 27:Hn(s,n),Gn(n),c&512&&(jt||o===null||Ui(o,o.return)),o!==null&&c&4&&rp(n,n.memoizedProps,o.memoizedProps);break;case 5:if(Hn(s,n),Gn(n),c&512&&(jt||o===null||Ui(o,o.return)),n.flags&32){f=n.stateNode;try{ri(f,"")}catch(J){_t(n,n.return,J)}}c&4&&n.stateNode!=null&&(f=n.memoizedProps,rp(n,f,o!==null?o.memoizedProps:f)),c&1024&&(op=!0);break;case 6:if(Hn(s,n),Gn(n),c&4){if(n.stateNode===null)throw Error(r(162));c=n.memoizedProps,o=n.stateNode;try{o.nodeValue=c}catch(J){_t(n,n.return,J)}}break;case 3:if(sd=null,f=Ei,Ei=id(s.containerInfo),Hn(s,n),Ei=f,Gn(n),c&4&&o!==null&&o.memoizedState.isDehydrated)try{Mc(s.containerInfo)}catch(J){_t(n,n.return,J)}op&&(op=!1,C_(n));break;case 4:c=Ei,Ei=id(n.stateNode.containerInfo),Hn(s,n),Gn(n),Ei=c;break;case 12:Hn(s,n),Gn(n);break;case 13:Hn(s,n),Gn(n),n.child.flags&8192&&n.memoizedState!==null!=(o!==null&&o.memoizedState!==null)&&(mp=Et()),c&4&&(c=n.updateQueue,c!==null&&(n.updateQueue=null,lp(n,c)));break;case 22:f=n.memoizedState!==null;var j=o!==null&&o.memoizedState!==null,Q=xr,le=jt;if(xr=Q||f,jt=le||j,Hn(s,n),jt=le,xr=Q,Gn(n),c&8192)e:for(s=n.stateNode,s._visibility=f?s._visibility&-2:s._visibility|1,f&&(o===null||j||xr||jt||va(n)),o=null,s=n;;){if(s.tag===5||s.tag===26){if(o===null){j=o=s;try{if(g=j.stateNode,f)E=g.style,typeof E.setProperty=="function"?E.setProperty("display","none","important"):E.display="none";else{w=j.stateNode;var he=j.memoizedProps.style,W=he!=null&&he.hasOwnProperty("display")?he.display:null;w.style.display=W==null||typeof W=="boolean"?"":(""+W).trim()}}catch(J){_t(j,j.return,J)}}}else if(s.tag===6){if(o===null){j=s;try{j.stateNode.nodeValue=f?"":j.memoizedProps}catch(J){_t(j,j.return,J)}}}else if((s.tag!==22&&s.tag!==23||s.memoizedState===null||s===n)&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===n)break e;for(;s.sibling===null;){if(s.return===null||s.return===n)break e;o===s&&(o=null),s=s.return}o===s&&(o=null),s.sibling.return=s.return,s=s.sibling}c&4&&(c=n.updateQueue,c!==null&&(o=c.retryQueue,o!==null&&(c.retryQueue=null,lp(n,o))));break;case 19:Hn(s,n),Gn(n),c&4&&(c=n.updateQueue,c!==null&&(n.updateQueue=null,lp(n,c)));break;case 30:break;case 21:break;default:Hn(s,n),Gn(n)}}function Gn(n){var s=n.flags;if(s&2){try{for(var o,c=n.return;c!==null;){if(E_(c)){o=c;break}c=c.return}if(o==null)throw Error(r(160));switch(o.tag){case 27:var f=o.stateNode,g=sp(n);Hh(n,g,f);break;case 5:var E=o.stateNode;o.flags&32&&(ri(E,""),o.flags&=-33);var w=sp(n);Hh(n,w,E);break;case 3:case 4:var j=o.stateNode.containerInfo,Q=sp(n);ap(n,Q,j);break;default:throw Error(r(161))}}catch(le){_t(n,n.return,le)}n.flags&=-3}s&4096&&(n.flags&=-4097)}function C_(n){if(n.subtreeFlags&1024)for(n=n.child;n!==null;){var s=n;C_(s),s.tag===5&&s.flags&1024&&s.stateNode.reset(),n=n.sibling}}function rs(n,s){if(s.subtreeFlags&8772)for(s=s.child;s!==null;)R_(n,s.alternate,s),s=s.sibling}function va(n){for(n=n.child;n!==null;){var s=n;switch(s.tag){case 0:case 11:case 14:case 15:is(4,s,s.return),va(s);break;case 1:Ui(s,s.return);var o=s.stateNode;typeof o.componentWillUnmount=="function"&&b_(s,s.return,o),va(s);break;case 27:Ac(s.stateNode);case 26:case 5:Ui(s,s.return),va(s);break;case 22:s.memoizedState===null&&va(s);break;case 30:va(s);break;default:va(s)}n=n.sibling}}function ss(n,s,o){for(o=o&&(s.subtreeFlags&8772)!==0,s=s.child;s!==null;){var c=s.alternate,f=n,g=s,E=g.flags;switch(g.tag){case 0:case 11:case 15:ss(f,g,o),yc(4,g);break;case 1:if(ss(f,g,o),c=g,f=c.stateNode,typeof f.componentDidMount=="function")try{f.componentDidMount()}catch(Q){_t(c,c.return,Q)}if(c=g,f=c.updateQueue,f!==null){var w=c.stateNode;try{var j=f.shared.hiddenCallbacks;if(j!==null)for(f.shared.hiddenCallbacks=null,f=0;f<j.length;f++)s0(j[f],w)}catch(Q){_t(c,c.return,Q)}}o&&E&64&&__(g),vc(g,g.return);break;case 27:T_(g);case 26:case 5:ss(f,g,o),o&&c===null&&E&4&&x_(g),vc(g,g.return);break;case 12:ss(f,g,o);break;case 13:ss(f,g,o),o&&E&4&&I_(f,g);break;case 22:g.memoizedState===null&&ss(f,g,o),vc(g,g.return);break;case 30:break;default:ss(f,g,o)}s=s.sibling}}function cp(n,s){var o=null;n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(o=n.memoizedState.cachePool.pool),n=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(n=s.memoizedState.cachePool.pool),n!==o&&(n!=null&&n.refCount++,o!=null&&ic(o))}function up(n,s){n=null,s.alternate!==null&&(n=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==n&&(s.refCount++,n!=null&&ic(n))}function zi(n,s,o,c){if(s.subtreeFlags&10256)for(s=s.child;s!==null;)P_(n,s,o,c),s=s.sibling}function P_(n,s,o,c){var f=s.flags;switch(s.tag){case 0:case 11:case 15:zi(n,s,o,c),f&2048&&yc(9,s);break;case 1:zi(n,s,o,c);break;case 3:zi(n,s,o,c),f&2048&&(n=null,s.alternate!==null&&(n=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==n&&(s.refCount++,n!=null&&ic(n)));break;case 12:if(f&2048){zi(n,s,o,c),n=s.stateNode;try{var g=s.memoizedProps,E=g.id,w=g.onPostCommit;typeof w=="function"&&w(E,s.alternate===null?"mount":"update",n.passiveEffectDuration,-0)}catch(j){_t(s,s.return,j)}}else zi(n,s,o,c);break;case 13:zi(n,s,o,c);break;case 23:break;case 22:g=s.stateNode,E=s.alternate,s.memoizedState!==null?g._visibility&2?zi(n,s,o,c):_c(n,s):g._visibility&2?zi(n,s,o,c):(g._visibility|=2,Po(n,s,o,c,(s.subtreeFlags&10256)!==0)),f&2048&&cp(E,s);break;case 24:zi(n,s,o,c),f&2048&&up(s.alternate,s);break;default:zi(n,s,o,c)}}function Po(n,s,o,c,f){for(f=f&&(s.subtreeFlags&10256)!==0,s=s.child;s!==null;){var g=n,E=s,w=o,j=c,Q=E.flags;switch(E.tag){case 0:case 11:case 15:Po(g,E,w,j,f),yc(8,E);break;case 23:break;case 22:var le=E.stateNode;E.memoizedState!==null?le._visibility&2?Po(g,E,w,j,f):_c(g,E):(le._visibility|=2,Po(g,E,w,j,f)),f&&Q&2048&&cp(E.alternate,E);break;case 24:Po(g,E,w,j,f),f&&Q&2048&&up(E.alternate,E);break;default:Po(g,E,w,j,f)}s=s.sibling}}function _c(n,s){if(s.subtreeFlags&10256)for(s=s.child;s!==null;){var o=n,c=s,f=c.flags;switch(c.tag){case 22:_c(o,c),f&2048&&cp(c.alternate,c);break;case 24:_c(o,c),f&2048&&up(c.alternate,c);break;default:_c(o,c)}s=s.sibling}}var bc=8192;function Do(n){if(n.subtreeFlags&bc)for(n=n.child;n!==null;)D_(n),n=n.sibling}function D_(n){switch(n.tag){case 26:Do(n),n.flags&bc&&n.memoizedState!==null&&aA(Ei,n.memoizedState,n.memoizedProps);break;case 5:Do(n);break;case 3:case 4:var s=Ei;Ei=id(n.stateNode.containerInfo),Do(n),Ei=s;break;case 22:n.memoizedState===null&&(s=n.alternate,s!==null&&s.memoizedState!==null?(s=bc,bc=16777216,Do(n),bc=s):Do(n));break;default:Do(n)}}function V_(n){var s=n.alternate;if(s!==null&&(n=s.child,n!==null)){s.child=null;do s=n.sibling,n.sibling=null,n=s;while(n!==null)}}function xc(n){var s=n.deletions;if((n.flags&16)!==0){if(s!==null)for(var o=0;o<s.length;o++){var c=s[o];an=c,M_(c,n)}V_(n)}if(n.subtreeFlags&10256)for(n=n.child;n!==null;)O_(n),n=n.sibling}function O_(n){switch(n.tag){case 0:case 11:case 15:xc(n),n.flags&2048&&is(9,n,n.return);break;case 3:xc(n);break;case 12:xc(n);break;case 22:var s=n.stateNode;n.memoizedState!==null&&s._visibility&2&&(n.return===null||n.return.tag!==13)?(s._visibility&=-3,Gh(n)):xc(n);break;default:xc(n)}}function Gh(n){var s=n.deletions;if((n.flags&16)!==0){if(s!==null)for(var o=0;o<s.length;o++){var c=s[o];an=c,M_(c,n)}V_(n)}for(n=n.child;n!==null;){switch(s=n,s.tag){case 0:case 11:case 15:is(8,s,s.return),Gh(s);break;case 22:o=s.stateNode,o._visibility&2&&(o._visibility&=-3,Gh(s));break;default:Gh(s)}n=n.sibling}}function M_(n,s){for(;an!==null;){var o=an;switch(o.tag){case 0:case 11:case 15:is(8,o,s);break;case 23:case 22:if(o.memoizedState!==null&&o.memoizedState.cachePool!==null){var c=o.memoizedState.cachePool.pool;c!=null&&c.refCount++}break;case 24:ic(o.memoizedState.cache)}if(c=o.child,c!==null)c.return=o,an=c;else e:for(o=n;an!==null;){c=an;var f=c.sibling,g=c.return;if(S_(c),c===o){an=null;break e}if(f!==null){f.return=g,an=f;break e}an=g}}}var ES={getCacheForType:function(n){var s=yn(Jt),o=s.data.get(n);return o===void 0&&(o=n(),s.data.set(n,o)),o}},TS=typeof WeakMap=="function"?WeakMap:Map,lt=0,bt=null,qe=null,Ze=0,ct=0,Kn=null,as=!1,Vo=!1,hp=!1,Tr=0,Pt=0,os=0,_a=0,dp=0,fi=0,Oo=0,Ec=null,kn=null,fp=!1,mp=0,Kh=1/0,Yh=null,ls=null,fn=0,cs=null,Mo=null,jo=0,pp=0,gp=null,j_=null,Tc=0,yp=null;function Yn(){if((lt&2)!==0&&Ze!==0)return Ze&-Ze;if(z.T!==null){var n=To;return n!==0?n:wp()}return Hr()}function k_(){fi===0&&(fi=(Ze&536870912)===0||st?Dl():536870912);var n=di.current;return n!==null&&(n.flags|=32),fi}function $n(n,s,o){(n===bt&&(ct===2||ct===9)||n.cancelPendingCommit!==null)&&(ko(n,0),us(n,Ze,fi,!1)),tr(n,o),((lt&2)===0||n!==bt)&&(n===bt&&((lt&2)===0&&(_a|=o),Pt===4&&us(n,Ze,fi,!1)),qi(n))}function L_(n,s,o){if((lt&6)!==0)throw Error(r(327));var c=!o&&(s&124)===0&&(s&n.expiredLanes)===0||Gs(n,s),f=c?SS(n,s):bp(n,s,!0),g=c;do{if(f===0){Vo&&!c&&us(n,s,0,!1);break}else{if(o=n.current.alternate,g&&!wS(o)){f=bp(n,s,!1),g=!1;continue}if(f===2){if(g=s,n.errorRecoveryDisabledLanes&g)var E=0;else E=n.pendingLanes&-536870913,E=E!==0?E:E&536870912?536870912:0;if(E!==0){s=E;e:{var w=n;f=Ec;var j=w.current.memoizedState.isDehydrated;if(j&&(ko(w,E).flags|=256),E=bp(w,E,!1),E!==2){if(hp&&!j){w.errorRecoveryDisabledLanes|=g,_a|=g,f=4;break e}g=kn,kn=f,g!==null&&(kn===null?kn=g:kn.push.apply(kn,g))}f=E}if(g=!1,f!==2)continue}}if(f===1){ko(n,0),us(n,s,0,!0);break}e:{switch(c=n,g=f,g){case 0:case 1:throw Error(r(345));case 4:if((s&4194048)!==s)break;case 6:us(c,s,fi,!as);break e;case 2:kn=null;break;case 3:case 5:break;default:throw Error(r(329))}if((s&62914560)===s&&(f=mp+300-Et(),10<f)){if(us(c,s,fi,!as),Za(c,0,!0)!==0)break e;c.timeoutHandle=fb(F_.bind(null,c,o,kn,Yh,fp,s,fi,_a,Oo,as,g,2,-0,0),f);break e}F_(c,o,kn,Yh,fp,s,fi,_a,Oo,as,g,0,-0,0)}}break}while(!0);qi(n)}function F_(n,s,o,c,f,g,E,w,j,Q,le,he,W,J){if(n.timeoutHandle=-1,he=s.subtreeFlags,(he&8192||(he&16785408)===16785408)&&(Cc={stylesheets:null,count:0,unsuspend:sA},D_(s),he=oA(),he!==null)){n.cancelPendingCommit=he(K_.bind(null,n,s,g,o,c,f,E,w,j,le,1,W,J)),us(n,g,E,!Q);return}K_(n,s,g,o,c,f,E,w,j)}function wS(n){for(var s=n;;){var o=s.tag;if((o===0||o===11||o===15)&&s.flags&16384&&(o=s.updateQueue,o!==null&&(o=o.stores,o!==null)))for(var c=0;c<o.length;c++){var f=o[c],g=f.getSnapshot;f=f.value;try{if(!qn(g(),f))return!1}catch{return!1}}if(o=s.child,s.subtreeFlags&16384&&o!==null)o.return=s,s=o;else{if(s===n)break;for(;s.sibling===null;){if(s.return===null||s.return===n)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function us(n,s,o,c){s&=~dp,s&=~_a,n.suspendedLanes|=s,n.pingedLanes&=~s,c&&(n.warmLanes|=s),c=n.expirationTimes;for(var f=s;0<f;){var g=31-$t(f),E=1<<g;c[g]=-1,f&=~E}o!==0&&Ai(n,o,s)}function $h(){return(lt&6)===0?(wc(0),!1):!0}function vp(){if(qe!==null){if(ct===0)var n=qe.return;else n=qe,pr=fa=null,Mm(n),No=null,mc=0,n=qe;for(;n!==null;)v_(n.alternate,n),n=n.return;qe=null}}function ko(n,s){var o=n.timeoutHandle;o!==-1&&(n.timeoutHandle=-1,qS(o)),o=n.cancelPendingCommit,o!==null&&(n.cancelPendingCommit=null,o()),vp(),bt=n,qe=o=dr(n.current,null),Ze=s,ct=0,Kn=null,as=!1,Vo=Gs(n,s),hp=!1,Oo=fi=dp=_a=os=Pt=0,kn=Ec=null,fp=!1,(s&8)!==0&&(s|=s&32);var c=n.entangledLanes;if(c!==0)for(n=n.entanglements,c&=s;0<c;){var f=31-$t(c),g=1<<f;s|=n[f],c&=~g}return Tr=s,gh(),o}function U_(n,s){Le=null,z.H=Mh,s===sc||s===Rh?(s=i0(),ct=3):s===e0?(s=i0(),ct=4):ct=s===r_?8:s!==null&&typeof s=="object"&&typeof s.then=="function"?6:1,Kn=s,qe===null&&(Pt=1,Uh(n,li(s,n.current)))}function z_(){var n=z.H;return z.H=Mh,n===null?Mh:n}function q_(){var n=z.A;return z.A=ES,n}function _p(){Pt=4,as||(Ze&4194048)!==Ze&&di.current!==null||(Vo=!0),(os&134217727)===0&&(_a&134217727)===0||bt===null||us(bt,Ze,fi,!1)}function bp(n,s,o){var c=lt;lt|=2;var f=z_(),g=q_();(bt!==n||Ze!==s)&&(Yh=null,ko(n,s)),s=!1;var E=Pt;e:do try{if(ct!==0&&qe!==null){var w=qe,j=Kn;switch(ct){case 8:vp(),E=6;break e;case 3:case 2:case 9:case 6:di.current===null&&(s=!0);var Q=ct;if(ct=0,Kn=null,Lo(n,w,j,Q),o&&Vo){E=0;break e}break;default:Q=ct,ct=0,Kn=null,Lo(n,w,j,Q)}}RS(),E=Pt;break}catch(le){U_(n,le)}while(!0);return s&&n.shellSuspendCounter++,pr=fa=null,lt=c,z.H=f,z.A=g,qe===null&&(bt=null,Ze=0,gh()),E}function RS(){for(;qe!==null;)B_(qe)}function SS(n,s){var o=lt;lt|=2;var c=z_(),f=q_();bt!==n||Ze!==s?(Yh=null,Kh=Et()+500,ko(n,s)):Vo=Gs(n,s);e:do try{if(ct!==0&&qe!==null){s=qe;var g=Kn;t:switch(ct){case 1:ct=0,Kn=null,Lo(n,s,g,1);break;case 2:case 9:if(t0(g)){ct=0,Kn=null,H_(s);break}s=function(){ct!==2&&ct!==9||bt!==n||(ct=7),qi(n)},g.then(s,s);break e;case 3:ct=7;break e;case 4:ct=5;break e;case 7:t0(g)?(ct=0,Kn=null,H_(s)):(ct=0,Kn=null,Lo(n,s,g,7));break;case 5:var E=null;switch(qe.tag){case 26:E=qe.memoizedState;case 5:case 27:var w=qe;if(!E||Rb(E)){ct=0,Kn=null;var j=w.sibling;if(j!==null)qe=j;else{var Q=w.return;Q!==null?(qe=Q,Qh(Q)):qe=null}break t}}ct=0,Kn=null,Lo(n,s,g,5);break;case 6:ct=0,Kn=null,Lo(n,s,g,6);break;case 8:vp(),Pt=6;break e;default:throw Error(r(462))}}AS();break}catch(le){U_(n,le)}while(!0);return pr=fa=null,z.H=c,z.A=f,lt=o,qe!==null?0:(bt=null,Ze=0,gh(),Pt)}function AS(){for(;qe!==null&&!Yt();)B_(qe)}function B_(n){var s=g_(n.alternate,n,Tr);n.memoizedProps=n.pendingProps,s===null?Qh(n):qe=s}function H_(n){var s=n,o=s.alternate;switch(s.tag){case 15:case 0:s=u_(o,s,s.pendingProps,s.type,void 0,Ze);break;case 11:s=u_(o,s,s.pendingProps,s.type.render,s.ref,Ze);break;case 5:Mm(s);default:v_(o,s),s=qe=Gv(s,Tr),s=g_(o,s,Tr)}n.memoizedProps=n.pendingProps,s===null?Qh(n):qe=s}function Lo(n,s,o,c){pr=fa=null,Mm(s),No=null,mc=0;var f=s.return;try{if(gS(n,f,s,o,Ze)){Pt=1,Uh(n,li(o,n.current)),qe=null;return}}catch(g){if(f!==null)throw qe=f,g;Pt=1,Uh(n,li(o,n.current)),qe=null;return}s.flags&32768?(st||c===1?n=!0:Vo||(Ze&536870912)!==0?n=!1:(as=n=!0,(c===2||c===9||c===3||c===6)&&(c=di.current,c!==null&&c.tag===13&&(c.flags|=16384))),G_(s,n)):Qh(s)}function Qh(n){var s=n;do{if((s.flags&32768)!==0){G_(s,as);return}n=s.return;var o=vS(s.alternate,s,Tr);if(o!==null){qe=o;return}if(s=s.sibling,s!==null){qe=s;return}qe=s=n}while(s!==null);Pt===0&&(Pt=5)}function G_(n,s){do{var o=_S(n.alternate,n);if(o!==null){o.flags&=32767,qe=o;return}if(o=n.return,o!==null&&(o.flags|=32768,o.subtreeFlags=0,o.deletions=null),!s&&(n=n.sibling,n!==null)){qe=n;return}qe=n=o}while(n!==null);Pt=6,qe=null}function K_(n,s,o,c,f,g,E,w,j){n.cancelPendingCommit=null;do Xh();while(fn!==0);if((lt&6)!==0)throw Error(r(327));if(s!==null){if(s===n.current)throw Error(r(177));if(g=s.lanes|s.childLanes,g|=um,Ol(n,o,g,E,w,j),n===bt&&(qe=bt=null,Ze=0),Mo=s,cs=n,jo=o,pp=g,gp=f,j_=c,(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?(n.callbackNode=null,n.callbackPriority=0,PS(ke,function(){return W_(),null})):(n.callbackNode=null,n.callbackPriority=0),c=(s.flags&13878)!==0,(s.subtreeFlags&13878)!==0||c){c=z.T,z.T=null,f=X.p,X.p=2,E=lt,lt|=4;try{bS(n,s,o)}finally{lt=E,X.p=f,z.T=c}}fn=1,Y_(),$_(),Q_()}}function Y_(){if(fn===1){fn=0;var n=cs,s=Mo,o=(s.flags&13878)!==0;if((s.subtreeFlags&13878)!==0||o){o=z.T,z.T=null;var c=X.p;X.p=2;var f=lt;lt|=4;try{N_(s,n);var g=Dp,E=Mv(n.containerInfo),w=g.focusedElem,j=g.selectionRange;if(E!==w&&w&&w.ownerDocument&&Ov(w.ownerDocument.documentElement,w)){if(j!==null&&sm(w)){var Q=j.start,le=j.end;if(le===void 0&&(le=Q),"selectionStart"in w)w.selectionStart=Q,w.selectionEnd=Math.min(le,w.value.length);else{var he=w.ownerDocument||document,W=he&&he.defaultView||window;if(W.getSelection){var J=W.getSelection(),Pe=w.textContent.length,Ae=Math.min(j.start,Pe),vt=j.end===void 0?Ae:Math.min(j.end,Pe);!J.extend&&Ae>vt&&(E=vt,vt=Ae,Ae=E);var H=Vv(w,Ae),F=Vv(w,vt);if(H&&F&&(J.rangeCount!==1||J.anchorNode!==H.node||J.anchorOffset!==H.offset||J.focusNode!==F.node||J.focusOffset!==F.offset)){var $=he.createRange();$.setStart(H.node,H.offset),J.removeAllRanges(),Ae>vt?(J.addRange($),J.extend(F.node,F.offset)):($.setEnd(F.node,F.offset),J.addRange($))}}}}for(he=[],J=w;J=J.parentNode;)J.nodeType===1&&he.push({element:J,left:J.scrollLeft,top:J.scrollTop});for(typeof w.focus=="function"&&w.focus(),w=0;w<he.length;w++){var ce=he[w];ce.element.scrollLeft=ce.left,ce.element.scrollTop=ce.top}}ld=!!Pp,Dp=Pp=null}finally{lt=f,X.p=c,z.T=o}}n.current=s,fn=2}}function $_(){if(fn===2){fn=0;var n=cs,s=Mo,o=(s.flags&8772)!==0;if((s.subtreeFlags&8772)!==0||o){o=z.T,z.T=null;var c=X.p;X.p=2;var f=lt;lt|=4;try{R_(n,s.alternate,s)}finally{lt=f,X.p=c,z.T=o}}fn=3}}function Q_(){if(fn===4||fn===3){fn=0,cn();var n=cs,s=Mo,o=jo,c=j_;(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?fn=5:(fn=0,Mo=cs=null,X_(n,n.pendingLanes));var f=n.pendingLanes;if(f===0&&(ls=null),eo(o),s=s.stateNode,rt&&typeof rt.onCommitFiberRoot=="function")try{rt.onCommitFiberRoot(mt,s,void 0,(s.current.flags&128)===128)}catch{}if(c!==null){s=z.T,f=X.p,X.p=2,z.T=null;try{for(var g=n.onRecoverableError,E=0;E<c.length;E++){var w=c[E];g(w.value,{componentStack:w.stack})}}finally{z.T=s,X.p=f}}(jo&3)!==0&&Xh(),qi(n),f=n.pendingLanes,(o&4194090)!==0&&(f&42)!==0?n===yp?Tc++:(Tc=0,yp=n):Tc=0,wc(0)}}function X_(n,s){(n.pooledCacheLanes&=s)===0&&(s=n.pooledCache,s!=null&&(n.pooledCache=null,ic(s)))}function Xh(n){return Y_(),$_(),Q_(),W_()}function W_(){if(fn!==5)return!1;var n=cs,s=pp;pp=0;var o=eo(jo),c=z.T,f=X.p;try{X.p=32>o?32:o,z.T=null,o=gp,gp=null;var g=cs,E=jo;if(fn=0,Mo=cs=null,jo=0,(lt&6)!==0)throw Error(r(331));var w=lt;if(lt|=4,O_(g.current),P_(g,g.current,E,o),lt=w,wc(0,!1),rt&&typeof rt.onPostCommitFiberRoot=="function")try{rt.onPostCommitFiberRoot(mt,g)}catch{}return!0}finally{X.p=f,z.T=c,X_(n,s)}}function J_(n,s,o){s=li(o,s),s=Qm(n.stateNode,s,2),n=Zr(n,s,2),n!==null&&(tr(n,2),qi(n))}function _t(n,s,o){if(n.tag===3)J_(n,n,o);else for(;s!==null;){if(s.tag===3){J_(s,n,o);break}else if(s.tag===1){var c=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&(ls===null||!ls.has(c))){n=li(o,n),o=n_(2),c=Zr(s,o,2),c!==null&&(i_(o,c,s,n),tr(c,2),qi(c));break}}s=s.return}}function xp(n,s,o){var c=n.pingCache;if(c===null){c=n.pingCache=new TS;var f=new Set;c.set(s,f)}else f=c.get(s),f===void 0&&(f=new Set,c.set(s,f));f.has(o)||(hp=!0,f.add(o),n=IS.bind(null,n,s,o),s.then(n,n))}function IS(n,s,o){var c=n.pingCache;c!==null&&c.delete(s),n.pingedLanes|=n.suspendedLanes&o,n.warmLanes&=~o,bt===n&&(Ze&o)===o&&(Pt===4||Pt===3&&(Ze&62914560)===Ze&&300>Et()-mp?(lt&2)===0&&ko(n,0):dp|=o,Oo===Ze&&(Oo=0)),qi(n)}function Z_(n,s){s===0&&(s=Vl()),n=_o(n,s),n!==null&&(tr(n,s),qi(n))}function NS(n){var s=n.memoizedState,o=0;s!==null&&(o=s.retryLane),Z_(n,o)}function CS(n,s){var o=0;switch(n.tag){case 13:var c=n.stateNode,f=n.memoizedState;f!==null&&(o=f.retryLane);break;case 19:c=n.stateNode;break;case 22:c=n.stateNode._retryCache;break;default:throw Error(r(314))}c!==null&&c.delete(s),Z_(n,o)}function PS(n,s){return He(n,s)}var Wh=null,Fo=null,Ep=!1,Jh=!1,Tp=!1,ba=0;function qi(n){n!==Fo&&n.next===null&&(Fo===null?Wh=Fo=n:Fo=Fo.next=n),Jh=!0,Ep||(Ep=!0,VS())}function wc(n,s){if(!Tp&&Jh){Tp=!0;do for(var o=!1,c=Wh;c!==null;){if(n!==0){var f=c.pendingLanes;if(f===0)var g=0;else{var E=c.suspendedLanes,w=c.pingedLanes;g=(1<<31-$t(42|n)+1)-1,g&=f&~(E&~w),g=g&201326741?g&201326741|1:g?g|2:0}g!==0&&(o=!0,ib(c,g))}else g=Ze,g=Za(c,c===bt?g:0,c.cancelPendingCommit!==null||c.timeoutHandle!==-1),(g&3)===0||Gs(c,g)||(o=!0,ib(c,g));c=c.next}while(o);Tp=!1}}function DS(){eb()}function eb(){Jh=Ep=!1;var n=0;ba!==0&&(zS()&&(n=ba),ba=0);for(var s=Et(),o=null,c=Wh;c!==null;){var f=c.next,g=tb(c,s);g===0?(c.next=null,o===null?Wh=f:o.next=f,f===null&&(Fo=o)):(o=c,(n!==0||(g&3)!==0)&&(Jh=!0)),c=f}wc(n)}function tb(n,s){for(var o=n.suspendedLanes,c=n.pingedLanes,f=n.expirationTimes,g=n.pendingLanes&-62914561;0<g;){var E=31-$t(g),w=1<<E,j=f[E];j===-1?((w&o)===0||(w&c)!==0)&&(f[E]=Pl(w,s)):j<=s&&(n.expiredLanes|=w),g&=~w}if(s=bt,o=Ze,o=Za(n,n===s?o:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),c=n.callbackNode,o===0||n===s&&(ct===2||ct===9)||n.cancelPendingCommit!==null)return c!==null&&c!==null&&nt(c),n.callbackNode=null,n.callbackPriority=0;if((o&3)===0||Gs(n,o)){if(s=o&-o,s===n.callbackPriority)return s;switch(c!==null&&nt(c),eo(o)){case 2:case 8:o=Xe;break;case 32:o=ke;break;case 268435456:o=Qe;break;default:o=ke}return c=nb.bind(null,n),o=He(o,c),n.callbackPriority=s,n.callbackNode=o,s}return c!==null&&c!==null&&nt(c),n.callbackPriority=2,n.callbackNode=null,2}function nb(n,s){if(fn!==0&&fn!==5)return n.callbackNode=null,n.callbackPriority=0,null;var o=n.callbackNode;if(Xh()&&n.callbackNode!==o)return null;var c=Ze;return c=Za(n,n===bt?c:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),c===0?null:(L_(n,c,s),tb(n,Et()),n.callbackNode!=null&&n.callbackNode===o?nb.bind(null,n):null)}function ib(n,s){if(Xh())return null;L_(n,s,!0)}function VS(){BS(function(){(lt&6)!==0?He(On,DS):eb()})}function wp(){return ba===0&&(ba=Dl()),ba}function rb(n){return n==null||typeof n=="symbol"||typeof n=="boolean"?null:typeof n=="function"?n:ao(""+n)}function sb(n,s){var o=s.ownerDocument.createElement("input");return o.name=s.name,o.value=s.value,n.id&&o.setAttribute("form",n.id),s.parentNode.insertBefore(o,s),n=new FormData(n),o.parentNode.removeChild(o),n}function OS(n,s,o,c,f){if(s==="submit"&&o&&o.stateNode===f){var g=rb((f[Ft]||null).action),E=c.submitter;E&&(s=(s=E[Ft]||null)?rb(s.formAction):E.getAttribute("formAction"),s!==null&&(g=s,E=null));var w=new oo("action","action",null,c,f);n.push({event:w,listeners:[{instance:null,listener:function(){if(c.defaultPrevented){if(ba!==0){var j=E?sb(f,E):new FormData(f);Hm(o,{pending:!0,data:j,method:f.method,action:g},null,j)}}else typeof g=="function"&&(w.preventDefault(),j=E?sb(f,E):new FormData(f),Hm(o,{pending:!0,data:j,method:f.method,action:g},g,j))},currentTarget:f}]})}}for(var Rp=0;Rp<cm.length;Rp++){var Sp=cm[Rp],MS=Sp.toLowerCase(),jS=Sp[0].toUpperCase()+Sp.slice(1);xi(MS,"on"+jS)}xi(Lv,"onAnimationEnd"),xi(Fv,"onAnimationIteration"),xi(Uv,"onAnimationStart"),xi("dblclick","onDoubleClick"),xi("focusin","onFocus"),xi("focusout","onBlur"),xi(ZR,"onTransitionRun"),xi(eS,"onTransitionStart"),xi(tS,"onTransitionCancel"),xi(zv,"onTransitionEnd"),ir("onMouseEnter",["mouseout","mouseover"]),ir("onMouseLeave",["mouseout","mouseover"]),ir("onPointerEnter",["pointerout","pointerover"]),ir("onPointerLeave",["pointerout","pointerover"]),_i("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),_i("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),_i("onBeforeInput",["compositionend","keypress","textInput","paste"]),_i("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),_i("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),_i("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Rc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),kS=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Rc));function ab(n,s){s=(s&4)!==0;for(var o=0;o<n.length;o++){var c=n[o],f=c.event;c=c.listeners;e:{var g=void 0;if(s)for(var E=c.length-1;0<=E;E--){var w=c[E],j=w.instance,Q=w.currentTarget;if(w=w.listener,j!==g&&f.isPropagationStopped())break e;g=w,f.currentTarget=Q;try{g(f)}catch(le){Fh(le)}f.currentTarget=null,g=j}else for(E=0;E<c.length;E++){if(w=c[E],j=w.instance,Q=w.currentTarget,w=w.listener,j!==g&&f.isPropagationStopped())break e;g=w,f.currentTarget=Q;try{g(f)}catch(le){Fh(le)}f.currentTarget=null,g=j}}}}function Be(n,s){var o=s[jl];o===void 0&&(o=s[jl]=new Set);var c=n+"__bubble";o.has(c)||(ob(s,n,2,!1),o.add(c))}function Ap(n,s,o){var c=0;s&&(c|=4),ob(o,n,c,s)}var Zh="_reactListening"+Math.random().toString(36).slice(2);function Ip(n){if(!n[Zh]){n[Zh]=!0,kl.forEach(function(o){o!=="selectionchange"&&(kS.has(o)||Ap(o,!1,n),Ap(o,!0,n))});var s=n.nodeType===9?n:n.ownerDocument;s===null||s[Zh]||(s[Zh]=!0,Ap("selectionchange",!1,s))}}function ob(n,s,o,c){switch(Pb(s)){case 2:var f=uA;break;case 8:f=hA;break;default:f=qp}o=f.bind(null,s,o,n),f=void 0,!ai||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(f=!0),c?f!==void 0?n.addEventListener(s,o,{capture:!0,passive:f}):n.addEventListener(s,o,!0):f!==void 0?n.addEventListener(s,o,{passive:f}):n.addEventListener(s,o,!1)}function Np(n,s,o,c,f){var g=c;if((s&1)===0&&(s&2)===0&&c!==null)e:for(;;){if(c===null)return;var E=c.tag;if(E===3||E===4){var w=c.stateNode.containerInfo;if(w===f)break;if(E===4)for(E=c.return;E!==null;){var j=E.tag;if((j===3||j===4)&&E.stateNode.containerInfo===f)return;E=E.return}for(;w!==null;){if(E=nr(w),E===null)return;if(j=E.tag,j===5||j===6||j===26||j===27){c=g=E;continue e}w=w.parentNode}}c=c.return}th(function(){var Q=g,le=si(o),he=[];e:{var W=qv.get(n);if(W!==void 0){var J=oo,Pe=n;switch(n){case"keypress":if(Vi(o)===0)break e;case"keydown":case"keyup":J=mo;break;case"focusin":Pe="focus",J=uo;break;case"focusout":Pe="blur",J=uo;break;case"beforeblur":case"afterblur":J=uo;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":J=oi;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":J=tm;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":J=ch;break;case Lv:case Fv:case Uv:J=ho;break;case zv:J=hh;break;case"scroll":case"scrollend":J=nh;break;case"wheel":J=po;break;case"copy":case"cut":case"paste":J=fo;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":J=Ql;break;case"toggle":case"beforetoggle":J=fh}var Ae=(s&4)!==0,vt=!Ae&&(n==="scroll"||n==="scrollend"),H=Ae?W!==null?W+"Capture":null:W;Ae=[];for(var F=Q,$;F!==null;){var ce=F;if($=ce.stateNode,ce=ce.tag,ce!==5&&ce!==26&&ce!==27||$===null||H===null||(ce=Zs(F,H),ce!=null&&Ae.push(Sc(F,ce,$))),vt)break;F=F.return}0<Ae.length&&(W=new J(W,Pe,null,o,le),he.push({event:W,listeners:Ae}))}}if((s&7)===0){e:{if(W=n==="mouseover"||n==="pointerover",J=n==="mouseout"||n==="pointerout",W&&o!==ar&&(Pe=o.relatedTarget||o.fromElement)&&(nr(Pe)||Pe[ii]))break e;if((J||W)&&(W=le.window===le?le:(W=le.ownerDocument)?W.defaultView||W.parentWindow:window,J?(Pe=o.relatedTarget||o.toElement,J=Q,Pe=Pe?nr(Pe):null,Pe!==null&&(vt=l(Pe),Ae=Pe.tag,Pe!==vt||Ae!==5&&Ae!==27&&Ae!==6)&&(Pe=null)):(J=null,Pe=Q),J!==Pe)){if(Ae=oi,ce="onMouseLeave",H="onMouseEnter",F="mouse",(n==="pointerout"||n==="pointerover")&&(Ae=Ql,ce="onPointerLeave",H="onPointerEnter",F="pointer"),vt=J==null?W:Ni(J),$=Pe==null?W:Ni(Pe),W=new Ae(ce,F+"leave",J,o,le),W.target=vt,W.relatedTarget=$,ce=null,nr(le)===Q&&(Ae=new Ae(H,F+"enter",Pe,o,le),Ae.target=$,Ae.relatedTarget=vt,ce=Ae),vt=ce,J&&Pe)t:{for(Ae=J,H=Pe,F=0,$=Ae;$;$=Uo($))F++;for($=0,ce=H;ce;ce=Uo(ce))$++;for(;0<F-$;)Ae=Uo(Ae),F--;for(;0<$-F;)H=Uo(H),$--;for(;F--;){if(Ae===H||H!==null&&Ae===H.alternate)break t;Ae=Uo(Ae),H=Uo(H)}Ae=null}else Ae=null;J!==null&&lb(he,W,J,Ae,!1),Pe!==null&&vt!==null&&lb(he,vt,Pe,Ae,!0)}}e:{if(W=Q?Ni(Q):window,J=W.nodeName&&W.nodeName.toLowerCase(),J==="select"||J==="input"&&W.type==="file")var Ee=Av;else if(Wt(W))if(Iv)Ee=XR;else{Ee=$R;var ze=YR}else J=W.nodeName,!J||J.toLowerCase()!=="input"||W.type!=="checkbox"&&W.type!=="radio"?Q&&ql(Q.elementType)&&(Ee=Av):Ee=QR;if(Ee&&(Ee=Ee(n,Q))){hr(he,Ee,o,le);break e}ze&&ze(n,W,Q),n==="focusout"&&Q&&W.type==="number"&&Q.memoizedProps.value!=null&&$r(W,"number",W.value)}switch(ze=Q?Ni(Q):window,n){case"focusin":(Wt(ze)||ze.contentEditable==="true")&&(go=ze,am=Q,Jl=null);break;case"focusout":Jl=am=go=null;break;case"mousedown":om=!0;break;case"contextmenu":case"mouseup":case"dragend":om=!1,jv(he,o,le);break;case"selectionchange":if(JR)break;case"keydown":case"keyup":jv(he,o,le)}var Re;if(ji)e:{switch(n){case"compositionstart":var Ie="onCompositionStart";break e;case"compositionend":Ie="onCompositionEnd";break e;case"compositionupdate":Ie="onCompositionUpdate";break e}Ie=void 0}else We?te(n,o)&&(Ie="onCompositionEnd"):n==="keydown"&&o.keyCode===229&&(Ie="onCompositionStart");Ie&&(x&&o.locale!=="ko"&&(We||Ie!=="onCompositionStart"?Ie==="onCompositionEnd"&&We&&(Re=Hl()):(Di=le,Qr="value"in Di?Di.value:Di.textContent,We=!0)),ze=ed(Q,Ie),0<ze.length&&(Ie=new Yl(Ie,n,null,o,le),he.push({event:Ie,listeners:ze}),Re?Ie.data=Re:(Re=pe(o),Re!==null&&(Ie.data=Re)))),(Re=v?Xt(n,o):Je(n,o))&&(Ie=ed(Q,"onBeforeInput"),0<Ie.length&&(ze=new Yl("onBeforeInput","beforeinput",null,o,le),he.push({event:ze,listeners:Ie}),ze.data=Re)),OS(he,n,Q,o,le)}ab(he,s)})}function Sc(n,s,o){return{instance:n,listener:s,currentTarget:o}}function ed(n,s){for(var o=s+"Capture",c=[];n!==null;){var f=n,g=f.stateNode;if(f=f.tag,f!==5&&f!==26&&f!==27||g===null||(f=Zs(n,o),f!=null&&c.unshift(Sc(n,f,g)),f=Zs(n,s),f!=null&&c.push(Sc(n,f,g))),n.tag===3)return c;n=n.return}return[]}function Uo(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5&&n.tag!==27);return n||null}function lb(n,s,o,c,f){for(var g=s._reactName,E=[];o!==null&&o!==c;){var w=o,j=w.alternate,Q=w.stateNode;if(w=w.tag,j!==null&&j===c)break;w!==5&&w!==26&&w!==27||Q===null||(j=Q,f?(Q=Zs(o,g),Q!=null&&E.unshift(Sc(o,Q,j))):f||(Q=Zs(o,g),Q!=null&&E.push(Sc(o,Q,j)))),o=o.return}E.length!==0&&n.push({event:s,listeners:E})}var LS=/\r\n?/g,FS=/\u0000|\uFFFD/g;function cb(n){return(typeof n=="string"?n:""+n).replace(LS,`
`).replace(FS,"")}function ub(n,s){return s=cb(s),cb(n)===s}function td(){}function yt(n,s,o,c,f,g){switch(o){case"children":typeof c=="string"?s==="body"||s==="textarea"&&c===""||ri(n,c):(typeof c=="number"||typeof c=="bigint")&&s!=="body"&&ri(n,""+c);break;case"className":Ci(n,"class",c);break;case"tabIndex":Ci(n,"tabindex",c);break;case"dir":case"role":case"viewBox":case"width":case"height":Ci(n,o,c);break;case"style":zl(n,c,g);break;case"data":if(s!=="object"){Ci(n,"data",c);break}case"src":case"href":if(c===""&&(s!=="a"||o!=="href")){n.removeAttribute(o);break}if(c==null||typeof c=="function"||typeof c=="symbol"||typeof c=="boolean"){n.removeAttribute(o);break}c=ao(""+c),n.setAttribute(o,c);break;case"action":case"formAction":if(typeof c=="function"){n.setAttribute(o,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof g=="function"&&(o==="formAction"?(s!=="input"&&yt(n,s,"name",f.name,f,null),yt(n,s,"formEncType",f.formEncType,f,null),yt(n,s,"formMethod",f.formMethod,f,null),yt(n,s,"formTarget",f.formTarget,f,null)):(yt(n,s,"encType",f.encType,f,null),yt(n,s,"method",f.method,f,null),yt(n,s,"target",f.target,f,null)));if(c==null||typeof c=="symbol"||typeof c=="boolean"){n.removeAttribute(o);break}c=ao(""+c),n.setAttribute(o,c);break;case"onClick":c!=null&&(n.onclick=td);break;case"onScroll":c!=null&&Be("scroll",n);break;case"onScrollEnd":c!=null&&Be("scrollend",n);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(r(61));if(o=c.__html,o!=null){if(f.children!=null)throw Error(r(60));n.innerHTML=o}}break;case"multiple":n.multiple=c&&typeof c!="function"&&typeof c!="symbol";break;case"muted":n.muted=c&&typeof c!="function"&&typeof c!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(c==null||typeof c=="function"||typeof c=="boolean"||typeof c=="symbol"){n.removeAttribute("xlink:href");break}o=ao(""+c),n.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":c!=null&&typeof c!="function"&&typeof c!="symbol"?n.setAttribute(o,""+c):n.removeAttribute(o);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":c&&typeof c!="function"&&typeof c!="symbol"?n.setAttribute(o,""):n.removeAttribute(o);break;case"capture":case"download":c===!0?n.setAttribute(o,""):c!==!1&&c!=null&&typeof c!="function"&&typeof c!="symbol"?n.setAttribute(o,c):n.removeAttribute(o);break;case"cols":case"rows":case"size":case"span":c!=null&&typeof c!="function"&&typeof c!="symbol"&&!isNaN(c)&&1<=c?n.setAttribute(o,c):n.removeAttribute(o);break;case"rowSpan":case"start":c==null||typeof c=="function"||typeof c=="symbol"||isNaN(c)?n.removeAttribute(o):n.setAttribute(o,c);break;case"popover":Be("beforetoggle",n),Be("toggle",n),Yr(n,"popover",c);break;case"xlinkActuate":un(n,"http://www.w3.org/1999/xlink","xlink:actuate",c);break;case"xlinkArcrole":un(n,"http://www.w3.org/1999/xlink","xlink:arcrole",c);break;case"xlinkRole":un(n,"http://www.w3.org/1999/xlink","xlink:role",c);break;case"xlinkShow":un(n,"http://www.w3.org/1999/xlink","xlink:show",c);break;case"xlinkTitle":un(n,"http://www.w3.org/1999/xlink","xlink:title",c);break;case"xlinkType":un(n,"http://www.w3.org/1999/xlink","xlink:type",c);break;case"xmlBase":un(n,"http://www.w3.org/XML/1998/namespace","xml:base",c);break;case"xmlLang":un(n,"http://www.w3.org/XML/1998/namespace","xml:lang",c);break;case"xmlSpace":un(n,"http://www.w3.org/XML/1998/namespace","xml:space",c);break;case"is":Yr(n,"is",c);break;case"innerText":case"textContent":break;default:(!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(o=Zf.get(o)||o,Yr(n,o,c))}}function Cp(n,s,o,c,f,g){switch(o){case"style":zl(n,c,g);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(r(61));if(o=c.__html,o!=null){if(f.children!=null)throw Error(r(60));n.innerHTML=o}}break;case"children":typeof c=="string"?ri(n,c):(typeof c=="number"||typeof c=="bigint")&&ri(n,""+c);break;case"onScroll":c!=null&&Be("scroll",n);break;case"onScrollEnd":c!=null&&Be("scrollend",n);break;case"onClick":c!=null&&(n.onclick=td);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!to.hasOwnProperty(o))e:{if(o[0]==="o"&&o[1]==="n"&&(f=o.endsWith("Capture"),s=o.slice(2,f?o.length-7:void 0),g=n[Ft]||null,g=g!=null?g[o]:null,typeof g=="function"&&n.removeEventListener(s,g,f),typeof c=="function")){typeof g!="function"&&g!==null&&(o in n?n[o]=null:n.hasAttribute(o)&&n.removeAttribute(o)),n.addEventListener(s,c,f);break e}o in n?n[o]=c:c===!0?n.setAttribute(o,""):Yr(n,o,c)}}}function mn(n,s,o){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Be("error",n),Be("load",n);var c=!1,f=!1,g;for(g in o)if(o.hasOwnProperty(g)){var E=o[g];if(E!=null)switch(g){case"src":c=!0;break;case"srcSet":f=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,s));default:yt(n,s,g,E,o,null)}}f&&yt(n,s,"srcSet",o.srcSet,o,null),c&&yt(n,s,"src",o.src,o,null);return;case"input":Be("invalid",n);var w=g=E=f=null,j=null,Q=null;for(c in o)if(o.hasOwnProperty(c)){var le=o[c];if(le!=null)switch(c){case"name":f=le;break;case"type":E=le;break;case"checked":j=le;break;case"defaultChecked":Q=le;break;case"value":g=le;break;case"defaultValue":w=le;break;case"children":case"dangerouslySetInnerHTML":if(le!=null)throw Error(r(137,s));break;default:yt(n,s,c,le,o,null)}}Xs(n,g,w,j,Q,E,f,!1),so(n);return;case"select":Be("invalid",n),c=E=g=null;for(f in o)if(o.hasOwnProperty(f)&&(w=o[f],w!=null))switch(f){case"value":g=w;break;case"defaultValue":E=w;break;case"multiple":c=w;default:yt(n,s,f,w,o,null)}s=g,o=E,n.multiple=!!c,s!=null?sr(n,!!c,s,!1):o!=null&&sr(n,!!c,o,!0);return;case"textarea":Be("invalid",n),g=f=c=null;for(E in o)if(o.hasOwnProperty(E)&&(w=o[E],w!=null))switch(E){case"value":c=w;break;case"defaultValue":f=w;break;case"children":g=w;break;case"dangerouslySetInnerHTML":if(w!=null)throw Error(r(91));break;default:yt(n,s,E,w,o,null)}Ws(n,c,f,g),so(n);return;case"option":for(j in o)if(o.hasOwnProperty(j)&&(c=o[j],c!=null))switch(j){case"selected":n.selected=c&&typeof c!="function"&&typeof c!="symbol";break;default:yt(n,s,j,c,o,null)}return;case"dialog":Be("beforetoggle",n),Be("toggle",n),Be("cancel",n),Be("close",n);break;case"iframe":case"object":Be("load",n);break;case"video":case"audio":for(c=0;c<Rc.length;c++)Be(Rc[c],n);break;case"image":Be("error",n),Be("load",n);break;case"details":Be("toggle",n);break;case"embed":case"source":case"link":Be("error",n),Be("load",n);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Q in o)if(o.hasOwnProperty(Q)&&(c=o[Q],c!=null))switch(Q){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,s));default:yt(n,s,Q,c,o,null)}return;default:if(ql(s)){for(le in o)o.hasOwnProperty(le)&&(c=o[le],c!==void 0&&Cp(n,s,le,c,o,void 0));return}}for(w in o)o.hasOwnProperty(w)&&(c=o[w],c!=null&&yt(n,s,w,c,o,null))}function US(n,s,o,c){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var f=null,g=null,E=null,w=null,j=null,Q=null,le=null;for(J in o){var he=o[J];if(o.hasOwnProperty(J)&&he!=null)switch(J){case"checked":break;case"value":break;case"defaultValue":j=he;default:c.hasOwnProperty(J)||yt(n,s,J,null,c,he)}}for(var W in c){var J=c[W];if(he=o[W],c.hasOwnProperty(W)&&(J!=null||he!=null))switch(W){case"type":g=J;break;case"name":f=J;break;case"checked":Q=J;break;case"defaultChecked":le=J;break;case"value":E=J;break;case"defaultValue":w=J;break;case"children":case"dangerouslySetInnerHTML":if(J!=null)throw Error(r(137,s));break;default:J!==he&&yt(n,s,W,J,c,he)}}zn(n,E,w,j,Q,le,g,f);return;case"select":J=E=w=W=null;for(g in o)if(j=o[g],o.hasOwnProperty(g)&&j!=null)switch(g){case"value":break;case"multiple":J=j;default:c.hasOwnProperty(g)||yt(n,s,g,null,c,j)}for(f in c)if(g=c[f],j=o[f],c.hasOwnProperty(f)&&(g!=null||j!=null))switch(f){case"value":W=g;break;case"defaultValue":w=g;break;case"multiple":E=g;default:g!==j&&yt(n,s,f,g,c,j)}s=w,o=E,c=J,W!=null?sr(n,!!o,W,!1):!!c!=!!o&&(s!=null?sr(n,!!o,s,!0):sr(n,!!o,o?[]:"",!1));return;case"textarea":J=W=null;for(w in o)if(f=o[w],o.hasOwnProperty(w)&&f!=null&&!c.hasOwnProperty(w))switch(w){case"value":break;case"children":break;default:yt(n,s,w,null,c,f)}for(E in c)if(f=c[E],g=o[E],c.hasOwnProperty(E)&&(f!=null||g!=null))switch(E){case"value":W=f;break;case"defaultValue":J=f;break;case"children":break;case"dangerouslySetInnerHTML":if(f!=null)throw Error(r(91));break;default:f!==g&&yt(n,s,E,f,c,g)}pt(n,W,J);return;case"option":for(var Pe in o)if(W=o[Pe],o.hasOwnProperty(Pe)&&W!=null&&!c.hasOwnProperty(Pe))switch(Pe){case"selected":n.selected=!1;break;default:yt(n,s,Pe,null,c,W)}for(j in c)if(W=c[j],J=o[j],c.hasOwnProperty(j)&&W!==J&&(W!=null||J!=null))switch(j){case"selected":n.selected=W&&typeof W!="function"&&typeof W!="symbol";break;default:yt(n,s,j,W,c,J)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ae in o)W=o[Ae],o.hasOwnProperty(Ae)&&W!=null&&!c.hasOwnProperty(Ae)&&yt(n,s,Ae,null,c,W);for(Q in c)if(W=c[Q],J=o[Q],c.hasOwnProperty(Q)&&W!==J&&(W!=null||J!=null))switch(Q){case"children":case"dangerouslySetInnerHTML":if(W!=null)throw Error(r(137,s));break;default:yt(n,s,Q,W,c,J)}return;default:if(ql(s)){for(var vt in o)W=o[vt],o.hasOwnProperty(vt)&&W!==void 0&&!c.hasOwnProperty(vt)&&Cp(n,s,vt,void 0,c,W);for(le in c)W=c[le],J=o[le],!c.hasOwnProperty(le)||W===J||W===void 0&&J===void 0||Cp(n,s,le,W,c,J);return}}for(var H in o)W=o[H],o.hasOwnProperty(H)&&W!=null&&!c.hasOwnProperty(H)&&yt(n,s,H,null,c,W);for(he in c)W=c[he],J=o[he],!c.hasOwnProperty(he)||W===J||W==null&&J==null||yt(n,s,he,W,c,J)}var Pp=null,Dp=null;function nd(n){return n.nodeType===9?n:n.ownerDocument}function hb(n){switch(n){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function db(n,s){if(n===0)switch(s){case"svg":return 1;case"math":return 2;default:return 0}return n===1&&s==="foreignObject"?0:n}function Vp(n,s){return n==="textarea"||n==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.children=="bigint"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var Op=null;function zS(){var n=window.event;return n&&n.type==="popstate"?n===Op?!1:(Op=n,!0):(Op=null,!1)}var fb=typeof setTimeout=="function"?setTimeout:void 0,qS=typeof clearTimeout=="function"?clearTimeout:void 0,mb=typeof Promise=="function"?Promise:void 0,BS=typeof queueMicrotask=="function"?queueMicrotask:typeof mb<"u"?function(n){return mb.resolve(null).then(n).catch(HS)}:fb;function HS(n){setTimeout(function(){throw n})}function hs(n){return n==="head"}function pb(n,s){var o=s,c=0,f=0;do{var g=o.nextSibling;if(n.removeChild(o),g&&g.nodeType===8)if(o=g.data,o==="/$"){if(0<c&&8>c){o=c;var E=n.ownerDocument;if(o&1&&Ac(E.documentElement),o&2&&Ac(E.body),o&4)for(o=E.head,Ac(o),E=o.firstChild;E;){var w=E.nextSibling,j=E.nodeName;E[Ks]||j==="SCRIPT"||j==="STYLE"||j==="LINK"&&E.rel.toLowerCase()==="stylesheet"||o.removeChild(E),E=w}}if(f===0){n.removeChild(g),Mc(s);return}f--}else o==="$"||o==="$?"||o==="$!"?f++:c=o.charCodeAt(0)-48;else c=0;o=g}while(o);Mc(s)}function Mp(n){var s=n.firstChild;for(s&&s.nodeType===10&&(s=s.nextSibling);s;){var o=s;switch(s=s.nextSibling,o.nodeName){case"HTML":case"HEAD":case"BODY":Mp(o),Kr(o);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(o.rel.toLowerCase()==="stylesheet")continue}n.removeChild(o)}}function GS(n,s,o,c){for(;n.nodeType===1;){var f=o;if(n.nodeName.toLowerCase()!==s.toLowerCase()){if(!c&&(n.nodeName!=="INPUT"||n.type!=="hidden"))break}else if(c){if(!n[Ks])switch(s){case"meta":if(!n.hasAttribute("itemprop"))break;return n;case"link":if(g=n.getAttribute("rel"),g==="stylesheet"&&n.hasAttribute("data-precedence"))break;if(g!==f.rel||n.getAttribute("href")!==(f.href==null||f.href===""?null:f.href)||n.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin)||n.getAttribute("title")!==(f.title==null?null:f.title))break;return n;case"style":if(n.hasAttribute("data-precedence"))break;return n;case"script":if(g=n.getAttribute("src"),(g!==(f.src==null?null:f.src)||n.getAttribute("type")!==(f.type==null?null:f.type)||n.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin))&&g&&n.hasAttribute("async")&&!n.hasAttribute("itemprop"))break;return n;default:return n}}else if(s==="input"&&n.type==="hidden"){var g=f.name==null?null:""+f.name;if(f.type==="hidden"&&n.getAttribute("name")===g)return n}else return n;if(n=Ti(n.nextSibling),n===null)break}return null}function KS(n,s,o){if(s==="")return null;for(;n.nodeType!==3;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!o||(n=Ti(n.nextSibling),n===null))return null;return n}function jp(n){return n.data==="$!"||n.data==="$?"&&n.ownerDocument.readyState==="complete"}function YS(n,s){var o=n.ownerDocument;if(n.data!=="$?"||o.readyState==="complete")s();else{var c=function(){s(),o.removeEventListener("DOMContentLoaded",c)};o.addEventListener("DOMContentLoaded",c),n._reactRetry=c}}function Ti(n){for(;n!=null;n=n.nextSibling){var s=n.nodeType;if(s===1||s===3)break;if(s===8){if(s=n.data,s==="$"||s==="$!"||s==="$?"||s==="F!"||s==="F")break;if(s==="/$")return null}}return n}var kp=null;function gb(n){n=n.previousSibling;for(var s=0;n;){if(n.nodeType===8){var o=n.data;if(o==="$"||o==="$!"||o==="$?"){if(s===0)return n;s--}else o==="/$"&&s++}n=n.previousSibling}return null}function yb(n,s,o){switch(s=nd(o),n){case"html":if(n=s.documentElement,!n)throw Error(r(452));return n;case"head":if(n=s.head,!n)throw Error(r(453));return n;case"body":if(n=s.body,!n)throw Error(r(454));return n;default:throw Error(r(451))}}function Ac(n){for(var s=n.attributes;s.length;)n.removeAttributeNode(s[0]);Kr(n)}var mi=new Map,vb=new Set;function id(n){return typeof n.getRootNode=="function"?n.getRootNode():n.nodeType===9?n:n.ownerDocument}var wr=X.d;X.d={f:$S,r:QS,D:XS,C:WS,L:JS,m:ZS,X:tA,S:eA,M:nA};function $S(){var n=wr.f(),s=$h();return n||s}function QS(n){var s=Ii(n);s!==null&&s.tag===5&&s.type==="form"?L0(s):wr.r(n)}var zo=typeof document>"u"?null:document;function _b(n,s,o){var c=zo;if(c&&typeof s=="string"&&s){var f=Ut(s);f='link[rel="'+n+'"][href="'+f+'"]',typeof o=="string"&&(f+='[crossorigin="'+o+'"]'),vb.has(f)||(vb.add(f),n={rel:n,crossOrigin:o,href:s},c.querySelector(f)===null&&(s=c.createElement("link"),mn(s,"link",n),Ot(s),c.head.appendChild(s)))}}function XS(n){wr.D(n),_b("dns-prefetch",n,null)}function WS(n,s){wr.C(n,s),_b("preconnect",n,s)}function JS(n,s,o){wr.L(n,s,o);var c=zo;if(c&&n&&s){var f='link[rel="preload"][as="'+Ut(s)+'"]';s==="image"&&o&&o.imageSrcSet?(f+='[imagesrcset="'+Ut(o.imageSrcSet)+'"]',typeof o.imageSizes=="string"&&(f+='[imagesizes="'+Ut(o.imageSizes)+'"]')):f+='[href="'+Ut(n)+'"]';var g=f;switch(s){case"style":g=qo(n);break;case"script":g=Bo(n)}mi.has(g)||(n=_({rel:"preload",href:s==="image"&&o&&o.imageSrcSet?void 0:n,as:s},o),mi.set(g,n),c.querySelector(f)!==null||s==="style"&&c.querySelector(Ic(g))||s==="script"&&c.querySelector(Nc(g))||(s=c.createElement("link"),mn(s,"link",n),Ot(s),c.head.appendChild(s)))}}function ZS(n,s){wr.m(n,s);var o=zo;if(o&&n){var c=s&&typeof s.as=="string"?s.as:"script",f='link[rel="modulepreload"][as="'+Ut(c)+'"][href="'+Ut(n)+'"]',g=f;switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":g=Bo(n)}if(!mi.has(g)&&(n=_({rel:"modulepreload",href:n},s),mi.set(g,n),o.querySelector(f)===null)){switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(o.querySelector(Nc(g)))return}c=o.createElement("link"),mn(c,"link",n),Ot(c),o.head.appendChild(c)}}}function eA(n,s,o){wr.S(n,s,o);var c=zo;if(c&&n){var f=Rn(c).hoistableStyles,g=qo(n);s=s||"default";var E=f.get(g);if(!E){var w={loading:0,preload:null};if(E=c.querySelector(Ic(g)))w.loading=5;else{n=_({rel:"stylesheet",href:n,"data-precedence":s},o),(o=mi.get(g))&&Lp(n,o);var j=E=c.createElement("link");Ot(j),mn(j,"link",n),j._p=new Promise(function(Q,le){j.onload=Q,j.onerror=le}),j.addEventListener("load",function(){w.loading|=1}),j.addEventListener("error",function(){w.loading|=2}),w.loading|=4,rd(E,s,c)}E={type:"stylesheet",instance:E,count:1,state:w},f.set(g,E)}}}function tA(n,s){wr.X(n,s);var o=zo;if(o&&n){var c=Rn(o).hoistableScripts,f=Bo(n),g=c.get(f);g||(g=o.querySelector(Nc(f)),g||(n=_({src:n,async:!0},s),(s=mi.get(f))&&Fp(n,s),g=o.createElement("script"),Ot(g),mn(g,"link",n),o.head.appendChild(g)),g={type:"script",instance:g,count:1,state:null},c.set(f,g))}}function nA(n,s){wr.M(n,s);var o=zo;if(o&&n){var c=Rn(o).hoistableScripts,f=Bo(n),g=c.get(f);g||(g=o.querySelector(Nc(f)),g||(n=_({src:n,async:!0,type:"module"},s),(s=mi.get(f))&&Fp(n,s),g=o.createElement("script"),Ot(g),mn(g,"link",n),o.head.appendChild(g)),g={type:"script",instance:g,count:1,state:null},c.set(f,g))}}function bb(n,s,o,c){var f=(f=be.current)?id(f):null;if(!f)throw Error(r(446));switch(n){case"meta":case"title":return null;case"style":return typeof o.precedence=="string"&&typeof o.href=="string"?(s=qo(o.href),o=Rn(f).hoistableStyles,c=o.get(s),c||(c={type:"style",instance:null,count:0,state:null},o.set(s,c)),c):{type:"void",instance:null,count:0,state:null};case"link":if(o.rel==="stylesheet"&&typeof o.href=="string"&&typeof o.precedence=="string"){n=qo(o.href);var g=Rn(f).hoistableStyles,E=g.get(n);if(E||(f=f.ownerDocument||f,E={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},g.set(n,E),(g=f.querySelector(Ic(n)))&&!g._p&&(E.instance=g,E.state.loading=5),mi.has(n)||(o={rel:"preload",as:"style",href:o.href,crossOrigin:o.crossOrigin,integrity:o.integrity,media:o.media,hrefLang:o.hrefLang,referrerPolicy:o.referrerPolicy},mi.set(n,o),g||iA(f,n,o,E.state))),s&&c===null)throw Error(r(528,""));return E}if(s&&c!==null)throw Error(r(529,""));return null;case"script":return s=o.async,o=o.src,typeof o=="string"&&s&&typeof s!="function"&&typeof s!="symbol"?(s=Bo(o),o=Rn(f).hoistableScripts,c=o.get(s),c||(c={type:"script",instance:null,count:0,state:null},o.set(s,c)),c):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,n))}}function qo(n){return'href="'+Ut(n)+'"'}function Ic(n){return'link[rel="stylesheet"]['+n+"]"}function xb(n){return _({},n,{"data-precedence":n.precedence,precedence:null})}function iA(n,s,o,c){n.querySelector('link[rel="preload"][as="style"]['+s+"]")?c.loading=1:(s=n.createElement("link"),c.preload=s,s.addEventListener("load",function(){return c.loading|=1}),s.addEventListener("error",function(){return c.loading|=2}),mn(s,"link",o),Ot(s),n.head.appendChild(s))}function Bo(n){return'[src="'+Ut(n)+'"]'}function Nc(n){return"script[async]"+n}function Eb(n,s,o){if(s.count++,s.instance===null)switch(s.type){case"style":var c=n.querySelector('style[data-href~="'+Ut(o.href)+'"]');if(c)return s.instance=c,Ot(c),c;var f=_({},o,{"data-href":o.href,"data-precedence":o.precedence,href:null,precedence:null});return c=(n.ownerDocument||n).createElement("style"),Ot(c),mn(c,"style",f),rd(c,o.precedence,n),s.instance=c;case"stylesheet":f=qo(o.href);var g=n.querySelector(Ic(f));if(g)return s.state.loading|=4,s.instance=g,Ot(g),g;c=xb(o),(f=mi.get(f))&&Lp(c,f),g=(n.ownerDocument||n).createElement("link"),Ot(g);var E=g;return E._p=new Promise(function(w,j){E.onload=w,E.onerror=j}),mn(g,"link",c),s.state.loading|=4,rd(g,o.precedence,n),s.instance=g;case"script":return g=Bo(o.src),(f=n.querySelector(Nc(g)))?(s.instance=f,Ot(f),f):(c=o,(f=mi.get(g))&&(c=_({},o),Fp(c,f)),n=n.ownerDocument||n,f=n.createElement("script"),Ot(f),mn(f,"link",c),n.head.appendChild(f),s.instance=f);case"void":return null;default:throw Error(r(443,s.type))}else s.type==="stylesheet"&&(s.state.loading&4)===0&&(c=s.instance,s.state.loading|=4,rd(c,o.precedence,n));return s.instance}function rd(n,s,o){for(var c=o.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),f=c.length?c[c.length-1]:null,g=f,E=0;E<c.length;E++){var w=c[E];if(w.dataset.precedence===s)g=w;else if(g!==f)break}g?g.parentNode.insertBefore(n,g.nextSibling):(s=o.nodeType===9?o.head:o,s.insertBefore(n,s.firstChild))}function Lp(n,s){n.crossOrigin==null&&(n.crossOrigin=s.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=s.referrerPolicy),n.title==null&&(n.title=s.title)}function Fp(n,s){n.crossOrigin==null&&(n.crossOrigin=s.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=s.referrerPolicy),n.integrity==null&&(n.integrity=s.integrity)}var sd=null;function Tb(n,s,o){if(sd===null){var c=new Map,f=sd=new Map;f.set(o,c)}else f=sd,c=f.get(o),c||(c=new Map,f.set(o,c));if(c.has(n))return c;for(c.set(n,null),o=o.getElementsByTagName(n),f=0;f<o.length;f++){var g=o[f];if(!(g[Ks]||g[Qt]||n==="link"&&g.getAttribute("rel")==="stylesheet")&&g.namespaceURI!=="http://www.w3.org/2000/svg"){var E=g.getAttribute(s)||"";E=n+E;var w=c.get(E);w?w.push(g):c.set(E,[g])}}return c}function wb(n,s,o){n=n.ownerDocument||n,n.head.insertBefore(o,s==="title"?n.querySelector("head > title"):null)}function rA(n,s,o){if(o===1||s.itemProp!=null)return!1;switch(n){case"meta":case"title":return!0;case"style":if(typeof s.precedence!="string"||typeof s.href!="string"||s.href==="")break;return!0;case"link":if(typeof s.rel!="string"||typeof s.href!="string"||s.href===""||s.onLoad||s.onError)break;switch(s.rel){case"stylesheet":return n=s.disabled,typeof s.precedence=="string"&&n==null;default:return!0}case"script":if(s.async&&typeof s.async!="function"&&typeof s.async!="symbol"&&!s.onLoad&&!s.onError&&s.src&&typeof s.src=="string")return!0}return!1}function Rb(n){return!(n.type==="stylesheet"&&(n.state.loading&3)===0)}var Cc=null;function sA(){}function aA(n,s,o){if(Cc===null)throw Error(r(475));var c=Cc;if(s.type==="stylesheet"&&(typeof o.media!="string"||matchMedia(o.media).matches!==!1)&&(s.state.loading&4)===0){if(s.instance===null){var f=qo(o.href),g=n.querySelector(Ic(f));if(g){n=g._p,n!==null&&typeof n=="object"&&typeof n.then=="function"&&(c.count++,c=ad.bind(c),n.then(c,c)),s.state.loading|=4,s.instance=g,Ot(g);return}g=n.ownerDocument||n,o=xb(o),(f=mi.get(f))&&Lp(o,f),g=g.createElement("link"),Ot(g);var E=g;E._p=new Promise(function(w,j){E.onload=w,E.onerror=j}),mn(g,"link",o),s.instance=g}c.stylesheets===null&&(c.stylesheets=new Map),c.stylesheets.set(s,n),(n=s.state.preload)&&(s.state.loading&3)===0&&(c.count++,s=ad.bind(c),n.addEventListener("load",s),n.addEventListener("error",s))}}function oA(){if(Cc===null)throw Error(r(475));var n=Cc;return n.stylesheets&&n.count===0&&Up(n,n.stylesheets),0<n.count?function(s){var o=setTimeout(function(){if(n.stylesheets&&Up(n,n.stylesheets),n.unsuspend){var c=n.unsuspend;n.unsuspend=null,c()}},6e4);return n.unsuspend=s,function(){n.unsuspend=null,clearTimeout(o)}}:null}function ad(){if(this.count--,this.count===0){if(this.stylesheets)Up(this,this.stylesheets);else if(this.unsuspend){var n=this.unsuspend;this.unsuspend=null,n()}}}var od=null;function Up(n,s){n.stylesheets=null,n.unsuspend!==null&&(n.count++,od=new Map,s.forEach(lA,n),od=null,ad.call(n))}function lA(n,s){if(!(s.state.loading&4)){var o=od.get(n);if(o)var c=o.get(null);else{o=new Map,od.set(n,o);for(var f=n.querySelectorAll("link[data-precedence],style[data-precedence]"),g=0;g<f.length;g++){var E=f[g];(E.nodeName==="LINK"||E.getAttribute("media")!=="not all")&&(o.set(E.dataset.precedence,E),c=E)}c&&o.set(null,c)}f=s.instance,E=f.getAttribute("data-precedence"),g=o.get(E)||c,g===c&&o.set(null,f),o.set(E,f),this.count++,c=ad.bind(this),f.addEventListener("load",c),f.addEventListener("error",c),g?g.parentNode.insertBefore(f,g.nextSibling):(n=n.nodeType===9?n.head:n,n.insertBefore(f,n.firstChild)),s.state.loading|=4}}var Pc={$$typeof:G,Provider:null,Consumer:null,_currentValue:ae,_currentValue2:ae,_threadCount:0};function cA(n,s,o,c,f,g,E,w){this.tag=1,this.containerInfo=n,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=er(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=er(0),this.hiddenUpdates=er(null),this.identifierPrefix=c,this.onUncaughtError=f,this.onCaughtError=g,this.onRecoverableError=E,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=w,this.incompleteTransitions=new Map}function Sb(n,s,o,c,f,g,E,w,j,Q,le,he){return n=new cA(n,s,o,E,w,j,Q,he),s=1,g===!0&&(s|=24),g=Bn(3,null,null,s),n.current=g,g.stateNode=n,s=xm(),s.refCount++,n.pooledCache=s,s.refCount++,g.memoizedState={element:c,isDehydrated:o,cache:s},Rm(g),n}function Ab(n){return n?(n=bo,n):bo}function Ib(n,s,o,c,f,g){f=Ab(f),c.context===null?c.context=f:c.pendingContext=f,c=Jr(s),c.payload={element:o},g=g===void 0?null:g,g!==null&&(c.callback=g),o=Zr(n,c,s),o!==null&&($n(o,n,s),oc(o,n,s))}function Nb(n,s){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var o=n.retryLane;n.retryLane=o!==0&&o<s?o:s}}function zp(n,s){Nb(n,s),(n=n.alternate)&&Nb(n,s)}function Cb(n){if(n.tag===13){var s=_o(n,67108864);s!==null&&$n(s,n,67108864),zp(n,67108864)}}var ld=!0;function uA(n,s,o,c){var f=z.T;z.T=null;var g=X.p;try{X.p=2,qp(n,s,o,c)}finally{X.p=g,z.T=f}}function hA(n,s,o,c){var f=z.T;z.T=null;var g=X.p;try{X.p=8,qp(n,s,o,c)}finally{X.p=g,z.T=f}}function qp(n,s,o,c){if(ld){var f=Bp(c);if(f===null)Np(n,s,c,cd,o),Db(n,c);else if(fA(f,n,s,o,c))c.stopPropagation();else if(Db(n,c),s&4&&-1<dA.indexOf(n)){for(;f!==null;){var g=Ii(f);if(g!==null)switch(g.tag){case 3:if(g=g.stateNode,g.current.memoizedState.isDehydrated){var E=Un(g.pendingLanes);if(E!==0){var w=g;for(w.pendingLanes|=2,w.entangledLanes|=2;E;){var j=1<<31-$t(E);w.entanglements[1]|=j,E&=~j}qi(g),(lt&6)===0&&(Kh=Et()+500,wc(0))}}break;case 13:w=_o(g,2),w!==null&&$n(w,g,2),$h(),zp(g,2)}if(g=Bp(c),g===null&&Np(n,s,c,cd,o),g===f)break;f=g}f!==null&&c.stopPropagation()}else Np(n,s,c,null,o)}}function Bp(n){return n=si(n),Hp(n)}var cd=null;function Hp(n){if(cd=null,n=nr(n),n!==null){var s=l(n);if(s===null)n=null;else{var o=s.tag;if(o===13){if(n=u(s),n!==null)return n;n=null}else if(o===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;n=null}else s!==n&&(n=null)}}return cd=n,null}function Pb(n){switch(n){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Vn()){case On:return 2;case Xe:return 8;case ke:case tt:return 32;case Qe:return 268435456;default:return 32}default:return 32}}var Gp=!1,ds=null,fs=null,ms=null,Dc=new Map,Vc=new Map,ps=[],dA="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Db(n,s){switch(n){case"focusin":case"focusout":ds=null;break;case"dragenter":case"dragleave":fs=null;break;case"mouseover":case"mouseout":ms=null;break;case"pointerover":case"pointerout":Dc.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":Vc.delete(s.pointerId)}}function Oc(n,s,o,c,f,g){return n===null||n.nativeEvent!==g?(n={blockedOn:s,domEventName:o,eventSystemFlags:c,nativeEvent:g,targetContainers:[f]},s!==null&&(s=Ii(s),s!==null&&Cb(s)),n):(n.eventSystemFlags|=c,s=n.targetContainers,f!==null&&s.indexOf(f)===-1&&s.push(f),n)}function fA(n,s,o,c,f){switch(s){case"focusin":return ds=Oc(ds,n,s,o,c,f),!0;case"dragenter":return fs=Oc(fs,n,s,o,c,f),!0;case"mouseover":return ms=Oc(ms,n,s,o,c,f),!0;case"pointerover":var g=f.pointerId;return Dc.set(g,Oc(Dc.get(g)||null,n,s,o,c,f)),!0;case"gotpointercapture":return g=f.pointerId,Vc.set(g,Oc(Vc.get(g)||null,n,s,o,c,f)),!0}return!1}function Vb(n){var s=nr(n.target);if(s!==null){var o=l(s);if(o!==null){if(s=o.tag,s===13){if(s=u(o),s!==null){n.blockedOn=s,$u(n.priority,function(){if(o.tag===13){var c=Yn();c=Br(c);var f=_o(o,c);f!==null&&$n(f,o,c),zp(o,c)}});return}}else if(s===3&&o.stateNode.current.memoizedState.isDehydrated){n.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}n.blockedOn=null}function ud(n){if(n.blockedOn!==null)return!1;for(var s=n.targetContainers;0<s.length;){var o=Bp(n.nativeEvent);if(o===null){o=n.nativeEvent;var c=new o.constructor(o.type,o);ar=c,o.target.dispatchEvent(c),ar=null}else return s=Ii(o),s!==null&&Cb(s),n.blockedOn=o,!1;s.shift()}return!0}function Ob(n,s,o){ud(n)&&o.delete(s)}function mA(){Gp=!1,ds!==null&&ud(ds)&&(ds=null),fs!==null&&ud(fs)&&(fs=null),ms!==null&&ud(ms)&&(ms=null),Dc.forEach(Ob),Vc.forEach(Ob)}function hd(n,s){n.blockedOn===s&&(n.blockedOn=null,Gp||(Gp=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,mA)))}var dd=null;function Mb(n){dd!==n&&(dd=n,i.unstable_scheduleCallback(i.unstable_NormalPriority,function(){dd===n&&(dd=null);for(var s=0;s<n.length;s+=3){var o=n[s],c=n[s+1],f=n[s+2];if(typeof c!="function"){if(Hp(c||o)===null)continue;break}var g=Ii(o);g!==null&&(n.splice(s,3),s-=3,Hm(g,{pending:!0,data:f,method:o.method,action:c},c,f))}}))}function Mc(n){function s(j){return hd(j,n)}ds!==null&&hd(ds,n),fs!==null&&hd(fs,n),ms!==null&&hd(ms,n),Dc.forEach(s),Vc.forEach(s);for(var o=0;o<ps.length;o++){var c=ps[o];c.blockedOn===n&&(c.blockedOn=null)}for(;0<ps.length&&(o=ps[0],o.blockedOn===null);)Vb(o),o.blockedOn===null&&ps.shift();if(o=(n.ownerDocument||n).$$reactFormReplay,o!=null)for(c=0;c<o.length;c+=3){var f=o[c],g=o[c+1],E=f[Ft]||null;if(typeof g=="function")E||Mb(o);else if(E){var w=null;if(g&&g.hasAttribute("formAction")){if(f=g,E=g[Ft]||null)w=E.formAction;else if(Hp(f)!==null)continue}else w=E.action;typeof w=="function"?o[c+1]=w:(o.splice(c,3),c-=3),Mb(o)}}}function Kp(n){this._internalRoot=n}fd.prototype.render=Kp.prototype.render=function(n){var s=this._internalRoot;if(s===null)throw Error(r(409));var o=s.current,c=Yn();Ib(o,c,n,s,null,null)},fd.prototype.unmount=Kp.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var s=n.containerInfo;Ib(n.current,2,null,n,null,null),$h(),s[ii]=null}};function fd(n){this._internalRoot=n}fd.prototype.unstable_scheduleHydration=function(n){if(n){var s=Hr();n={blockedOn:null,target:n,priority:s};for(var o=0;o<ps.length&&s!==0&&s<ps[o].priority;o++);ps.splice(o,0,n),o===0&&Vb(n)}};var jb=e.version;if(jb!=="19.1.1")throw Error(r(527,jb,"19.1.1"));X.findDOMNode=function(n){var s=n._reactInternals;if(s===void 0)throw typeof n.render=="function"?Error(r(188)):(n=Object.keys(n).join(","),Error(r(268,n)));return n=m(s),n=n!==null?y(n):null,n=n===null?null:n.stateNode,n};var pA={bundleType:0,version:"19.1.1",rendererPackageName:"react-dom",currentDispatcherRef:z,reconcilerVersion:"19.1.1"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var md=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!md.isDisabled&&md.supportsFiber)try{mt=md.inject(pA),rt=md}catch{}}return kc.createRoot=function(n,s){if(!a(n))throw Error(r(299));var o=!1,c="",f=J0,g=Z0,E=e_,w=null;return s!=null&&(s.unstable_strictMode===!0&&(o=!0),s.identifierPrefix!==void 0&&(c=s.identifierPrefix),s.onUncaughtError!==void 0&&(f=s.onUncaughtError),s.onCaughtError!==void 0&&(g=s.onCaughtError),s.onRecoverableError!==void 0&&(E=s.onRecoverableError),s.unstable_transitionCallbacks!==void 0&&(w=s.unstable_transitionCallbacks)),s=Sb(n,1,!1,null,null,o,c,f,g,E,w,null),n[ii]=s.current,Ip(n),new Kp(s)},kc.hydrateRoot=function(n,s,o){if(!a(n))throw Error(r(299));var c=!1,f="",g=J0,E=Z0,w=e_,j=null,Q=null;return o!=null&&(o.unstable_strictMode===!0&&(c=!0),o.identifierPrefix!==void 0&&(f=o.identifierPrefix),o.onUncaughtError!==void 0&&(g=o.onUncaughtError),o.onCaughtError!==void 0&&(E=o.onCaughtError),o.onRecoverableError!==void 0&&(w=o.onRecoverableError),o.unstable_transitionCallbacks!==void 0&&(j=o.unstable_transitionCallbacks),o.formState!==void 0&&(Q=o.formState)),s=Sb(n,1,!0,s,o??null,c,f,g,E,w,j,Q),s.context=Ab(null),o=s.current,c=Yn(),c=Br(c),f=Jr(c),f.callback=null,Zr(o,f,c),o=c,s.current.lanes=o,tr(s,o),qi(s),n[ii]=s.current,Ip(n),new fd(s)},kc.version="19.1.1",kc}var Kb;function IA(){if(Kb)return Qp.exports;Kb=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(e){console.error(e)}}return i(),Qp.exports=AA(),Qp.exports}var NA=IA();lT();/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function lu(){return lu=Object.assign?Object.assign.bind():function(i){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(i[r]=t[r])}return i},lu.apply(this,arguments)}var Rs;(function(i){i.Pop="POP",i.Push="PUSH",i.Replace="REPLACE"})(Rs||(Rs={}));const Yb="popstate";function CA(i){i===void 0&&(i={});function e(a,l){let{pathname:u="/",search:h="",hash:m=""}=Qa(a.location.hash.substr(1));return!u.startsWith("/")&&!u.startsWith(".")&&(u="/"+u),bg("",{pathname:u,search:h,hash:m},l.state&&l.state.usr||null,l.state&&l.state.key||"default")}function t(a,l){let u=a.document.querySelector("base"),h="";if(u&&u.getAttribute("href")){let m=a.location.href,y=m.indexOf("#");h=y===-1?m:m.slice(0,y)}return h+"#"+(typeof l=="string"?l:qd(l))}function r(a,l){oy(a.pathname.charAt(0)==="/","relative pathnames are not supported in hash history.push("+JSON.stringify(l)+")")}return DA(e,t,r,i)}function Lt(i,e){if(i===!1||i===null||typeof i>"u")throw new Error(e)}function oy(i,e){if(!i){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function PA(){return Math.random().toString(36).substr(2,8)}function $b(i,e){return{usr:i.state,key:i.key,idx:e}}function bg(i,e,t,r){return t===void 0&&(t=null),lu({pathname:typeof i=="string"?i:i.pathname,search:"",hash:""},typeof e=="string"?Qa(e):e,{state:t,key:e&&e.key||r||PA()})}function qd(i){let{pathname:e="/",search:t="",hash:r=""}=i;return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function Qa(i){let e={};if(i){let t=i.indexOf("#");t>=0&&(e.hash=i.substr(t),i=i.substr(0,t));let r=i.indexOf("?");r>=0&&(e.search=i.substr(r),i=i.substr(0,r)),i&&(e.pathname=i)}return e}function DA(i,e,t,r){r===void 0&&(r={});let{window:a=document.defaultView,v5Compat:l=!1}=r,u=a.history,h=Rs.Pop,m=null,y=_();y==null&&(y=0,u.replaceState(lu({},u.state,{idx:y}),""));function _(){return(u.state||{idx:null}).idx}function b(){h=Rs.Pop;let O=_(),Z=O==null?null:O-y;y=O,m&&m({action:h,location:L.location,delta:Z})}function T(O,Z){h=Rs.Push;let se=bg(L.location,O,Z);t&&t(se,O),y=_()+1;let G=$b(se,y),ne=L.createHref(se);try{u.pushState(G,"",ne)}catch(B){if(B instanceof DOMException&&B.name==="DataCloneError")throw B;a.location.assign(ne)}l&&m&&m({action:h,location:L.location,delta:1})}function I(O,Z){h=Rs.Replace;let se=bg(L.location,O,Z);t&&t(se,O),y=_();let G=$b(se,y),ne=L.createHref(se);u.replaceState(G,"",ne),l&&m&&m({action:h,location:L.location,delta:0})}function V(O){let Z=a.location.origin!=="null"?a.location.origin:a.location.href,se=typeof O=="string"?O:qd(O);return se=se.replace(/ $/,"%20"),Lt(Z,"No window.location.(origin|href) available to create URL for href: "+se),new URL(se,Z)}let L={get action(){return h},get location(){return i(a,u)},listen(O){if(m)throw new Error("A history only accepts one active listener");return a.addEventListener(Yb,b),m=O,()=>{a.removeEventListener(Yb,b),m=null}},createHref(O){return e(a,O)},createURL:V,encodeLocation(O){let Z=V(O);return{pathname:Z.pathname,search:Z.search,hash:Z.hash}},push:T,replace:I,go(O){return u.go(O)}};return L}var Qb;(function(i){i.data="data",i.deferred="deferred",i.redirect="redirect",i.error="error"})(Qb||(Qb={}));function VA(i,e,t){return t===void 0&&(t="/"),OA(i,e,t)}function OA(i,e,t,r){let a=typeof e=="string"?Qa(e):e,l=ly(a.pathname||"/",t);if(l==null)return null;let u=cT(i);MA(u);let h=null;for(let m=0;h==null&&m<u.length;++m){let y=YA(l);h=HA(u[m],y)}return h}function cT(i,e,t,r){e===void 0&&(e=[]),t===void 0&&(t=[]),r===void 0&&(r="");let a=(l,u,h)=>{let m={relativePath:h===void 0?l.path||"":h,caseSensitive:l.caseSensitive===!0,childrenIndex:u,route:l};m.relativePath.startsWith("/")&&(Lt(m.relativePath.startsWith(r),'Absolute route path "'+m.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),m.relativePath=m.relativePath.slice(r.length));let y=Is([r,m.relativePath]),_=t.concat(m);l.children&&l.children.length>0&&(Lt(l.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+y+'".')),cT(l.children,e,_,y)),!(l.path==null&&!l.index)&&e.push({path:y,score:qA(y,l.index),routesMeta:_})};return i.forEach((l,u)=>{var h;if(l.path===""||!((h=l.path)!=null&&h.includes("?")))a(l,u);else for(let m of uT(l.path))a(l,u,m)}),e}function uT(i){let e=i.split("/");if(e.length===0)return[];let[t,...r]=e,a=t.endsWith("?"),l=t.replace(/\?$/,"");if(r.length===0)return a?[l,""]:[l];let u=uT(r.join("/")),h=[];return h.push(...u.map(m=>m===""?l:[l,m].join("/"))),a&&h.push(...u),h.map(m=>i.startsWith("/")&&m===""?"/":m)}function MA(i){i.sort((e,t)=>e.score!==t.score?t.score-e.score:BA(e.routesMeta.map(r=>r.childrenIndex),t.routesMeta.map(r=>r.childrenIndex)))}const jA=/^:[\w-]+$/,kA=3,LA=2,FA=1,UA=10,zA=-2,Xb=i=>i==="*";function qA(i,e){let t=i.split("/"),r=t.length;return t.some(Xb)&&(r+=zA),e&&(r+=LA),t.filter(a=>!Xb(a)).reduce((a,l)=>a+(jA.test(l)?kA:l===""?FA:UA),r)}function BA(i,e){return i.length===e.length&&i.slice(0,-1).every((r,a)=>r===e[a])?i[i.length-1]-e[e.length-1]:0}function HA(i,e,t){let{routesMeta:r}=i,a={},l="/",u=[];for(let h=0;h<r.length;++h){let m=r[h],y=h===r.length-1,_=l==="/"?e:e.slice(l.length)||"/",b=GA({path:m.relativePath,caseSensitive:m.caseSensitive,end:y},_),T=m.route;if(!b)return null;Object.assign(a,b.params),u.push({params:a,pathname:Is([l,b.pathname]),pathnameBase:WA(Is([l,b.pathnameBase])),route:T}),b.pathnameBase!=="/"&&(l=Is([l,b.pathnameBase]))}return u}function GA(i,e){typeof i=="string"&&(i={path:i,caseSensitive:!1,end:!0});let[t,r]=KA(i.path,i.caseSensitive,i.end),a=e.match(t);if(!a)return null;let l=a[0],u=l.replace(/(.)\/+$/,"$1"),h=a.slice(1);return{params:r.reduce((y,_,b)=>{let{paramName:T,isOptional:I}=_;if(T==="*"){let L=h[b]||"";u=l.slice(0,l.length-L.length).replace(/(.)\/+$/,"$1")}const V=h[b];return I&&!V?y[T]=void 0:y[T]=(V||"").replace(/%2F/g,"/"),y},{}),pathname:l,pathnameBase:u,pattern:i}}function KA(i,e,t){e===void 0&&(e=!1),t===void 0&&(t=!0),oy(i==="*"||!i.endsWith("*")||i.endsWith("/*"),'Route path "'+i+'" will be treated as if it were '+('"'+i.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+i.replace(/\*$/,"/*")+'".'));let r=[],a="^"+i.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(u,h,m)=>(r.push({paramName:h,isOptional:m!=null}),m?"/?([^\\/]+)?":"/([^\\/]+)"));return i.endsWith("*")?(r.push({paramName:"*"}),a+=i==="*"||i==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?a+="\\/*$":i!==""&&i!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,e?void 0:"i"),r]}function YA(i){try{return i.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return oy(!1,'The URL path "'+i+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),i}}function ly(i,e){if(e==="/")return i;if(!i.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,r=i.charAt(t);return r&&r!=="/"?null:i.slice(t)||"/"}function $A(i,e){e===void 0&&(e="/");let{pathname:t,search:r="",hash:a=""}=typeof i=="string"?Qa(i):i;return{pathname:t?t.startsWith("/")?t:QA(t,e):e,search:JA(r),hash:ZA(a)}}function QA(i,e){let t=e.replace(/\/+$/,"").split("/");return i.split("/").forEach(a=>{a===".."?t.length>1&&t.pop():a!=="."&&t.push(a)}),t.length>1?t.join("/"):"/"}function Zp(i,e,t,r){return"Cannot include a '"+i+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+t+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function XA(i){return i.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function cy(i,e){let t=XA(i);return e?t.map((r,a)=>a===t.length-1?r.pathname:r.pathnameBase):t.map(r=>r.pathnameBase)}function uy(i,e,t,r){r===void 0&&(r=!1);let a;typeof i=="string"?a=Qa(i):(a=lu({},i),Lt(!a.pathname||!a.pathname.includes("?"),Zp("?","pathname","search",a)),Lt(!a.pathname||!a.pathname.includes("#"),Zp("#","pathname","hash",a)),Lt(!a.search||!a.search.includes("#"),Zp("#","search","hash",a)));let l=i===""||a.pathname==="",u=l?"/":a.pathname,h;if(u==null)h=t;else{let b=e.length-1;if(!r&&u.startsWith("..")){let T=u.split("/");for(;T[0]==="..";)T.shift(),b-=1;a.pathname=T.join("/")}h=b>=0?e[b]:"/"}let m=$A(a,h),y=u&&u!=="/"&&u.endsWith("/"),_=(l||u===".")&&t.endsWith("/");return!m.pathname.endsWith("/")&&(y||_)&&(m.pathname+="/"),m}const Is=i=>i.join("/").replace(/\/\/+/g,"/"),WA=i=>i.replace(/\/+$/,"").replace(/^\/*/,"/"),JA=i=>!i||i==="?"?"":i.startsWith("?")?i:"?"+i,ZA=i=>!i||i==="#"?"":i.startsWith("#")?i:"#"+i;function eI(i){return i!=null&&typeof i.status=="number"&&typeof i.statusText=="string"&&typeof i.internal=="boolean"&&"data"in i}const hT=["post","put","patch","delete"];new Set(hT);const tI=["get",...hT];new Set(tI);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function cu(){return cu=Object.assign?Object.assign.bind():function(i){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(i[r]=t[r])}return i},cu.apply(this,arguments)}const hy=q.createContext(null),nI=q.createContext(null),Us=q.createContext(null),vf=q.createContext(null),zs=q.createContext({outlet:null,matches:[],isDataRoute:!1}),dT=q.createContext(null);function iI(i,e){let{relative:t}=e===void 0?{}:e;El()||Lt(!1);let{basename:r,navigator:a}=q.useContext(Us),{hash:l,pathname:u,search:h}=mT(i,{relative:t}),m=u;return r!=="/"&&(m=u==="/"?r:Is([r,u])),a.createHref({pathname:m,search:h,hash:l})}function El(){return q.useContext(vf)!=null}function Mr(){return El()||Lt(!1),q.useContext(vf).location}function fT(i){q.useContext(Us).static||q.useLayoutEffect(i)}function _f(){let{isDataRoute:i}=q.useContext(zs);return i?gI():rI()}function rI(){El()||Lt(!1);let i=q.useContext(hy),{basename:e,future:t,navigator:r}=q.useContext(Us),{matches:a}=q.useContext(zs),{pathname:l}=Mr(),u=JSON.stringify(cy(a,t.v7_relativeSplatPath)),h=q.useRef(!1);return fT(()=>{h.current=!0}),q.useCallback(function(y,_){if(_===void 0&&(_={}),!h.current)return;if(typeof y=="number"){r.go(y);return}let b=uy(y,JSON.parse(u),l,_.relative==="path");i==null&&e!=="/"&&(b.pathname=b.pathname==="/"?e:Is([e,b.pathname])),(_.replace?r.replace:r.push)(b,_.state,_)},[e,r,u,l,i])}function mT(i,e){let{relative:t}=e===void 0?{}:e,{future:r}=q.useContext(Us),{matches:a}=q.useContext(zs),{pathname:l}=Mr(),u=JSON.stringify(cy(a,r.v7_relativeSplatPath));return q.useMemo(()=>uy(i,JSON.parse(u),l,t==="path"),[i,u,l,t])}function sI(i,e){return aI(i,e)}function aI(i,e,t,r){El()||Lt(!1);let{navigator:a}=q.useContext(Us),{matches:l}=q.useContext(zs),u=l[l.length-1],h=u?u.params:{};u&&u.pathname;let m=u?u.pathnameBase:"/";u&&u.route;let y=Mr(),_;if(e){var b;let O=typeof e=="string"?Qa(e):e;m==="/"||(b=O.pathname)!=null&&b.startsWith(m)||Lt(!1),_=O}else _=y;let T=_.pathname||"/",I=T;if(m!=="/"){let O=m.replace(/^\//,"").split("/");I="/"+T.replace(/^\//,"").split("/").slice(O.length).join("/")}let V=VA(i,{pathname:I}),L=hI(V&&V.map(O=>Object.assign({},O,{params:Object.assign({},h,O.params),pathname:Is([m,a.encodeLocation?a.encodeLocation(O.pathname).pathname:O.pathname]),pathnameBase:O.pathnameBase==="/"?m:Is([m,a.encodeLocation?a.encodeLocation(O.pathnameBase).pathname:O.pathnameBase])})),l,t,r);return e&&L?q.createElement(vf.Provider,{value:{location:cu({pathname:"/",search:"",hash:"",state:null,key:"default"},_),navigationType:Rs.Pop}},L):L}function oI(){let i=pI(),e=eI(i)?i.status+" "+i.statusText:i instanceof Error?i.message:JSON.stringify(i),t=i instanceof Error?i.stack:null,a={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return q.createElement(q.Fragment,null,q.createElement("h2",null,"Unexpected Application Error!"),q.createElement("h3",{style:{fontStyle:"italic"}},e),t?q.createElement("pre",{style:a},t):null,null)}const lI=q.createElement(oI,null);class cI extends q.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?q.createElement(zs.Provider,{value:this.props.routeContext},q.createElement(dT.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function uI(i){let{routeContext:e,match:t,children:r}=i,a=q.useContext(hy);return a&&a.static&&a.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=t.route.id),q.createElement(zs.Provider,{value:e},r)}function hI(i,e,t,r){var a;if(e===void 0&&(e=[]),t===void 0&&(t=null),r===void 0&&(r=null),i==null){var l;if(!t)return null;if(t.errors)i=t.matches;else if((l=r)!=null&&l.v7_partialHydration&&e.length===0&&!t.initialized&&t.matches.length>0)i=t.matches;else return null}let u=i,h=(a=t)==null?void 0:a.errors;if(h!=null){let _=u.findIndex(b=>b.route.id&&h?.[b.route.id]!==void 0);_>=0||Lt(!1),u=u.slice(0,Math.min(u.length,_+1))}let m=!1,y=-1;if(t&&r&&r.v7_partialHydration)for(let _=0;_<u.length;_++){let b=u[_];if((b.route.HydrateFallback||b.route.hydrateFallbackElement)&&(y=_),b.route.id){let{loaderData:T,errors:I}=t,V=b.route.loader&&T[b.route.id]===void 0&&(!I||I[b.route.id]===void 0);if(b.route.lazy||V){m=!0,y>=0?u=u.slice(0,y+1):u=[u[0]];break}}}return u.reduceRight((_,b,T)=>{let I,V=!1,L=null,O=null;t&&(I=h&&b.route.id?h[b.route.id]:void 0,L=b.route.errorElement||lI,m&&(y<0&&T===0?(yI("route-fallback"),V=!0,O=null):y===T&&(V=!0,O=b.route.hydrateFallbackElement||null)));let Z=e.concat(u.slice(0,T+1)),se=()=>{let G;return I?G=L:V?G=O:b.route.Component?G=q.createElement(b.route.Component,null):b.route.element?G=b.route.element:G=_,q.createElement(uI,{match:b,routeContext:{outlet:_,matches:Z,isDataRoute:t!=null},children:G})};return t&&(b.route.ErrorBoundary||b.route.errorElement||T===0)?q.createElement(cI,{location:t.location,revalidation:t.revalidation,component:L,error:I,children:se(),routeContext:{outlet:null,matches:Z,isDataRoute:!0}}):se()},null)}var pT=function(i){return i.UseBlocker="useBlocker",i.UseRevalidator="useRevalidator",i.UseNavigateStable="useNavigate",i}(pT||{}),gT=function(i){return i.UseBlocker="useBlocker",i.UseLoaderData="useLoaderData",i.UseActionData="useActionData",i.UseRouteError="useRouteError",i.UseNavigation="useNavigation",i.UseRouteLoaderData="useRouteLoaderData",i.UseMatches="useMatches",i.UseRevalidator="useRevalidator",i.UseNavigateStable="useNavigate",i.UseRouteId="useRouteId",i}(gT||{});function dI(i){let e=q.useContext(hy);return e||Lt(!1),e}function fI(i){let e=q.useContext(nI);return e||Lt(!1),e}function mI(i){let e=q.useContext(zs);return e||Lt(!1),e}function yT(i){let e=mI(),t=e.matches[e.matches.length-1];return t.route.id||Lt(!1),t.route.id}function pI(){var i;let e=q.useContext(dT),t=fI(),r=yT();return e!==void 0?e:(i=t.errors)==null?void 0:i[r]}function gI(){let{router:i}=dI(pT.UseNavigateStable),e=yT(gT.UseNavigateStable),t=q.useRef(!1);return fT(()=>{t.current=!0}),q.useCallback(function(a,l){l===void 0&&(l={}),t.current&&(typeof a=="number"?i.navigate(a):i.navigate(a,cu({fromRouteId:e},l)))},[i,e])}const Wb={};function yI(i,e,t){Wb[i]||(Wb[i]=!0)}function vI(i,e){i?.v7_startTransition,i?.v7_relativeSplatPath}function _I(i){let{to:e,replace:t,state:r,relative:a}=i;El()||Lt(!1);let{future:l,static:u}=q.useContext(Us),{matches:h}=q.useContext(zs),{pathname:m}=Mr(),y=_f(),_=uy(e,cy(h,l.v7_relativeSplatPath),m,a==="path"),b=JSON.stringify(_);return q.useEffect(()=>y(JSON.parse(b),{replace:t,state:r,relative:a}),[y,b,a,t,r]),null}function Bc(i){Lt(!1)}function bI(i){let{basename:e="/",children:t=null,location:r,navigationType:a=Rs.Pop,navigator:l,static:u=!1,future:h}=i;El()&&Lt(!1);let m=e.replace(/^\/*/,"/"),y=q.useMemo(()=>({basename:m,navigator:l,static:u,future:cu({v7_relativeSplatPath:!1},h)}),[m,h,l,u]);typeof r=="string"&&(r=Qa(r));let{pathname:_="/",search:b="",hash:T="",state:I=null,key:V="default"}=r,L=q.useMemo(()=>{let O=ly(_,m);return O==null?null:{location:{pathname:O,search:b,hash:T,state:I,key:V},navigationType:a}},[m,_,b,T,I,V,a]);return L==null?null:q.createElement(Us.Provider,{value:y},q.createElement(vf.Provider,{children:t,value:L}))}function xI(i){let{children:e,location:t}=i;return sI(xg(e),t)}new Promise(()=>{});function xg(i,e){e===void 0&&(e=[]);let t=[];return q.Children.forEach(i,(r,a)=>{if(!q.isValidElement(r))return;let l=[...e,a];if(r.type===q.Fragment){t.push.apply(t,xg(r.props.children,l));return}r.type!==Bc&&Lt(!1),!r.props.index||!r.props.children||Lt(!1);let u={id:r.props.id||l.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(u.children=xg(r.props.children,l)),t.push(u)}),t}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Eg(){return Eg=Object.assign?Object.assign.bind():function(i){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(i[r]=t[r])}return i},Eg.apply(this,arguments)}function EI(i,e){if(i==null)return{};var t={},r=Object.keys(i),a,l;for(l=0;l<r.length;l++)a=r[l],!(e.indexOf(a)>=0)&&(t[a]=i[a]);return t}function TI(i){return!!(i.metaKey||i.altKey||i.ctrlKey||i.shiftKey)}function wI(i,e){return i.button===0&&(!e||e==="_self")&&!TI(i)}const RI=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],SI="6";try{window.__reactRouterVersion=SI}catch{}const AI="startTransition",Jb=TA[AI];function II(i){let{basename:e,children:t,future:r,window:a}=i,l=q.useRef();l.current==null&&(l.current=CA({window:a,v5Compat:!0}));let u=l.current,[h,m]=q.useState({action:u.action,location:u.location}),{v7_startTransition:y}=r||{},_=q.useCallback(b=>{y&&Jb?Jb(()=>m(b)):m(b)},[m,y]);return q.useLayoutEffect(()=>u.listen(_),[u,_]),q.useEffect(()=>vI(r),[r]),q.createElement(bI,{basename:e,children:t,location:h.location,navigationType:h.action,navigator:u,future:r})}const NI=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",CI=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Bd=q.forwardRef(function(e,t){let{onClick:r,relative:a,reloadDocument:l,replace:u,state:h,target:m,to:y,preventScrollReset:_,viewTransition:b}=e,T=EI(e,RI),{basename:I}=q.useContext(Us),V,L=!1;if(typeof y=="string"&&CI.test(y)&&(V=y,NI))try{let G=new URL(window.location.href),ne=y.startsWith("//")?new URL(G.protocol+y):new URL(y),B=ly(ne.pathname,I);ne.origin===G.origin&&B!=null?y=B+ne.search+ne.hash:L=!0}catch{}let O=iI(y,{relative:a}),Z=PI(y,{replace:u,state:h,target:m,preventScrollReset:_,relative:a,viewTransition:b});function se(G){r&&r(G),G.defaultPrevented||Z(G)}return q.createElement("a",Eg({},T,{href:V||O,onClick:L||l?r:se,ref:t,target:m}))});var Zb;(function(i){i.UseScrollRestoration="useScrollRestoration",i.UseSubmit="useSubmit",i.UseSubmitFetcher="useSubmitFetcher",i.UseFetcher="useFetcher",i.useViewTransitionState="useViewTransitionState"})(Zb||(Zb={}));var ex;(function(i){i.UseFetcher="useFetcher",i.UseFetchers="useFetchers",i.UseScrollRestoration="useScrollRestoration"})(ex||(ex={}));function PI(i,e){let{target:t,replace:r,state:a,preventScrollReset:l,relative:u,viewTransition:h}=e===void 0?{}:e,m=_f(),y=Mr(),_=mT(i,{relative:u});return q.useCallback(b=>{if(wI(b,t)){b.preventDefault();let T=r!==void 0?r:qd(y)===qd(_);m(i,{replace:T,state:a,preventScrollReset:l,relative:u,viewTransition:h})}},[y,m,_,r,a,t,i,l,u,h])}/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DI=i=>i.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),VI=i=>i.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase()),tx=i=>{const e=VI(i);return e.charAt(0).toUpperCase()+e.slice(1)},vT=(...i)=>i.filter((e,t,r)=>!!e&&e.trim()!==""&&r.indexOf(e)===t).join(" ").trim(),OI=i=>{for(const e in i)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var MI={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jI=q.forwardRef(({color:i="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:r,className:a="",children:l,iconNode:u,...h},m)=>q.createElement("svg",{ref:m,...MI,width:e,height:e,stroke:i,strokeWidth:r?Number(t)*24/Number(e):t,className:vT("lucide",a),...!l&&!OI(h)&&{"aria-hidden":"true"},...h},[...u.map(([y,_])=>q.createElement(y,_)),...Array.isArray(l)?l:[l]]));/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nt=(i,e)=>{const t=q.forwardRef(({className:r,...a},l)=>q.createElement(jI,{ref:l,iconNode:e,className:vT(`lucide-${DI(tx(i))}`,`lucide-${i}`,r),...a}));return t.displayName=tx(i),t};/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kI=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],LI=Nt("arrow-left",kI);/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FI=[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]],Tg=Nt("briefcase",FI);/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UI=[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]],zI=Nt("building",UI);/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qI=[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]],wg=Nt("calculator",qI);/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BI=[["line",{x1:"12",x2:"12",y1:"20",y2:"10",key:"1vz5eb"}],["line",{x1:"18",x2:"18",y1:"20",y2:"4",key:"cun8e5"}],["line",{x1:"6",x2:"6",y1:"20",y2:"16",key:"hq0ia6"}]],Wc=Nt("chart-no-axes-column-increasing",BI);/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HI=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],nx=Nt("circle-alert",HI);/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GI=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],ix=Nt("circle-check-big",GI);/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KI=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],rx=Nt("circle-x",KI);/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YI=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],$I=Nt("clock",YI);/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QI=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],eg=Nt("copy",QI);/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XI=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],Xn=Nt("dollar-sign",XI);/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WI=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],nl=Nt("eye",WI);/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JI=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],ZI=Nt("file-text",JI);/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eN=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]],_T=Nt("house",eN);/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tN=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],nN=Nt("info",tN);/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iN=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],il=Nt("pencil",iN);/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rN=[["line",{x1:"19",x2:"5",y1:"5",y2:"19",key:"1x9vlm"}],["circle",{cx:"6.5",cy:"6.5",r:"2.5",key:"4mh3h7"}],["circle",{cx:"17.5",cy:"17.5",r:"2.5",key:"1mdrzq"}]],sx=Nt("percent",rN);/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sN=[["path",{d:"M11 17h3v2a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1v-3a3.16 3.16 0 0 0 2-2h1a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1h-1a5 5 0 0 0-2-4V3a4 4 0 0 0-3.2 1.6l-.3.4H11a6 6 0 0 0-6 6v1a5 5 0 0 0 2 4v3a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1z",key:"1piglc"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M2 8v1a2 2 0 0 0 2 2h1",key:"1env43"}]],ax=Nt("piggy-bank",sN);/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aN=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],ox=Nt("plus",aN);/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oN=[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]],lN=Nt("share-2",oN);/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cN=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],Rd=Nt("trash-2",cN);/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uN=[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]],hN=Nt("trending-down",uN);/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dN=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],Ss=Nt("trending-up",dN);function Cn(i){return i==null?"":typeof i=="number"?i.toString():i.toString().replace(/[\s$%]/g,"").replace(",",".")}function xt(i){const e=Cn(i);if(e==="")return"";const t=Number(e);return Number.isNaN(t)?"":new Intl.NumberFormat("fr-CA",{minimumFractionDigits:0,maximumFractionDigits:0}).format(t).replace(/\u00A0|\u202F/g," ")+" $"}function Rg(i){const e=Cn(i);if(e==="")return"";const t=Number(e);return Number.isNaN(t)?"":new Intl.NumberFormat("fr-CA",{minimumFractionDigits:0,maximumFractionDigits:2}).format(t).replace(/\u00A0|\u202F/g," ")+" %"}function Ke({value:i,onChange:e,type:t,...r}){const[a,l]=q.useState(""),[u,h]=q.useState(!1);q.useEffect(()=>{if(u)return;const b=Cn(i);if(b===""){l("");return}if(t==="currency")l(xt(b));else if(t==="percentage")l(Rg(b));else{const T=Number(b);Number.isNaN(T)?l(""):l(new Intl.NumberFormat("fr-CA").format(T))}},[i,t,u]);const m=b=>{const I=b.target.value.replace(/[^\d.,-]/g,"");l(I),e(Cn(I))},y=()=>{h(!0),l(Cn(a))},_=()=>{h(!1);const b=Cn(a);let T=b;t==="currency"?T=xt(b):t==="percentage"?T=Rg(b):T=b.replace(".",","),l(T),e(b)};return p.jsx("input",{type:"text",value:a,onChange:m,onFocus:y,onBlur:_,...r})}const fN=(i,e={})=>{const t=q.useRef(null);return q.useEffect(()=>{let r;const a=()=>{!t.current||!window.google?.maps?.places||(r=new window.google.maps.places.Autocomplete(t.current,{types:["address"],...e}),i&&r.addListener("place_changed",()=>{const u=r.getPlace();i(u)}))},l="google-maps-script";if(window.google?.maps?.places)a();else{let u=document.getElementById(l);u||(u=document.createElement("script"),u.id=l,u.src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCXO_Z0_9iAIKDtfWUvS6_GtJrB3fmy88A&libraries=places&v=beta",u.async=!0,document.head.appendChild(u)),u.addEventListener("load",a)}return()=>{r&&window.google.maps.event.clearInstanceListeners(r)}},[i]),t},mN={en:{"network.online":"Online","network.offline":"Offline","auth.login.title":"Login","auth.login.error":"Failed to log in","auth.google.error":"Unable to log in with Google","auth.email":"Email","auth.password":"Password","auth.login.submit":"Log In","auth.google":"Continue with Google","auth.forgotPassword":"Forgot password?","auth.createAccount":"Create an account","auth.signup.title":"Sign Up","auth.signup.error":"Unable to create account","auth.signup.submit":"Sign Up","auth.haveAccount":"Already have an account?","auth.login.link":"Log In","auth.reset.title":"Reset Password","auth.reset.success":"Check your email for further instructions.","auth.reset.error":"Failed to reset password","auth.reset.submit":"Reset","auth.backToLogin":"Back to login","auth.logout":"Log out","about.back":"Back","about.tagline":"Actuary by training, entrepreneur and real estate investor","about.intro":"Passionate about financial analysis and real estate, I developed Rentalyzer to provide investors with a simple and reliable tool to validate the actual returns of their projects.","about.mvvTitle":"Application mission, vision, and values","about.mvv1":"Rentalyzer was born from the desire to democratize real estate profitability analysis and help investors make informed decisions.","about.mvv2":"In the long term, the goal is to support investors in understanding their investments and validating the actual returns they generate.","about.valuesLabel":"Values","about.valuesList":"Simplicity, Reliability, Ethics","about.backgroundTitle":"Professional background","about.education":"Holder of a bachelor's degree in actuarial science","about.entrepreneur":"Entrepreneur since the age of 20","about.investor":"Experienced real estate investor","about.lender":"Private lender (through Omega Capital Privé and Société de Crédit Immo Québec)","about.contactTitle":"Contact","about.email":"Email","about.phone":"Phone","about.linkedin":"LinkedIn","about.photoAlt":"Developer photo",loading:"Loading...","property.import.success":"Property imported successfully","share.link.copied":"Share link copied to clipboard","share.error":"Error while sharing","home.title":"Multifamily Real Estate Profitability Analysis Tool","home.subtitle":"Rentalyzer, your smart assistant for successful multifamily real estate investments","home.empty.title":"🚀 Start your first analysis","home.step1.title":"1. Enter your data","home.step1.text":"Price, income, expenses – we guide you every step of the way","home.step2.title":"2. Get the analysis","home.step2.text":"Profitability, cash flow, personalized recommendations","home.step3.title":"3. Generate the report","home.step3.text":"Professional report ready to present","home.new.button":"Analyze my first building","home.existing.title":"My Analyses","home.existing.new":"New analysis","home.share":"Share","home.delete":"Delete","home.address.unset":"Address not specified","home.units":"units","home.pricePerDoor":"$/door","home.perYear":"$/year","home.about":"ABOUT","home.cmb.title":"Canadian CMB rates","home.cmb.twoYear":"2Y","home.cmb.fiveYear":"5Y","home.cmb.tenYear":"10Y","home.cmb.error":"Unable to load CMB rates","property.form.title":"New Property Analysis","property.form.simpleMode":"Simple mode","property.form.advancedMode":"Advanced mode","property.alert.fillAddress":"Please fill in the complete address (address, city, province, postal code).",back:"Back",cancel:"Cancel",save:"Save",edit:"Edit","building.dashboard.title":"Building Dashboard","building.purchasePrice":"Purchase Price","building.numberOfUnits":"Number of units","building.pricePerDoor":"Price per door","building.grossIncome":"Gross income","building.totalExpenses":"Total expenses","building.netIncome":"Net income (NOI)","building.grm":"GRM","building.nim":"NIM","building.capRate":"Cap Rate","building.createScenario":"Create Financing Scenario","propertyReport.title":"Profitability Analysis Report","propertyReport.analyzingProperty":"Property to analyze","propertyReport.askingPrice":"Asking price","propertyReport.purchasePrice":"Purchase price","propertyReport.numberOfUnits":"Number of units","propertyReport.pricePerDoor":"Price per door","propertyReport.totalRevenue":"Total revenue","propertyReport.totalExpenses":"Total expenses","propertyReport.debtServiceYear1":"Year 1 debt service","propertyReport.cashFlow":"Cash Flow","propertyReport.financing":"Financing","propertyReport.financingType.conventional":"Conventional","propertyReport.financingType.cmhc":"CMHC Standard","propertyReport.financingType.cmhc_aph":"CMHC APH Select","propertyReport.financingType.private":"Private loan","propertyReport.maxLoan":"Maximum loan","propertyReport.loanGranted":"Loan granted","propertyReport.ltv":"Loan-to-value ratio","propertyReport.downPayment":"Down payment","propertyReport.totalInvestment":"Total investment","propertyReport.averageRentPerDoor":"Average rent per door","propertyReport.futureReturns.title":"Future returns","propertyReport.futureReturns.desc1":"Adjust assumptions to estimate returns after","propertyReport.futureReturns.desc2":"years.","propertyReport.subScenario":"Sub-scenario","propertyReport.none":"None","propertyReport.untitled":"Untitled","propertyReport.years":"Years","propertyReport.incomeGrowth":"Income growth (%)","propertyReport.expenseGrowth":"Expense growth (%)","propertyReport.valueAppreciation":"Value appreciation (%)","propertyReport.globalReturn.prefix":"Overall return over","propertyReport.globalReturn.suffix":"year(s)","propertyReport.annualizedReturn":"Annualized return","propertyReport.irrAtYear.prefix":"IRR at year","propertyReport.irrAtYear.suffix":" ","propertyReport.irrInfo":"The internal rate of return (IRR) is the discount rate that makes the net present value of the investment zero.","propertyReport.amortization":"Amortization","propertyReport.newScenario":"New scenario","propertyReport.generatePdf":"Generate PDF","propertyReport.chooseScenarioType":"Choose scenario type","scenario.initialFinancing":"Initial financing","scenario.refinancing":"Refinancing","scenario.renewal":"Mortgage renewal","scenario.optimization":"Optimization","scenario.other":"Other",notApplicable:"N/A","amortization.title":"Amortization Schedule","amortization.noData":"Amortization data unavailable.","amortization.period":"Period (months)","amortization.loanBalance":"Loan balance","amortization.interestPayment":"Interest payment","amortization.principalPayment":"Principal payment","amortization.cumulativePrincipal":"Cumulative principal","amortization.propertyValue":"Property value","amortization.equity":"Equity","keyIndicators.mrb":"Gross rent multiplier (GRM)","keyIndicators.mrn":"Net income multiplier (NIM)","keyIndicators.capRate":"Cap Rate","keyIndicators.coc":"Cash on Cash return (CoC)","keyIndicators.loanPaydownReturn":"Loan paydown return (1yr)","keyIndicators.appreciationReturn":"Appreciation return (default 3% of loan value)","keyIndicators.valueGeneratedYear1":"Value generated after year 1","keyIndicators.totalReturn":"Total return (1 yr)","keyIndicators.loanValueRatio":"Loan to value ratio (LVR)","keyIndicators.revenueIncrease":"Revenue increase","keyIndicators.expenseReduction":"Expense reduction","keyIndicators.noiImprovement":"NOI improvement","keyIndicators.cocImprovement":"CoC improvement","keyIndicators.investmentEfficiency":"Return on work investment","keyIndicators.paybackPeriod":"Payback period","keyIndicators.years":"years","keyIndicators.interestRate":"Loan interest rate","keyIndicators.monthlyInterest":"Monthly interest paid","keyIndicators.totalInterest":"Total interest payable","keyIndicators.capitalRequired":"Capital required","financialSummary.title":"Financial Summary","financialSummary.grossIncome":"Gross income","financialSummary.effectiveIncome":"Effective income","financialSummary.operatingExpensesSCHL":"CMHC operating expenses","financialSummary.totalExpenses":"Total expenses","financialSummary.netIncomeSCHL":"CMHC net income (NOI)","financialSummary.effectiveNetIncome":"Effective net income","financialSummary.netIncome":"Net income (NOI)","financialSummary.annualDebtService":"Annual debt service","financialSummary.annualCashFlow":"Annual cash flow","financingSummary.title":"Financing Summary","financingSummary.financingType":"Financing type","financingSummary.aphPoints":"APH points","financingSummary.qualificationRate":"Qualification rate","financingSummary.remainingAmortization":"Remaining amortization","financingSummary.debtCoverageRatio":"Debt coverage ratio","financingSummary.ltvRatio":"Loan-to-value ratio","financingSummary.originationFee":"Origination fee","financingSummary.propertyValue":"Property value","financingSummary.purchasePrice":"Purchase price","financingSummary.borrowingValue":"Borrowing value","financingSummary.maxLoan":"Maximum loan","financingSummary.loanBalance":"Loan balance","financingSummary.cmhcPremium":"CMHC premium","financingSummary.totalLoanWithPremium":"Total loan including premium","financingSummary.downPayment":"Down payment","financingSummary.trappedEquity":"Trapped equity","financingSummary.financingAndWorksFees":"Financing and works fees","financingSummary.financingFees":"Financing fees","financingSummary.acquisitionFees":"Acquisition fees","financingSummary.equityWithdrawal":"Equity withdrawal","financingSummary.totalInvestment":"Total investment","financingSummary.monthlyPayment":"Monthly payment","financingSummary.monthlyPaymentInterestOnly":"Monthly payment (interest only)","financingSummary.conventional":"Conventional","financingSummary.cmhc":"CMHC Standard","financingSummary.cmhc_aph":"CMHC APH Select","financingSummary.private":"Private loan","scenarioList.viewReport":"View report","scenarioList.edit":"Edit","scenarioList.duplicate":"Duplicate","scenarioList.delete":"Delete","basicInfo.title":"Basic Information","basicInfo.address":"Address","basicInfo.city":"City","basicInfo.province":"Province","basicInfo.postalCode":"Postal Code","basicInfo.askingPrice":"Asking Price","basicInfo.purchasePrice":"Purchase Price","basicInfo.municipalEvaluation":"Municipal Assessment","basicInfo.numberOfUnits":"Number of units","basicInfo.structureType":"Structure type","basicInfo.structureType.woodFrame":"Wood","basicInfo.structureType.concrete":"Concrete","revenue.title":"Annual Revenue","revenue.annualRent":"Annual Rent","revenue.otherRevenue":"Other Revenue","revenue.parkingRevenue":"Parking Revenue","revenue.internetRevenue":"Internet Revenue","revenue.storageRevenue":"Storage Revenue","operatingExpenses.title":"Operating Expenses","operatingExpenses.vacancyRate":"Vacancy / Bad debt (%)","operatingExpenses.insurance":"Insurance","operatingExpenses.municipalTaxes":"Municipal Taxes","operatingExpenses.schoolTaxes":"School Taxes","operatingExpenses.electricityHeating":"Electricity/Heating","operatingExpenses.maintenancePerUnit":"Maintenance (per unit)","operatingExpenses.conciergePerUnit":"Concierge (per unit)","operatingExpenses.managementRate":"Management/Administration (%)","operatingExpenses.otherExpenses":"Other Expenses","operatingExpenses.totalExpenses":"Total Expenses","operatingExpenses.heating":"Heating","operatingExpenses.electricity":"Electricity","operatingExpenses.landscaping":"Landscaping","operatingExpenses.snowRemoval":"Snow Removal","operatingExpenses.extermination":"Extermination","operatingExpenses.fireInspection":"Fire Inspection","operatingExpenses.advertising":"Advertising","operatingExpenses.legal":"Legal Fees","operatingExpenses.accounting":"Accounting","operatingExpenses.elevator":"Elevator","operatingExpenses.cableInternet":"Cable/Internet","operatingExpenses.garbage":"Garbage","operatingExpenses.hotWater":"Hot Water","operatingExpenses.numHeatPumps":"Wall-mounted Heat Pumps (count)","operatingExpenses.numFridges":"Refrigerators (count)","operatingExpenses.numStoves":"Stoves (count)","operatingExpenses.numDishwashers":"Dishwashers (count)","operatingExpenses.numWashers":"Washers (count)","operatingExpenses.numDryers":"Dryers (count)","operatingExpenses.numElevators":"Elevators (count)","operatingExpenses.replacementReserve":"Replacement Reserve","operatingExpenses.includedInOther":"Included in Other Expenses","financing.title":"Financing","financing.type":"Financing Type","financing.type.conventional":"Conventional","financing.type.cmhc":"CMHC Standard","financing.type.cmhc_aph":"CMHC APH Select","financing.type.private":"Private Loan","financing.aphPoints":"APH Points","financing.mortgageRate":"Interest Rate (%)","financing.ltvRatio":"Loan-to-Value Ratio (LTV)","financing.amortization":"Amortization (years)","financing.term":"Term (years)","financing.originationFee":"Origination Fee","financing.qualificationRate":"Qualification Rate (%)","financing.debtCoverageRatio":"Debt coverage ratio","financingFees.environmental1":"Env. Phase 1","financingFees.appraiser":"Certified Appraiser","financingFees.cmhcAnalysis":"CMHC Analysis Fees","financingFees.cmhcTax":"Tax on CMHC Premium","financingFees.otherFees":"Other fees","financingFees.notary":"Notary","financingFees.workCost":"Work cost","financingFees.sectionTitle":"Financing fees","financingFees.sectionTitleWithWork":"Financing fees and optimization work","financingFees.total":"Total financing fees","financingFees.totalWithWork":"Total financing fees and work","acquisitionCosts.title":"Acquisition Costs","acquisitionCosts.expertises":"Expertise","acquisitionCosts.expertisesInfo":"Inspection, environmental studies, appraiser, other tests","acquisitionCosts.notary":"Notary","acquisitionCosts.notaryInfo":"Notary fees","acquisitionCosts.cmhcAnalysis":"CMHC Analysis Fees","acquisitionCosts.cmhcAnalysisInfo":"$200 per unit","acquisitionCosts.cmhcTax":"Tax on CMHC Premium","acquisitionCosts.cmhcTaxInfo":"9% of CMHC premium","acquisitionCosts.welcomeTax":"Welcome Tax","acquisitionCosts.welcomeTaxInfo":"Municipal transfer tax","acquisitionCosts.otherFees":"Other Fees","acquisitionCosts.otherFeesInfo":"Other acquisition fees such as work at acquisition, CMHC analysis fees, tax on CMHC premium, etc.","acquisitionCosts.total":"Total Acquisition Costs","acquisitionCosts.inspection":"Inspection","acquisitionCosts.environmental1":"Env. Phase I","acquisitionCosts.environmental2":"Env. Phase II","acquisitionCosts.environmental3":"Env. Phase III","acquisitionCosts.appraiser":"Certified Appraiser","acquisitionCosts.renovations":"Renovations","currentFinancing.title":"Current Financing","currentFinancing.financingType":"Financing Type","currentFinancing.bank":"Bank Institution","currentFinancing.financedAmount":"Financed Amount","currentFinancing.interestRate":"Interest Rate (%)","currentFinancing.loanStartDate":"Loan Start Date","currentFinancing.amortization":"Amortization (years)","currentFinancing.termEndDate":"Current Term End Date","scenarioForm.financing.title":"Financing Scenario","scenarioForm.refinancing.title":"Refinancing Scenario","scenarioForm.optimization.title":"Optimization Scenario","scenarioForm.renewal.title":"Renewal Scenario","scenarioForm.genericTitle":"Scenario","scenarioForm.parameters":"Scenario Parameters","scenarioForm.titleLabel":"Title","scenarioForm.titlePlaceholder":"Scenario","scenarioForm.revenueGrowthPct":"Revenue Growth (%)","scenarioForm.expenseGrowthPct":"Expense Growth (%)","scenarioForm.valueAppreciationPct":"Value Appreciation (%)","scenarioForm.refinanceYears":"Refinance in (years)","scenarioForm.marketValue":"New Market Value","scenarioForm.notPossible":"This refinancing scenario is not possible.","scenarioForm.newInterestRate":"New interest rate (%)","scenarioForm.viewSummary":"View results","scenarioForm.editScenario":"Edit scenario","recommendations.title":"Recommendations","recommendations.capRate.veryLow":"Cap rate is very low. Consider negotiating the price or increasing revenues. If the building is very recent or strong optimization is possible, the cap rate may be acceptable.","recommendations.capRate.low":"Cap rate is acceptable but could be improved. Consider negotiating the price or increasing rents. If the building is recent (less than 15 years) or optimization is possible, the cap rate may be acceptable.","recommendations.capRate.good":"Good cap rate above 5%.","recommendations.cashFlow.negative":"Negative cash flow - the property does not finance itself. Review your strategy or plan additional funds.","recommendations.cashFlow.low":"Positive but very low cash flow (less than 2% of net income). Plan a contingency reserve.","recommendations.cashFlow.good":"Positive cash flow allowing good flexibility.","executiveSummary.title":"Executive Summary","executiveSummary.p1.part1":"This building of","executiveSummary.units":"units","executiveSummary.p1.part2":"located at","executiveSummary.addressNotSpecified":"address not specified","executiveSummary.p1.part3":"represents an investment of","executiveSummary.p2.part1":"With a net operating income (NOI) of","executiveSummary.p2.part2":"the project generates a capitalization rate of","executiveSummary.p2.part3":"The projected annual cash flow is","executiveSummary.p2.part4":"for a cash-on-cash return of","executiveSummary.p3.part1":"The total investment required (down payment + fees) amounts to","executiveSummary.p3.part2":"with a monthly mortgage payment of"},fr:{"network.online":"En ligne","network.offline":"Hors ligne","auth.login.title":"Connexion","auth.login.error":"Impossible de se connecter","auth.google.error":"Impossible de se connecter avec Google","auth.email":"Email","auth.password":"Mot de passe","auth.login.submit":"Se connecter","auth.google":"Continuer avec Google","auth.forgotPassword":"Mot de passe oublié?","auth.createAccount":"Créer un compte","auth.signup.title":"Inscription","auth.signup.error":"Impossible de créer le compte","auth.signup.submit":"S'inscrire","auth.haveAccount":"Déjà un compte?","auth.login.link":"Se connecter","auth.reset.title":"Réinitialiser le mot de passe","auth.reset.success":"Vérifiez vos courriels pour continuer.","auth.reset.error":"Impossible de réinitialiser le mot de passe","auth.reset.submit":"Réinitialiser","auth.backToLogin":"Retour à la connexion","auth.logout":"Déconnexion","about.back":"Retour","about.tagline":"Actuaire de formation, entrepreneur et investisseur immobilier","about.intro":"Passionné par l'analyse financière et l'immobilier, j'ai développé Rentalyzer pour offrir aux investisseurs un outil simple et fiable afin de valider les rendements réels de leurs projets.","about.mvvTitle":"Mission, vision et valeurs de l'application","about.mvv1":"Rentalyzer est né du désir de démocratiser l'analyse de rentabilité immobilière et d'aider les investisseurs à prendre des décisions éclairées.","about.mvv2":"À long terme, l'objectif est d'accompagner les investisseurs pour comprendre leurs placements et valider les rendements réels qu'ils génèrent.","about.valuesLabel":"Valeurs","about.valuesList":"Simplicité, Fiabilité, Éthique","about.backgroundTitle":"Parcours professionnel","about.education":"Détenteur d'un baccalauréat en actuariat","about.entrepreneur":"Entrepreneur depuis l'âge de 20 ans","about.investor":"Investisseur immobilier d'expérience","about.lender":"Prêteur privé (via Omega Capital Privé et Société de Crédit Immo Québec)","about.contactTitle":"Contact","about.email":"Courriel","about.phone":"Téléphone","about.linkedin":"LinkedIn","about.photoAlt":"Photo du développeur",loading:"Chargement...","property.import.success":"Immeuble importé avec succès","share.link.copied":"Lien de partage copié dans le presse-papiers","share.error":"Erreur lors du partage","home.title":"Outil d'Analyse de Rentabilité Multi Logements","home.subtitle":"Rentalyzer, votre assistant intelligent pour réussir vos investissements immobiliers","home.empty.title":"🚀 Commencez votre première analyse","home.step1.title":"1. Saisissez vos données","home.step1.text":"Prix, revenus, dépenses - nous vous guidons à chaque étape","home.step2.title":"2. Obtenez l'analyse","home.step2.text":"Rentabilité, cash flow, recommandations personnalisées","home.step3.title":"3. Générez le rapport","home.step3.text":"Rapport professionnel prêt à présenter","home.new.button":"Analyser mon premier immeuble","home.existing.title":"Mes Analyses","home.existing.new":"Nouvelle analyse","home.share":"Partager","home.delete":"Supprimer","home.address.unset":"Adresse non spécifiée","home.units":"unités","home.pricePerDoor":"$/porte","home.perYear":"$/an","home.about":"À PROPOS","home.cmb.title":"Taux CMB canadiens","home.cmb.twoYear":"2 ans","home.cmb.fiveYear":"5 ans","home.cmb.tenYear":"10 ans","home.cmb.error":"Impossible de charger les taux CMB","property.form.title":"Nouvelle Analyse d'Immeuble","property.form.simpleMode":"Mode simplifié","property.form.advancedMode":"Mode avancé","property.alert.fillAddress":"Veuillez remplir l'adresse complète (adresse, ville, province, code postal).",back:"Retour",cancel:"Annuler",save:"Sauvegarder",edit:"Modifier","building.dashboard.title":"Tableau de bord de l'immeuble","building.purchasePrice":"Prix d'Achat","building.numberOfUnits":"Nombre d'unités","building.pricePerDoor":"Prix par porte","building.grossIncome":"Revenu brut","building.totalExpenses":"Dépenses totales","building.netIncome":"Revenu net (NOI)","building.grm":"MRB","building.nim":"MRN","building.capRate":"TGA","building.createScenario":"Créer Scénario de Financement","propertyReport.title":"Rapport d'Analyse de Rentabilité","propertyReport.analyzingProperty":"Propriété à analyser","propertyReport.askingPrice":"Prix demandé","propertyReport.purchasePrice":"Prix d'achat","propertyReport.numberOfUnits":"Nombre d'unités","propertyReport.pricePerDoor":"Prix par porte","propertyReport.totalRevenue":"Revenus totaux","propertyReport.totalExpenses":"Dépenses totales","propertyReport.debtServiceYear1":"Service de la dette an 1","propertyReport.cashFlow":"Cash Flow","propertyReport.financing":"Financement","propertyReport.financingType.conventional":"Conventionnel","propertyReport.financingType.cmhc":"SCHL Standard","propertyReport.financingType.cmhc_aph":"SCHL APH Select","propertyReport.financingType.private":"Prêt privé","propertyReport.maxLoan":"Prêt maximal","propertyReport.loanGranted":"Prêt octroyé","propertyReport.ltv":"Ratio prêt-valeur","propertyReport.downPayment":"Mise de fonds","propertyReport.totalInvestment":"Investissement total","propertyReport.averageRentPerDoor":"Loyer moyen par porte","propertyReport.futureReturns.title":"Rendements futurs","propertyReport.futureReturns.desc1":"Ajustez les hypothèses pour estimer les rendements après","propertyReport.futureReturns.desc2":"ans.","propertyReport.subScenario":"Sous-scénario","propertyReport.none":"Aucun","propertyReport.untitled":"Sans titre","propertyReport.years":"Années","propertyReport.incomeGrowth":"Croissance des revenus (%)","propertyReport.expenseGrowth":"Croissance des dépenses (%)","propertyReport.valueAppreciation":"Appréciation de la valeur (%)","propertyReport.globalReturn.prefix":"Rendement global sur","propertyReport.globalReturn.suffix":"an(s)","propertyReport.annualizedReturn":"Rendement annualisé","propertyReport.irrAtYear.prefix":"TRI à la","propertyReport.irrAtYear.suffix":"e année","propertyReport.irrInfo":"Le taux de rendement interne (TRI) est le taux d'actualisation qui rend la valeur actuelle nette de l'investissement nulle.","propertyReport.amortization":"Amortissement","propertyReport.newScenario":"Nouveau scénario","propertyReport.generatePdf":"Générer PDF","propertyReport.chooseScenarioType":"Choisir le type de scénario","scenario.initialFinancing":"Financement initial","scenario.refinancing":"Refinancement","scenario.renewal":"Renouvellement hypothécaire","scenario.optimization":"Optimisation","scenario.other":"Autres",notApplicable:"S/O","amortization.title":"Tableau d'Amortissement","amortization.noData":"Données d'amortissement indisponibles.","amortization.period":"Période (mois)","amortization.loanBalance":"Solde du prêt","amortization.interestPayment":"Versement intérêt","amortization.principalPayment":"Versement capital","amortization.cumulativePrincipal":"Capital cumulé","amortization.propertyValue":"Valeur immeuble","amortization.equity":"Équité","keyIndicators.mrb":"Multiplicateur de revenu brut (MRB)","keyIndicators.mrn":"Multiplicateur de revenu net (MRN)","keyIndicators.capRate":"TGA (Cap Rate)","keyIndicators.coc":"Rendement Cash on Cash (CoC)","keyIndicators.loanPaydownReturn":"Rendement capitalisation du prêt (1an)","keyIndicators.appreciationReturn":"Rendement sur la plus value","keyIndicators.valueGeneratedYear1":"Valeur générée après l'an 1","keyIndicators.totalReturn":"Rendement global (1 an)","keyIndicators.loanValueRatio":"Ratio Prêt Valeur (RPV)","keyIndicators.revenueIncrease":"Augmentation des revenus","keyIndicators.expenseReduction":"Réduction des dépenses","keyIndicators.noiImprovement":"Amélioration du NOI","keyIndicators.cocImprovement":"Amélioration du CoC","keyIndicators.investmentEfficiency":"Rendement sur investissement des travaux","keyIndicators.paybackPeriod":"Période de récupération","keyIndicators.years":"ans","keyIndicators.interestRate":"Taux d'intérêt du prêt","keyIndicators.monthlyInterest":"Intérêt mensuel payé","keyIndicators.totalInterest":"Total des intérêts payables","keyIndicators.capitalRequired":"Capital nécessaire","financialSummary.title":"Résumé Financier","financialSummary.grossIncome":"Revenus bruts","financialSummary.effectiveIncome":"Revenus effectifs","financialSummary.operatingExpensesSCHL":"Dépenses d'exploitation SCHL","financialSummary.totalExpenses":"Dépenses totales","financialSummary.netIncomeSCHL":"Revenu net SCHL (NOI)","financialSummary.effectiveNetIncome":"Revenu net effectif","financialSummary.netIncome":"Revenu net (NOI)","financialSummary.annualDebtService":"Service de dette annuel","financialSummary.annualCashFlow":"Cash Flow annuel","financingSummary.title":"Résumé du Financement","financingSummary.financingType":"Type de financement","financingSummary.aphPoints":"Points APH","financingSummary.qualificationRate":"Taux de qualification","financingSummary.remainingAmortization":"Amortissement restant","financingSummary.debtCoverageRatio":"Ratio couverture dette","financingSummary.ltvRatio":"Ratio prêt-valeur","financingSummary.originationFee":"Frais de dossier","financingSummary.propertyValue":"Valeur de l'immeuble","financingSummary.purchasePrice":"Prix d'achat","financingSummary.borrowingValue":"Valeur d'emprunt","financingSummary.maxLoan":"Prêt maximal","financingSummary.loanBalance":"Solde du prêt","financingSummary.cmhcPremium":"Prime SCHL","financingSummary.totalLoanWithPremium":"Prêt total incluant prime","financingSummary.downPayment":"Mise de fonds","financingSummary.trappedEquity":"Équité figée","financingSummary.financingAndWorksFees":"Frais de financement et travaux","financingSummary.financingFees":"Frais de financement","financingSummary.acquisitionFees":"Frais d'acquisition","financingSummary.equityWithdrawal":"Retrait d'équité","financingSummary.totalInvestment":"Investissement total","financingSummary.monthlyPayment":"Paiement mensuel","financingSummary.monthlyPaymentInterestOnly":"Paiement mensuel (intérêts seulement)","financingSummary.conventional":"Conventionnel","financingSummary.cmhc":"SCHL Standard","financingSummary.cmhc_aph":"SCHL APH Select","financingSummary.private":"Prêt privé","scenarioList.viewReport":"Voir le rapport","scenarioList.edit":"Modifier","scenarioList.duplicate":"Dupliquer","scenarioList.delete":"Supprimer","basicInfo.title":"Informations de base","basicInfo.address":"Adresse","basicInfo.city":"Ville","basicInfo.province":"Province","basicInfo.postalCode":"Code postal","basicInfo.askingPrice":"Prix demandé","basicInfo.purchasePrice":"Prix d'achat","basicInfo.municipalEvaluation":"Évaluation municipale","basicInfo.numberOfUnits":"Nombre d'unités","basicInfo.structureType":"Type de structure","basicInfo.structureType.woodFrame":"Bois","basicInfo.structureType.concrete":"Béton","revenue.title":"Revenus annuels","revenue.annualRent":"Loyers annuels","revenue.otherRevenue":"Autres revenus","revenue.parkingRevenue":"Revenus de stationnement","revenue.internetRevenue":"Revenus Internet","revenue.storageRevenue":"Revenus de rangement","operatingExpenses.title":"Dépenses d'exploitation","operatingExpenses.vacancyRate":"Vacances / mauvaises créances (%)","operatingExpenses.insurance":"Assurance","operatingExpenses.municipalTaxes":"Taxes municipales","operatingExpenses.schoolTaxes":"Taxes scolaires","operatingExpenses.electricityHeating":"Électricité/Chauffage","operatingExpenses.maintenancePerUnit":"Entretien (par logement)","operatingExpenses.conciergePerUnit":"Conciergerie (par logement)","operatingExpenses.managementRate":"Gestion / Administration (%)","operatingExpenses.otherExpenses":"Autres dépenses","operatingExpenses.totalExpenses":"Total des dépenses","operatingExpenses.heating":"Chauffage","operatingExpenses.electricity":"Électricité","operatingExpenses.landscaping":"Aménagement paysager","operatingExpenses.snowRemoval":"Déneigement","operatingExpenses.extermination":"Extermination","operatingExpenses.fireInspection":"Inspection incendie","operatingExpenses.advertising":"Publicité","operatingExpenses.legal":"Frais légaux","operatingExpenses.accounting":"Comptabilité","operatingExpenses.elevator":"Ascenseur","operatingExpenses.cableInternet":"Câble/Internet","operatingExpenses.garbage":"Ordures","operatingExpenses.hotWater":"Eau chaude","operatingExpenses.numHeatPumps":"Thermopompes murales (nombre)","operatingExpenses.numFridges":"Réfrigérateurs (nombre)","operatingExpenses.numStoves":"Cuisinières (nombre)","operatingExpenses.numDishwashers":"Lave-vaisselles (nombre)","operatingExpenses.numWashers":"Laveuses (nombre)","operatingExpenses.numDryers":"Sécheuses (nombre)","operatingExpenses.numElevators":"Ascenseurs (nombre)","operatingExpenses.replacementReserve":"Réserve de remplacement","operatingExpenses.includedInOther":"Inclus dans Autres dépenses","financing.title":"Financement","financing.type":"Type de financement","financing.type.conventional":"Conventionnel","financing.type.cmhc":"SCHL Standard","financing.type.cmhc_aph":"SCHL APH Select","financing.type.private":"Prêt privé","financing.aphPoints":"Points APH","financing.mortgageRate":"Taux d'intérêt (%)","financing.ltvRatio":"Ratio Prêt Valeur (RPV)","financing.amortization":"Amortissement (années)","financing.term":"Terme (années)","financing.originationFee":"Frais de dossier","financing.qualificationRate":"Taux de qualification (%)","financing.debtCoverageRatio":"Ratio couverture dette","financingFees.environmental1":"Env. Phase 1","financingFees.appraiser":"Évaluateur agréé","financingFees.cmhcAnalysis":"Frais d'analyse SCHL","financingFees.cmhcTax":"Taxe sur la prime SCHL","financingFees.otherFees":"Autres frais","financingFees.notary":"Notaire","financingFees.workCost":"Coût des travaux","financingFees.sectionTitle":"Frais de financement","financingFees.sectionTitleWithWork":"Frais de financement et travaux d'optimisation","financingFees.total":"Total frais de financement","financingFees.totalWithWork":"Total frais de financement et travaux","acquisitionCosts.title":"Frais d'acquisition","acquisitionCosts.expertises":"Expertises","acquisitionCosts.expertisesInfo":"Inspection, études environnementales, évaluateur, autres tests","acquisitionCosts.notary":"Notaire","acquisitionCosts.notaryInfo":"Frais de notaire","acquisitionCosts.cmhcAnalysis":"Frais d'analyse SCHL","acquisitionCosts.cmhcAnalysisInfo":"200$ par logement","acquisitionCosts.cmhcTax":"Taxe sur la prime SCHL","acquisitionCosts.cmhcTaxInfo":"9% de la prime SCHL","acquisitionCosts.welcomeTax":"Taxe de bienvenue","acquisitionCosts.welcomeTaxInfo":"Droit de mutation municipale","acquisitionCosts.otherFees":"Autres frais","acquisitionCosts.otherFeesInfo":"Autres frais d'acquisition tel que travaux à l'acquisition, frais analyse SCHL, taxe sur prime SCHL, etc.","acquisitionCosts.total":"Total des Frais d'Acquisition","acquisitionCosts.inspection":"Inspection","acquisitionCosts.environmental1":"Env. Phase I","acquisitionCosts.environmental2":"Env. Phase II","acquisitionCosts.environmental3":"Env. Phase III","acquisitionCosts.appraiser":"Évaluateur agréé","acquisitionCosts.renovations":"Rénovations","currentFinancing.title":"Financement en cours","currentFinancing.financingType":"Type de financement","currentFinancing.bank":"Institution bancaire","currentFinancing.financedAmount":"Montant financé","currentFinancing.interestRate":"Taux d'intérêt (%)","currentFinancing.loanStartDate":"Date de début du prêt","currentFinancing.amortization":"Durée d'amortissement (années)","currentFinancing.termEndDate":"Fin du terme en cours","scenarioForm.financing.title":"Scénario de financement","scenarioForm.refinancing.title":"Scénario de refinancement","scenarioForm.optimization.title":"Scénario d'optimisation","scenarioForm.renewal.title":"Scénario de renouvellement","scenarioForm.genericTitle":"Scénario","scenarioForm.parameters":"Paramètres du scénario","scenarioForm.titleLabel":"Titre","scenarioForm.titlePlaceholder":"Scénario","scenarioForm.revenueGrowthPct":"Croissance des revenus (%)","scenarioForm.expenseGrowthPct":"Croissance des dépenses (%)","scenarioForm.valueAppreciationPct":"Appréciation de la valeur (%)","scenarioForm.refinanceYears":"Refinancement dans (années)","scenarioForm.marketValue":"Nouvelle valeur marchande","scenarioForm.notPossible":"Ce scénario de refinancement n'est pas possible.","scenarioForm.newInterestRate":"Nouveau taux d'intérêt (%)","scenarioForm.viewSummary":"Voir les résultats","scenarioForm.editScenario":"Modifier le scénario","recommendations.title":"Recommandations","recommendations.capRate.veryLow":"Le taux de capitalisation est très faible. Considérez négocier le prix ou augmenter les revenus. Si l'immeuble est très récent ou qu'une forte optimisation est possible, le taux de capitalisation peut être acceptable.","recommendations.capRate.low":"Le taux de capitalisation est acceptable mais pourrait être amélioré. Considérer une négociation du prix ou une augmentation des loyers. Si l'immeuble est récent (moins de 15 ans) ou qu'une optimisation est possible, le taux de capitalisation peut être acceptable.","recommendations.capRate.good":"Bon taux de capitalisation supérieur à 5%.","recommendations.cashFlow.negative":"Cash flow négatif - l'immeuble ne s'autofinance pas. Révisez votre stratégie ou prévoyez des fonds supplémentaires.","recommendations.cashFlow.low":"Cash flow de positif mais très faible (inférieur à 2% des revenus net). Prévoyez une réserve pour imprévus.","recommendations.cashFlow.good":"Cash flow positif permettant une bonne marge de manœuvre.","executiveSummary.title":"Résumé Exécutif","executiveSummary.p1.part1":"Cet immeuble de","executiveSummary.units":"unités","executiveSummary.p1.part2":"situé au","executiveSummary.addressNotSpecified":"adresse non spécifiée","executiveSummary.p1.part3":"représente un investissement de","executiveSummary.p2.part1":"Avec un revenu net d'exploitation (NOI) de","executiveSummary.p2.part2":"le projet génère un taux de capitalisation de","executiveSummary.p2.part3":"Le cashflow annuel projeté est de","executiveSummary.p2.part4":"pour un rendement sur mise de fonds de","executiveSummary.p3.part1":"L'investissement total requis (mise de fonds + frais) s'élève à","executiveSummary.p3.part2":"avec un paiement hypothécaire mensuel de"}},bT=q.createContext(),pN=({children:i})=>{const[e,t]=q.useState("en");q.useEffect(()=>{const a=navigator.language||navigator.userLanguage||"en";t(a.startsWith("fr")?"fr":"en")},[]);const r=a=>mN[e][a]||a;return p.jsx(bT.Provider,{value:{language:e,t:r},children:i})},ft=()=>q.useContext(bT);function xT({property:i={},onChange:e,advancedExpenses:t,readOnly:r=!1,disablePlaceAutocomplete:a=!1,purchasePriceLabel:l}){const{t:u}=ft(),h=l||u("basicInfo.purchasePrice"),m=(b,T)=>{e({...i,[b]:T})},y=q.useMemo(()=>({componentRestrictions:{country:"ca"},fields:["address_components"]}),[]),_=a?q.useRef(null):fN(b=>{const T=b.address_components||[],I=(O,Z=!1)=>{const se=T.find(G=>G.types.includes(O));return se?Z?se.short_name:se.long_name:""},V=[I("street_number"),I("route")].filter(Boolean).join(" "),L=I("locality")||I("administrative_area_level_2")||I("sublocality")||I("postal_town");e({...i,address:V,city:L,province:I("administrative_area_level_1",!0),postalCode:I("postal_code")})},y);return p.jsxs("div",{className:"border rounded-lg p-6",children:[p.jsxs("h2",{className:"text-lg font-semibold mb-4 text-blue-600 flex items-center",children:[p.jsx(_T,{className:"w-5 h-5 mr-2"}),u("basicInfo.title")]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium mb-1",children:u("basicInfo.address")}),p.jsx("input",{ref:_,type:"text",value:i.address||"",onChange:b=>m("address",b.target.value),className:`w-full border rounded p-2 ${r?"bg-gray-100":""}`,placeholder:"123 Example St",disabled:r,readOnly:r,required:!0})]}),p.jsxs("div",{className:"grid grid-cols-3 gap-4 mt-4",children:[p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium mb-1",children:u("basicInfo.city")}),p.jsx("input",{type:"text",value:i.city||"",onChange:b=>m("city",b.target.value),className:`w-full border rounded p-2 ${r?"bg-gray-100":""}`,placeholder:"Montreal",disabled:r,readOnly:r,required:!0})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium mb-1",children:u("basicInfo.province")}),p.jsx("input",{type:"text",value:i.province||"",onChange:b=>m("province",b.target.value),className:`w-full border rounded p-2 ${r?"bg-gray-100":""}`,placeholder:"QC",disabled:r,readOnly:r,required:!0})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium mb-1",children:u("basicInfo.postalCode")}),p.jsx("input",{type:"text",value:i.postalCode||"",onChange:b=>m("postalCode",b.target.value),className:`w-full border rounded p-2 ${r?"bg-gray-100":""}`,placeholder:"H2B 1A0",disabled:r,readOnly:r,required:!0})]})]}),p.jsxs("div",{className:"grid grid-cols-2 gap-4 mt-4",children:[t&&p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium mb-1",children:u("basicInfo.askingPrice")}),p.jsx(Ke,{value:i.askingPrice||"",onChange:b=>m("askingPrice",b),className:`w-full border rounded p-2 ${r?"bg-gray-100":""}`,placeholder:"0",type:"currency",disabled:r,readOnly:r})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium mb-1",children:h}),p.jsx(Ke,{value:i.purchasePrice||"",onChange:b=>m("purchasePrice",b),className:`w-full border rounded p-2 ${r?"bg-gray-100":""}`,placeholder:"0",type:"currency",disabled:r,readOnly:r})]}),t&&p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium mb-1",children:u("basicInfo.municipalEvaluation")}),p.jsx(Ke,{value:i.municipalEvaluation||"",onChange:b=>m("municipalEvaluation",b),className:`w-full border rounded p-2 ${r?"bg-gray-100":""}`,placeholder:"0",type:"currency",disabled:r,readOnly:r})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium mb-1",children:u("basicInfo.numberOfUnits")}),p.jsx(Ke,{value:i.numberOfUnits||"",onChange:b=>m("numberOfUnits",b),className:`w-full border rounded p-2 ${r?"bg-gray-100":""}`,placeholder:"0",disabled:r,readOnly:r})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium mb-1",children:u("basicInfo.structureType")}),p.jsxs("select",{value:i.structureType||"woodFrame",onChange:b=>m("structureType",b.target.value),className:`w-full border rounded p-2 ${r?"bg-gray-100":""}`,disabled:r,children:[p.jsx("option",{value:"woodFrame",children:u("basicInfo.structureType.woodFrame")}),p.jsx("option",{value:"concrete",children:u("basicInfo.structureType.concrete")})]})]})]})]})}function dy({revenue:i={},onChange:e,advancedExpenses:t,readOnly:r=!1}){const{t:a}=ft(),l=(h,m)=>{e({...i,[h]:m})};if(!t)return p.jsxs("div",{className:"border rounded-lg p-6",children:[p.jsxs("h2",{className:"text-lg font-semibold mb-4 text-green-600 flex items-center",children:[p.jsx(Xn,{className:"w-5 h-5 mr-2"}),a("revenue.title")]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium mb-1",children:a("revenue.annualRent")}),p.jsx(Ke,{value:i.annualRent||"",onChange:h=>l("annualRent",h),className:`w-full border rounded p-2 ${r?"bg-gray-100":""}`,placeholder:"0",type:"currency",disabled:r,readOnly:r})]}),p.jsxs("div",{className:"mt-4",children:[p.jsx("label",{className:"block text-sm font-medium mb-1",children:a("revenue.otherRevenue")}),p.jsx(Ke,{value:i.otherRevenue||"",onChange:h=>l("otherRevenue",h),className:`w-full border rounded p-2 ${r?"bg-gray-100":""}`,placeholder:"0",type:"currency",disabled:r,readOnly:r})]})]});const u=[{field:"parkingRevenue",label:a("revenue.parkingRevenue")},{field:"internetRevenue",label:a("revenue.internetRevenue")},{field:"storageRevenue",label:a("revenue.storageRevenue")},{field:"otherRevenue",label:a("revenue.otherRevenue")}];return p.jsxs("div",{className:"border rounded-lg p-6",children:[p.jsxs("h2",{className:"text-lg font-semibold mb-4 text-green-600 flex items-center",children:[p.jsx(Xn,{className:"w-5 h-5 mr-2"}),a("revenue.title")]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium mb-1",children:a("revenue.annualRent")}),p.jsx(Ke,{value:i.annualRent||"",onChange:h=>l("annualRent",h),className:`w-full border rounded p-2 ${r?"bg-gray-100":""}`,placeholder:"0",type:"currency",disabled:r,readOnly:r})]}),p.jsx("div",{className:"grid grid-cols-2 gap-4 mt-4",children:u.map(({field:h,label:m})=>p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium mb-1",children:m}),p.jsx(Ke,{value:i[h]||"",onChange:y=>l(h,y),className:`w-full border rounded p-2 ${r?"bg-gray-100":""}`,placeholder:"0",type:"currency",disabled:r,readOnly:r})]},h))})]})}const pd={woodFrame:{small:{maintenance:610,managementRate:4.25,salaries:420,otherCostRate:1,replacementReserve:{appliance:60,heatPump:190,elevator:300}},large:{maintenance:610,managementRate:4.25,salaries:420,otherCostRate:1,replacementReserve:{appliance:60,heatPump:190,elevator:300}}},concrete:{any:{maintenance:825,managementRate:4.25,salaries:610,otherCostRate:1.3,replacementReserve:{appliance:60,heatPump:190}}}},gN={woodFrame:{small:{maintenance:830,managementRate:4.25,salaries:555,otherCostRate:1,replacementReserve:{appliance:60,heatPump:190,elevator:300}},large:{maintenance:830,managementRate:4.25,salaries:555,otherCostRate:1,replacementReserve:{appliance:60,heatPump:190,elevator:300}}},concrete:{any:{maintenance:975,managementRate:4.25,salaries:700,otherCostRate:1,replacementReserve:{appliance:60,heatPump:190}}}},Ho={woodFrame:{small:{maintenance:830,managementRate:4.25,salaries:500,otherCostRate:2,replacementReserve:{appliance:60,heatPump:190,elevator:300}},large:{maintenance:830,managementRate:4.25,salaries:500,otherCostRate:2,replacementReserve:{appliance:60,heatPump:190,elevator:300}}},concrete:{any:{maintenance:975,managementRate:4.25,salaries:665,otherCostRate:2,replacementReserve:{appliance:60,heatPump:190}}}},yN={woodFrame:{small:{maintenance:830,managementRate:4.25,salaries:635,otherCostRate:1.7,replacementReserve:{appliance:60,heatPump:190,elevator:300}},large:{maintenance:830,managementRate:4.25,salaries:635,otherCostRate:1.7,replacementReserve:{appliance:60,heatPump:190,elevator:300}}},concrete:{any:{maintenance:975,managementRate:4.25,salaries:700,otherCostRate:1.8,replacementReserve:{appliance:60,heatPump:190}}}},vN={woodFrame:{small:{maintenance:610,managementRate:4.25,salaries:215,otherCostRate:0,replacementReserve:{appliance:60,heatPump:190,elevator:300}},large:{maintenance:610,managementRate:5,salaries:365,otherCostRate:0,replacementReserve:{appliance:60,heatPump:190,elevator:300}}},concrete:{any:{maintenance:925,managementRate:5,salaries:610,otherCostRate:0,replacementReserve:{appliance:60,heatPump:190}}}},fy={NB:pd,NS:pd,PE:pd,NL:pd,ON:gN,MB:Ho,SK:Ho,AB:Ho,BC:yN,NT:Ho,NU:Ho,YT:Ho,QC:vN};function my({expenses:i={},onChange:e,advancedExpenses:t,readOnly:r=!1}){const{t:a}=ft(),l=(U,ee)=>{e({...i,[U]:ee})},u=parseInt(i.numberOfUnits)||0,h=i.province,m=i.structureType||"woodFrame",y=h?fy[h]:null;let _;y&&(m==="woodFrame"?_=y.woodFrame[u<=11?"small":"large"]:_=y.concrete.any);const b=["annualRent","parkingRevenue","internetRevenue","storageRevenue","otherRevenue"].reduce((U,ee)=>U+(parseFloat(i[ee])||0),0),T=b*((parseFloat(i.vacancyRate)||0)/100),I=b-T,V=I*((parseFloat(i.managementRate)||0)/100),L=parseFloat(i.maintenance)||0,O=parseFloat(i.concierge)||0,Z=parseFloat(i.maintenance)*u,se=parseFloat(i.concierge)*u,G=t&&_?.otherCostRate||0,ne=t?I*G/100:0,B=i.otherExpenses!==void 0&&i.otherExpenses!==""?parseFloat(i.otherExpenses):ne,re=parseInt(i.numHeatPumps)||0,P=parseInt(i.numElevators)||0,S=parseInt(i.numFridges)||0,A=parseInt(i.numStoves)||0,M=parseInt(i.numDishwashers)||0,D=parseInt(i.numWashers)||0,k=parseInt(i.numDryers)||0,N=_?.replacementReserve||{},ue={numHeatPumps:{rate:N.heatPump||0,count:re,multiplier:1},numFridges:{rate:N.appliance||0,count:S,multiplier:1},numStoves:{rate:N.appliance||0,count:A,multiplier:1},numDishwashers:{rate:N.appliance||0,count:M,multiplier:1},numWashers:{rate:N.appliance||0,count:D,multiplier:1},numDryers:{rate:N.appliance||0,count:k,multiplier:1},numElevators:{rate:N.elevator||0,count:P,multiplier:12}};Object.values(ue).forEach(U=>{U.value=U.rate*U.count*U.multiplier});const de=Object.values(ue).reduce((U,ee)=>U+ee.value,0),z=()=>{const U=Object.values(ue).filter(ee=>ee.value).map(ee=>xt(ee.value));return U.length?`${U.join(" + ")} = ${xt(de)}`:""},X=q.useRef(h);q.useEffect(()=>{if(!_)return;const U={},ee=X.current;h!==ee?(U.maintenance=_.maintenance.toString(),U.managementRate=_.managementRate.toString(),U.concierge=_.salaries.toString()):(i.maintenance||(U.maintenance=_.maintenance.toString()),i.managementRate||(U.managementRate=_.managementRate.toString()),i.concierge||(U.concierge=_.salaries.toString())),Object.keys(U).length>0&&e(ie=>({...ie,...U})),X.current=h},[_,h,i.maintenance,i.managementRate,i.concierge,e]);const ae=t?["municipalTaxes","schoolTaxes","heating","electricity","insurance","landscaping","snowRemoval","extermination","fireInspection","advertising","legal","accounting","elevator","cableInternet","garbage","hotWater","otherExpenses"].reduce((U,ee)=>G>0&&["landscaping","snowRemoval","extermination","fireInspection","advertising","legal","accounting"].includes(ee)?U:U+(ee==="otherExpenses"?B:parseFloat(i[ee])||0),0)+V+T+Z+se+de:["municipalTaxes","schoolTaxes","insurance","electricityHeating","management"].reduce((U,ee)=>U+(parseFloat(i[ee])||0),0)+V+T+Z+se+de+B;if(q.useEffect(()=>{t||(parseFloat(i.operatingExpenses)||0)!==ae&&e(ee=>({...ee,operatingExpenses:ae.toString()}))},[ae,t,e,i.operatingExpenses]),!t){const U=[{field:"vacancyRate",label:a("operatingExpenses.vacancyRate")},{field:"insurance",label:a("operatingExpenses.insurance")},{field:"municipalTaxes",label:a("operatingExpenses.municipalTaxes")},{field:"schoolTaxes",label:a("operatingExpenses.schoolTaxes")},{field:"electricityHeating",label:a("operatingExpenses.electricityHeating")},{field:"maintenance",label:a("operatingExpenses.maintenancePerUnit")},{field:"concierge",label:a("operatingExpenses.conciergePerUnit")},{field:"managementRate",label:a("operatingExpenses.managementRate")},{field:"otherExpenses",label:a("operatingExpenses.otherExpenses")}];return p.jsxs("div",{className:"border rounded-lg p-6",children:[p.jsxs("h2",{className:"text-lg font-semibold mb-4 text-red-600 flex items-center",children:[p.jsx(Ss,{className:"w-5 h-5 mr-2"}),a("operatingExpenses.title")]}),p.jsx("div",{className:"grid grid-cols-2 gap-4",children:U.map(({field:ee,label:ie})=>p.jsxs("div",{className:"col-span-1",children:[p.jsx("label",{className:"block text-sm font-medium mb-1",children:ie}),p.jsx(Ke,{value:ee==="otherExpenses"?i.otherExpenses!==void 0&&i.otherExpenses!==""?i.otherExpenses:ne:i[ee]||"",onChange:ge=>l(ee,ge),className:`w-full border rounded p-2 ${r?"bg-gray-100":""}`,placeholder:"0",type:ee==="vacancyRate"||ee==="managementRate"?"percentage":"currency",disabled:r,readOnly:r}),ee==="vacancyRate"&&p.jsx("p",{className:"text-xs text-gray-500 mt-1",children:i.vacancyRate?`${i.vacancyRate}% de ${xt(b)} = ${xt(T)}`:""}),ee==="managementRate"&&p.jsx("p",{className:"text-xs text-gray-500 mt-1",children:i.managementRate?`${i.managementRate}% de ${xt(I)} = ${xt(V)}`:""}),ee==="maintenance"&&p.jsx("p",{className:"text-xs text-gray-500 mt-1",children:i.maintenance?`${xt(L)} × ${u} = ${xt(Z)}`:""}),ee==="concierge"&&p.jsx("p",{className:"text-xs text-gray-500 mt-1",children:i.concierge?`${xt(O)} × ${u} = ${xt(se)}`:""}),ee==="otherExpenses"&&G>0&&p.jsx("p",{className:"text-xs text-gray-500 mt-1",children:`${G}% de ${xt(I)} = ${xt(ne)}`})]},ee))}),p.jsxs("div",{className:"mt-4",children:[p.jsx("label",{className:"block text-sm font-medium mb-1",children:a("operatingExpenses.totalExpenses")}),p.jsx(Ke,{value:ae||"",onChange:()=>{},className:"w-full border rounded p-2 bg-gray-100",placeholder:"0",disabled:!0,type:"currency"})]})]})}const me=[{field:"vacancyRate",label:a("operatingExpenses.vacancyRate")},{field:"insurance",label:a("operatingExpenses.insurance")},{field:"municipalTaxes",label:a("operatingExpenses.municipalTaxes")},{field:"schoolTaxes",label:a("operatingExpenses.schoolTaxes")},{field:"heating",label:a("operatingExpenses.heating")},{field:"electricity",label:a("operatingExpenses.electricity")},{field:"maintenance",label:a("operatingExpenses.maintenancePerUnit")},{field:"managementRate",label:a("operatingExpenses.managementRate")},{field:"concierge",label:a("operatingExpenses.conciergePerUnit")},{field:"landscaping",label:a("operatingExpenses.landscaping")},{field:"snowRemoval",label:a("operatingExpenses.snowRemoval")},{field:"extermination",label:a("operatingExpenses.extermination")},{field:"fireInspection",label:a("operatingExpenses.fireInspection")},{field:"advertising",label:a("operatingExpenses.advertising")},{field:"legal",label:a("operatingExpenses.legal")},{field:"accounting",label:a("operatingExpenses.accounting")},{field:"elevator",label:a("operatingExpenses.elevator")},{field:"cableInternet",label:a("operatingExpenses.cableInternet")},{field:"garbage",label:a("operatingExpenses.garbage")},{field:"hotWater",label:a("operatingExpenses.hotWater")},{field:"numHeatPumps",label:a("operatingExpenses.numHeatPumps")},{field:"numFridges",label:a("operatingExpenses.numFridges")},{field:"numStoves",label:a("operatingExpenses.numStoves")},{field:"numDishwashers",label:a("operatingExpenses.numDishwashers")},{field:"numWashers",label:a("operatingExpenses.numWashers")},{field:"numDryers",label:a("operatingExpenses.numDryers")},{field:"numElevators",label:a("operatingExpenses.numElevators")},{field:"otherExpenses",label:a("operatingExpenses.otherExpenses")}],C=["numHeatPumps","numFridges","numStoves","numDishwashers","numWashers","numDryers","numElevators"];return p.jsxs("div",{className:"border rounded-lg p-6",children:[p.jsxs("h2",{className:"text-lg font-semibold mb-4 text-red-600 flex items-center",children:[p.jsx(Ss,{className:"w-5 h-5 mr-2"}),a("operatingExpenses.title")]}),p.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[me.map(({field:U,label:ee})=>{const ie=G>0&&["landscaping","snowRemoval","extermination","fireInspection","advertising","legal","accounting"].includes(U);return p.jsxs("div",{className:"col-span-1",children:[p.jsx("label",{className:"block text-sm font-medium mb-1",children:ee}),p.jsx(Ke,{value:U==="otherExpenses"?i.otherExpenses!==void 0&&i.otherExpenses!==""?i.otherExpenses:ne:i[U]||"",onChange:ge=>l(U,ge),className:`w-full border rounded p-2 ${r||ie?"bg-gray-100":""}`,placeholder:"0",type:U==="vacancyRate"||U==="managementRate"?"percentage":C.includes(U)?"number":"currency",disabled:r||ie,readOnly:r||ie}),U==="vacancyRate"&&p.jsx("p",{className:"text-xs text-gray-500 mt-1",children:i.vacancyRate?`${i.vacancyRate}% de ${xt(b)} = ${xt(T)}`:""}),U==="managementRate"&&p.jsx("p",{className:"text-xs text-gray-500 mt-1",children:i.managementRate?`${i.managementRate}% de ${xt(I)} = ${xt(V)}`:""}),U==="maintenance"&&p.jsx("p",{className:"text-xs text-gray-500 mt-1",children:i.maintenance?`${xt(L)} × ${u} = ${xt(Z)}`:""}),U==="concierge"&&p.jsx("p",{className:"text-xs text-gray-500 mt-1",children:i.concierge?`${xt(O)} × ${u} = ${xt(se)}`:""}),U==="otherExpenses"&&G>0&&p.jsx("p",{className:"text-xs text-gray-500 mt-1",children:`${G}% de ${xt(I)} = ${xt(ne)}`}),ie&&p.jsx("p",{className:"text-xs text-gray-500 mt-1",children:a("operatingExpenses.includedInOther")}),ue[U]?.value>0&&p.jsx("p",{className:"text-xs text-gray-500 mt-1",children:`${xt(ue[U].rate)} × ${ue[U].multiplier>1?ue[U].multiplier+" × ":""}${ue[U].count} = ${xt(ue[U].value)}`})]},U)}),p.jsxs("div",{className:"col-span-1",children:[p.jsx("label",{className:"block text-sm font-medium mb-1",children:a("operatingExpenses.replacementReserve")}),p.jsx(Ke,{value:de||"",onChange:()=>{},className:"w-full border rounded p-2 bg-gray-100",placeholder:"0",disabled:!0,type:"currency"}),z()&&p.jsx("p",{className:"text-xs text-gray-500 mt-1",children:z()})]})]}),p.jsxs("div",{className:"mt-4",children:[p.jsx("label",{className:"block text-sm font-medium mb-1",children:a("operatingExpenses.totalExpenses")}),p.jsx(Ke,{value:ae||"",onChange:()=>{},className:"w-full border rounded p-2 bg-gray-100",placeholder:"0",disabled:!0,type:"currency"})]})]})}const _N=({currentProperty:i,setCurrentProperty:e,setCurrentStep:t,advancedExpenses:r,setAdvancedExpenses:a,onSave:l})=>{const{t:u}=ft(),h=()=>{if(!i.address||!i.city||!i.province||!i.postalCode){alert(u("property.alert.fillAddress"));return}l()};return p.jsx("div",{className:"min-h-screen bg-gray-50 p-4",children:p.jsx("div",{className:"max-w-4xl mx-auto",children:p.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[p.jsxs("div",{className:"flex justify-between items-center mb-6",children:[p.jsx("h2",{className:"text-2xl font-semibold",children:u("property.form.title")}),p.jsxs("div",{className:"flex items-center gap-4",children:[p.jsx("button",{onClick:()=>a(!r),className:"px-4 py-2 border rounded-lg hover:bg-gray-50",children:u(r?"property.form.simpleMode":"property.form.advancedMode")}),p.jsxs("button",{onClick:()=>t(i.id?"dashboard":"home"),className:"text-gray-600 hover:text-gray-800",children:["← ",u("back")]})]})]}),p.jsxs("div",{className:"space-y-8",children:[p.jsx(xT,{property:i,onChange:e,advancedExpenses:r}),p.jsx(dy,{revenue:i,onChange:e,advancedExpenses:r}),p.jsx(my,{expenses:i,onChange:e,advancedExpenses:r}),p.jsxs("div",{className:`flex ${i.id?"justify-end":"justify-between"}`,children:[!i.id&&p.jsx("button",{onClick:()=>t("home"),className:"px-6 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:u("cancel")}),p.jsx("button",{onClick:h,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:u("save")})]})]})]})})})};function bf({analysis:i,variant:e="acquisition",exclude:t=[]}){const{t:r}=ft();if(!i)return null;const a=A=>A!=null?`${A.toFixed(1)}%`:"—",l=A=>A!=null?new Intl.NumberFormat("fr-CA",{style:"currency",currency:"CAD",minimumFractionDigits:0,maximumFractionDigits:0}).format(A):"—",u=A=>A==null?"text-gray-700":A>=0?"text-green-600":"text-red-600",h=i?.optimizationComparison,m=h?.base?.totalGrossRevenue??null,y=h?.optimized?.totalGrossRevenue??null,_=h?.base?.totalExpenses??null,b=h?.optimized?.totalExpenses??null,T=h?.base?.netOperatingIncome??null,I=h?.optimized?.netOperatingIncome??null,V=h?.workCost??0,L=m!==null&&y!==null?y-m:null,O=_!==null&&b!==null?_-b:null,Z=T!==null&&I!==null?I-T:null,se=Z??h?.noiIncrease??null,G=V>0&&se!==null?se/V*100:null,ne=V>0&&se>0?V/se:null;let B=[{key:"mrb",label:r("keyIndicators.mrb"),value:i.grossRentMultiplier?.toFixed(1)||"—",icon:p.jsx(Wc,{className:"w-6 h-6 text-blue-600"}),color:"text-gray-700"},{key:"mrn",label:r("keyIndicators.mrn"),value:i.netIncomeMultiplier?.toFixed(1)||"—",icon:p.jsx(Wc,{className:"w-6 h-6 text-indigo-600"}),color:"text-gray-700"},{key:"tga",label:r("keyIndicators.capRate"),value:a(i.capRate),icon:p.jsx(Ss,{className:"w-6 h-6 text-green-600"}),color:i.capRate>=5?"text-green-600":"text-orange-600"},{key:"coc",label:r("keyIndicators.coc"),value:a(i.cashOnCashReturn),icon:p.jsx(Xn,{className:"w-6 h-6 text-emerald-600"}),color:i.cashOnCashReturn>=8?"text-green-600":"text-orange-600"},{key:"loanPaydownReturn",label:r("keyIndicators.loanPaydownReturn"),value:a(i.loanPaydownReturn),icon:p.jsx(ax,{className:"w-6 h-6 text-purple-600"}),color:"text-gray-700"},{key:"appreciationReturn",label:r("keyIndicators.appreciationReturn"),value:a(i.appreciationReturn),icon:p.jsx(Ss,{className:"w-6 h-6 text-amber-600"}),color:"text-gray-700"},{key:"valueGeneratedYear1",label:r("keyIndicators.valueGeneratedYear1"),value:l(i.valueGeneratedYear1),icon:p.jsx(Xn,{className:"w-6 h-6 text-indigo-600"}),color:i.valueGeneratedYear1>=0?"text-green-600":"text-red-600"},{key:"totalReturn",label:r("keyIndicators.totalReturn"),value:a(i.totalReturn),icon:p.jsx(Ss,{className:"w-6 h-6 text-emerald-600"}),color:"text-gray-700"},{key:"loanValueRatio",label:r("keyIndicators.loanValueRatio"),value:a(i.loanValueRatio),icon:p.jsx(sx,{className:"w-6 h-6 text-cyan-600"}),color:"text-gray-700"}];e==="optimization"&&h&&(B=B.concat([{key:"revenueIncrease",label:r("keyIndicators.revenueIncrease"),value:l(L),icon:p.jsx(Ss,{className:"w-6 h-6 text-green-600"}),color:u(L)},{key:"expenseReduction",label:r("keyIndicators.expenseReduction"),value:l(O),icon:p.jsx(hN,{className:"w-6 h-6 text-green-600"}),color:u(O)},{key:"noiImprovement",label:r("keyIndicators.noiImprovement"),value:l(Z),icon:p.jsx(Xn,{className:"w-6 h-6 text-emerald-600"}),color:u(Z)},{key:"investmentEfficiency",label:r("keyIndicators.investmentEfficiency"),value:G!==null?a(G):"—",icon:p.jsx(Wc,{className:"w-6 h-6 text-purple-600"}),color:"text-gray-700"},{key:"paybackPeriod",label:r("keyIndicators.paybackPeriod"),value:ne!==null?`${ne.toFixed(1)} ${r("keyIndicators.years")}`:"—",icon:p.jsx($I,{className:"w-6 h-6 text-blue-600"}),color:ne!==null&&ne>10?"text-orange-500":"text-gray-700"}])),e==="private"&&(B=B.concat([{key:"interestRate",label:r("keyIndicators.interestRate"),value:a(i.mortgageRate),icon:p.jsx(sx,{className:"w-6 h-6 text-rose-600"}),color:"text-gray-700"},{key:"monthlyInterest",label:r("keyIndicators.monthlyInterest"),value:l(i.monthlyPayment),icon:p.jsx(Xn,{className:"w-6 h-6 text-rose-600"}),color:"text-gray-700"},{key:"annualInterest",label:r("keyIndicators.totalInterest"),value:l(i.annualDebtService),icon:p.jsx(Xn,{className:"w-6 h-6 text-red-600"}),color:"text-gray-700"},{key:"capitalRequired",label:r("keyIndicators.capitalRequired"),value:l((i.totalInvestment||0)+(i.annualDebtService||0)),icon:p.jsx(ax,{className:"w-6 h-6 text-rose-600"}),color:"text-gray-700"}]));const re=["coc","loanPaydownReturn","appreciationReturn","totalReturn","investmentEfficiency","paybackPeriod","revenueIncrease","expenseReduction","noiImprovement"],P={future:A=>!["mrb","mrn","tga"].includes(A.key),private:A=>!["coc","loanPaydownReturn","appreciationReturn","totalReturn"].includes(A.key),optimization:A=>re.includes(A.key)};let S=B.filter(A=>{if(t.includes(A.key))return!1;const M=P[e];return M?M(A):!0});return e==="optimization"&&(S=re.map(A=>S.find(M=>M.key===A)).filter(Boolean)),p.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-8",children:S.map(({key:A,label:M,value:D,icon:k,color:N})=>p.jsxs("div",{className:"bg-white rounded-lg p-4 border border-gray-200 flex items-center gap-4",children:[p.jsx("div",{children:k}),p.jsxs("div",{className:"flex-1",children:[p.jsx("p",{className:"text-sm text-gray-500",children:M}),p.jsx("p",{className:`text-lg font-semibold ${N}`,children:D})]})]},A))})}function xf({analysis:i,advancedExpenses:e=!1}){const{t}=ft(),r=a=>a==null?"—":new Intl.NumberFormat("fr-CA",{style:"currency",currency:"CAD",minimumFractionDigits:0,maximumFractionDigits:0}).format(a);return e?p.jsxs("div",{className:"bg-white rounded-lg p-6",children:[p.jsx("h3",{className:"text-lg font-semibold mb-4",children:t("financialSummary.title")}),p.jsxs("div",{className:"space-y-3",children:[p.jsxs("div",{className:"flex justify-between",children:[p.jsxs("span",{className:"text-gray-600",children:[t("financialSummary.grossIncome"),":"]}),p.jsx("span",{className:"font-medium",children:r(i?.totalGrossRevenue)})]}),p.jsxs("div",{className:"flex justify-between",children:[p.jsxs("span",{className:"text-gray-600",children:[t("financialSummary.effectiveIncome"),":"]}),p.jsx("span",{className:"font-medium",children:r(i?.effectiveGrossRevenue)})]}),p.jsxs("div",{className:"flex justify-between",children:[p.jsxs("span",{className:"text-gray-600",children:[t("financialSummary.operatingExpensesSCHL"),":"]}),p.jsx("span",{className:"font-medium text-red-600",children:r(i?.operatingExpensesSCHL)})]}),p.jsxs("div",{className:"flex justify-between",children:[p.jsxs("span",{className:"text-gray-600",children:[t("financialSummary.totalExpenses"),":"]}),p.jsx("span",{className:"font-medium text-red-600",children:r(i?.totalExpenses)})]}),p.jsxs("div",{className:"flex justify-between border-t pt-3",children:[p.jsxs("span",{className:"text-gray-600",children:[t("financialSummary.netIncomeSCHL"),":"]}),p.jsx("span",{className:"font-semibold text-lg",children:r(i?.netOperatingIncome)})]}),p.jsxs("div",{className:"flex justify-between",children:[p.jsxs("span",{className:"text-gray-600",children:[t("financialSummary.effectiveNetIncome"),":"]}),p.jsx("span",{className:"font-semibold",children:r(i?.effectiveNetIncome)})]}),p.jsxs("div",{className:"flex justify-between",children:[p.jsxs("span",{className:"text-gray-600",children:[t("financialSummary.annualDebtService"),":"]}),p.jsx("span",{className:"font-medium text-red-600",children:r(i?.annualDebtService)})]}),p.jsxs("div",{className:"flex justify-between border-t pt-3",children:[p.jsxs("span",{className:"text-gray-600 font-semibold",children:[t("financialSummary.annualCashFlow"),":"]}),p.jsx("span",{className:`font-bold text-lg ${i?.cashFlow>=0?"text-green-600":"text-red-600"}`,children:r(i?.cashFlow)})]})]})]}):p.jsxs("div",{className:"bg-white rounded-lg p-6",children:[p.jsx("h3",{className:"text-lg font-semibold mb-4",children:t("financialSummary.title")}),p.jsxs("div",{className:"space-y-3",children:[p.jsxs("div",{className:"flex justify-between",children:[p.jsxs("span",{className:"text-gray-600",children:[t("financialSummary.grossIncome"),":"]}),p.jsx("span",{className:"font-medium",children:r(i?.totalGrossRevenue)})]}),p.jsxs("div",{className:"flex justify-between",children:[p.jsxs("span",{className:"text-gray-600",children:[t("financialSummary.effectiveIncome"),":"]}),p.jsx("span",{className:"font-medium",children:r(i?.effectiveGrossRevenue)})]}),p.jsxs("div",{className:"flex justify-between",children:[p.jsxs("span",{className:"text-gray-600",children:[t("financialSummary.totalExpenses"),":"]}),p.jsx("span",{className:"font-medium text-red-600",children:r(i?.operatingExpensesTotal)})]}),p.jsxs("div",{className:"flex justify-between border-t pt-3",children:[p.jsxs("span",{className:"text-gray-600",children:[t("financialSummary.netIncome"),":"]}),p.jsx("span",{className:"font-semibold text-lg",children:r(i?.effectiveNetIncome)})]}),p.jsxs("div",{className:"flex justify-between",children:[p.jsxs("span",{className:"text-gray-600",children:[t("financialSummary.annualDebtService"),":"]}),p.jsx("span",{className:"font-medium text-red-600",children:r(i?.annualDebtService)})]}),p.jsxs("div",{className:"flex justify-between border-t pt-3",children:[p.jsxs("span",{className:"text-gray-600 font-semibold",children:[t("financialSummary.annualCashFlow"),":"]}),p.jsx("span",{className:`font-bold text-lg ${i?.cashFlow>=0?"text-green-600":"text-red-600"}`,children:r(i?.cashFlow)})]})]})]})}function Ef({analysis:i,currentProperty:e,equityAmount:t,scenarioType:r,financing:a={}}){const{t:l}=ft(),u=V=>V==null?"—":new Intl.NumberFormat("fr-CA",{style:"currency",currency:"CAD",minimumFractionDigits:0,maximumFractionDigits:0}).format(V),h=V=>V==null||V===""?"—":`${new Intl.NumberFormat("fr-CA",{minimumFractionDigits:2,maximumFractionDigits:2}).format(parseFloat(V))}%`,m=r===void 0||r!=="initialFinancing",y=r==="renewal",_=l(m?"financingSummary.propertyValue":"financingSummary.purchasePrice"),b=l(m?"financingSummary.trappedEquity":"financingSummary.downPayment"),T=l(r==="optimization"?"financingSummary.financingAndWorksFees":m?"financingSummary.financingFees":"financingSummary.acquisitionFees"),I={conventional:l("financingSummary.conventional"),cmhc:l("financingSummary.cmhc"),cmhc_aph:l("financingSummary.cmhc_aph"),private:l("financingSummary.private")};return p.jsxs("div",{className:"bg-white rounded-lg p-6",children:[p.jsx("h3",{className:"text-lg font-semibold mb-4",children:l("financingSummary.title")}),p.jsxs("div",{className:"space-y-3",children:[a.financingType&&p.jsxs("div",{className:"flex justify-between",children:[p.jsxs("span",{className:"text-gray-600",children:[l("financingSummary.financingType"),":"]}),p.jsx("span",{className:"font-medium",children:I[a.financingType]||a.financingType})]}),a.financingType==="cmhc_aph"&&a.aphPoints&&!y&&p.jsxs("div",{className:"flex justify-between",children:[p.jsxs("span",{className:"text-gray-600",children:[l("financingSummary.aphPoints"),":"]}),p.jsx("span",{className:"font-medium",children:a.aphPoints})]}),a.qualificationRate&&p.jsxs("div",{className:"flex justify-between",children:[p.jsxs("span",{className:"text-gray-600",children:[l("financingSummary.qualificationRate"),":"]}),p.jsx("span",{className:"font-medium",children:h(a.qualificationRate)})]}),a.amortization&&p.jsxs("div",{className:"flex justify-between",children:[p.jsxs("span",{className:"text-gray-600",children:[l("financingSummary.remainingAmortization"),":"]}),p.jsxs("span",{className:"font-medium",children:[a.amortization," ans"]})]}),a.debtCoverageRatio&&!y&&p.jsxs("div",{className:"flex justify-between",children:[p.jsxs("span",{className:"text-gray-600",children:[l("financingSummary.debtCoverageRatio"),":"]}),p.jsx("span",{className:"font-medium",children:a.debtCoverageRatio})]}),a.financingType==="private"&&a.ltvRatio&&p.jsxs("div",{className:"flex justify-between",children:[p.jsxs("span",{className:"text-gray-600",children:[l("financingSummary.ltvRatio"),":"]}),p.jsx("span",{className:"font-medium",children:h(a.ltvRatio)})]}),a.financingType==="private"&&i?.originationFee>0&&p.jsxs("div",{className:"flex justify-between",children:[p.jsxs("span",{className:"text-gray-600",children:[l("financingSummary.originationFee"),":"]}),p.jsx("span",{className:"font-medium",children:u(i.originationFee)})]}),r!=="optimization"&&p.jsxs("div",{className:"flex justify-between",children:[p.jsxs("span",{className:"text-gray-600",children:[_,":"]}),p.jsx("span",{className:"font-medium",children:u(parseFloat(e?.purchasePrice)||0)})]}),!y&&p.jsxs("div",{className:"flex justify-between",children:[p.jsxs("span",{className:"text-gray-600",children:[l("financingSummary.borrowingValue"),":"]}),p.jsx("span",{className:"font-medium",children:u(i?.economicValue)})]}),p.jsxs("div",{className:"flex justify-between",children:[p.jsxs("span",{className:"text-gray-600",children:[l(y?"financingSummary.loanBalance":"financingSummary.maxLoan"),":"]}),p.jsx("span",{className:"font-medium",children:u(y?i?.totalLoanAmount:i?.maxLoanAmount)})]}),!y&&i?.cmhcPremium>0&&p.jsxs("div",{className:"flex justify-between",children:[p.jsxs("span",{className:"text-gray-600",children:[l("financingSummary.cmhcPremium"),":"]}),p.jsx("span",{className:"font-medium",children:u(i?.cmhcPremium)})]}),!y&&i?.cmhcPremium>0&&p.jsxs("div",{className:"flex justify-between",children:[p.jsxs("span",{className:"text-gray-600",children:[l("financingSummary.totalLoanWithPremium"),":"]}),p.jsx("span",{className:"font-medium",children:u(i?.totalLoanAmount)})]}),p.jsxs("div",{className:"flex justify-between",children:[p.jsxs("span",{className:"text-gray-600",children:[b,":"]}),p.jsx("span",{className:"font-medium",children:u(i?.downPayment)})]}),!y&&p.jsxs("div",{className:"flex justify-between",children:[p.jsxs("span",{className:"text-gray-600",children:[T,":"]}),p.jsx("span",{className:"font-medium",children:u(i?.acquisitionCosts)})]}),!y&&(t!==void 0?p.jsxs("div",{className:"flex justify-between border-t pt-3",children:[p.jsxs("span",{className:"text-gray-600 font-semibold",children:[l("financingSummary.equityWithdrawal"),":"]}),p.jsx("span",{className:`font-bold text-lg ${t>=0?"text-green-600":"text-red-600"}`,children:u(t)})]}):p.jsxs("div",{className:"flex justify-between border-t pt-3",children:[p.jsxs("span",{className:"text-gray-600 font-semibold",children:[l("financingSummary.totalInvestment"),":"]}),p.jsx("span",{className:"font-bold text-lg",children:u(i?.totalInvestment)})]})),p.jsxs("div",{className:"flex justify-between",children:[p.jsx("span",{className:"text-gray-600",children:a.financingType==="private"?l("financingSummary.monthlyPaymentInterestOnly")+":":l("financingSummary.monthlyPayment")+":"}),p.jsx("span",{className:"font-medium",children:u(i?.monthlyPayment)})]})]})]})}function bN({analysis:i}){const{t:e}=ft(),t=[];i?.capRate<4?t.push({type:"danger",icon:p.jsx(rx,{className:"w-5 h-5"}),text:e("recommendations.capRate.veryLow")}):i?.capRate<5?t.push({type:"warning",icon:p.jsx(nx,{className:"w-5 h-5"}),text:e("recommendations.capRate.low")}):t.push({type:"success",icon:p.jsx(ix,{className:"w-5 h-5"}),text:e("recommendations.capRate.good")}),i?.cashFlow<0?t.push({type:"danger",icon:p.jsx(rx,{className:"w-5 h-5"}),text:e("recommendations.cashFlow.negative")}):i?.cashFlow/i?.effectiveNetIncome<.02?t.push({type:"warning",icon:p.jsx(nx,{className:"w-5 h-5"}),text:e("recommendations.cashFlow.low")}):t.push({type:"success",icon:p.jsx(ix,{className:"w-5 h-5"}),text:e("recommendations.cashFlow.good")});const r=a=>{switch(a){case"success":return"bg-green-50 text-green-800 border-green-200";case"warning":return"bg-yellow-50 text-yellow-800 border-yellow-200";case"danger":return"bg-red-50 text-red-800 border-red-200";default:return"bg-gray-50 text-gray-800 border-gray-200"}};return p.jsxs("div",{className:"mt-8",children:[p.jsx("h3",{className:"text-xl font-semibold mb-4",children:e("recommendations.title")}),p.jsx("div",{className:"space-y-3",children:t.map((a,l)=>p.jsxs("div",{className:`flex items-start gap-3 p-4 rounded-lg border ${r(a.type)}`,children:[p.jsx("div",{className:"mt-0.5",children:a.icon}),p.jsx("p",{className:"flex-1 text-sm font-medium",children:a.text})]},l))})]})}function xN({analysis:i,currentProperty:e}){const{t}=ft(),r=l=>l==null?"—":new Intl.NumberFormat("fr-CA",{style:"currency",currency:"CAD",minimumFractionDigits:0,maximumFractionDigits:0}).format(l),a=[e?.address,e?.city,e?.province,e?.postalCode].filter(Boolean).join(", ");return p.jsxs("div",{className:"bg-blue-50 rounded-lg p-6 mt-8",children:[p.jsx("h3",{className:"text-xl font-semibold mb-4",children:t("executiveSummary.title")}),p.jsxs("div",{className:"prose max-w-none text-gray-700",children:[p.jsxs("p",{children:[t("executiveSummary.p1.part1")," ",p.jsxs("strong",{children:[e?.numberOfUnits||0," ",t("executiveSummary.units")]})," ",t("executiveSummary.p1.part2")," ",p.jsx("strong",{children:a||t("executiveSummary.addressNotSpecified")})," ",t("executiveSummary.p1.part3")," ",p.jsx("strong",{children:r(parseFloat(e?.purchasePrice))}),"."]}),p.jsxs("p",{className:"mt-3",children:[t("executiveSummary.p2.part1")," ",p.jsx("strong",{children:r(i?.netOperatingIncome)}),","," ",t("executiveSummary.p2.part2")," ",p.jsxs("strong",{children:[i?.capRate?.toFixed(1),"%"]}),"."," ",t("executiveSummary.p2.part3")," ",p.jsx("strong",{className:i?.cashFlow>=0?"text-green-600":"text-red-600",children:r(i?.cashFlow)})," ",t("executiveSummary.p2.part4")," ",p.jsxs("strong",{children:[i?.cashOnCashReturn?.toFixed(1),"%"]}),"."]}),p.jsxs("p",{className:"mt-3",children:[t("executiveSummary.p3.part1")," ",p.jsx("strong",{children:r(i?.totalInvestment)}),","," ",t("executiveSummary.p3.part2")," ",p.jsx("strong",{children:r(i?.monthlyPayment)}),"."]})]})]})}const EN=()=>{};var lx={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ET=function(i){const e=[];let t=0;for(let r=0;r<i.length;r++){let a=i.charCodeAt(r);a<128?e[t++]=a:a<2048?(e[t++]=a>>6|192,e[t++]=a&63|128):(a&64512)===55296&&r+1<i.length&&(i.charCodeAt(r+1)&64512)===56320?(a=65536+((a&1023)<<10)+(i.charCodeAt(++r)&1023),e[t++]=a>>18|240,e[t++]=a>>12&63|128,e[t++]=a>>6&63|128,e[t++]=a&63|128):(e[t++]=a>>12|224,e[t++]=a>>6&63|128,e[t++]=a&63|128)}return e},TN=function(i){const e=[];let t=0,r=0;for(;t<i.length;){const a=i[t++];if(a<128)e[r++]=String.fromCharCode(a);else if(a>191&&a<224){const l=i[t++];e[r++]=String.fromCharCode((a&31)<<6|l&63)}else if(a>239&&a<365){const l=i[t++],u=i[t++],h=i[t++],m=((a&7)<<18|(l&63)<<12|(u&63)<<6|h&63)-65536;e[r++]=String.fromCharCode(55296+(m>>10)),e[r++]=String.fromCharCode(56320+(m&1023))}else{const l=i[t++],u=i[t++];e[r++]=String.fromCharCode((a&15)<<12|(l&63)<<6|u&63)}}return e.join("")},TT={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(i,e){if(!Array.isArray(i))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let a=0;a<i.length;a+=3){const l=i[a],u=a+1<i.length,h=u?i[a+1]:0,m=a+2<i.length,y=m?i[a+2]:0,_=l>>2,b=(l&3)<<4|h>>4;let T=(h&15)<<2|y>>6,I=y&63;m||(I=64,u||(T=64)),r.push(t[_],t[b],t[T],t[I])}return r.join("")},encodeString(i,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(i):this.encodeByteArray(ET(i),e)},decodeString(i,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(i):TN(this.decodeStringToByteArray(i,e))},decodeStringToByteArray(i,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let a=0;a<i.length;){const l=t[i.charAt(a++)],h=a<i.length?t[i.charAt(a)]:0;++a;const y=a<i.length?t[i.charAt(a)]:64;++a;const b=a<i.length?t[i.charAt(a)]:64;if(++a,l==null||h==null||y==null||b==null)throw new wN;const T=l<<2|h>>4;if(r.push(T),y!==64){const I=h<<4&240|y>>2;if(r.push(I),b!==64){const V=y<<6&192|b;r.push(V)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let i=0;i<this.ENCODED_VALS.length;i++)this.byteToCharMap_[i]=this.ENCODED_VALS.charAt(i),this.charToByteMap_[this.byteToCharMap_[i]]=i,this.byteToCharMapWebSafe_[i]=this.ENCODED_VALS_WEBSAFE.charAt(i),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[i]]=i,i>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(i)]=i,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(i)]=i)}}};class wN extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const RN=function(i){const e=ET(i);return TT.encodeByteArray(e,!0)},Hd=function(i){return RN(i).replace(/\./g,"")},wT=function(i){try{return TT.decodeString(i,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RT(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SN=()=>RT().__FIREBASE_DEFAULTS__,AN=()=>{if(typeof process>"u"||typeof lx>"u")return;const i=lx.__FIREBASE_DEFAULTS__;if(i)return JSON.parse(i)},IN=()=>{if(typeof document>"u")return;let i;try{i=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=i&&wT(i[1]);return e&&JSON.parse(e)},Tf=()=>{try{return EN()||SN()||AN()||IN()}catch(i){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${i}`);return}},ST=i=>Tf()?.emulatorHosts?.[i],NN=i=>{const e=ST(i);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},AT=()=>Tf()?.config,IT=i=>Tf()?.[`_${i}`];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CN{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tl(i){try{return(i.startsWith("http://")||i.startsWith("https://")?new URL(i).hostname:i).endsWith(".cloudworkstations.dev")}catch{return!1}}async function NT(i){return(await fetch(i,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PN(i,e){if(i.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",a=i.iat||0,l=i.sub||i.user_id;if(!l)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const u={iss:`https://securetoken.google.com/${r}`,aud:r,iat:a,exp:a+3600,auth_time:a,sub:l,user_id:l,firebase:{sign_in_provider:"custom",identities:{}},...i};return[Hd(JSON.stringify(t)),Hd(JSON.stringify(u)),""].join(".")}const Jc={};function DN(){const i={prod:[],emulator:[]};for(const e of Object.keys(Jc))Jc[e]?i.emulator.push(e):i.prod.push(e);return i}function VN(i){let e=document.getElementById(i),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",i),t=!0),{created:t,element:e}}let cx=!1;function CT(i,e){if(typeof window>"u"||typeof document>"u"||!Tl(window.location.host)||Jc[i]===e||Jc[i]||cx)return;Jc[i]=e;function t(T){return`__firebase__banner__${T}`}const r="__firebase__banner",l=DN().prod.length>0;function u(){const T=document.getElementById(r);T&&T.remove()}function h(T){T.style.display="flex",T.style.background="#7faaf0",T.style.position="fixed",T.style.bottom="5px",T.style.left="5px",T.style.padding=".5em",T.style.borderRadius="5px",T.style.alignItems="center"}function m(T,I){T.setAttribute("width","24"),T.setAttribute("id",I),T.setAttribute("height","24"),T.setAttribute("viewBox","0 0 24 24"),T.setAttribute("fill","none"),T.style.marginLeft="-6px"}function y(){const T=document.createElement("span");return T.style.cursor="pointer",T.style.marginLeft="16px",T.style.fontSize="24px",T.innerHTML=" &times;",T.onclick=()=>{cx=!0,u()},T}function _(T,I){T.setAttribute("id",I),T.innerText="Learn more",T.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",T.setAttribute("target","__blank"),T.style.paddingLeft="5px",T.style.textDecoration="underline"}function b(){const T=VN(r),I=t("text"),V=document.getElementById(I)||document.createElement("span"),L=t("learnmore"),O=document.getElementById(L)||document.createElement("a"),Z=t("preprendIcon"),se=document.getElementById(Z)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(T.created){const G=T.element;h(G),_(O,L);const ne=y();m(se,Z),G.append(se,V,O,ne),document.body.appendChild(G)}l?(V.innerText="Preview backend disconnected.",se.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(se.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,V.innerText="Preview backend running in this workspace."),V.setAttribute("id",I)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",b):b()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function en(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function ON(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(en())}function PT(){const i=Tf()?.forceEnvironment;if(i==="node")return!0;if(i==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function MN(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function jN(){const i=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof i=="object"&&i.id!==void 0}function kN(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function LN(){const i=en();return i.indexOf("MSIE ")>=0||i.indexOf("Trident/")>=0}function DT(){return!PT()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function VT(){return!PT()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function OT(){try{return typeof indexedDB=="object"}catch{return!1}}function FN(){return new Promise((i,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",a=self.indexedDB.open(r);a.onsuccess=()=>{a.result.close(),t||self.indexedDB.deleteDatabase(r),i(!0)},a.onupgradeneeded=()=>{t=!1},a.onerror=()=>{e(a.error?.message||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UN="FirebaseError";class jr extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=UN,Object.setPrototypeOf(this,jr.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Iu.prototype.create)}}class Iu{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},a=`${this.service}/${e}`,l=this.errors[e],u=l?zN(l,r):"Error",h=`${this.serviceName}: ${u} (${a}).`;return new jr(a,h,r)}}function zN(i,e){return i.replace(qN,(t,r)=>{const a=e[r];return a!=null?String(a):`<${r}?>`})}const qN=/\{\$([^}]+)}/g;function BN(i){for(const e in i)if(Object.prototype.hasOwnProperty.call(i,e))return!1;return!0}function ka(i,e){if(i===e)return!0;const t=Object.keys(i),r=Object.keys(e);for(const a of t){if(!r.includes(a))return!1;const l=i[a],u=e[a];if(ux(l)&&ux(u)){if(!ka(l,u))return!1}else if(l!==u)return!1}for(const a of r)if(!t.includes(a))return!1;return!0}function ux(i){return i!==null&&typeof i=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nu(i){const e=[];for(const[t,r]of Object.entries(i))Array.isArray(r)?r.forEach(a=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(a))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Hc(i){const e={};return i.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[a,l]=r.split("=");e[decodeURIComponent(a)]=decodeURIComponent(l)}}),e}function Gc(i){const e=i.indexOf("?");if(!e)return"";const t=i.indexOf("#",e);return i.substring(e,t>0?t:void 0)}function HN(i,e){const t=new GN(i,e);return t.subscribe.bind(t)}class GN{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let a;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");KN(e,["next","error","complete"])?a=e:a={next:e,error:t,complete:r},a.next===void 0&&(a.next=tg),a.error===void 0&&(a.error=tg),a.complete===void 0&&(a.complete=tg);const l=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?a.error(this.finalError):a.complete()}catch{}}),this.observers.push(a),l}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function KN(i,e){if(typeof i!="object"||i===null)return!1;for(const t of e)if(t in i&&typeof i[t]=="function")return!0;return!1}function tg(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gt(i){return i&&i._delegate?i._delegate:i}class La{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ta="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YN{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new CN;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const a=this.getOrInitializeService({instanceIdentifier:t});a&&r.resolve(a)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),r=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(a){if(r)return null;throw a}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(QN(e))try{this.getOrInitializeService({instanceIdentifier:Ta})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(t);try{const l=this.getOrInitializeService({instanceIdentifier:a});r.resolve(l)}catch{}}}}clearInstance(e=Ta){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Ta){return this.instances.has(e)}getOptions(e=Ta){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const a=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[l,u]of this.instancesDeferred.entries()){const h=this.normalizeInstanceIdentifier(l);r===h&&u.resolve(a)}return a}onInit(e,t){const r=this.normalizeInstanceIdentifier(t),a=this.onInitCallbacks.get(r)??new Set;a.add(e),this.onInitCallbacks.set(r,a);const l=this.instances.get(r);return l&&e(l,r),()=>{a.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const a of r)try{a(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:$N(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Ta){return this.component?this.component.multipleInstances?e:Ta:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function $N(i){return i===Ta?void 0:i}function QN(i){return i.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XN{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new YN(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ge;(function(i){i[i.DEBUG=0]="DEBUG",i[i.VERBOSE=1]="VERBOSE",i[i.INFO=2]="INFO",i[i.WARN=3]="WARN",i[i.ERROR=4]="ERROR",i[i.SILENT=5]="SILENT"})(Ge||(Ge={}));const WN={debug:Ge.DEBUG,verbose:Ge.VERBOSE,info:Ge.INFO,warn:Ge.WARN,error:Ge.ERROR,silent:Ge.SILENT},JN=Ge.INFO,ZN={[Ge.DEBUG]:"log",[Ge.VERBOSE]:"log",[Ge.INFO]:"info",[Ge.WARN]:"warn",[Ge.ERROR]:"error"},eC=(i,e,...t)=>{if(e<i.logLevel)return;const r=new Date().toISOString(),a=ZN[e];if(a)console[a](`[${r}]  ${i.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class py{constructor(e){this.name=e,this._logLevel=JN,this._logHandler=eC,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ge))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?WN[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ge.DEBUG,...e),this._logHandler(this,Ge.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ge.VERBOSE,...e),this._logHandler(this,Ge.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ge.INFO,...e),this._logHandler(this,Ge.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ge.WARN,...e),this._logHandler(this,Ge.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ge.ERROR,...e),this._logHandler(this,Ge.ERROR,...e)}}const tC=(i,e)=>e.some(t=>i instanceof t);let hx,dx;function nC(){return hx||(hx=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function iC(){return dx||(dx=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const MT=new WeakMap,Sg=new WeakMap,jT=new WeakMap,ng=new WeakMap,gy=new WeakMap;function rC(i){const e=new Promise((t,r)=>{const a=()=>{i.removeEventListener("success",l),i.removeEventListener("error",u)},l=()=>{t(Ns(i.result)),a()},u=()=>{r(i.error),a()};i.addEventListener("success",l),i.addEventListener("error",u)});return e.then(t=>{t instanceof IDBCursor&&MT.set(t,i)}).catch(()=>{}),gy.set(e,i),e}function sC(i){if(Sg.has(i))return;const e=new Promise((t,r)=>{const a=()=>{i.removeEventListener("complete",l),i.removeEventListener("error",u),i.removeEventListener("abort",u)},l=()=>{t(),a()},u=()=>{r(i.error||new DOMException("AbortError","AbortError")),a()};i.addEventListener("complete",l),i.addEventListener("error",u),i.addEventListener("abort",u)});Sg.set(i,e)}let Ag={get(i,e,t){if(i instanceof IDBTransaction){if(e==="done")return Sg.get(i);if(e==="objectStoreNames")return i.objectStoreNames||jT.get(i);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Ns(i[e])},set(i,e,t){return i[e]=t,!0},has(i,e){return i instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in i}};function aC(i){Ag=i(Ag)}function oC(i){return i===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=i.call(ig(this),e,...t);return jT.set(r,e.sort?e.sort():[e]),Ns(r)}:iC().includes(i)?function(...e){return i.apply(ig(this),e),Ns(MT.get(this))}:function(...e){return Ns(i.apply(ig(this),e))}}function lC(i){return typeof i=="function"?oC(i):(i instanceof IDBTransaction&&sC(i),tC(i,nC())?new Proxy(i,Ag):i)}function Ns(i){if(i instanceof IDBRequest)return rC(i);if(ng.has(i))return ng.get(i);const e=lC(i);return e!==i&&(ng.set(i,e),gy.set(e,i)),e}const ig=i=>gy.get(i);function cC(i,e,{blocked:t,upgrade:r,blocking:a,terminated:l}={}){const u=indexedDB.open(i,e),h=Ns(u);return r&&u.addEventListener("upgradeneeded",m=>{r(Ns(u.result),m.oldVersion,m.newVersion,Ns(u.transaction),m)}),t&&u.addEventListener("blocked",m=>t(m.oldVersion,m.newVersion,m)),h.then(m=>{l&&m.addEventListener("close",()=>l()),a&&m.addEventListener("versionchange",y=>a(y.oldVersion,y.newVersion,y))}).catch(()=>{}),h}const uC=["get","getKey","getAll","getAllKeys","count"],hC=["put","add","delete","clear"],rg=new Map;function fx(i,e){if(!(i instanceof IDBDatabase&&!(e in i)&&typeof e=="string"))return;if(rg.get(e))return rg.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,a=hC.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(a||uC.includes(t)))return;const l=async function(u,...h){const m=this.transaction(u,a?"readwrite":"readonly");let y=m.store;return r&&(y=y.index(h.shift())),(await Promise.all([y[t](...h),a&&m.done]))[0]};return rg.set(e,l),l}aC(i=>({...i,get:(e,t,r)=>fx(e,t)||i.get(e,t,r),has:(e,t)=>!!fx(e,t)||i.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dC{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(fC(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function fC(i){return i.getComponent()?.type==="VERSION"}const Ig="@firebase/app",mx="0.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cr=new py("@firebase/app"),mC="@firebase/app-compat",pC="@firebase/analytics-compat",gC="@firebase/analytics",yC="@firebase/app-check-compat",vC="@firebase/app-check",_C="@firebase/auth",bC="@firebase/auth-compat",xC="@firebase/database",EC="@firebase/data-connect",TC="@firebase/database-compat",wC="@firebase/functions",RC="@firebase/functions-compat",SC="@firebase/installations",AC="@firebase/installations-compat",IC="@firebase/messaging",NC="@firebase/messaging-compat",CC="@firebase/performance",PC="@firebase/performance-compat",DC="@firebase/remote-config",VC="@firebase/remote-config-compat",OC="@firebase/storage",MC="@firebase/storage-compat",jC="@firebase/firestore",kC="@firebase/ai",LC="@firebase/firestore-compat",FC="firebase",UC="12.1.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ng="[DEFAULT]",zC={[Ig]:"fire-core",[mC]:"fire-core-compat",[gC]:"fire-analytics",[pC]:"fire-analytics-compat",[vC]:"fire-app-check",[yC]:"fire-app-check-compat",[_C]:"fire-auth",[bC]:"fire-auth-compat",[xC]:"fire-rtdb",[EC]:"fire-data-connect",[TC]:"fire-rtdb-compat",[wC]:"fire-fn",[RC]:"fire-fn-compat",[SC]:"fire-iid",[AC]:"fire-iid-compat",[IC]:"fire-fcm",[NC]:"fire-fcm-compat",[CC]:"fire-perf",[PC]:"fire-perf-compat",[DC]:"fire-rc",[VC]:"fire-rc-compat",[OC]:"fire-gcs",[MC]:"fire-gcs-compat",[jC]:"fire-fst",[LC]:"fire-fst-compat",[kC]:"fire-vertex","fire-js":"fire-js",[FC]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gd=new Map,qC=new Map,Cg=new Map;function px(i,e){try{i.container.addComponent(e)}catch(t){Cr.debug(`Component ${e.name} failed to register with FirebaseApp ${i.name}`,t)}}function ll(i){const e=i.name;if(Cg.has(e))return Cr.debug(`There were multiple attempts to register component ${e}.`),!1;Cg.set(e,i);for(const t of Gd.values())px(t,i);for(const t of qC.values())px(t,i);return!0}function yy(i,e){const t=i.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),i.container.getProvider(e)}function Wn(i){return i==null?!1:i.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BC={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Cs=new Iu("app","Firebase",BC);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HC{constructor(e,t,r){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new La("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Cs.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wl=UC;function kT(i,e={}){let t=i;typeof e!="object"&&(e={name:e});const r={name:Ng,automaticDataCollectionEnabled:!0,...e},a=r.name;if(typeof a!="string"||!a)throw Cs.create("bad-app-name",{appName:String(a)});if(t||(t=AT()),!t)throw Cs.create("no-options");const l=Gd.get(a);if(l){if(ka(t,l.options)&&ka(r,l.config))return l;throw Cs.create("duplicate-app",{appName:a})}const u=new XN(a);for(const m of Cg.values())u.addComponent(m);const h=new HC(t,r,u);return Gd.set(a,h),h}function LT(i=Ng){const e=Gd.get(i);if(!e&&i===Ng&&AT())return kT();if(!e)throw Cs.create("no-app",{appName:i});return e}function Ps(i,e,t){let r=zC[i]??i;t&&(r+=`-${t}`);const a=r.match(/\s|\//),l=e.match(/\s|\//);if(a||l){const u=[`Unable to register library "${r}" with version "${e}":`];a&&u.push(`library name "${r}" contains illegal characters (whitespace or "/")`),a&&l&&u.push("and"),l&&u.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Cr.warn(u.join(" "));return}ll(new La(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GC="firebase-heartbeat-database",KC=1,uu="firebase-heartbeat-store";let sg=null;function FT(){return sg||(sg=cC(GC,KC,{upgrade:(i,e)=>{switch(e){case 0:try{i.createObjectStore(uu)}catch(t){console.warn(t)}}}}).catch(i=>{throw Cs.create("idb-open",{originalErrorMessage:i.message})})),sg}async function YC(i){try{const t=(await FT()).transaction(uu),r=await t.objectStore(uu).get(UT(i));return await t.done,r}catch(e){if(e instanceof jr)Cr.warn(e.message);else{const t=Cs.create("idb-get",{originalErrorMessage:e?.message});Cr.warn(t.message)}}}async function gx(i,e){try{const r=(await FT()).transaction(uu,"readwrite");await r.objectStore(uu).put(e,UT(i)),await r.done}catch(t){if(t instanceof jr)Cr.warn(t.message);else{const r=Cs.create("idb-set",{originalErrorMessage:t?.message});Cr.warn(r.message)}}}function UT(i){return`${i.name}!${i.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $C=1024,QC=30;class XC{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new JC(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=yx();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(a=>a.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:t}),this._heartbeatsCache.heartbeats.length>QC){const a=ZC(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(a,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Cr.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=yx(),{heartbeatsToSend:t,unsentEntries:r}=WC(this._heartbeatsCache.heartbeats),a=Hd(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),a}catch(e){return Cr.warn(e),""}}}function yx(){return new Date().toISOString().substring(0,10)}function WC(i,e=$C){const t=[];let r=i.slice();for(const a of i){const l=t.find(u=>u.agent===a.agent);if(l){if(l.dates.push(a.date),vx(t)>e){l.dates.pop();break}}else if(t.push({agent:a.agent,dates:[a.date]}),vx(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class JC{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return OT()?FN().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await YC(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return gx(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return gx(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function vx(i){return Hd(JSON.stringify({version:2,heartbeats:i})).length}function ZC(i){if(i.length===0)return-1;let e=0,t=i[0].date;for(let r=1;r<i.length;r++)i[r].date<t&&(t=i[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function e2(i){ll(new La("platform-logger",e=>new dC(e),"PRIVATE")),ll(new La("heartbeat",e=>new XC(e),"PRIVATE")),Ps(Ig,mx,i),Ps(Ig,mx,"esm2020"),Ps("fire-js","")}e2("");var t2="firebase",n2="12.1.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ps(t2,n2,"app");function zT(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const i2=zT,qT=new Iu("auth","Firebase",zT());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kd=new py("@firebase/auth");function r2(i,...e){Kd.logLevel<=Ge.WARN&&Kd.warn(`Auth (${wl}): ${i}`,...e)}function Sd(i,...e){Kd.logLevel<=Ge.ERROR&&Kd.error(`Auth (${wl}): ${i}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vi(i,...e){throw _y(i,...e)}function Si(i,...e){return _y(i,...e)}function vy(i,e,t){const r={...i2(),[e]:t};return new Iu("auth","Firebase",r).create(e,{appName:i.name})}function Nr(i){return vy(i,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function s2(i,e,t){const r=t;if(!(e instanceof r))throw r.name!==e.constructor.name&&vi(i,"argument-error"),vy(i,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function _y(i,...e){if(typeof i!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=i.name),i._errorFactory.create(t,...r)}return qT.create(i,...e)}function Ce(i,e,...t){if(!i)throw _y(e,...t)}function Sr(i){const e="INTERNAL ASSERTION FAILED: "+i;throw Sd(e),new Error(e)}function Pr(i,e){i||Sr(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pg(){return typeof self<"u"&&self.location?.href||""}function a2(){return _x()==="http:"||_x()==="https:"}function _x(){return typeof self<"u"&&self.location?.protocol||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function o2(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(a2()||jN()||"connection"in navigator)?navigator.onLine:!0}function l2(){if(typeof navigator>"u")return null;const i=navigator;return i.languages&&i.languages[0]||i.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cu{constructor(e,t){this.shortDelay=e,this.longDelay=t,Pr(t>e,"Short delay should be less than long delay!"),this.isMobile=ON()||kN()}get(){return o2()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function by(i,e){Pr(i.emulator,"Emulator should always be set here");const{url:t}=i.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BT{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Sr("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Sr("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Sr("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c2={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u2=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],h2=new Cu(3e4,6e4);function kr(i,e){return i.tenantId&&!e.tenantId?{...e,tenantId:i.tenantId}:e}async function Lr(i,e,t,r,a={}){return HT(i,a,async()=>{let l={},u={};r&&(e==="GET"?u=r:l={body:JSON.stringify(r)});const h=Nu({key:i.config.apiKey,...u}).slice(1),m=await i._getAdditionalHeaders();m["Content-Type"]="application/json",i.languageCode&&(m["X-Firebase-Locale"]=i.languageCode);const y={method:e,headers:m,...l};return MN()||(y.referrerPolicy="no-referrer"),i.emulatorConfig&&Tl(i.emulatorConfig.host)&&(y.credentials="include"),BT.fetch()(await GT(i,i.config.apiHost,t,h),y)})}async function HT(i,e,t){i._canInitEmulator=!1;const r={...c2,...e};try{const a=new f2(i),l=await Promise.race([t(),a.promise]);a.clearNetworkTimeout();const u=await l.json();if("needConfirmation"in u)throw gd(i,"account-exists-with-different-credential",u);if(l.ok&&!("errorMessage"in u))return u;{const h=l.ok?u.errorMessage:u.error.message,[m,y]=h.split(" : ");if(m==="FEDERATED_USER_ID_ALREADY_LINKED")throw gd(i,"credential-already-in-use",u);if(m==="EMAIL_EXISTS")throw gd(i,"email-already-in-use",u);if(m==="USER_DISABLED")throw gd(i,"user-disabled",u);const _=r[m]||m.toLowerCase().replace(/[_\s]+/g,"-");if(y)throw vy(i,_,y);vi(i,_)}}catch(a){if(a instanceof jr)throw a;vi(i,"network-request-failed",{message:String(a)})}}async function Pu(i,e,t,r,a={}){const l=await Lr(i,e,t,r,a);return"mfaPendingCredential"in l&&vi(i,"multi-factor-auth-required",{_serverResponse:l}),l}async function GT(i,e,t,r){const a=`${e}${t}?${r}`,l=i,u=l.config.emulator?by(i.config,a):`${i.config.apiScheme}://${a}`;return u2.includes(t)&&(await l._persistenceManagerAvailable,l._getPersistenceType()==="COOKIE")?l._getPersistence()._getFinalTarget(u).toString():u}function d2(i){switch(i){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class f2{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(Si(this.auth,"network-request-failed")),h2.get())})}}function gd(i,e,t){const r={appName:i.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const a=Si(i,e,r);return a.customData._tokenResponse=t,a}function bx(i){return i!==void 0&&i.enterprise!==void 0}class m2{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return d2(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function p2(i,e){return Lr(i,"GET","/v2/recaptchaConfig",kr(i,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function g2(i,e){return Lr(i,"POST","/v1/accounts:delete",e)}async function Yd(i,e){return Lr(i,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zc(i){if(i)try{const e=new Date(Number(i));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function y2(i,e=!1){const t=Gt(i),r=await t.getIdToken(e),a=xy(r);Ce(a&&a.exp&&a.auth_time&&a.iat,t.auth,"internal-error");const l=typeof a.firebase=="object"?a.firebase:void 0,u=l?.sign_in_provider;return{claims:a,token:r,authTime:Zc(ag(a.auth_time)),issuedAtTime:Zc(ag(a.iat)),expirationTime:Zc(ag(a.exp)),signInProvider:u||null,signInSecondFactor:l?.sign_in_second_factor||null}}function ag(i){return Number(i)*1e3}function xy(i){const[e,t,r]=i.split(".");if(e===void 0||t===void 0||r===void 0)return Sd("JWT malformed, contained fewer than 3 sections"),null;try{const a=wT(t);return a?JSON.parse(a):(Sd("Failed to decode base64 JWT payload"),null)}catch(a){return Sd("Caught error parsing JWT payload as JSON",a?.toString()),null}}function xx(i){const e=xy(i);return Ce(e,"internal-error"),Ce(typeof e.exp<"u","internal-error"),Ce(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hu(i,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof jr&&v2(r)&&i.auth.currentUser===i&&await i.auth.signOut(),r}}function v2({code:i}){return i==="auth/user-disabled"||i==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _2{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dg{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Zc(this.lastLoginAt),this.creationTime=Zc(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $d(i){const e=i.auth,t=await i.getIdToken(),r=await hu(i,Yd(e,{idToken:t}));Ce(r?.users.length,e,"internal-error");const a=r.users[0];i._notifyReloadListener(a);const l=a.providerUserInfo?.length?KT(a.providerUserInfo):[],u=x2(i.providerData,l),h=i.isAnonymous,m=!(i.email&&a.passwordHash)&&!u?.length,y=h?m:!1,_={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:u,metadata:new Dg(a.createdAt,a.lastLoginAt),isAnonymous:y};Object.assign(i,_)}async function b2(i){const e=Gt(i);await $d(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function x2(i,e){return[...i.filter(r=>!e.some(a=>a.providerId===r.providerId)),...e]}function KT(i){return i.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function E2(i,e){const t=await HT(i,{},async()=>{const r=Nu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:a,apiKey:l}=i.config,u=await GT(i,a,"/v1/token",`key=${l}`),h=await i._getAdditionalHeaders();h["Content-Type"]="application/x-www-form-urlencoded";const m={method:"POST",headers:h,body:r};return i.emulatorConfig&&Tl(i.emulatorConfig.host)&&(m.credentials="include"),BT.fetch()(u,m)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function T2(i,e){return Lr(i,"POST","/v2/accounts:revokeToken",kr(i,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rl{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Ce(e.idToken,"internal-error"),Ce(typeof e.idToken<"u","internal-error"),Ce(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):xx(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Ce(e.length!==0,"internal-error");const t=xx(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Ce(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:a,expiresIn:l}=await E2(e,t);this.updateTokensAndExpiration(r,a,Number(l))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:a,expirationTime:l}=t,u=new rl;return r&&(Ce(typeof r=="string","internal-error",{appName:e}),u.refreshToken=r),a&&(Ce(typeof a=="string","internal-error",{appName:e}),u.accessToken=a),l&&(Ce(typeof l=="number","internal-error",{appName:e}),u.expirationTime=l),u}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new rl,this.toJSON())}_performRefresh(){return Sr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ys(i,e){Ce(typeof i=="string"||typeof i>"u","internal-error",{appName:e})}class Ri{constructor({uid:e,auth:t,stsTokenManager:r,...a}){this.providerId="firebase",this.proactiveRefresh=new _2(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=a.displayName||null,this.email=a.email||null,this.emailVerified=a.emailVerified||!1,this.phoneNumber=a.phoneNumber||null,this.photoURL=a.photoURL||null,this.isAnonymous=a.isAnonymous||!1,this.tenantId=a.tenantId||null,this.providerData=a.providerData?[...a.providerData]:[],this.metadata=new Dg(a.createdAt||void 0,a.lastLoginAt||void 0)}async getIdToken(e){const t=await hu(this,this.stsTokenManager.getToken(this.auth,e));return Ce(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return y2(this,e)}reload(){return b2(this)}_assign(e){this!==e&&(Ce(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Ri({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){Ce(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await $d(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Wn(this.auth.app))return Promise.reject(Nr(this.auth));const e=await this.getIdToken();return await hu(this,g2(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const r=t.displayName??void 0,a=t.email??void 0,l=t.phoneNumber??void 0,u=t.photoURL??void 0,h=t.tenantId??void 0,m=t._redirectEventId??void 0,y=t.createdAt??void 0,_=t.lastLoginAt??void 0,{uid:b,emailVerified:T,isAnonymous:I,providerData:V,stsTokenManager:L}=t;Ce(b&&L,e,"internal-error");const O=rl.fromJSON(this.name,L);Ce(typeof b=="string",e,"internal-error"),ys(r,e.name),ys(a,e.name),Ce(typeof T=="boolean",e,"internal-error"),Ce(typeof I=="boolean",e,"internal-error"),ys(l,e.name),ys(u,e.name),ys(h,e.name),ys(m,e.name),ys(y,e.name),ys(_,e.name);const Z=new Ri({uid:b,auth:e,email:a,emailVerified:T,displayName:r,isAnonymous:I,photoURL:u,phoneNumber:l,tenantId:h,stsTokenManager:O,createdAt:y,lastLoginAt:_});return V&&Array.isArray(V)&&(Z.providerData=V.map(se=>({...se}))),m&&(Z._redirectEventId=m),Z}static async _fromIdTokenResponse(e,t,r=!1){const a=new rl;a.updateFromServerResponse(t);const l=new Ri({uid:t.localId,auth:e,stsTokenManager:a,isAnonymous:r});return await $d(l),l}static async _fromGetAccountInfoResponse(e,t,r){const a=t.users[0];Ce(a.localId!==void 0,"internal-error");const l=a.providerUserInfo!==void 0?KT(a.providerUserInfo):[],u=!(a.email&&a.passwordHash)&&!l?.length,h=new rl;h.updateFromIdToken(r);const m=new Ri({uid:a.localId,auth:e,stsTokenManager:h,isAnonymous:u}),y={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:l,metadata:new Dg(a.createdAt,a.lastLoginAt),isAnonymous:!(a.email&&a.passwordHash)&&!l?.length};return Object.assign(m,y),m}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ex=new Map;function Ar(i){Pr(i instanceof Function,"Expected a class definition");let e=Ex.get(i);return e?(Pr(e instanceof i,"Instance stored in cache mismatched with class"),e):(e=new i,Ex.set(i,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YT{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}YT.type="NONE";const Tx=YT;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ad(i,e,t){return`firebase:${i}:${e}:${t}`}class sl{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:a,name:l}=this.auth;this.fullUserKey=Ad(this.userKey,a.apiKey,l),this.fullPersistenceKey=Ad("persistence",a.apiKey,l),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Yd(this.auth,{idToken:e}).catch(()=>{});return t?Ri._fromGetAccountInfoResponse(this.auth,t,e):null}return Ri._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new sl(Ar(Tx),e,r);const a=(await Promise.all(t.map(async y=>{if(await y._isAvailable())return y}))).filter(y=>y);let l=a[0]||Ar(Tx);const u=Ad(r,e.config.apiKey,e.name);let h=null;for(const y of t)try{const _=await y._get(u);if(_){let b;if(typeof _=="string"){const T=await Yd(e,{idToken:_}).catch(()=>{});if(!T)break;b=await Ri._fromGetAccountInfoResponse(e,T,_)}else b=Ri._fromJSON(e,_);y!==l&&(h=b),l=y;break}}catch{}const m=a.filter(y=>y._shouldAllowMigration);return!l._shouldAllowMigration||!m.length?new sl(l,e,r):(l=m[0],h&&await l._set(u,h.toJSON()),await Promise.all(t.map(async y=>{if(y!==l)try{await y._remove(u)}catch{}})),new sl(l,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wx(i){const e=i.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(WT(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if($T(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(ZT(e))return"Blackberry";if(ew(e))return"Webos";if(QT(e))return"Safari";if((e.includes("chrome/")||XT(e))&&!e.includes("edge/"))return"Chrome";if(JT(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=i.match(t);if(r?.length===2)return r[1]}return"Other"}function $T(i=en()){return/firefox\//i.test(i)}function QT(i=en()){const e=i.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function XT(i=en()){return/crios\//i.test(i)}function WT(i=en()){return/iemobile/i.test(i)}function JT(i=en()){return/android/i.test(i)}function ZT(i=en()){return/blackberry/i.test(i)}function ew(i=en()){return/webos/i.test(i)}function Ey(i=en()){return/iphone|ipad|ipod/i.test(i)||/macintosh/i.test(i)&&/mobile/i.test(i)}function w2(i=en()){return Ey(i)&&!!window.navigator?.standalone}function R2(){return LN()&&document.documentMode===10}function tw(i=en()){return Ey(i)||JT(i)||ew(i)||ZT(i)||/windows phone/i.test(i)||WT(i)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nw(i,e=[]){let t;switch(i){case"Browser":t=wx(en());break;case"Worker":t=`${wx(en())}-${i}`;break;default:t=i}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${wl}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S2{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=l=>new Promise((u,h)=>{try{const m=e(l);u(m)}catch(m){h(m)}});r.onAbort=t,this.queue.push(r);const a=this.queue.length-1;return()=>{this.queue[a]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const a of t)try{a()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function A2(i,e={}){return Lr(i,"GET","/v2/passwordPolicy",kr(i,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const I2=6;class N2{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??I2,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,a=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),a&&(t.meetsMaxPasswordLength=e.length<=a)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let a=0;a<e.length;a++)r=e.charAt(a),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,a,l){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=a)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C2{constructor(e,t,r,a){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=a,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Rx(this),this.idTokenSubscription=new Rx(this),this.beforeStateQueue=new S2(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=qT,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=a.sdkClientVersion,this._persistenceManagerAvailable=new Promise(l=>this._resolvePersistenceManagerAvailable=l)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Ar(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await sl.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Yd(this,{idToken:e}),r=await Ri._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Wn(this.app)){const l=this.app.settings.authIdToken;return l?new Promise(u=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(l).then(u,u))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let r=t,a=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const l=this.redirectUser?._redirectEventId,u=r?._redirectEventId,h=await this.tryRedirectSignIn(e);(!l||l===u)&&h?.user&&(r=h.user,a=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(a)try{await this.beforeStateQueue.runMiddleware(r)}catch(l){r=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(l))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return Ce(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await $d(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=l2()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Wn(this.app))return Promise.reject(Nr(this));const t=e?Gt(e):null;return t&&Ce(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Ce(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Wn(this.app)?Promise.reject(Nr(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Wn(this.app)?Promise.reject(Nr(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Ar(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await A2(this),t=new N2(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Iu("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await T2(this,r)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Ar(e)||this._popupRedirectResolver;Ce(t,this,"argument-error"),this.redirectPersistenceManager=await sl.create(this,[Ar(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,a){if(this._deleted)return()=>{};const l=typeof t=="function"?t:t.next.bind(t);let u=!1;const h=this._isInitialized?Promise.resolve():this._initializationPromise;if(Ce(h,this,"internal-error"),h.then(()=>{u||l(this.currentUser)}),typeof t=="function"){const m=e.addObserver(t,r,a);return()=>{u=!0,m()}}else{const m=e.addObserver(t);return()=>{u=!0,m()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Ce(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=nw(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){if(Wn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&r2(`Error while retrieving App Check token: ${e.error}`),e?.token}}function Fr(i){return Gt(i)}class Rx{constructor(e){this.auth=e,this.observer=null,this.addObserver=HN(t=>this.observer=t)}get next(){return Ce(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let wf={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function P2(i){wf=i}function iw(i){return wf.loadJS(i)}function D2(){return wf.recaptchaEnterpriseScript}function V2(){return wf.gapiScript}function O2(i){return`__${i}${Math.floor(Math.random()*1e6)}`}class M2{constructor(){this.enterprise=new j2}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class j2{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const k2="recaptcha-enterprise",rw="NO_RECAPTCHA";class L2{constructor(e){this.type=k2,this.auth=Fr(e)}async verify(e="verify",t=!1){async function r(l){if(!t){if(l.tenantId==null&&l._agentRecaptchaConfig!=null)return l._agentRecaptchaConfig.siteKey;if(l.tenantId!=null&&l._tenantRecaptchaConfigs[l.tenantId]!==void 0)return l._tenantRecaptchaConfigs[l.tenantId].siteKey}return new Promise(async(u,h)=>{p2(l,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(m=>{if(m.recaptchaKey===void 0)h(new Error("recaptcha Enterprise site key undefined"));else{const y=new m2(m);return l.tenantId==null?l._agentRecaptchaConfig=y:l._tenantRecaptchaConfigs[l.tenantId]=y,u(y.siteKey)}}).catch(m=>{h(m)})})}function a(l,u,h){const m=window.grecaptcha;bx(m)?m.enterprise.ready(()=>{m.enterprise.execute(l,{action:e}).then(y=>{u(y)}).catch(()=>{u(rw)})}):h(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new M2().execute("siteKey",{action:"verify"}):new Promise((l,u)=>{r(this.auth).then(h=>{if(!t&&bx(window.grecaptcha))a(h,l,u);else{if(typeof window>"u"){u(new Error("RecaptchaVerifier is only supported in browser"));return}let m=D2();m.length!==0&&(m+=h),iw(m).then(()=>{a(h,l,u)}).catch(y=>{u(y)})}}).catch(h=>{u(h)})})}}async function Sx(i,e,t,r=!1,a=!1){const l=new L2(i);let u;if(a)u=rw;else try{u=await l.verify(t)}catch{u=await l.verify(t,!0)}const h={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in h){const m=h.phoneEnrollmentInfo.phoneNumber,y=h.phoneEnrollmentInfo.recaptchaToken;Object.assign(h,{phoneEnrollmentInfo:{phoneNumber:m,recaptchaToken:y,captchaResponse:u,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in h){const m=h.phoneSignInInfo.recaptchaToken;Object.assign(h,{phoneSignInInfo:{recaptchaToken:m,captchaResponse:u,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return h}return r?Object.assign(h,{captchaResp:u}):Object.assign(h,{captchaResponse:u}),Object.assign(h,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(h,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),h}async function Qd(i,e,t,r,a){if(i._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const l=await Sx(i,e,t,t==="getOobCode");return r(i,l)}else return r(i,e).catch(async l=>{if(l.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const u=await Sx(i,e,t,t==="getOobCode");return r(i,u)}else return Promise.reject(l)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function F2(i,e){const t=yy(i,"auth");if(t.isInitialized()){const a=t.getImmediate(),l=t.getOptions();if(ka(l,e??{}))return a;vi(a,"already-initialized")}return t.initialize({options:e})}function U2(i,e){const t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(Ar);e?.errorMap&&i._updateErrorMap(e.errorMap),i._initializeWithPersistence(r,e?.popupRedirectResolver)}function z2(i,e,t){const r=Fr(i);Ce(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const a=!1,l=sw(e),{host:u,port:h}=q2(e),m=h===null?"":`:${h}`,y={url:`${l}//${u}${m}/`},_=Object.freeze({host:u,port:h,protocol:l.replace(":",""),options:Object.freeze({disableWarnings:a})});if(!r._canInitEmulator){Ce(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),Ce(ka(y,r.config.emulator)&&ka(_,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=y,r.emulatorConfig=_,r.settings.appVerificationDisabledForTesting=!0,Tl(u)?(NT(`${l}//${u}${m}`),CT("Auth",!0)):B2()}function sw(i){const e=i.indexOf(":");return e<0?"":i.substr(0,e+1)}function q2(i){const e=sw(i),t=/(\/\/)?([^?#/]+)/.exec(i.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",a=/^(\[[^\]]+\])(:|$)/.exec(r);if(a){const l=a[1];return{host:l,port:Ax(r.substr(l.length+1))}}else{const[l,u]=r.split(":");return{host:l,port:Ax(u)}}}function Ax(i){if(!i)return null;const e=Number(i);return isNaN(e)?null:e}function B2(){function i(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",i):i())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ty{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Sr("not implemented")}_getIdTokenResponse(e){return Sr("not implemented")}_linkToIdToken(e,t){return Sr("not implemented")}_getReauthenticationResolver(e){return Sr("not implemented")}}async function H2(i,e){return Lr(i,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function G2(i,e){return Pu(i,"POST","/v1/accounts:signInWithPassword",kr(i,e))}async function K2(i,e){return Lr(i,"POST","/v1/accounts:sendOobCode",kr(i,e))}async function Y2(i,e){return K2(i,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $2(i,e){return Pu(i,"POST","/v1/accounts:signInWithEmailLink",kr(i,e))}async function Q2(i,e){return Pu(i,"POST","/v1/accounts:signInWithEmailLink",kr(i,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class du extends Ty{constructor(e,t,r,a=null){super("password",r),this._email=e,this._password=t,this._tenantId=a}static _fromEmailAndPassword(e,t){return new du(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new du(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Qd(e,t,"signInWithPassword",G2);case"emailLink":return $2(e,{email:this._email,oobCode:this._password});default:vi(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Qd(e,r,"signUpPassword",H2);case"emailLink":return Q2(e,{idToken:t,email:this._email,oobCode:this._password});default:vi(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function al(i,e){return Pu(i,"POST","/v1/accounts:signInWithIdp",kr(i,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X2="http://localhost";class Fa extends Ty{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Fa(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):vi("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:a,...l}=t;if(!r||!a)return null;const u=new Fa(r,a);return u.idToken=l.idToken||void 0,u.accessToken=l.accessToken||void 0,u.secret=l.secret,u.nonce=l.nonce,u.pendingToken=l.pendingToken||null,u}_getIdTokenResponse(e){const t=this.buildRequest();return al(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,al(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,al(e,t)}buildRequest(){const e={requestUri:X2,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Nu(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function W2(i){switch(i){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function J2(i){const e=Hc(Gc(i)).link,t=e?Hc(Gc(e)).deep_link_id:null,r=Hc(Gc(i)).deep_link_id;return(r?Hc(Gc(r)).link:null)||r||t||e||i}class wy{constructor(e){const t=Hc(Gc(e)),r=t.apiKey??null,a=t.oobCode??null,l=W2(t.mode??null);Ce(r&&a&&l,"argument-error"),this.apiKey=r,this.operation=l,this.code=a,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=J2(e);try{return new wy(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rl{constructor(){this.providerId=Rl.PROVIDER_ID}static credential(e,t){return du._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const r=wy.parseLink(t);return Ce(r,"argument-error"),du._fromEmailAndCode(e,r.code,r.tenantId)}}Rl.PROVIDER_ID="password";Rl.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Rl.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ry{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Du extends Ry{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xs extends Du{constructor(){super("facebook.com")}static credential(e){return Fa._fromParams({providerId:xs.PROVIDER_ID,signInMethod:xs.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return xs.credentialFromTaggedObject(e)}static credentialFromError(e){return xs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return xs.credential(e.oauthAccessToken)}catch{return null}}}xs.FACEBOOK_SIGN_IN_METHOD="facebook.com";xs.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rr extends Du{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Fa._fromParams({providerId:Rr.PROVIDER_ID,signInMethod:Rr.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Rr.credentialFromTaggedObject(e)}static credentialFromError(e){return Rr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return Rr.credential(t,r)}catch{return null}}}Rr.GOOGLE_SIGN_IN_METHOD="google.com";Rr.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Es extends Du{constructor(){super("github.com")}static credential(e){return Fa._fromParams({providerId:Es.PROVIDER_ID,signInMethod:Es.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Es.credentialFromTaggedObject(e)}static credentialFromError(e){return Es.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Es.credential(e.oauthAccessToken)}catch{return null}}}Es.GITHUB_SIGN_IN_METHOD="github.com";Es.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ts extends Du{constructor(){super("twitter.com")}static credential(e,t){return Fa._fromParams({providerId:Ts.PROVIDER_ID,signInMethod:Ts.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Ts.credentialFromTaggedObject(e)}static credentialFromError(e){return Ts.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return Ts.credential(t,r)}catch{return null}}}Ts.TWITTER_SIGN_IN_METHOD="twitter.com";Ts.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Z2(i,e){return Pu(i,"POST","/v1/accounts:signUp",kr(i,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ua{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,a=!1){const l=await Ri._fromIdTokenResponse(e,r,a),u=Ix(r);return new Ua({user:l,providerId:u,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const a=Ix(r);return new Ua({user:e,providerId:a,_tokenResponse:r,operationType:t})}}function Ix(i){return i.providerId?i.providerId:"phoneNumber"in i?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xd extends jr{constructor(e,t,r,a){super(t.code,t.message),this.operationType=r,this.user=a,Object.setPrototypeOf(this,Xd.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,a){return new Xd(e,t,r,a)}}function aw(i,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(i):t._getIdTokenResponse(i)).catch(l=>{throw l.code==="auth/multi-factor-auth-required"?Xd._fromErrorAndOperation(i,l,e,r):l})}async function eP(i,e,t=!1){const r=await hu(i,e._linkToIdToken(i.auth,await i.getIdToken()),t);return Ua._forOperation(i,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tP(i,e,t=!1){const{auth:r}=i;if(Wn(r.app))return Promise.reject(Nr(r));const a="reauthenticate";try{const l=await hu(i,aw(r,a,e,i),t);Ce(l.idToken,r,"internal-error");const u=xy(l.idToken);Ce(u,r,"internal-error");const{sub:h}=u;return Ce(i.uid===h,r,"user-mismatch"),Ua._forOperation(i,a,l)}catch(l){throw l?.code==="auth/user-not-found"&&vi(r,"user-mismatch"),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ow(i,e,t=!1){if(Wn(i.app))return Promise.reject(Nr(i));const r="signIn",a=await aw(i,r,e),l=await Ua._fromIdTokenResponse(i,r,a);return t||await i._updateCurrentUser(l.user),l}async function nP(i,e){return ow(Fr(i),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function lw(i){const e=Fr(i);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function iP(i,e,t){const r=Fr(i);await Qd(r,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",Y2)}async function rP(i,e,t){if(Wn(i.app))return Promise.reject(Nr(i));const r=Fr(i),u=await Qd(r,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Z2).catch(m=>{throw m.code==="auth/password-does-not-meet-requirements"&&lw(i),m}),h=await Ua._fromIdTokenResponse(r,"signIn",u);return await r._updateCurrentUser(h.user),h}function sP(i,e,t){return Wn(i.app)?Promise.reject(Nr(i)):nP(Gt(i),Rl.credential(e,t)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&lw(i),r})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aP(i,e){return Gt(i).setPersistence(e)}function oP(i,e,t,r){return Gt(i).onIdTokenChanged(e,t,r)}function lP(i,e,t){return Gt(i).beforeAuthStateChanged(e,t)}function cP(i,e,t,r){return Gt(i).onAuthStateChanged(e,t,r)}function uP(i){return Gt(i).signOut()}const Wd="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cw{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Wd,"1"),this.storage.removeItem(Wd),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hP=1e3,dP=10;class uw extends cw{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=tw(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),a=this.localCache[t];r!==a&&e(t,a,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((u,h,m)=>{this.notifyListeners(u,m)});return}const r=e.key;t?this.detachListener():this.stopPolling();const a=()=>{const u=this.storage.getItem(r);!t&&this.localCache[r]===u||this.notifyListeners(r,u)},l=this.storage.getItem(r);R2()&&l!==e.newValue&&e.newValue!==e.oldValue?setTimeout(a,dP):a()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const a of Array.from(r))a(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},hP)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}uw.type="LOCAL";const hw=uw;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dw extends cw{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}dw.type="SESSION";const fw=dw;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fP(i){return Promise.all(i.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rf{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(a=>a.isListeningto(e));if(t)return t;const r=new Rf(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:a,data:l}=t.data,u=this.handlersMap[a];if(!u?.size)return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:a});const h=Array.from(u).map(async y=>y(t.origin,l)),m=await fP(h);t.ports[0].postMessage({status:"done",eventId:r,eventType:a,response:m})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Rf.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sy(i="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return i+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mP{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const a=typeof MessageChannel<"u"?new MessageChannel:null;if(!a)throw new Error("connection_unavailable");let l,u;return new Promise((h,m)=>{const y=Sy("",20);a.port1.start();const _=setTimeout(()=>{m(new Error("unsupported_event"))},r);u={messageChannel:a,onMessage(b){const T=b;if(T.data.eventId===y)switch(T.data.status){case"ack":clearTimeout(_),l=setTimeout(()=>{m(new Error("timeout"))},3e3);break;case"done":clearTimeout(l),h(T.data.response);break;default:clearTimeout(_),clearTimeout(l),m(new Error("invalid_response"));break}}},this.handlers.add(u),a.port1.addEventListener("message",u.onMessage),this.target.postMessage({eventType:e,eventId:y,data:t},[a.port2])}).finally(()=>{u&&this.removeMessageHandler(u)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ki(){return window}function pP(i){Ki().location.href=i}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mw(){return typeof Ki().WorkerGlobalScope<"u"&&typeof Ki().importScripts=="function"}async function gP(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function yP(){return navigator?.serviceWorker?.controller||null}function vP(){return mw()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pw="firebaseLocalStorageDb",_P=1,Jd="firebaseLocalStorage",gw="fbase_key";class Vu{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Sf(i,e){return i.transaction([Jd],e?"readwrite":"readonly").objectStore(Jd)}function bP(){const i=indexedDB.deleteDatabase(pw);return new Vu(i).toPromise()}function Vg(){const i=indexedDB.open(pw,_P);return new Promise((e,t)=>{i.addEventListener("error",()=>{t(i.error)}),i.addEventListener("upgradeneeded",()=>{const r=i.result;try{r.createObjectStore(Jd,{keyPath:gw})}catch(a){t(a)}}),i.addEventListener("success",async()=>{const r=i.result;r.objectStoreNames.contains(Jd)?e(r):(r.close(),await bP(),e(await Vg()))})})}async function Nx(i,e,t){const r=Sf(i,!0).put({[gw]:e,value:t});return new Vu(r).toPromise()}async function xP(i,e){const t=Sf(i,!1).get(e),r=await new Vu(t).toPromise();return r===void 0?null:r.value}function Cx(i,e){const t=Sf(i,!0).delete(e);return new Vu(t).toPromise()}const EP=800,TP=3;class yw{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Vg(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>TP)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return mw()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Rf._getInstance(vP()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await gP(),!this.activeServiceWorker)return;this.sender=new mP(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||yP()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Vg();return await Nx(e,Wd,"1"),await Cx(e,Wd),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>Nx(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>xP(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>Cx(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(a=>{const l=Sf(a,!1).getAll();return new Vu(l).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:a,value:l}of e)r.add(a),JSON.stringify(this.localCache[a])!==JSON.stringify(l)&&(this.notifyListeners(a,l),t.push(a));for(const a of Object.keys(this.localCache))this.localCache[a]&&!r.has(a)&&(this.notifyListeners(a,null),t.push(a));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const a of Array.from(r))a(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),EP)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}yw.type="LOCAL";const wP=yw;new Cu(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vw(i,e){return e?Ar(e):(Ce(i._popupRedirectResolver,i,"argument-error"),i._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ay extends Ty{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return al(e,this._buildIdpRequest())}_linkToIdToken(e,t){return al(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return al(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function RP(i){return ow(i.auth,new Ay(i),i.bypassAuthState)}function SP(i){const{auth:e,user:t}=i;return Ce(t,e,"internal-error"),tP(t,new Ay(i),i.bypassAuthState)}async function AP(i){const{auth:e,user:t}=i;return Ce(t,e,"internal-error"),eP(t,new Ay(i),i.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _w{constructor(e,t,r,a,l=!1){this.auth=e,this.resolver=r,this.user=a,this.bypassAuthState=l,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:a,tenantId:l,error:u,type:h}=e;if(u){this.reject(u);return}const m={auth:this.auth,requestUri:t,sessionId:r,tenantId:l||void 0,postBody:a||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(h)(m))}catch(y){this.reject(y)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return RP;case"linkViaPopup":case"linkViaRedirect":return AP;case"reauthViaPopup":case"reauthViaRedirect":return SP;default:vi(this.auth,"internal-error")}}resolve(e){Pr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Pr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IP=new Cu(2e3,1e4);async function NP(i,e,t){if(Wn(i.app))return Promise.reject(Si(i,"operation-not-supported-in-this-environment"));const r=Fr(i);s2(i,e,Ry);const a=vw(r,t);return new Ca(r,"signInViaPopup",e,a).executeNotNull()}class Ca extends _w{constructor(e,t,r,a,l){super(e,t,a,l),this.provider=r,this.authWindow=null,this.pollId=null,Ca.currentPopupAction&&Ca.currentPopupAction.cancel(),Ca.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Ce(e,this.auth,"internal-error"),e}async onExecution(){Pr(this.filter.length===1,"Popup operations only handle one event");const e=Sy();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Si(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Si(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Ca.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Si(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,IP.get())};e()}}Ca.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CP="pendingRedirect",Id=new Map;class PP extends _w{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=Id.get(this.auth._key());if(!e){try{const r=await DP(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}Id.set(this.auth._key(),e)}return this.bypassAuthState||Id.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function DP(i,e){const t=MP(e),r=OP(i);if(!await r._isAvailable())return!1;const a=await r._get(t)==="true";return await r._remove(t),a}function VP(i,e){Id.set(i._key(),e)}function OP(i){return Ar(i._redirectPersistence)}function MP(i){return Ad(CP,i.config.apiKey,i.name)}async function jP(i,e,t=!1){if(Wn(i.app))return Promise.reject(Nr(i));const r=Fr(i),a=vw(r,e),u=await new PP(r,a,t).execute();return u&&!t&&(delete u.user._redirectEventId,await r._persistUserIfCurrent(u.user),await r._setRedirectUser(null,e)),u}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kP=600*1e3;class LP{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!FP(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!bw(e)){const r=e.error.code?.split("auth/")[1]||"internal-error";t.onError(Si(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=kP&&this.cachedEventUids.clear(),this.cachedEventUids.has(Px(e))}saveEventToCache(e){this.cachedEventUids.add(Px(e)),this.lastProcessedEventTime=Date.now()}}function Px(i){return[i.type,i.eventId,i.sessionId,i.tenantId].filter(e=>e).join("-")}function bw({type:i,error:e}){return i==="unknown"&&e?.code==="auth/no-auth-event"}function FP(i){switch(i.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return bw(i);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function UP(i,e={}){return Lr(i,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zP=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,qP=/^https?/;async function BP(i){if(i.config.emulator)return;const{authorizedDomains:e}=await UP(i);for(const t of e)try{if(HP(t))return}catch{}vi(i,"unauthorized-domain")}function HP(i){const e=Pg(),{protocol:t,hostname:r}=new URL(e);if(i.startsWith("chrome-extension://")){const u=new URL(i);return u.hostname===""&&r===""?t==="chrome-extension:"&&i.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&u.hostname===r}if(!qP.test(t))return!1;if(zP.test(i))return r===i;const a=i.replace(/\./g,"\\.");return new RegExp("^(.+\\."+a+"|"+a+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GP=new Cu(3e4,6e4);function Dx(){const i=Ki().___jsl;if(i?.H){for(const e of Object.keys(i.H))if(i.H[e].r=i.H[e].r||[],i.H[e].L=i.H[e].L||[],i.H[e].r=[...i.H[e].L],i.CP)for(let t=0;t<i.CP.length;t++)i.CP[t]=null}}function KP(i){return new Promise((e,t)=>{function r(){Dx(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Dx(),t(Si(i,"network-request-failed"))},timeout:GP.get()})}if(Ki().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(Ki().gapi?.load)r();else{const a=O2("iframefcb");return Ki()[a]=()=>{gapi.load?r():t(Si(i,"network-request-failed"))},iw(`${V2()}?onload=${a}`).catch(l=>t(l))}}).catch(e=>{throw Nd=null,e})}let Nd=null;function YP(i){return Nd=Nd||KP(i),Nd}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $P=new Cu(5e3,15e3),QP="__/auth/iframe",XP="emulator/auth/iframe",WP={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},JP=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function ZP(i){const e=i.config;Ce(e.authDomain,i,"auth-domain-config-required");const t=e.emulator?by(e,XP):`https://${i.config.authDomain}/${QP}`,r={apiKey:e.apiKey,appName:i.name,v:wl},a=JP.get(i.config.apiHost);a&&(r.eid=a);const l=i._getFrameworks();return l.length&&(r.fw=l.join(",")),`${t}?${Nu(r).slice(1)}`}async function eD(i){const e=await YP(i),t=Ki().gapi;return Ce(t,i,"internal-error"),e.open({where:document.body,url:ZP(i),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:WP,dontclear:!0},r=>new Promise(async(a,l)=>{await r.restyle({setHideOnLeave:!1});const u=Si(i,"network-request-failed"),h=Ki().setTimeout(()=>{l(u)},$P.get());function m(){Ki().clearTimeout(h),a(r)}r.ping(m).then(m,()=>{l(u)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tD={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},nD=500,iD=600,rD="_blank",sD="http://localhost";class Vx{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function aD(i,e,t,r=nD,a=iD){const l=Math.max((window.screen.availHeight-a)/2,0).toString(),u=Math.max((window.screen.availWidth-r)/2,0).toString();let h="";const m={...tD,width:r.toString(),height:a.toString(),top:l,left:u},y=en().toLowerCase();t&&(h=XT(y)?rD:t),$T(y)&&(e=e||sD,m.scrollbars="yes");const _=Object.entries(m).reduce((T,[I,V])=>`${T}${I}=${V},`,"");if(w2(y)&&h!=="_self")return oD(e||"",h),new Vx(null);const b=window.open(e||"",h,_);Ce(b,i,"popup-blocked");try{b.focus()}catch{}return new Vx(b)}function oD(i,e){const t=document.createElement("a");t.href=i,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lD="__/auth/handler",cD="emulator/auth/handler",uD=encodeURIComponent("fac");async function Ox(i,e,t,r,a,l){Ce(i.config.authDomain,i,"auth-domain-config-required"),Ce(i.config.apiKey,i,"invalid-api-key");const u={apiKey:i.config.apiKey,appName:i.name,authType:t,redirectUrl:r,v:wl,eventId:a};if(e instanceof Ry){e.setDefaultLanguage(i.languageCode),u.providerId=e.providerId||"",BN(e.getCustomParameters())||(u.customParameters=JSON.stringify(e.getCustomParameters()));for(const[_,b]of Object.entries({}))u[_]=b}if(e instanceof Du){const _=e.getScopes().filter(b=>b!=="");_.length>0&&(u.scopes=_.join(","))}i.tenantId&&(u.tid=i.tenantId);const h=u;for(const _ of Object.keys(h))h[_]===void 0&&delete h[_];const m=await i._getAppCheckToken(),y=m?`#${uD}=${encodeURIComponent(m)}`:"";return`${hD(i)}?${Nu(h).slice(1)}${y}`}function hD({config:i}){return i.emulator?by(i,cD):`https://${i.authDomain}/${lD}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const og="webStorageSupport";class dD{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=fw,this._completeRedirectFn=jP,this._overrideRedirectResult=VP}async _openPopup(e,t,r,a){Pr(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const l=await Ox(e,t,r,Pg(),a);return aD(e,l,Sy())}async _openRedirect(e,t,r,a){await this._originValidation(e);const l=await Ox(e,t,r,Pg(),a);return pP(l),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:a,promise:l}=this.eventManagers[t];return a?Promise.resolve(a):(Pr(l,"If manager is not set, promise should be"),l)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await eD(e),r=new LP(e);return t.register("authEvent",a=>(Ce(a?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(a.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(og,{type:og},a=>{const l=a?.[0]?.[og];l!==void 0&&t(!!l),vi(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=BP(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return tw()||QT()||Ey()}}const fD=dD;var Mx="@firebase/auth",jx="1.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mD{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Ce(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pD(i){switch(i){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function gD(i){ll(new La("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),a=e.getProvider("heartbeat"),l=e.getProvider("app-check-internal"),{apiKey:u,authDomain:h}=r.options;Ce(u&&!u.includes(":"),"invalid-api-key",{appName:r.name});const m={apiKey:u,authDomain:h,clientPlatform:i,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:nw(i)},y=new C2(r,a,l,m);return U2(y,t),y},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),ll(new La("auth-internal",e=>{const t=Fr(e.getProvider("auth").getImmediate());return(r=>new mD(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Ps(Mx,jx,pD(i)),Ps(Mx,jx,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yD=300,vD=IT("authIdTokenMaxAge")||yD;let kx=null;const _D=i=>async e=>{const t=e&&await e.getIdTokenResult(),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>vD)return;const a=t?.token;kx!==a&&(kx=a,await fetch(i,{method:a?"POST":"DELETE",headers:a?{Authorization:`Bearer ${a}`}:{}}))};function bD(i=LT()){const e=yy(i,"auth");if(e.isInitialized())return e.getImmediate();const t=F2(i,{popupRedirectResolver:fD,persistence:[wP,hw,fw]}),r=IT("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const l=new URL(r,location.origin);if(location.origin===l.origin){const u=_D(l.toString());lP(t,u,()=>u(t.currentUser)),oP(t,h=>u(h))}}const a=ST("auth");return a&&z2(t,`http://${a}`),t}function xD(){return document.getElementsByTagName("head")?.[0]??document}P2({loadJS(i){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",i),r.onload=e,r.onerror=a=>{const l=Si("internal-error");l.customData=a,t(l)},r.type="text/javascript",r.charset="UTF-8",xD().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});gD("Browser");var Lx=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Ds,xw;(function(){var i;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(P,S){function A(){}A.prototype=S.prototype,P.D=S.prototype,P.prototype=new A,P.prototype.constructor=P,P.C=function(M,D,k){for(var N=Array(arguments.length-2),ue=2;ue<arguments.length;ue++)N[ue-2]=arguments[ue];return S.prototype[D].apply(M,N)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function a(P,S,A){A||(A=0);var M=Array(16);if(typeof S=="string")for(var D=0;16>D;++D)M[D]=S.charCodeAt(A++)|S.charCodeAt(A++)<<8|S.charCodeAt(A++)<<16|S.charCodeAt(A++)<<24;else for(D=0;16>D;++D)M[D]=S[A++]|S[A++]<<8|S[A++]<<16|S[A++]<<24;S=P.g[0],A=P.g[1],D=P.g[2];var k=P.g[3],N=S+(k^A&(D^k))+M[0]+3614090360&4294967295;S=A+(N<<7&4294967295|N>>>25),N=k+(D^S&(A^D))+M[1]+3905402710&4294967295,k=S+(N<<12&4294967295|N>>>20),N=D+(A^k&(S^A))+M[2]+606105819&4294967295,D=k+(N<<17&4294967295|N>>>15),N=A+(S^D&(k^S))+M[3]+3250441966&4294967295,A=D+(N<<22&4294967295|N>>>10),N=S+(k^A&(D^k))+M[4]+4118548399&4294967295,S=A+(N<<7&4294967295|N>>>25),N=k+(D^S&(A^D))+M[5]+1200080426&4294967295,k=S+(N<<12&4294967295|N>>>20),N=D+(A^k&(S^A))+M[6]+2821735955&4294967295,D=k+(N<<17&4294967295|N>>>15),N=A+(S^D&(k^S))+M[7]+4249261313&4294967295,A=D+(N<<22&4294967295|N>>>10),N=S+(k^A&(D^k))+M[8]+1770035416&4294967295,S=A+(N<<7&4294967295|N>>>25),N=k+(D^S&(A^D))+M[9]+2336552879&4294967295,k=S+(N<<12&4294967295|N>>>20),N=D+(A^k&(S^A))+M[10]+4294925233&4294967295,D=k+(N<<17&4294967295|N>>>15),N=A+(S^D&(k^S))+M[11]+2304563134&4294967295,A=D+(N<<22&4294967295|N>>>10),N=S+(k^A&(D^k))+M[12]+1804603682&4294967295,S=A+(N<<7&4294967295|N>>>25),N=k+(D^S&(A^D))+M[13]+4254626195&4294967295,k=S+(N<<12&4294967295|N>>>20),N=D+(A^k&(S^A))+M[14]+2792965006&4294967295,D=k+(N<<17&4294967295|N>>>15),N=A+(S^D&(k^S))+M[15]+1236535329&4294967295,A=D+(N<<22&4294967295|N>>>10),N=S+(D^k&(A^D))+M[1]+4129170786&4294967295,S=A+(N<<5&4294967295|N>>>27),N=k+(A^D&(S^A))+M[6]+3225465664&4294967295,k=S+(N<<9&4294967295|N>>>23),N=D+(S^A&(k^S))+M[11]+643717713&4294967295,D=k+(N<<14&4294967295|N>>>18),N=A+(k^S&(D^k))+M[0]+3921069994&4294967295,A=D+(N<<20&4294967295|N>>>12),N=S+(D^k&(A^D))+M[5]+3593408605&4294967295,S=A+(N<<5&4294967295|N>>>27),N=k+(A^D&(S^A))+M[10]+38016083&4294967295,k=S+(N<<9&4294967295|N>>>23),N=D+(S^A&(k^S))+M[15]+3634488961&4294967295,D=k+(N<<14&4294967295|N>>>18),N=A+(k^S&(D^k))+M[4]+3889429448&4294967295,A=D+(N<<20&4294967295|N>>>12),N=S+(D^k&(A^D))+M[9]+568446438&4294967295,S=A+(N<<5&4294967295|N>>>27),N=k+(A^D&(S^A))+M[14]+3275163606&4294967295,k=S+(N<<9&4294967295|N>>>23),N=D+(S^A&(k^S))+M[3]+4107603335&4294967295,D=k+(N<<14&4294967295|N>>>18),N=A+(k^S&(D^k))+M[8]+1163531501&4294967295,A=D+(N<<20&4294967295|N>>>12),N=S+(D^k&(A^D))+M[13]+2850285829&4294967295,S=A+(N<<5&4294967295|N>>>27),N=k+(A^D&(S^A))+M[2]+4243563512&4294967295,k=S+(N<<9&4294967295|N>>>23),N=D+(S^A&(k^S))+M[7]+1735328473&4294967295,D=k+(N<<14&4294967295|N>>>18),N=A+(k^S&(D^k))+M[12]+2368359562&4294967295,A=D+(N<<20&4294967295|N>>>12),N=S+(A^D^k)+M[5]+4294588738&4294967295,S=A+(N<<4&4294967295|N>>>28),N=k+(S^A^D)+M[8]+2272392833&4294967295,k=S+(N<<11&4294967295|N>>>21),N=D+(k^S^A)+M[11]+1839030562&4294967295,D=k+(N<<16&4294967295|N>>>16),N=A+(D^k^S)+M[14]+4259657740&4294967295,A=D+(N<<23&4294967295|N>>>9),N=S+(A^D^k)+M[1]+2763975236&4294967295,S=A+(N<<4&4294967295|N>>>28),N=k+(S^A^D)+M[4]+1272893353&4294967295,k=S+(N<<11&4294967295|N>>>21),N=D+(k^S^A)+M[7]+4139469664&4294967295,D=k+(N<<16&4294967295|N>>>16),N=A+(D^k^S)+M[10]+3200236656&4294967295,A=D+(N<<23&4294967295|N>>>9),N=S+(A^D^k)+M[13]+681279174&4294967295,S=A+(N<<4&4294967295|N>>>28),N=k+(S^A^D)+M[0]+3936430074&4294967295,k=S+(N<<11&4294967295|N>>>21),N=D+(k^S^A)+M[3]+3572445317&4294967295,D=k+(N<<16&4294967295|N>>>16),N=A+(D^k^S)+M[6]+76029189&4294967295,A=D+(N<<23&4294967295|N>>>9),N=S+(A^D^k)+M[9]+3654602809&4294967295,S=A+(N<<4&4294967295|N>>>28),N=k+(S^A^D)+M[12]+3873151461&4294967295,k=S+(N<<11&4294967295|N>>>21),N=D+(k^S^A)+M[15]+530742520&4294967295,D=k+(N<<16&4294967295|N>>>16),N=A+(D^k^S)+M[2]+3299628645&4294967295,A=D+(N<<23&4294967295|N>>>9),N=S+(D^(A|~k))+M[0]+4096336452&4294967295,S=A+(N<<6&4294967295|N>>>26),N=k+(A^(S|~D))+M[7]+1126891415&4294967295,k=S+(N<<10&4294967295|N>>>22),N=D+(S^(k|~A))+M[14]+2878612391&4294967295,D=k+(N<<15&4294967295|N>>>17),N=A+(k^(D|~S))+M[5]+4237533241&4294967295,A=D+(N<<21&4294967295|N>>>11),N=S+(D^(A|~k))+M[12]+1700485571&4294967295,S=A+(N<<6&4294967295|N>>>26),N=k+(A^(S|~D))+M[3]+2399980690&4294967295,k=S+(N<<10&4294967295|N>>>22),N=D+(S^(k|~A))+M[10]+4293915773&4294967295,D=k+(N<<15&4294967295|N>>>17),N=A+(k^(D|~S))+M[1]+2240044497&4294967295,A=D+(N<<21&4294967295|N>>>11),N=S+(D^(A|~k))+M[8]+1873313359&4294967295,S=A+(N<<6&4294967295|N>>>26),N=k+(A^(S|~D))+M[15]+4264355552&4294967295,k=S+(N<<10&4294967295|N>>>22),N=D+(S^(k|~A))+M[6]+2734768916&4294967295,D=k+(N<<15&4294967295|N>>>17),N=A+(k^(D|~S))+M[13]+1309151649&4294967295,A=D+(N<<21&4294967295|N>>>11),N=S+(D^(A|~k))+M[4]+4149444226&4294967295,S=A+(N<<6&4294967295|N>>>26),N=k+(A^(S|~D))+M[11]+3174756917&4294967295,k=S+(N<<10&4294967295|N>>>22),N=D+(S^(k|~A))+M[2]+718787259&4294967295,D=k+(N<<15&4294967295|N>>>17),N=A+(k^(D|~S))+M[9]+3951481745&4294967295,P.g[0]=P.g[0]+S&4294967295,P.g[1]=P.g[1]+(D+(N<<21&4294967295|N>>>11))&4294967295,P.g[2]=P.g[2]+D&4294967295,P.g[3]=P.g[3]+k&4294967295}r.prototype.u=function(P,S){S===void 0&&(S=P.length);for(var A=S-this.blockSize,M=this.B,D=this.h,k=0;k<S;){if(D==0)for(;k<=A;)a(this,P,k),k+=this.blockSize;if(typeof P=="string"){for(;k<S;)if(M[D++]=P.charCodeAt(k++),D==this.blockSize){a(this,M),D=0;break}}else for(;k<S;)if(M[D++]=P[k++],D==this.blockSize){a(this,M),D=0;break}}this.h=D,this.o+=S},r.prototype.v=function(){var P=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);P[0]=128;for(var S=1;S<P.length-8;++S)P[S]=0;var A=8*this.o;for(S=P.length-8;S<P.length;++S)P[S]=A&255,A/=256;for(this.u(P),P=Array(16),S=A=0;4>S;++S)for(var M=0;32>M;M+=8)P[A++]=this.g[S]>>>M&255;return P};function l(P,S){var A=h;return Object.prototype.hasOwnProperty.call(A,P)?A[P]:A[P]=S(P)}function u(P,S){this.h=S;for(var A=[],M=!0,D=P.length-1;0<=D;D--){var k=P[D]|0;M&&k==S||(A[D]=k,M=!1)}this.g=A}var h={};function m(P){return-128<=P&&128>P?l(P,function(S){return new u([S|0],0>S?-1:0)}):new u([P|0],0>P?-1:0)}function y(P){if(isNaN(P)||!isFinite(P))return b;if(0>P)return O(y(-P));for(var S=[],A=1,M=0;P>=A;M++)S[M]=P/A|0,A*=4294967296;return new u(S,0)}function _(P,S){if(P.length==0)throw Error("number format error: empty string");if(S=S||10,2>S||36<S)throw Error("radix out of range: "+S);if(P.charAt(0)=="-")return O(_(P.substring(1),S));if(0<=P.indexOf("-"))throw Error('number format error: interior "-" character');for(var A=y(Math.pow(S,8)),M=b,D=0;D<P.length;D+=8){var k=Math.min(8,P.length-D),N=parseInt(P.substring(D,D+k),S);8>k?(k=y(Math.pow(S,k)),M=M.j(k).add(y(N))):(M=M.j(A),M=M.add(y(N)))}return M}var b=m(0),T=m(1),I=m(16777216);i=u.prototype,i.m=function(){if(L(this))return-O(this).m();for(var P=0,S=1,A=0;A<this.g.length;A++){var M=this.i(A);P+=(0<=M?M:4294967296+M)*S,S*=4294967296}return P},i.toString=function(P){if(P=P||10,2>P||36<P)throw Error("radix out of range: "+P);if(V(this))return"0";if(L(this))return"-"+O(this).toString(P);for(var S=y(Math.pow(P,6)),A=this,M="";;){var D=ne(A,S).g;A=Z(A,D.j(S));var k=((0<A.g.length?A.g[0]:A.h)>>>0).toString(P);if(A=D,V(A))return k+M;for(;6>k.length;)k="0"+k;M=k+M}},i.i=function(P){return 0>P?0:P<this.g.length?this.g[P]:this.h};function V(P){if(P.h!=0)return!1;for(var S=0;S<P.g.length;S++)if(P.g[S]!=0)return!1;return!0}function L(P){return P.h==-1}i.l=function(P){return P=Z(this,P),L(P)?-1:V(P)?0:1};function O(P){for(var S=P.g.length,A=[],M=0;M<S;M++)A[M]=~P.g[M];return new u(A,~P.h).add(T)}i.abs=function(){return L(this)?O(this):this},i.add=function(P){for(var S=Math.max(this.g.length,P.g.length),A=[],M=0,D=0;D<=S;D++){var k=M+(this.i(D)&65535)+(P.i(D)&65535),N=(k>>>16)+(this.i(D)>>>16)+(P.i(D)>>>16);M=N>>>16,k&=65535,N&=65535,A[D]=N<<16|k}return new u(A,A[A.length-1]&-2147483648?-1:0)};function Z(P,S){return P.add(O(S))}i.j=function(P){if(V(this)||V(P))return b;if(L(this))return L(P)?O(this).j(O(P)):O(O(this).j(P));if(L(P))return O(this.j(O(P)));if(0>this.l(I)&&0>P.l(I))return y(this.m()*P.m());for(var S=this.g.length+P.g.length,A=[],M=0;M<2*S;M++)A[M]=0;for(M=0;M<this.g.length;M++)for(var D=0;D<P.g.length;D++){var k=this.i(M)>>>16,N=this.i(M)&65535,ue=P.i(D)>>>16,de=P.i(D)&65535;A[2*M+2*D]+=N*de,se(A,2*M+2*D),A[2*M+2*D+1]+=k*de,se(A,2*M+2*D+1),A[2*M+2*D+1]+=N*ue,se(A,2*M+2*D+1),A[2*M+2*D+2]+=k*ue,se(A,2*M+2*D+2)}for(M=0;M<S;M++)A[M]=A[2*M+1]<<16|A[2*M];for(M=S;M<2*S;M++)A[M]=0;return new u(A,0)};function se(P,S){for(;(P[S]&65535)!=P[S];)P[S+1]+=P[S]>>>16,P[S]&=65535,S++}function G(P,S){this.g=P,this.h=S}function ne(P,S){if(V(S))throw Error("division by zero");if(V(P))return new G(b,b);if(L(P))return S=ne(O(P),S),new G(O(S.g),O(S.h));if(L(S))return S=ne(P,O(S)),new G(O(S.g),S.h);if(30<P.g.length){if(L(P)||L(S))throw Error("slowDivide_ only works with positive integers.");for(var A=T,M=S;0>=M.l(P);)A=B(A),M=B(M);var D=re(A,1),k=re(M,1);for(M=re(M,2),A=re(A,2);!V(M);){var N=k.add(M);0>=N.l(P)&&(D=D.add(A),k=N),M=re(M,1),A=re(A,1)}return S=Z(P,D.j(S)),new G(D,S)}for(D=b;0<=P.l(S);){for(A=Math.max(1,Math.floor(P.m()/S.m())),M=Math.ceil(Math.log(A)/Math.LN2),M=48>=M?1:Math.pow(2,M-48),k=y(A),N=k.j(S);L(N)||0<N.l(P);)A-=M,k=y(A),N=k.j(S);V(k)&&(k=T),D=D.add(k),P=Z(P,N)}return new G(D,P)}i.A=function(P){return ne(this,P).h},i.and=function(P){for(var S=Math.max(this.g.length,P.g.length),A=[],M=0;M<S;M++)A[M]=this.i(M)&P.i(M);return new u(A,this.h&P.h)},i.or=function(P){for(var S=Math.max(this.g.length,P.g.length),A=[],M=0;M<S;M++)A[M]=this.i(M)|P.i(M);return new u(A,this.h|P.h)},i.xor=function(P){for(var S=Math.max(this.g.length,P.g.length),A=[],M=0;M<S;M++)A[M]=this.i(M)^P.i(M);return new u(A,this.h^P.h)};function B(P){for(var S=P.g.length+1,A=[],M=0;M<S;M++)A[M]=P.i(M)<<1|P.i(M-1)>>>31;return new u(A,P.h)}function re(P,S){var A=S>>5;S%=32;for(var M=P.g.length-A,D=[],k=0;k<M;k++)D[k]=0<S?P.i(k+A)>>>S|P.i(k+A+1)<<32-S:P.i(k+A);return new u(D,P.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,xw=r,u.prototype.add=u.prototype.add,u.prototype.multiply=u.prototype.j,u.prototype.modulo=u.prototype.A,u.prototype.compare=u.prototype.l,u.prototype.toNumber=u.prototype.m,u.prototype.toString=u.prototype.toString,u.prototype.getBits=u.prototype.i,u.fromNumber=y,u.fromString=_,Ds=u}).apply(typeof Lx<"u"?Lx:typeof self<"u"?self:typeof window<"u"?window:{});var yd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Ew,Kc,Tw,Cd,Og,ww,Rw,Sw;(function(){var i,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(d,v,x){return d==Array.prototype||d==Object.prototype||(d[v]=x.value),d};function t(d){d=[typeof globalThis=="object"&&globalThis,d,typeof window=="object"&&window,typeof self=="object"&&self,typeof yd=="object"&&yd];for(var v=0;v<d.length;++v){var x=d[v];if(x&&x.Math==Math)return x}throw Error("Cannot find global object")}var r=t(this);function a(d,v){if(v)e:{var x=r;d=d.split(".");for(var R=0;R<d.length-1;R++){var K=d[R];if(!(K in x))break e;x=x[K]}d=d[d.length-1],R=x[d],v=v(R),v!=R&&v!=null&&e(x,d,{configurable:!0,writable:!0,value:v})}}function l(d,v){d instanceof String&&(d+="");var x=0,R=!1,K={next:function(){if(!R&&x<d.length){var te=x++;return{value:v(te,d[te]),done:!1}}return R=!0,{done:!0,value:void 0}}};return K[Symbol.iterator]=function(){return K},K}a("Array.prototype.values",function(d){return d||function(){return l(this,function(v,x){return x})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var u=u||{},h=this||self;function m(d){var v=typeof d;return v=v!="object"?v:d?Array.isArray(d)?"array":v:"null",v=="array"||v=="object"&&typeof d.length=="number"}function y(d){var v=typeof d;return v=="object"&&d!=null||v=="function"}function _(d,v,x){return d.call.apply(d.bind,arguments)}function b(d,v,x){if(!d)throw Error();if(2<arguments.length){var R=Array.prototype.slice.call(arguments,2);return function(){var K=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(K,R),d.apply(v,K)}}return function(){return d.apply(v,arguments)}}function T(d,v,x){return T=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?_:b,T.apply(null,arguments)}function I(d,v){var x=Array.prototype.slice.call(arguments,1);return function(){var R=x.slice();return R.push.apply(R,arguments),d.apply(this,R)}}function V(d,v){function x(){}x.prototype=v.prototype,d.aa=v.prototype,d.prototype=new x,d.prototype.constructor=d,d.Qb=function(R,K,te){for(var pe=Array(arguments.length-2),We=2;We<arguments.length;We++)pe[We-2]=arguments[We];return v.prototype[K].apply(R,pe)}}function L(d){const v=d.length;if(0<v){const x=Array(v);for(let R=0;R<v;R++)x[R]=d[R];return x}return[]}function O(d,v){for(let x=1;x<arguments.length;x++){const R=arguments[x];if(m(R)){const K=d.length||0,te=R.length||0;d.length=K+te;for(let pe=0;pe<te;pe++)d[K+pe]=R[pe]}else d.push(R)}}class Z{constructor(v,x){this.i=v,this.j=x,this.h=0,this.g=null}get(){let v;return 0<this.h?(this.h--,v=this.g,this.g=v.next,v.next=null):v=this.i(),v}}function se(d){return/^[\s\xa0]*$/.test(d)}function G(){var d=h.navigator;return d&&(d=d.userAgent)?d:""}function ne(d){return ne[" "](d),d}ne[" "]=function(){};var B=G().indexOf("Gecko")!=-1&&!(G().toLowerCase().indexOf("webkit")!=-1&&G().indexOf("Edge")==-1)&&!(G().indexOf("Trident")!=-1||G().indexOf("MSIE")!=-1)&&G().indexOf("Edge")==-1;function re(d,v,x){for(const R in d)v.call(x,d[R],R,d)}function P(d,v){for(const x in d)v.call(void 0,d[x],x,d)}function S(d){const v={};for(const x in d)v[x]=d[x];return v}const A="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function M(d,v){let x,R;for(let K=1;K<arguments.length;K++){R=arguments[K];for(x in R)d[x]=R[x];for(let te=0;te<A.length;te++)x=A[te],Object.prototype.hasOwnProperty.call(R,x)&&(d[x]=R[x])}}function D(d){var v=1;d=d.split(":");const x=[];for(;0<v&&d.length;)x.push(d.shift()),v--;return d.length&&x.push(d.join(":")),x}function k(d){h.setTimeout(()=>{throw d},0)}function N(){var d=me;let v=null;return d.g&&(v=d.g,d.g=d.g.next,d.g||(d.h=null),v.next=null),v}class ue{constructor(){this.h=this.g=null}add(v,x){const R=de.get();R.set(v,x),this.h?this.h.next=R:this.g=R,this.h=R}}var de=new Z(()=>new z,d=>d.reset());class z{constructor(){this.next=this.g=this.h=null}set(v,x){this.h=v,this.g=x,this.next=null}reset(){this.next=this.g=this.h=null}}let X,ae=!1,me=new ue,C=()=>{const d=h.Promise.resolve(void 0);X=()=>{d.then(U)}};var U=()=>{for(var d;d=N();){try{d.h.call(d.g)}catch(x){k(x)}var v=de;v.j(d),100>v.h&&(v.h++,d.next=v.g,v.g=d)}ae=!1};function ee(){this.s=this.s,this.C=this.C}ee.prototype.s=!1,ee.prototype.ma=function(){this.s||(this.s=!0,this.N())},ee.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function ie(d,v){this.type=d,this.g=this.target=v,this.defaultPrevented=!1}ie.prototype.h=function(){this.defaultPrevented=!0};var ge=function(){if(!h.addEventListener||!Object.defineProperty)return!1;var d=!1,v=Object.defineProperty({},"passive",{get:function(){d=!0}});try{const x=()=>{};h.addEventListener("test",x,v),h.removeEventListener("test",x,v)}catch{}return d}();function xe(d,v){if(ie.call(this,d?d.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,d){var x=this.type=d.type,R=d.changedTouches&&d.changedTouches.length?d.changedTouches[0]:null;if(this.target=d.target||d.srcElement,this.g=v,v=d.relatedTarget){if(B){e:{try{ne(v.nodeName);var K=!0;break e}catch{}K=!1}K||(v=null)}}else x=="mouseover"?v=d.fromElement:x=="mouseout"&&(v=d.toElement);this.relatedTarget=v,R?(this.clientX=R.clientX!==void 0?R.clientX:R.pageX,this.clientY=R.clientY!==void 0?R.clientY:R.pageY,this.screenX=R.screenX||0,this.screenY=R.screenY||0):(this.clientX=d.clientX!==void 0?d.clientX:d.pageX,this.clientY=d.clientY!==void 0?d.clientY:d.pageY,this.screenX=d.screenX||0,this.screenY=d.screenY||0),this.button=d.button,this.key=d.key||"",this.ctrlKey=d.ctrlKey,this.altKey=d.altKey,this.shiftKey=d.shiftKey,this.metaKey=d.metaKey,this.pointerId=d.pointerId||0,this.pointerType=typeof d.pointerType=="string"?d.pointerType:be[d.pointerType]||"",this.state=d.state,this.i=d,d.defaultPrevented&&xe.aa.h.call(this)}}V(xe,ie);var be={2:"touch",3:"pen",4:"mouse"};xe.prototype.h=function(){xe.aa.h.call(this);var d=this.i;d.preventDefault?d.preventDefault():d.returnValue=!1};var $e="closure_listenable_"+(1e6*Math.random()|0),ve=0;function Ne(d,v,x,R,K){this.listener=d,this.proxy=null,this.src=v,this.type=x,this.capture=!!R,this.ha=K,this.key=++ve,this.da=this.fa=!1}function je(d){d.da=!0,d.listener=null,d.proxy=null,d.src=null,d.ha=null}function De(d){this.src=d,this.g={},this.h=0}De.prototype.add=function(d,v,x,R,K){var te=d.toString();d=this.g[te],d||(d=this.g[te]=[],this.h++);var pe=He(d,v,R,K);return-1<pe?(v=d[pe],x||(v.fa=!1)):(v=new Ne(v,this.src,te,!!R,K),v.fa=x,d.push(v)),v};function Ue(d,v){var x=v.type;if(x in d.g){var R=d.g[x],K=Array.prototype.indexOf.call(R,v,void 0),te;(te=0<=K)&&Array.prototype.splice.call(R,K,1),te&&(je(v),d.g[x].length==0&&(delete d.g[x],d.h--))}}function He(d,v,x,R){for(var K=0;K<d.length;++K){var te=d[K];if(!te.da&&te.listener==v&&te.capture==!!x&&te.ha==R)return K}return-1}var nt="closure_lm_"+(1e6*Math.random()|0),Yt={};function cn(d,v,x,R,K){if(Array.isArray(v)){for(var te=0;te<v.length;te++)cn(d,v[te],x,R,K);return null}return x=Tn(x),d&&d[$e]?d.K(v,x,y(R)?!!R.capture:!1,K):Et(d,v,x,!1,R,K)}function Et(d,v,x,R,K,te){if(!v)throw Error("Invalid event type");var pe=y(K)?!!K.capture:!!K,We=Qe(d);if(We||(d[nt]=We=new De(d)),x=We.add(v,x,R,pe,te),x.proxy)return x;if(R=Vn(),x.proxy=R,R.src=d,R.listener=x,d.addEventListener)ge||(K=pe),K===void 0&&(K=!1),d.addEventListener(v.toString(),R,K);else if(d.attachEvent)d.attachEvent(ke(v.toString()),R);else if(d.addListener&&d.removeListener)d.addListener(R);else throw Error("addEventListener and attachEvent are unavailable.");return x}function Vn(){function d(x){return v.call(d.src,d.listener,x)}const v=tt;return d}function On(d,v,x,R,K){if(Array.isArray(v))for(var te=0;te<v.length;te++)On(d,v[te],x,R,K);else R=y(R)?!!R.capture:!!R,x=Tn(x),d&&d[$e]?(d=d.i,v=String(v).toString(),v in d.g&&(te=d.g[v],x=He(te,x,R,K),-1<x&&(je(te[x]),Array.prototype.splice.call(te,x,1),te.length==0&&(delete d.g[v],d.h--)))):d&&(d=Qe(d))&&(v=d.g[v.toString()],d=-1,v&&(d=He(v,x,R,K)),(x=-1<d?v[d]:null)&&Xe(x))}function Xe(d){if(typeof d!="number"&&d&&!d.da){var v=d.src;if(v&&v[$e])Ue(v.i,d);else{var x=d.type,R=d.proxy;v.removeEventListener?v.removeEventListener(x,R,d.capture):v.detachEvent?v.detachEvent(ke(x),R):v.addListener&&v.removeListener&&v.removeListener(R),(x=Qe(v))?(Ue(x,d),x.h==0&&(x.src=null,v[nt]=null)):je(d)}}}function ke(d){return d in Yt?Yt[d]:Yt[d]="on"+d}function tt(d,v){if(d.da)d=!0;else{v=new xe(v,this);var x=d.listener,R=d.ha||d.src;d.fa&&Xe(d),d=x.call(R,v)}return d}function Qe(d){return d=d[nt],d instanceof De?d:null}var ni="__closure_events_fn_"+(1e9*Math.random()>>>0);function Tn(d){return typeof d=="function"?d:(d[ni]||(d[ni]=function(v){return d.handleEvent(v)}),d[ni])}function mt(){ee.call(this),this.i=new De(this),this.M=this,this.F=null}V(mt,ee),mt.prototype[$e]=!0,mt.prototype.removeEventListener=function(d,v,x,R){On(this,d,v,x,R)};function rt(d,v){var x,R=d.F;if(R)for(x=[];R;R=R.F)x.push(R);if(d=d.M,R=v.type||v,typeof v=="string")v=new ie(v,d);else if(v instanceof ie)v.target=v.target||d;else{var K=v;v=new ie(R,d),M(v,K)}if(K=!0,x)for(var te=x.length-1;0<=te;te--){var pe=v.g=x[te];K=wn(pe,R,!0,v)&&K}if(pe=v.g=d,K=wn(pe,R,!0,v)&&K,K=wn(pe,R,!1,v)&&K,x)for(te=0;te<x.length;te++)pe=v.g=x[te],K=wn(pe,R,!1,v)&&K}mt.prototype.N=function(){if(mt.aa.N.call(this),this.i){var d=this.i,v;for(v in d.g){for(var x=d.g[v],R=0;R<x.length;R++)je(x[R]);delete d.g[v],d.h--}}this.F=null},mt.prototype.K=function(d,v,x,R){return this.i.add(String(d),v,!1,x,R)},mt.prototype.L=function(d,v,x,R){return this.i.add(String(d),v,!0,x,R)};function wn(d,v,x,R){if(v=d.i.g[String(v)],!v)return!0;v=v.concat();for(var K=!0,te=0;te<v.length;++te){var pe=v[te];if(pe&&!pe.da&&pe.capture==x){var We=pe.listener,Xt=pe.ha||pe.src;pe.fa&&Ue(d.i,pe),K=We.call(Xt,R)!==!1&&K}}return K&&!R.defaultPrevented}function $t(d,v,x){if(typeof d=="function")x&&(d=T(d,x));else if(d&&typeof d.handleEvent=="function")d=T(d.handleEvent,d);else throw Error("Invalid listener argument");return 2147483647<Number(v)?-1:h.setTimeout(d,v||0)}function Ji(d){d.g=$t(()=>{d.g=null,d.i&&(d.i=!1,Ji(d))},d.l);const v=d.h;d.h=null,d.m.apply(null,v)}class Hs extends ee{constructor(v,x){super(),this.m=v,this.l=x,this.h=null,this.i=!1,this.g=null}j(v){this.h=arguments,this.g?this.i=!0:Ji(this)}N(){super.N(),this.g&&(h.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Zi(d){ee.call(this),this.h=d,this.g={}}V(Zi,ee);var Fn=[];function qr(d){re(d.g,function(v,x){this.g.hasOwnProperty(x)&&Xe(v)},d),d.g={}}Zi.prototype.N=function(){Zi.aa.N.call(this),qr(this)},Zi.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Un=h.JSON.stringify,Za=h.JSON.parse,Gs=class{stringify(d){return h.JSON.stringify(d,void 0)}parse(d){return h.JSON.parse(d,void 0)}};function Pl(){}Pl.prototype.h=null;function Dl(d){return d.h||(d.h=d.i())}function Vl(){}var er={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function tr(){ie.call(this,"d")}V(tr,ie);function Ol(){ie.call(this,"c")}V(Ol,ie);var Ai={},Ml=null;function Br(){return Ml=Ml||new mt}Ai.La="serverreachability";function eo(d){ie.call(this,Ai.La,d)}V(eo,ie);function Hr(d){const v=Br();rt(v,new eo(v))}Ai.STAT_EVENT="statevent";function $u(d,v){ie.call(this,Ai.STAT_EVENT,d),this.stat=v}V($u,ie);function Tt(d){const v=Br();rt(v,new $u(v,d))}Ai.Ma="timingevent";function Qt(d,v){ie.call(this,Ai.Ma,d),this.size=v}V(Qt,ie);function Ft(d,v){if(typeof d!="function")throw Error("Fn must not be null and must be a function");return h.setTimeout(function(){d()},v)}function ii(){this.g=!0}ii.prototype.xa=function(){this.g=!1};function jl(d,v,x,R,K,te){d.info(function(){if(d.g)if(te)for(var pe="",We=te.split("&"),Xt=0;Xt<We.length;Xt++){var Je=We[Xt].split("=");if(1<Je.length){var rn=Je[0];Je=Je[1];var Wt=rn.split("_");pe=2<=Wt.length&&Wt[1]=="type"?pe+(rn+"="+Je+"&"):pe+(rn+"=redacted&")}}else pe=null;else pe=te;return"XMLHTTP REQ ("+R+") [attempt "+K+"]: "+v+`
`+x+`
`+pe})}function Xf(d,v,x,R,K,te,pe){d.info(function(){return"XMLHTTP RESP ("+R+") [ attempt "+K+"]: "+v+`
`+x+`
`+te+" "+pe})}function Gr(d,v,x,R){d.info(function(){return"XMLHTTP TEXT ("+v+"): "+Ks(d,x)+(R?" "+R:"")})}function Qu(d,v){d.info(function(){return"TIMEOUT: "+v})}ii.prototype.info=function(){};function Ks(d,v){if(!d.g)return v;if(!v)return null;try{var x=JSON.parse(v);if(x){for(d=0;d<x.length;d++)if(Array.isArray(x[d])){var R=x[d];if(!(2>R.length)){var K=R[1];if(Array.isArray(K)&&!(1>K.length)){var te=K[0];if(te!="noop"&&te!="stop"&&te!="close")for(var pe=1;pe<K.length;pe++)K[pe]=""}}}}return Un(x)}catch{return v}}var Kr={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},nr={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Ii;function Ni(){}V(Ni,Pl),Ni.prototype.g=function(){return new XMLHttpRequest},Ni.prototype.i=function(){return{}},Ii=new Ni;function Rn(d,v,x,R){this.j=d,this.i=v,this.l=x,this.R=R||1,this.U=new Zi(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Ot}function Ot(){this.i=null,this.g="",this.h=!1}var kl={},to={};function _i(d,v,x){d.L=1,d.v=Ws(zn(v)),d.m=x,d.P=!0,ir(d,null)}function ir(d,v){d.F=Date.now(),Ys(d),d.A=zn(d.v);var x=d.A,R=d.R;Array.isArray(R)||(R=[String(R)]),Bl(x.i,"t",R),d.C=0,x=d.j.J,d.h=new Ot,d.g=hh(d.j,x?v:null,!d.m),0<d.O&&(d.M=new Hs(T(d.Y,d,d.g),d.O)),v=d.U,x=d.g,R=d.ca;var K="readystatechange";Array.isArray(K)||(K&&(Fn[0]=K.toString()),K=Fn);for(var te=0;te<K.length;te++){var pe=cn(x,K[te],R||v.handleEvent,!1,v.h||v);if(!pe)break;v.g[pe.key]=pe}v=d.H?S(d.H):{},d.m?(d.u||(d.u="POST"),v["Content-Type"]="application/x-www-form-urlencoded",d.g.ea(d.A,d.u,d.m,v)):(d.u="GET",d.g.ea(d.A,d.u,null,v)),Hr(),jl(d.i,d.u,d.A,d.l,d.R,d.m)}Rn.prototype.ca=function(d){d=d.target;const v=this.M;v&&oi(d)==3?v.j():this.Y(d)},Rn.prototype.Y=function(d){try{if(d==this.g)e:{const Wt=oi(this.g);var v=this.g.Ba();const hr=this.g.Z();if(!(3>Wt)&&(Wt!=3||this.g&&(this.h.h||this.g.oa()||ih(this.g)))){this.J||Wt!=4||v==7||(v==8||0>=hr?Hr(3):Hr(2)),Yr(this);var x=this.g.Z();this.X=x;t:if(Xu(this)){var R=ih(this.g);d="";var K=R.length,te=oi(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){un(this),Ci(this);var pe="";break t}this.h.i=new h.TextDecoder}for(v=0;v<K;v++)this.h.h=!0,d+=this.h.i.decode(R[v],{stream:!(te&&v==K-1)});R.length=0,this.h.g+=d,this.C=0,pe=this.h.g}else pe=this.g.oa();if(this.o=x==200,Xf(this.i,this.u,this.A,this.l,this.R,Wt,x),this.o){if(this.T&&!this.K){t:{if(this.g){var We,Xt=this.g;if((We=Xt.g?Xt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!se(We)){var Je=We;break t}}Je=null}if(x=Je)Gr(this.i,this.l,x,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,$s(this,x);else{this.o=!1,this.s=3,Tt(12),un(this),Ci(this);break e}}if(this.P){x=!0;let hn;for(;!this.J&&this.C<pe.length;)if(hn=Wu(this,pe),hn==to){Wt==4&&(this.s=4,Tt(14),x=!1),Gr(this.i,this.l,null,"[Incomplete Response]");break}else if(hn==kl){this.s=4,Tt(15),Gr(this.i,this.l,pe,"[Invalid Chunk]"),x=!1;break}else Gr(this.i,this.l,hn,null),$s(this,hn);if(Xu(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Wt!=4||pe.length!=0||this.h.h||(this.s=1,Tt(16),x=!1),this.o=this.o&&x,!x)Gr(this.i,this.l,pe,"[Invalid Chunked Response]"),un(this),Ci(this);else if(0<pe.length&&!this.W){this.W=!0;var rn=this.j;rn.g==this&&rn.ba&&!rn.M&&(rn.j.info("Great, no buffering proxy detected. Bytes received: "+pe.length),sa(rn),rn.M=!0,Tt(11))}}else Gr(this.i,this.l,pe,null),$s(this,pe);Wt==4&&un(this),this.o&&!this.J&&(Wt==4?lh(this.j,this):(this.o=!1,Ys(this)))}else tm(this.g),x==400&&0<pe.indexOf("Unknown SID")?(this.s=3,Tt(12)):(this.s=0,Tt(13)),un(this),Ci(this)}}}catch{}finally{}};function Xu(d){return d.g?d.u=="GET"&&d.L!=2&&d.j.Ca:!1}function Wu(d,v){var x=d.C,R=v.indexOf(`
`,x);return R==-1?to:(x=Number(v.substring(x,R)),isNaN(x)?kl:(R+=1,R+x>v.length?to:(v=v.slice(R,R+x),d.C=R+x,v)))}Rn.prototype.cancel=function(){this.J=!0,un(this)};function Ys(d){d.S=Date.now()+d.I,Ju(d,d.I)}function Ju(d,v){if(d.B!=null)throw Error("WatchDog timer not null");d.B=Ft(T(d.ba,d),v)}function Yr(d){d.B&&(h.clearTimeout(d.B),d.B=null)}Rn.prototype.ba=function(){this.B=null;const d=Date.now();0<=d-this.S?(Qu(this.i,this.A),this.L!=2&&(Hr(),Tt(17)),un(this),this.s=2,Ci(this)):Ju(this,this.S-d)};function Ci(d){d.j.G==0||d.J||lh(d.j,d)}function un(d){Yr(d);var v=d.M;v&&typeof v.ma=="function"&&v.ma(),d.M=null,qr(d.U),d.g&&(v=d.g,d.g=null,v.abort(),v.ma())}function $s(d,v){try{var x=d.j;if(x.G!=0&&(x.g==d||Ll(x.h,d))){if(!d.K&&Ll(x.h,d)&&x.G==3){try{var R=x.Da.g.parse(v)}catch{R=null}if(Array.isArray(R)&&R.length==3){var K=R;if(K[0]==0){e:if(!x.u){if(x.g)if(x.g.F+3e3<d.F)mo(x),ho(x);else break e;$l(x),Tt(18)}}else x.za=K[1],0<x.za-x.T&&37500>K[2]&&x.F&&x.v==0&&!x.C&&(x.C=Ft(T(x.Za,x),6e3));if(1>=io(x.h)&&x.ca){try{x.ca()}catch{}x.ca=void 0}}else ur(x,11)}else if((d.K||x.g==d)&&mo(x),!se(v))for(K=x.Da.g.parse(v),v=0;v<K.length;v++){let Je=K[v];if(x.T=Je[0],Je=Je[1],x.G==2)if(Je[0]=="c"){x.K=Je[1],x.ia=Je[2];const rn=Je[3];rn!=null&&(x.la=rn,x.j.info("VER="+x.la));const Wt=Je[4];Wt!=null&&(x.Aa=Wt,x.j.info("SVER="+x.Aa));const hr=Je[5];hr!=null&&typeof hr=="number"&&0<hr&&(R=1.5*hr,x.L=R,x.j.info("backChannelRequestTimeoutMs_="+R)),R=x;const hn=d.g;if(hn){const ki=hn.g?hn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(ki){var te=R.h;te.g||ki.indexOf("spdy")==-1&&ki.indexOf("quic")==-1&&ki.indexOf("h2")==-1||(te.j=te.l,te.g=new Set,te.h&&(ro(te,te.h),te.h=null))}if(R.D){const Xl=hn.g?hn.g.getResponseHeader("X-HTTP-Session-Id"):null;Xl&&(R.ya=Xl,pt(R.I,R.D,Xl))}}x.G=3,x.l&&x.l.ua(),x.ba&&(x.R=Date.now()-d.F,x.j.info("Handshake RTT: "+x.R+"ms")),R=x;var pe=d;if(R.qa=uh(R,R.J?R.ia:null,R.W),pe.K){Sn(R.h,pe);var We=pe,Xt=R.L;Xt&&(We.I=Xt),We.B&&(Yr(We),Ys(We)),R.g=pe}else ah(R);0<x.i.length&&fo(x)}else Je[0]!="stop"&&Je[0]!="close"||ur(x,7);else x.G==3&&(Je[0]=="stop"||Je[0]=="close"?Je[0]=="stop"?ur(x,7):Kl(x):Je[0]!="noop"&&x.l&&x.l.ta(Je),x.v=0)}}Hr(4)}catch{}}var Zu=class{constructor(d,v){this.g=d,this.map=v}};function rr(d){this.l=d||10,h.PerformanceNavigationTiming?(d=h.performance.getEntriesByType("navigation"),d=0<d.length&&(d[0].nextHopProtocol=="hq"||d[0].nextHopProtocol=="h2")):d=!!(h.chrome&&h.chrome.loadTimes&&h.chrome.loadTimes()&&h.chrome.loadTimes().wasFetchedViaSpdy),this.j=d?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function no(d){return d.h?!0:d.g?d.g.size>=d.j:!1}function io(d){return d.h?1:d.g?d.g.size:0}function Ll(d,v){return d.h?d.h==v:d.g?d.g.has(v):!1}function ro(d,v){d.g?d.g.add(v):d.h=v}function Sn(d,v){d.h&&d.h==v?d.h=null:d.g&&d.g.has(v)&&d.g.delete(v)}rr.prototype.cancel=function(){if(this.i=Fl(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const d of this.g.values())d.cancel();this.g.clear()}};function Fl(d){if(d.h!=null)return d.i.concat(d.h.D);if(d.g!=null&&d.g.size!==0){let v=d.i;for(const x of d.g.values())v=v.concat(x.D);return v}return L(d.i)}function Wf(d){if(d.V&&typeof d.V=="function")return d.V();if(typeof Map<"u"&&d instanceof Map||typeof Set<"u"&&d instanceof Set)return Array.from(d.values());if(typeof d=="string")return d.split("");if(m(d)){for(var v=[],x=d.length,R=0;R<x;R++)v.push(d[R]);return v}v=[],x=0;for(R in d)v[x++]=d[R];return v}function so(d){if(d.na&&typeof d.na=="function")return d.na();if(!d.V||typeof d.V!="function"){if(typeof Map<"u"&&d instanceof Map)return Array.from(d.keys());if(!(typeof Set<"u"&&d instanceof Set)){if(m(d)||typeof d=="string"){var v=[];d=d.length;for(var x=0;x<d;x++)v.push(x);return v}v=[],x=0;for(const R in d)v[x++]=R;return v}}}function Ul(d,v){if(d.forEach&&typeof d.forEach=="function")d.forEach(v,void 0);else if(m(d)||typeof d=="string")Array.prototype.forEach.call(d,v,void 0);else for(var x=so(d),R=Wf(d),K=R.length,te=0;te<K;te++)v.call(void 0,R[te],x&&x[te],d)}var Qs=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Jf(d,v){if(d){d=d.split("&");for(var x=0;x<d.length;x++){var R=d[x].indexOf("="),K=null;if(0<=R){var te=d[x].substring(0,R);K=d[x].substring(R+1)}else te=d[x];v(te,K?decodeURIComponent(K.replace(/\+/g," ")):"")}}}function Ut(d){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,d instanceof Ut){this.h=d.h,Xs(this,d.j),this.o=d.o,this.g=d.g,$r(this,d.s),this.l=d.l;var v=d.i,x=new ar;x.i=v.i,v.g&&(x.g=new Map(v.g),x.h=v.h),sr(this,x),this.m=d.m}else d&&(v=String(d).match(Qs))?(this.h=!1,Xs(this,v[1]||"",!0),this.o=ri(v[2]||""),this.g=ri(v[3]||"",!0),$r(this,v[4]),this.l=ri(v[5]||"",!0),sr(this,v[6]||"",!0),this.m=ri(v[7]||"")):(this.h=!1,this.i=new ar(null,this.h))}Ut.prototype.toString=function(){var d=[],v=this.j;v&&d.push(Js(v,zl,!0),":");var x=this.g;return(x||v=="file")&&(d.push("//"),(v=this.o)&&d.push(Js(v,zl,!0),"@"),d.push(encodeURIComponent(String(x)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),x=this.s,x!=null&&d.push(":",String(x))),(x=this.l)&&(this.g&&x.charAt(0)!="/"&&d.push("/"),d.push(Js(x,x.charAt(0)=="/"?Zf:ql,!0))),(x=this.i.toString())&&d.push("?",x),(x=this.m)&&d.push("#",Js(x,ao)),d.join("")};function zn(d){return new Ut(d)}function Xs(d,v,x){d.j=x?ri(v,!0):v,d.j&&(d.j=d.j.replace(/:$/,""))}function $r(d,v){if(v){if(v=Number(v),isNaN(v)||0>v)throw Error("Bad port number "+v);d.s=v}else d.s=null}function sr(d,v,x){v instanceof ar?(d.i=v,th(d.i,d.h)):(x||(v=Js(v,em)),d.i=new ar(v,d.h))}function pt(d,v,x){d.i.set(v,x)}function Ws(d){return pt(d,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),d}function ri(d,v){return d?v?decodeURI(d.replace(/%25/g,"%2525")):decodeURIComponent(d):""}function Js(d,v,x){return typeof d=="string"?(d=encodeURI(d).replace(v,eh),x&&(d=d.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),d):null}function eh(d){return d=d.charCodeAt(0),"%"+(d>>4&15).toString(16)+(d&15).toString(16)}var zl=/[#\/\?@]/g,ql=/[#\?:]/g,Zf=/[#\?]/g,em=/[#\?@]/g,ao=/#/g;function ar(d,v){this.h=this.g=null,this.i=d||null,this.j=!!v}function si(d){d.g||(d.g=new Map,d.h=0,d.i&&Jf(d.i,function(v,x){d.add(decodeURIComponent(v.replace(/\+/g," ")),x)}))}i=ar.prototype,i.add=function(d,v){si(this),this.i=null,d=Pi(this,d);var x=this.g.get(d);return x||this.g.set(d,x=[]),x.push(v),this.h+=1,this};function or(d,v){si(d),v=Pi(d,v),d.g.has(v)&&(d.i=null,d.h-=d.g.get(v).length,d.g.delete(v))}function lr(d,v){return si(d),v=Pi(d,v),d.g.has(v)}i.forEach=function(d,v){si(this),this.g.forEach(function(x,R){x.forEach(function(K){d.call(v,K,R,this)},this)},this)},i.na=function(){si(this);const d=Array.from(this.g.values()),v=Array.from(this.g.keys()),x=[];for(let R=0;R<v.length;R++){const K=d[R];for(let te=0;te<K.length;te++)x.push(v[R])}return x},i.V=function(d){si(this);let v=[];if(typeof d=="string")lr(this,d)&&(v=v.concat(this.g.get(Pi(this,d))));else{d=Array.from(this.g.values());for(let x=0;x<d.length;x++)v=v.concat(d[x])}return v},i.set=function(d,v){return si(this),this.i=null,d=Pi(this,d),lr(this,d)&&(this.h-=this.g.get(d).length),this.g.set(d,[v]),this.h+=1,this},i.get=function(d,v){return d?(d=this.V(d),0<d.length?String(d[0]):v):v};function Bl(d,v,x){or(d,v),0<x.length&&(d.i=null,d.g.set(Pi(d,v),L(x)),d.h+=x.length)}i.toString=function(){if(this.i)return this.i;if(!this.g)return"";const d=[],v=Array.from(this.g.keys());for(var x=0;x<v.length;x++){var R=v[x];const te=encodeURIComponent(String(R)),pe=this.V(R);for(R=0;R<pe.length;R++){var K=te;pe[R]!==""&&(K+="="+encodeURIComponent(String(pe[R]))),d.push(K)}}return this.i=d.join("&")};function Pi(d,v){return v=String(v),d.j&&(v=v.toLowerCase()),v}function th(d,v){v&&!d.j&&(si(d),d.i=null,d.g.forEach(function(x,R){var K=R.toLowerCase();R!=K&&(or(this,R),Bl(this,K,x))},d)),d.j=v}function Zs(d,v){const x=new ii;if(h.Image){const R=new Image;R.onload=I(ai,x,"TestLoadImage: loaded",!0,v,R),R.onerror=I(ai,x,"TestLoadImage: error",!1,v,R),R.onabort=I(ai,x,"TestLoadImage: abort",!1,v,R),R.ontimeout=I(ai,x,"TestLoadImage: timeout",!1,v,R),h.setTimeout(function(){R.ontimeout&&R.ontimeout()},1e4),R.src=d}else v(!1)}function bi(d,v){const x=new ii,R=new AbortController,K=setTimeout(()=>{R.abort(),ai(x,"TestPingServer: timeout",!1,v)},1e4);fetch(d,{signal:R.signal}).then(te=>{clearTimeout(K),te.ok?ai(x,"TestPingServer: ok",!0,v):ai(x,"TestPingServer: server error",!1,v)}).catch(()=>{clearTimeout(K),ai(x,"TestPingServer: error",!1,v)})}function ai(d,v,x,R,K){try{K&&(K.onload=null,K.onerror=null,K.onabort=null,K.ontimeout=null),R(x)}catch{}}function ea(){this.g=new Gs}function Di(d,v,x){const R=x||"";try{Ul(d,function(K,te){let pe=K;y(K)&&(pe=Un(K)),v.push(R+te+"="+encodeURIComponent(pe))})}catch(K){throw v.push(R+"type="+encodeURIComponent("_badmap")),K}}function Qr(d){this.l=d.Ub||null,this.j=d.eb||!1}V(Qr,Pl),Qr.prototype.g=function(){return new cr(this.l,this.j)},Qr.prototype.i=function(d){return function(){return d}}({});function cr(d,v){mt.call(this),this.D=d,this.o=v,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}V(cr,mt),i=cr.prototype,i.open=function(d,v){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=d,this.A=v,this.readyState=1,Oi(this)},i.send=function(d){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const v={headers:this.u,method:this.B,credentials:this.m,cache:void 0};d&&(v.body=d),(this.D||h).fetch(new Request(this.A,v)).then(this.Sa.bind(this),this.ga.bind(this))},i.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Vi(this)),this.readyState=0},i.Sa=function(d){if(this.g&&(this.l=d,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=d.headers,this.readyState=2,Oi(this)),this.g&&(this.readyState=3,Oi(this),this.g)))if(this.responseType==="arraybuffer")d.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof h.ReadableStream<"u"&&"body"in d){if(this.j=d.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Hl(this)}else d.text().then(this.Ra.bind(this),this.ga.bind(this))};function Hl(d){d.j.read().then(d.Pa.bind(d)).catch(d.ga.bind(d))}i.Pa=function(d){if(this.g){if(this.o&&d.value)this.response.push(d.value);else if(!this.o){var v=d.value?d.value:new Uint8Array(0);(v=this.v.decode(v,{stream:!d.done}))&&(this.response=this.responseText+=v)}d.done?Vi(this):Oi(this),this.readyState==3&&Hl(this)}},i.Ra=function(d){this.g&&(this.response=this.responseText=d,Vi(this))},i.Qa=function(d){this.g&&(this.response=d,Vi(this))},i.ga=function(){this.g&&Vi(this)};function Vi(d){d.readyState=4,d.l=null,d.j=null,d.v=null,Oi(d)}i.setRequestHeader=function(d,v){this.u.append(d,v)},i.getResponseHeader=function(d){return this.h&&this.h.get(d.toLowerCase())||""},i.getAllResponseHeaders=function(){if(!this.h)return"";const d=[],v=this.h.entries();for(var x=v.next();!x.done;)x=x.value,d.push(x[0]+": "+x[1]),x=v.next();return d.join(`\r
`)};function Oi(d){d.onreadystatechange&&d.onreadystatechange.call(d)}Object.defineProperty(cr.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(d){this.m=d?"include":"same-origin"}});function Gl(d){let v="";return re(d,function(x,R){v+=R,v+=":",v+=x,v+=`\r
`}),v}function nn(d,v,x){e:{for(R in x){var R=!1;break e}R=!0}R||(x=Gl(x),typeof d=="string"?x!=null&&encodeURIComponent(String(x)):pt(d,v,x))}function ot(d){mt.call(this),this.headers=new Map,this.o=d||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}V(ot,mt);var oo=/^https?$/i,ta=["POST","PUT"];i=ot.prototype,i.Ha=function(d){this.J=d},i.ea=function(d,v,x,R){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+d);v=v?v.toUpperCase():"GET",this.D=d,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Ii.g(),this.v=this.o?Dl(this.o):Dl(Ii),this.g.onreadystatechange=T(this.Ea,this);try{this.B=!0,this.g.open(v,String(d),!0),this.B=!1}catch(te){nh(this,te);return}if(d=x||"",x=new Map(this.headers),R)if(Object.getPrototypeOf(R)===Object.prototype)for(var K in R)x.set(K,R[K]);else if(typeof R.keys=="function"&&typeof R.get=="function")for(const te of R.keys())x.set(te,R.get(te));else throw Error("Unknown input type for opt_headers: "+String(R));R=Array.from(x.keys()).find(te=>te.toLowerCase()=="content-type"),K=h.FormData&&d instanceof h.FormData,!(0<=Array.prototype.indexOf.call(ta,v,void 0))||R||K||x.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[te,pe]of x)this.g.setRequestHeader(te,pe);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{na(this),this.u=!0,this.g.send(d),this.u=!1}catch(te){nh(this,te)}};function nh(d,v){d.h=!1,d.g&&(d.j=!0,d.g.abort(),d.j=!1),d.l=v,d.m=5,lo(d),Mi(d)}function lo(d){d.A||(d.A=!0,rt(d,"complete"),rt(d,"error"))}i.abort=function(d){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=d||7,rt(this,"complete"),rt(this,"abort"),Mi(this))},i.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Mi(this,!0)),ot.aa.N.call(this)},i.Ea=function(){this.s||(this.B||this.u||this.j?co(this):this.bb())},i.bb=function(){co(this)};function co(d){if(d.h&&typeof u<"u"&&(!d.v[1]||oi(d)!=4||d.Z()!=2)){if(d.u&&oi(d)==4)$t(d.Ea,0,d);else if(rt(d,"readystatechange"),oi(d)==4){d.h=!1;try{const pe=d.Z();e:switch(pe){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var v=!0;break e;default:v=!1}var x;if(!(x=v)){var R;if(R=pe===0){var K=String(d.D).match(Qs)[1]||null;!K&&h.self&&h.self.location&&(K=h.self.location.protocol.slice(0,-1)),R=!oo.test(K?K.toLowerCase():"")}x=R}if(x)rt(d,"complete"),rt(d,"success");else{d.m=6;try{var te=2<oi(d)?d.g.statusText:""}catch{te=""}d.l=te+" ["+d.Z()+"]",lo(d)}}finally{Mi(d)}}}}function Mi(d,v){if(d.g){na(d);const x=d.g,R=d.v[0]?()=>{}:null;d.g=null,d.v=null,v||rt(d,"ready");try{x.onreadystatechange=R}catch{}}}function na(d){d.I&&(h.clearTimeout(d.I),d.I=null)}i.isActive=function(){return!!this.g};function oi(d){return d.g?d.g.readyState:0}i.Z=function(){try{return 2<oi(this)?this.g.status:-1}catch{return-1}},i.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},i.Oa=function(d){if(this.g){var v=this.g.responseText;return d&&v.indexOf(d)==0&&(v=v.substring(d.length)),Za(v)}};function ih(d){try{if(!d.g)return null;if("response"in d.g)return d.g.response;switch(d.H){case"":case"text":return d.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in d.g)return d.g.mozResponseArrayBuffer}return null}catch{return null}}function tm(d){const v={};d=(d.g&&2<=oi(d)&&d.g.getAllResponseHeaders()||"").split(`\r
`);for(let R=0;R<d.length;R++){if(se(d[R]))continue;var x=D(d[R]);const K=x[0];if(x=x[1],typeof x!="string")continue;x=x.trim();const te=v[K]||[];v[K]=te,te.push(x)}P(v,function(R){return R.join(", ")})}i.Ba=function(){return this.m},i.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function ia(d,v,x){return x&&x.internalChannelParams&&x.internalChannelParams[d]||v}function uo(d){this.Aa=0,this.i=[],this.j=new ii,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=ia("failFast",!1,d),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=ia("baseRetryDelayMs",5e3,d),this.cb=ia("retryDelaySeedMs",1e4,d),this.Wa=ia("forwardChannelMaxRetries",2,d),this.wa=ia("forwardChannelRequestTimeoutMs",2e4,d),this.pa=d&&d.xmlHttpFactory||void 0,this.Xa=d&&d.Tb||void 0,this.Ca=d&&d.useFetchStreams||!1,this.L=void 0,this.J=d&&d.supportsCrossDomainXhr||!1,this.K="",this.h=new rr(d&&d.concurrentRequestLimit),this.Da=new ea,this.P=d&&d.fastHandshake||!1,this.O=d&&d.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=d&&d.Rb||!1,d&&d.xa&&this.j.xa(),d&&d.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&d&&d.detectBufferingProxy||!1,this.ja=void 0,d&&d.longPollingTimeout&&0<d.longPollingTimeout&&(this.ja=d.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}i=uo.prototype,i.la=8,i.G=1,i.connect=function(d,v,x,R){Tt(0),this.W=d,this.H=v||{},x&&R!==void 0&&(this.H.OSID=x,this.H.OAID=R),this.F=this.X,this.I=uh(this,null,this.W),fo(this)};function Kl(d){if(rh(d),d.G==3){var v=d.U++,x=zn(d.I);if(pt(x,"SID",d.K),pt(x,"RID",v),pt(x,"TYPE","terminate"),ra(d,x),v=new Rn(d,d.j,v),v.L=2,v.v=Ws(zn(x)),x=!1,h.navigator&&h.navigator.sendBeacon)try{x=h.navigator.sendBeacon(v.v.toString(),"")}catch{}!x&&h.Image&&(new Image().src=v.v,x=!0),x||(v.g=hh(v.j,null),v.g.ea(v.v)),v.F=Date.now(),Ys(v)}ch(d)}function ho(d){d.g&&(sa(d),d.g.cancel(),d.g=null)}function rh(d){ho(d),d.u&&(h.clearTimeout(d.u),d.u=null),mo(d),d.h.cancel(),d.s&&(typeof d.s=="number"&&h.clearTimeout(d.s),d.s=null)}function fo(d){if(!no(d.h)&&!d.s){d.s=!0;var v=d.Ga;X||C(),ae||(X(),ae=!0),me.add(v,d),d.B=0}}function nm(d,v){return io(d.h)>=d.h.j-(d.s?1:0)?!1:d.s?(d.i=v.D.concat(d.i),!0):d.G==1||d.G==2||d.B>=(d.Va?0:d.Wa)?!1:(d.s=Ft(T(d.Ga,d,v),Ql(d,d.B)),d.B++,!0)}i.Ga=function(d){if(this.s)if(this.s=null,this.G==1){if(!d){this.U=Math.floor(1e5*Math.random()),d=this.U++;const K=new Rn(this,this.j,d);let te=this.o;if(this.S&&(te?(te=S(te),M(te,this.S)):te=this.S),this.m!==null||this.O||(K.H=te,te=null),this.P)e:{for(var v=0,x=0;x<this.i.length;x++){t:{var R=this.i[x];if("__data__"in R.map&&(R=R.map.__data__,typeof R=="string")){R=R.length;break t}R=void 0}if(R===void 0)break;if(v+=R,4096<v){v=x;break e}if(v===4096||x===this.i.length-1){v=x+1;break e}}v=1e3}else v=1e3;v=sh(this,K,v),x=zn(this.I),pt(x,"RID",d),pt(x,"CVER",22),this.D&&pt(x,"X-HTTP-Session-Id",this.D),ra(this,x),te&&(this.O?v="headers="+encodeURIComponent(String(Gl(te)))+"&"+v:this.m&&nn(x,this.m,te)),ro(this.h,K),this.Ua&&pt(x,"TYPE","init"),this.P?(pt(x,"$req",v),pt(x,"SID","null"),K.T=!0,_i(K,x,null)):_i(K,x,v),this.G=2}}else this.G==3&&(d?Yl(this,d):this.i.length==0||no(this.h)||Yl(this))};function Yl(d,v){var x;v?x=v.l:x=d.U++;const R=zn(d.I);pt(R,"SID",d.K),pt(R,"RID",x),pt(R,"AID",d.T),ra(d,R),d.m&&d.o&&nn(R,d.m,d.o),x=new Rn(d,d.j,x,d.B+1),d.m===null&&(x.H=d.o),v&&(d.i=v.D.concat(d.i)),v=sh(d,x,1e3),x.I=Math.round(.5*d.wa)+Math.round(.5*d.wa*Math.random()),ro(d.h,x),_i(x,R,v)}function ra(d,v){d.H&&re(d.H,function(x,R){pt(v,R,x)}),d.l&&Ul({},function(x,R){pt(v,R,x)})}function sh(d,v,x){x=Math.min(d.i.length,x);var R=d.l?T(d.l.Na,d.l,d):null;e:{var K=d.i;let te=-1;for(;;){const pe=["count="+x];te==-1?0<x?(te=K[0].g,pe.push("ofs="+te)):te=0:pe.push("ofs="+te);let We=!0;for(let Xt=0;Xt<x;Xt++){let Je=K[Xt].g;const rn=K[Xt].map;if(Je-=te,0>Je)te=Math.max(0,K[Xt].g-100),We=!1;else try{Di(rn,pe,"req"+Je+"_")}catch{R&&R(rn)}}if(We){R=pe.join("&");break e}}}return d=d.i.splice(0,x),v.D=d,R}function ah(d){if(!d.g&&!d.u){d.Y=1;var v=d.Fa;X||C(),ae||(X(),ae=!0),me.add(v,d),d.v=0}}function $l(d){return d.g||d.u||3<=d.v?!1:(d.Y++,d.u=Ft(T(d.Fa,d),Ql(d,d.v)),d.v++,!0)}i.Fa=function(){if(this.u=null,oh(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var d=2*this.R;this.j.info("BP detection timer enabled: "+d),this.A=Ft(T(this.ab,this),d)}},i.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Tt(10),ho(this),oh(this))};function sa(d){d.A!=null&&(h.clearTimeout(d.A),d.A=null)}function oh(d){d.g=new Rn(d,d.j,"rpc",d.Y),d.m===null&&(d.g.H=d.o),d.g.O=0;var v=zn(d.qa);pt(v,"RID","rpc"),pt(v,"SID",d.K),pt(v,"AID",d.T),pt(v,"CI",d.F?"0":"1"),!d.F&&d.ja&&pt(v,"TO",d.ja),pt(v,"TYPE","xmlhttp"),ra(d,v),d.m&&d.o&&nn(v,d.m,d.o),d.L&&(d.g.I=d.L);var x=d.g;d=d.ia,x.L=1,x.v=Ws(zn(v)),x.m=null,x.P=!0,ir(x,d)}i.Za=function(){this.C!=null&&(this.C=null,ho(this),$l(this),Tt(19))};function mo(d){d.C!=null&&(h.clearTimeout(d.C),d.C=null)}function lh(d,v){var x=null;if(d.g==v){mo(d),sa(d),d.g=null;var R=2}else if(Ll(d.h,v))x=v.D,Sn(d.h,v),R=1;else return;if(d.G!=0){if(v.o)if(R==1){x=v.m?v.m.length:0,v=Date.now()-v.F;var K=d.B;R=Br(),rt(R,new Qt(R,x)),fo(d)}else ah(d);else if(K=v.s,K==3||K==0&&0<v.X||!(R==1&&nm(d,v)||R==2&&$l(d)))switch(x&&0<x.length&&(v=d.h,v.i=v.i.concat(x)),K){case 1:ur(d,5);break;case 4:ur(d,10);break;case 3:ur(d,6);break;default:ur(d,2)}}}function Ql(d,v){let x=d.Ta+Math.floor(Math.random()*d.cb);return d.isActive()||(x*=2),x*v}function ur(d,v){if(d.j.info("Error code "+v),v==2){var x=T(d.fb,d),R=d.Xa;const K=!R;R=new Ut(R||"//www.google.com/images/cleardot.gif"),h.location&&h.location.protocol=="http"||Xs(R,"https"),Ws(R),K?Zs(R.toString(),x):bi(R.toString(),x)}else Tt(2);d.G=0,d.l&&d.l.sa(v),ch(d),rh(d)}i.fb=function(d){d?(this.j.info("Successfully pinged google.com"),Tt(2)):(this.j.info("Failed to ping google.com"),Tt(1))};function ch(d){if(d.G=0,d.ka=[],d.l){const v=Fl(d.h);(v.length!=0||d.i.length!=0)&&(O(d.ka,v),O(d.ka,d.i),d.h.i.length=0,L(d.i),d.i.length=0),d.l.ra()}}function uh(d,v,x){var R=x instanceof Ut?zn(x):new Ut(x);if(R.g!="")v&&(R.g=v+"."+R.g),$r(R,R.s);else{var K=h.location;R=K.protocol,v=v?v+"."+K.hostname:K.hostname,K=+K.port;var te=new Ut(null);R&&Xs(te,R),v&&(te.g=v),K&&$r(te,K),x&&(te.l=x),R=te}return x=d.D,v=d.ya,x&&v&&pt(R,x,v),pt(R,"VER",d.la),ra(d,R),R}function hh(d,v,x){if(v&&!d.J)throw Error("Can't create secondary domain capable XhrIo object.");return v=d.Ca&&!d.pa?new ot(new Qr({eb:x})):new ot(d.pa),v.Ha(d.J),v}i.isActive=function(){return!!this.l&&this.l.isActive(this)};function dh(){}i=dh.prototype,i.ua=function(){},i.ta=function(){},i.sa=function(){},i.ra=function(){},i.isActive=function(){return!0},i.Na=function(){};function po(){}po.prototype.g=function(d,v){return new An(d,v)};function An(d,v){mt.call(this),this.g=new uo(v),this.l=d,this.h=v&&v.messageUrlParams||null,d=v&&v.messageHeaders||null,v&&v.clientProtocolHeaderRequired&&(d?d["X-Client-Protocol"]="webchannel":d={"X-Client-Protocol":"webchannel"}),this.g.o=d,d=v&&v.initMessageHeaders||null,v&&v.messageContentType&&(d?d["X-WebChannel-Content-Type"]=v.messageContentType:d={"X-WebChannel-Content-Type":v.messageContentType}),v&&v.va&&(d?d["X-WebChannel-Client-Profile"]=v.va:d={"X-WebChannel-Client-Profile":v.va}),this.g.S=d,(d=v&&v.Sb)&&!se(d)&&(this.g.m=d),this.v=v&&v.supportsCrossDomainXhr||!1,this.u=v&&v.sendRawJson||!1,(v=v&&v.httpSessionIdParam)&&!se(v)&&(this.g.D=v,d=this.h,d!==null&&v in d&&(d=this.h,v in d&&delete d[v])),this.j=new ji(this)}V(An,mt),An.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},An.prototype.close=function(){Kl(this.g)},An.prototype.o=function(d){var v=this.g;if(typeof d=="string"){var x={};x.__data__=d,d=x}else this.u&&(x={},x.__data__=Un(d),d=x);v.i.push(new Zu(v.Ya++,d)),v.G==3&&fo(v)},An.prototype.N=function(){this.g.l=null,delete this.j,Kl(this.g),delete this.g,An.aa.N.call(this)};function fh(d){tr.call(this),d.__headers__&&(this.headers=d.__headers__,this.statusCode=d.__status__,delete d.__headers__,delete d.__status__);var v=d.__sm__;if(v){e:{for(const x in v){d=x;break e}d=void 0}(this.i=d)&&(d=this.i,v=v!==null&&d in v?v[d]:void 0),this.data=v}else this.data=d}V(fh,tr);function mh(){Ol.call(this),this.status=1}V(mh,Ol);function ji(d){this.g=d}V(ji,dh),ji.prototype.ua=function(){rt(this.g,"a")},ji.prototype.ta=function(d){rt(this.g,new fh(d))},ji.prototype.sa=function(d){rt(this.g,new mh)},ji.prototype.ra=function(){rt(this.g,"b")},po.prototype.createWebChannel=po.prototype.g,An.prototype.send=An.prototype.o,An.prototype.open=An.prototype.m,An.prototype.close=An.prototype.close,Sw=function(){return new po},Rw=function(){return Br()},ww=Ai,Og={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Kr.NO_ERROR=0,Kr.TIMEOUT=8,Kr.HTTP_ERROR=6,Cd=Kr,nr.COMPLETE="complete",Tw=nr,Vl.EventType=er,er.OPEN="a",er.CLOSE="b",er.ERROR="c",er.MESSAGE="d",mt.prototype.listen=mt.prototype.K,Kc=Vl,ot.prototype.listenOnce=ot.prototype.L,ot.prototype.getLastError=ot.prototype.Ka,ot.prototype.getLastErrorCode=ot.prototype.Ba,ot.prototype.getStatus=ot.prototype.Z,ot.prototype.getResponseJson=ot.prototype.Oa,ot.prototype.getResponseText=ot.prototype.oa,ot.prototype.send=ot.prototype.ea,ot.prototype.setWithCredentials=ot.prototype.Ha,Ew=ot}).apply(typeof yd<"u"?yd:typeof self<"u"?self:typeof window<"u"?window:{});const Fx="@firebase/firestore",Ux="4.9.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}pn.UNAUTHENTICATED=new pn(null),pn.GOOGLE_CREDENTIALS=new pn("google-credentials-uid"),pn.FIRST_PARTY=new pn("first-party-uid"),pn.MOCK_USER=new pn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Sl="12.0.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const za=new py("@firebase/firestore");function Wo(){return za.logLevel}function fe(i,...e){if(za.logLevel<=Ge.DEBUG){const t=e.map(Iy);za.debug(`Firestore (${Sl}): ${i}`,...t)}}function Nn(i,...e){if(za.logLevel<=Ge.ERROR){const t=e.map(Iy);za.error(`Firestore (${Sl}): ${i}`,...t)}}function qa(i,...e){if(za.logLevel<=Ge.WARN){const t=e.map(Iy);za.warn(`Firestore (${Sl}): ${i}`,...t)}}function Iy(i){if(typeof i=="string")return i;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(i)}catch{return i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Te(i,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,Aw(i,r,t)}function Aw(i,e,t){let r=`FIRESTORE (${Sl}) INTERNAL ASSERTION FAILED: ${e} (ID: ${i.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw Nn(r),new Error(r)}function we(i,e,t,r){let a="Unexpected state";typeof t=="string"?a=t:r=t,i||Aw(e,a,r)}function Oe(i,e){return i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oe={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ye extends jr{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yi{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Iw{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class ED{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(pn.UNAUTHENTICATED))}shutdown(){}}class TD{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class wD{constructor(e){this.t=e,this.currentUser=pn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){we(this.o===void 0,42304);let r=this.i;const a=m=>this.i!==r?(r=this.i,t(m)):Promise.resolve();let l=new Yi;this.o=()=>{this.i++,this.currentUser=this.u(),l.resolve(),l=new Yi,e.enqueueRetryable(()=>a(this.currentUser))};const u=()=>{const m=l;e.enqueueRetryable(async()=>{await m.promise,await a(this.currentUser)})},h=m=>{fe("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=m,this.o&&(this.auth.addAuthTokenListener(this.o),u())};this.t.onInit(m=>h(m)),setTimeout(()=>{if(!this.auth){const m=this.t.getImmediate({optional:!0});m?h(m):(fe("FirebaseAuthCredentialsProvider","Auth not yet detected"),l.resolve(),l=new Yi)}},0),u()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(fe("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(we(typeof r.accessToken=="string",31837,{l:r}),new Iw(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return we(e===null||typeof e=="string",2055,{h:e}),new pn(e)}}class RD{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=pn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class SD{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new RD(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(pn.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class zx{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class AD{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Wn(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){we(this.o===void 0,3512);const r=l=>{l.error!=null&&fe("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${l.error.message}`);const u=l.token!==this.m;return this.m=l.token,fe("FirebaseAppCheckTokenProvider",`Received ${u?"new":"existing"} token.`),u?t(l.token):Promise.resolve()};this.o=l=>{e.enqueueRetryable(()=>r(l))};const a=l=>{fe("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=l,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(l=>a(l)),setTimeout(()=>{if(!this.appCheck){const l=this.V.getImmediate({optional:!0});l?a(l):fe("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new zx(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(we(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new zx(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ID(i){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(i);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<i;r++)t[r]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ny{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const a=ID(40);for(let l=0;l<a.length;++l)r.length<20&&a[l]<t&&(r+=e.charAt(a[l]%62))}return r}}function Ve(i,e){return i<e?-1:i>e?1:0}function Mg(i,e){const t=Math.min(i.length,e.length);for(let r=0;r<t;r++){const a=i.charAt(r),l=e.charAt(r);if(a!==l)return lg(a)===lg(l)?Ve(a,l):lg(a)?1:-1}return Ve(i.length,e.length)}const ND=55296,CD=57343;function lg(i){const e=i.charCodeAt(0);return e>=ND&&e<=CD}function cl(i,e,t){return i.length===e.length&&i.every((r,a)=>t(r,e[a]))}function Nw(i){return i+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qx="__name__";class Bi{constructor(e,t,r){t===void 0?t=0:t>e.length&&Te(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&Te(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return Bi.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Bi?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let a=0;a<r;a++){const l=Bi.compareSegments(e.get(a),t.get(a));if(l!==0)return l}return Ve(e.length,t.length)}static compareSegments(e,t){const r=Bi.isNumericId(e),a=Bi.isNumericId(t);return r&&!a?-1:!r&&a?1:r&&a?Bi.extractNumericId(e).compare(Bi.extractNumericId(t)):Mg(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Ds.fromString(e.substring(4,e.length-2))}}class at extends Bi{construct(e,t,r){return new at(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new ye(oe.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(a=>a.length>0))}return new at(t)}static emptyPath(){return new at([])}}const PD=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class It extends Bi{construct(e,t,r){return new It(e,t,r)}static isValidIdentifier(e){return PD.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),It.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===qx}static keyField(){return new It([qx])}static fromServerFormat(e){const t=[];let r="",a=0;const l=()=>{if(r.length===0)throw new ye(oe.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let u=!1;for(;a<e.length;){const h=e[a];if(h==="\\"){if(a+1===e.length)throw new ye(oe.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const m=e[a+1];if(m!=="\\"&&m!=="."&&m!=="`")throw new ye(oe.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=m,a+=2}else h==="`"?(u=!u,a++):h!=="."||u?(r+=h,a++):(l(),a++)}if(l(),u)throw new ye(oe.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new It(t)}static emptyPath(){return new It([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _e{constructor(e){this.path=e}static fromPath(e){return new _e(at.fromString(e))}static fromName(e){return new _e(at.fromString(e).popFirst(5))}static empty(){return new _e(at.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&at.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return at.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new _e(new at(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cw(i,e,t){if(!t)throw new ye(oe.INVALID_ARGUMENT,`Function ${i}() cannot be called with an empty ${e}.`)}function DD(i,e,t,r){if(e===!0&&r===!0)throw new ye(oe.INVALID_ARGUMENT,`${i} and ${t} cannot be used together.`)}function Bx(i){if(!_e.isDocumentKey(i))throw new ye(oe.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${i} has ${i.length}.`)}function Hx(i){if(_e.isDocumentKey(i))throw new ye(oe.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${i} has ${i.length}.`)}function Pw(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}function Af(i){if(i===void 0)return"undefined";if(i===null)return"null";if(typeof i=="string")return i.length>20&&(i=`${i.substring(0,20)}...`),JSON.stringify(i);if(typeof i=="number"||typeof i=="boolean")return""+i;if(typeof i=="object"){if(i instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(i);return e?`a custom ${e} object`:"an object"}}return typeof i=="function"?"a function":Te(12329,{type:typeof i})}function Zn(i,e){if("_delegate"in i&&(i=i._delegate),!(i instanceof e)){if(e.name===i.constructor.name)throw new ye(oe.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Af(i);throw new ye(oe.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return i}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ht(i,e){const t={typeString:i};return e&&(t.value=e),t}function Ou(i,e){if(!Pw(i))throw new ye(oe.INVALID_ARGUMENT,"JSON must be an object");let t;for(const r in e)if(e[r]){const a=e[r].typeString,l="value"in e[r]?{value:e[r].value}:void 0;if(!(r in i)){t=`JSON missing required field: '${r}'`;break}const u=i[r];if(a&&typeof u!==a){t=`JSON field '${r}' must be a ${a}.`;break}if(l!==void 0&&u!==l.value){t=`Expected '${r}' field to equal '${l.value}'`;break}}if(t)throw new ye(oe.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gx=-62135596800,Kx=1e6;class ut{static now(){return ut.fromMillis(Date.now())}static fromDate(e){return ut.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*Kx);return new ut(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new ye(oe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new ye(oe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<Gx)throw new ye(oe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ye(oe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Kx}_compareTo(e){return this.seconds===e.seconds?Ve(this.nanoseconds,e.nanoseconds):Ve(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:ut._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Ou(e,ut._jsonSchema))return new ut(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-Gx;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}ut._jsonSchemaVersion="firestore/timestamp/1.0",ut._jsonSchema={type:Ht("string",ut._jsonSchemaVersion),seconds:Ht("number"),nanoseconds:Ht("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Se{static fromTimestamp(e){return new Se(e)}static min(){return new Se(new ut(0,0))}static max(){return new Se(new ut(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fu=-1;class Zd{constructor(e,t,r,a){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=a}}function jg(i){return i.fields.find(e=>e.kind===2)}function wa(i){return i.fields.filter(e=>e.kind!==2)}Zd.UNKNOWN_ID=-1;class Pd{constructor(e,t){this.fieldPath=e,this.kind=t}}class mu{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new mu(0,ti.min())}}function VD(i,e){const t=i.toTimestamp().seconds,r=i.toTimestamp().nanoseconds+1,a=Se.fromTimestamp(r===1e9?new ut(t+1,0):new ut(t,r));return new ti(a,_e.empty(),e)}function Dw(i){return new ti(i.readTime,i.key,fu)}class ti{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new ti(Se.min(),_e.empty(),fu)}static max(){return new ti(Se.max(),_e.empty(),fu)}}function Cy(i,e){let t=i.readTime.compareTo(e.readTime);return t!==0?t:(t=_e.comparator(i.documentKey,e.documentKey),t!==0?t:Ve(i.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vw="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Ow{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Xa(i){if(i.code!==oe.FAILED_PRECONDITION||i.message!==Vw)throw i;fe("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Te(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new Y((r,a)=>{this.nextCallback=l=>{this.wrapSuccess(e,l).next(r,a)},this.catchCallback=l=>{this.wrapFailure(t,l).next(r,a)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof Y?t:Y.resolve(t)}catch(t){return Y.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):Y.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):Y.reject(t)}static resolve(e){return new Y((t,r)=>{t(e)})}static reject(e){return new Y((t,r)=>{r(e)})}static waitFor(e){return new Y((t,r)=>{let a=0,l=0,u=!1;e.forEach(h=>{++a,h.next(()=>{++l,u&&l===a&&t()},m=>r(m))}),u=!0,l===a&&t()})}static or(e){let t=Y.resolve(!1);for(const r of e)t=t.next(a=>a?Y.resolve(a):r());return t}static forEach(e,t){const r=[];return e.forEach((a,l)=>{r.push(t.call(this,a,l))}),this.waitFor(r)}static mapArray(e,t){return new Y((r,a)=>{const l=e.length,u=new Array(l);let h=0;for(let m=0;m<l;m++){const y=m;t(e[y]).next(_=>{u[y]=_,++h,h===l&&r(u)},_=>a(_))}})}static doWhile(e,t){return new Y((r,a)=>{const l=()=>{e()===!0?t().next(()=>{l()},a):r()};l()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qn="SimpleDb";class If{static open(e,t,r,a){try{return new If(t,e.transaction(a,r))}catch(l){throw new eu(t,l)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new Yi,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new eu(e,t.error)):this.S.resolve()},this.transaction.onerror=r=>{const a=Py(r.target.error);this.S.reject(new eu(e,a))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(fe(Qn,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new MD(t)}}class Vs{static delete(e){return fe(Qn,"Removing database:",e),Sa(RT().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!OT())return!1;if(Vs.F())return!0;const e=en(),t=Vs.M(e),r=0<t&&t<10,a=Mw(e),l=0<a&&a<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||l)}static F(){return typeof process<"u"&&process.__PRIVATE_env?.__PRIVATE_USE_MOCK_PERSISTENCE==="YES"}static O(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}constructor(e,t,r){this.name=e,this.version=t,this.N=r,this.B=null,Vs.M(en())===12.2&&Nn("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(fe(Qn,"Opening database:",this.name),this.db=await new Promise((t,r)=>{const a=indexedDB.open(this.name,this.version);a.onsuccess=l=>{const u=l.target.result;t(u)},a.onblocked=()=>{r(new eu(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},a.onerror=l=>{const u=l.target.error;u.name==="VersionError"?r(new ye(oe.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):u.name==="InvalidStateError"?r(new ye(oe.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+u)):r(new eu(e,u))},a.onupgradeneeded=l=>{fe(Qn,'Database "'+this.name+'" requires upgrade from version:',l.oldVersion);const u=l.target.result;this.N.k(u,a.transaction,l.oldVersion,this.version).next(()=>{fe(Qn,"Database upgrade to version "+this.version+" complete")})}})),this.q&&(this.db.onversionchange=t=>this.q(t)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,r,a){const l=t==="readonly";let u=0;for(;;){++u;try{this.db=await this.L(e);const h=If.open(this.db,e,l?"readonly":"readwrite",r),m=a(h).next(y=>(h.C(),y)).catch(y=>(h.abort(y),Y.reject(y))).toPromise();return m.catch(()=>{}),await h.D,m}catch(h){const m=h,y=m.name!=="FirebaseError"&&u<3;if(fe(Qn,"Transaction failed with error:",m.message,"Retrying:",y),this.close(),!y)return Promise.reject(m)}}}close(){this.db&&this.db.close(),this.db=void 0}}function Mw(i){const e=i.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class OD{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return Sa(this.U.delete())}}class eu extends ye{constructor(e,t){super(oe.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function qs(i){return i.name==="IndexedDbTransactionError"}class MD{constructor(e){this.store=e}put(e,t){let r;return t!==void 0?(fe(Qn,"PUT",this.store.name,e,t),r=this.store.put(t,e)):(fe(Qn,"PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Sa(r)}add(e){return fe(Qn,"ADD",this.store.name,e,e),Sa(this.store.add(e))}get(e){return Sa(this.store.get(e)).next(t=>(t===void 0&&(t=null),fe(Qn,"GET",this.store.name,e,t),t))}delete(e){return fe(Qn,"DELETE",this.store.name,e),Sa(this.store.delete(e))}count(){return fe(Qn,"COUNT",this.store.name),Sa(this.store.count())}J(e,t){const r=this.options(e,t),a=r.index?this.store.index(r.index):this.store;if(typeof a.getAll=="function"){const l=a.getAll(r.range);return new Y((u,h)=>{l.onerror=m=>{h(m.target.error)},l.onsuccess=m=>{u(m.target.result)}})}{const l=this.cursor(r),u=[];return this.H(l,(h,m)=>{u.push(m)}).next(()=>u)}}Y(e,t){const r=this.store.getAll(e,t===null?void 0:t);return new Y((a,l)=>{r.onerror=u=>{l(u.target.error)},r.onsuccess=u=>{a(u.target.result)}})}Z(e,t){fe(Qn,"DELETE ALL",this.store.name);const r=this.options(e,t);r.X=!1;const a=this.cursor(r);return this.H(a,(l,u,h)=>h.delete())}ee(e,t){let r;t?r=e:(r={},t=e);const a=this.cursor(r);return this.H(a,t)}te(e){const t=this.cursor({});return new Y((r,a)=>{t.onerror=l=>{const u=Py(l.target.error);a(u)},t.onsuccess=l=>{const u=l.target.result;u?e(u.primaryKey,u.value).next(h=>{h?u.continue():r()}):r()}})}H(e,t){const r=[];return new Y((a,l)=>{e.onerror=u=>{l(u.target.error)},e.onsuccess=u=>{const h=u.target.result;if(!h)return void a();const m=new OD(h),y=t(h.primaryKey,h.value,m);if(y instanceof Y){const _=y.catch(b=>(m.done(),Y.reject(b)));r.push(_)}m.isDone?a():m.G===null?h.continue():h.continue(m.G)}}).next(()=>Y.waitFor(r))}options(e,t){let r;return e!==void 0&&(typeof e=="string"?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const r=this.store.index(e.index);return e.X?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Sa(i){return new Y((e,t)=>{i.onsuccess=r=>{const a=r.target.result;e(a)},i.onerror=r=>{const a=Py(r.target.error);t(a)}})}let Yx=!1;function Py(i){const e=Vs.M(en());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(i.message.indexOf(t)>=0){const r=new ye("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return Yx||(Yx=!0,setTimeout(()=>{throw r},0)),r}}return i}const tu="IndexBackfiller";class jD{constructor(e,t){this.asyncQueue=e,this.ne=t,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){fe(tu,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{const t=await this.ne.ie();fe(tu,`Documents written: ${t}`)}catch(t){qs(t)?fe(tu,"Ignoring IndexedDB error during index backfill: ",t):await Xa(t)}await this.re(6e4)})}}class kD{constructor(e,t){this.localStore=e,this.persistence=t}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.se(t,e))}se(e,t){const r=new Set;let a=t,l=!0;return Y.doWhile(()=>l===!0&&a>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(u=>{if(u!==null&&!r.has(u))return fe(tu,`Processing collection: ${u}`),this.oe(e,u,a).next(h=>{a-=h,r.add(u)});l=!1})).next(()=>t-a)}oe(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(a=>this.localStore.localDocuments.getNextDocuments(e,t,a,r).next(l=>{const u=l.changes;return this.localStore.indexManager.updateIndexEntries(e,u).next(()=>this._e(a,l)).next(h=>(fe(tu,`Updating offset: ${h}`),this.localStore.indexManager.updateCollectionGroup(e,t,h))).next(()=>u.size)}))}_e(e,t){let r=e;return t.changes.forEach((a,l)=>{const u=Dw(l);Cy(u,r)>0&&(r=u)}),new ti(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gi{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>t.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}gi.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Da=-1;function Nf(i){return i==null}function pu(i){return i===0&&1/i==-1/0}function LD(i){return typeof i=="number"&&Number.isInteger(i)&&!pu(i)&&i<=Number.MAX_SAFE_INTEGER&&i>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ef="";function En(i){let e="";for(let t=0;t<i.length;t++)e.length>0&&(e=$x(e)),e=FD(i.get(t),e);return $x(e)}function FD(i,e){let t=e;const r=i.length;for(let a=0;a<r;a++){const l=i.charAt(a);switch(l){case"\0":t+="";break;case ef:t+="";break;default:t+=l}}return t}function $x(i){return i+ef+""}function Hi(i){const e=i.length;if(we(e>=2,64408,{path:i}),e===2)return we(i.charAt(0)===ef&&i.charAt(1)==="",56145,{path:i}),at.emptyPath();const t=e-2,r=[];let a="";for(let l=0;l<e;){const u=i.indexOf(ef,l);switch((u<0||u>t)&&Te(50515,{path:i}),i.charAt(u+1)){case"":const h=i.substring(l,u);let m;a.length===0?m=h:(a+=h,m=a,a=""),r.push(m);break;case"":a+=i.substring(l,u),a+="\0";break;case"":a+=i.substring(l,u+1);break;default:Te(61167,{path:i})}l=u+2}return new at(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ra="remoteDocuments",Mu="owner",Go="owner",gu="mutationQueues",UD="userId",wi="mutations",Qx="batchId",Pa="userMutationsIndex",Xx=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dd(i,e){return[i,En(e)]}function jw(i,e,t){return[i,En(e),t]}const zD={},ul="documentMutations",tf="remoteDocumentsV14",qD=["prefixPath","collectionGroup","readTime","documentId"],Vd="documentKeyIndex",BD=["prefixPath","collectionGroup","documentId"],kw="collectionGroupIndex",HD=["collectionGroup","readTime","prefixPath","documentId"],yu="remoteDocumentGlobal",kg="remoteDocumentGlobalKey",hl="targets",Lw="queryTargetsIndex",GD=["canonicalId","targetId"],dl="targetDocuments",KD=["targetId","path"],Dy="documentTargetsIndex",YD=["path","targetId"],nf="targetGlobalKey",Va="targetGlobal",vu="collectionParents",$D=["collectionId","parent"],fl="clientMetadata",QD="clientId",Cf="bundles",XD="bundleId",Pf="namedQueries",WD="name",Vy="indexConfiguration",JD="indexId",Lg="collectionGroupIndex",ZD="collectionGroup",nu="indexState",eV=["indexId","uid"],Fw="sequenceNumberIndex",tV=["uid","sequenceNumber"],iu="indexEntries",nV=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],Uw="documentKeyIndex",iV=["indexId","uid","orderedDocumentKey"],Df="documentOverlays",rV=["userId","collectionPath","documentId"],Fg="collectionPathOverlayIndex",sV=["userId","collectionPath","largestBatchId"],zw="collectionGroupOverlayIndex",aV=["userId","collectionGroup","largestBatchId"],Oy="globals",oV="name",qw=[gu,wi,ul,Ra,hl,Mu,Va,dl,fl,yu,vu,Cf,Pf],lV=[...qw,Df],Bw=[gu,wi,ul,tf,hl,Mu,Va,dl,fl,yu,vu,Cf,Pf,Df],Hw=Bw,My=[...Hw,Vy,nu,iu],cV=My,Gw=[...My,Oy],uV=Gw;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ug extends Ow{constructor(e,t){super(),this.le=e,this.currentSequenceNumber=t}}function tn(i,e){const t=Oe(i);return Vs.O(t.le,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wx(i){let e=0;for(const t in i)Object.prototype.hasOwnProperty.call(i,t)&&e++;return e}function Bs(i,e){for(const t in i)Object.prototype.hasOwnProperty.call(i,t)&&e(t,i[t])}function Kw(i){for(const e in i)if(Object.prototype.hasOwnProperty.call(i,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class St{constructor(e,t){this.comparator=e,this.root=t||gn.EMPTY}insert(e,t){return new St(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,gn.BLACK,null,null))}remove(e){return new St(this.comparator,this.root.remove(e,this.comparator).copy(null,null,gn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const a=this.comparator(e,r.key);if(a===0)return t+r.left.size;a<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){const e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new vd(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new vd(this.root,e,this.comparator,!1)}getReverseIterator(){return new vd(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new vd(this.root,e,this.comparator,!0)}}class vd{constructor(e,t,r,a){this.isReverse=a,this.nodeStack=[];let l=1;for(;!e.isEmpty();)if(l=t?r(e.key,t):1,t&&a&&(l*=-1),l<0)e=this.isReverse?e.left:e.right;else{if(l===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class gn{constructor(e,t,r,a,l){this.key=e,this.value=t,this.color=r??gn.RED,this.left=a??gn.EMPTY,this.right=l??gn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,a,l){return new gn(e??this.key,t??this.value,r??this.color,a??this.left,l??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let a=this;const l=r(e,a.key);return a=l<0?a.copy(null,null,null,a.left.insert(e,t,r),null):l===0?a.copy(null,t,null,null,null):a.copy(null,null,null,null,a.right.insert(e,t,r)),a.fixUp()}removeMin(){if(this.left.isEmpty())return gn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,a=this;if(t(e,a.key)<0)a.left.isEmpty()||a.left.isRed()||a.left.left.isRed()||(a=a.moveRedLeft()),a=a.copy(null,null,null,a.left.remove(e,t),null);else{if(a.left.isRed()&&(a=a.rotateRight()),a.right.isEmpty()||a.right.isRed()||a.right.left.isRed()||(a=a.moveRedRight()),t(e,a.key)===0){if(a.right.isEmpty())return gn.EMPTY;r=a.right.min(),a=a.copy(r.key,r.value,null,null,a.right.removeMin())}a=a.copy(null,null,null,null,a.right.remove(e,t))}return a.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,gn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,gn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Te(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Te(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Te(27949);return e+(this.isRed()?0:1)}}gn.EMPTY=null,gn.RED=!0,gn.BLACK=!1;gn.EMPTY=new class{constructor(){this.size=0}get key(){throw Te(57766)}get value(){throw Te(16141)}get color(){throw Te(16727)}get left(){throw Te(29726)}get right(){throw Te(36894)}copy(e,t,r,a,l){return this}insert(e,t,r){return new gn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dt{constructor(e){this.comparator=e,this.data=new St(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const a=r.getNext();if(this.comparator(a.key,e[1])>=0)return;t(a.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Jx(this.data.getIterator())}getIteratorFrom(e){return new Jx(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof dt)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const a=t.getNext().key,l=r.getNext().key;if(this.comparator(a,l)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new dt(this.comparator);return t.data=e,t}}class Jx{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Ko(i){return i.hasNext()?i.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ln{constructor(e){this.fields=e,e.sort(It.comparator)}static empty(){return new Ln([])}unionWith(e){let t=new dt(It.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new Ln(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return cl(this.fields,e.fields,(t,r)=>t.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yw extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kt{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(a){try{return atob(a)}catch(l){throw typeof DOMException<"u"&&l instanceof DOMException?new Yw("Invalid base64 string: "+l):l}}(e);return new Kt(t)}static fromUint8Array(e){const t=function(a){let l="";for(let u=0;u<a.length;++u)l+=String.fromCharCode(a[u]);return l}(e);return new Kt(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const r=new Uint8Array(t.length);for(let a=0;a<t.length;a++)r[a]=t.charCodeAt(a);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ve(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Kt.EMPTY_BYTE_STRING=new Kt("");const hV=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Dr(i){if(we(!!i,39018),typeof i=="string"){let e=0;const t=hV.exec(i);if(we(!!t,46558,{timestamp:i}),t[1]){let a=t[1];a=(a+"000000000").substr(0,9),e=Number(a)}const r=new Date(i);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Rt(i.seconds),nanos:Rt(i.nanos)}}function Rt(i){return typeof i=="number"?i:typeof i=="string"?Number(i):0}function Vr(i){return typeof i=="string"?Kt.fromBase64String(i):Kt.fromUint8Array(i)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $w="server_timestamp",Qw="__type__",Xw="__previous_value__",Ww="__local_write_time__";function jy(i){return(i?.mapValue?.fields||{})[Qw]?.stringValue===$w}function Vf(i){const e=i.mapValue.fields[Xw];return jy(e)?Vf(e):e}function _u(i){const e=Dr(i.mapValue.fields[Ww].timestampValue);return new ut(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dV{constructor(e,t,r,a,l,u,h,m,y,_){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=a,this.ssl=l,this.forceLongPolling=u,this.autoDetectLongPolling=h,this.longPollingOptions=m,this.useFetchStreams=y,this.isUsingEmulator=_}}const rf="(default)";class Ba{constructor(e,t){this.projectId=e,this.database=t||rf}static empty(){return new Ba("","")}get isDefaultDatabase(){return this.database===rf}isEqual(e){return e instanceof Ba&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ky="__type__",Jw="__max__",As={mapValue:{fields:{__type__:{stringValue:Jw}}}},Ly="__vector__",ml="value",Od={nullValue:"NULL_VALUE"};function Ms(i){return"nullValue"in i?0:"booleanValue"in i?1:"integerValue"in i||"doubleValue"in i?2:"timestampValue"in i?3:"stringValue"in i?5:"bytesValue"in i?6:"referenceValue"in i?7:"geoPointValue"in i?8:"arrayValue"in i?9:"mapValue"in i?jy(i)?4:Zw(i)?9007199254740991:Of(i)?10:11:Te(28295,{value:i})}function Xi(i,e){if(i===e)return!0;const t=Ms(i);if(t!==Ms(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return i.booleanValue===e.booleanValue;case 4:return _u(i).isEqual(_u(e));case 3:return function(a,l){if(typeof a.timestampValue=="string"&&typeof l.timestampValue=="string"&&a.timestampValue.length===l.timestampValue.length)return a.timestampValue===l.timestampValue;const u=Dr(a.timestampValue),h=Dr(l.timestampValue);return u.seconds===h.seconds&&u.nanos===h.nanos}(i,e);case 5:return i.stringValue===e.stringValue;case 6:return function(a,l){return Vr(a.bytesValue).isEqual(Vr(l.bytesValue))}(i,e);case 7:return i.referenceValue===e.referenceValue;case 8:return function(a,l){return Rt(a.geoPointValue.latitude)===Rt(l.geoPointValue.latitude)&&Rt(a.geoPointValue.longitude)===Rt(l.geoPointValue.longitude)}(i,e);case 2:return function(a,l){if("integerValue"in a&&"integerValue"in l)return Rt(a.integerValue)===Rt(l.integerValue);if("doubleValue"in a&&"doubleValue"in l){const u=Rt(a.doubleValue),h=Rt(l.doubleValue);return u===h?pu(u)===pu(h):isNaN(u)&&isNaN(h)}return!1}(i,e);case 9:return cl(i.arrayValue.values||[],e.arrayValue.values||[],Xi);case 10:case 11:return function(a,l){const u=a.mapValue.fields||{},h=l.mapValue.fields||{};if(Wx(u)!==Wx(h))return!1;for(const m in u)if(u.hasOwnProperty(m)&&(h[m]===void 0||!Xi(u[m],h[m])))return!1;return!0}(i,e);default:return Te(52216,{left:i})}}function bu(i,e){return(i.values||[]).find(t=>Xi(t,e))!==void 0}function js(i,e){if(i===e)return 0;const t=Ms(i),r=Ms(e);if(t!==r)return Ve(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return Ve(i.booleanValue,e.booleanValue);case 2:return function(l,u){const h=Rt(l.integerValue||l.doubleValue),m=Rt(u.integerValue||u.doubleValue);return h<m?-1:h>m?1:h===m?0:isNaN(h)?isNaN(m)?0:-1:1}(i,e);case 3:return Zx(i.timestampValue,e.timestampValue);case 4:return Zx(_u(i),_u(e));case 5:return Mg(i.stringValue,e.stringValue);case 6:return function(l,u){const h=Vr(l),m=Vr(u);return h.compareTo(m)}(i.bytesValue,e.bytesValue);case 7:return function(l,u){const h=l.split("/"),m=u.split("/");for(let y=0;y<h.length&&y<m.length;y++){const _=Ve(h[y],m[y]);if(_!==0)return _}return Ve(h.length,m.length)}(i.referenceValue,e.referenceValue);case 8:return function(l,u){const h=Ve(Rt(l.latitude),Rt(u.latitude));return h!==0?h:Ve(Rt(l.longitude),Rt(u.longitude))}(i.geoPointValue,e.geoPointValue);case 9:return eE(i.arrayValue,e.arrayValue);case 10:return function(l,u){const h=l.fields||{},m=u.fields||{},y=h[ml]?.arrayValue,_=m[ml]?.arrayValue,b=Ve(y?.values?.length||0,_?.values?.length||0);return b!==0?b:eE(y,_)}(i.mapValue,e.mapValue);case 11:return function(l,u){if(l===As.mapValue&&u===As.mapValue)return 0;if(l===As.mapValue)return 1;if(u===As.mapValue)return-1;const h=l.fields||{},m=Object.keys(h),y=u.fields||{},_=Object.keys(y);m.sort(),_.sort();for(let b=0;b<m.length&&b<_.length;++b){const T=Mg(m[b],_[b]);if(T!==0)return T;const I=js(h[m[b]],y[_[b]]);if(I!==0)return I}return Ve(m.length,_.length)}(i.mapValue,e.mapValue);default:throw Te(23264,{he:t})}}function Zx(i,e){if(typeof i=="string"&&typeof e=="string"&&i.length===e.length)return Ve(i,e);const t=Dr(i),r=Dr(e),a=Ve(t.seconds,r.seconds);return a!==0?a:Ve(t.nanos,r.nanos)}function eE(i,e){const t=i.values||[],r=e.values||[];for(let a=0;a<t.length&&a<r.length;++a){const l=js(t[a],r[a]);if(l)return l}return Ve(t.length,r.length)}function pl(i){return zg(i)}function zg(i){return"nullValue"in i?"null":"booleanValue"in i?""+i.booleanValue:"integerValue"in i?""+i.integerValue:"doubleValue"in i?""+i.doubleValue:"timestampValue"in i?function(t){const r=Dr(t);return`time(${r.seconds},${r.nanos})`}(i.timestampValue):"stringValue"in i?i.stringValue:"bytesValue"in i?function(t){return Vr(t).toBase64()}(i.bytesValue):"referenceValue"in i?function(t){return _e.fromName(t).toString()}(i.referenceValue):"geoPointValue"in i?function(t){return`geo(${t.latitude},${t.longitude})`}(i.geoPointValue):"arrayValue"in i?function(t){let r="[",a=!0;for(const l of t.values||[])a?a=!1:r+=",",r+=zg(l);return r+"]"}(i.arrayValue):"mapValue"in i?function(t){const r=Object.keys(t.fields||{}).sort();let a="{",l=!0;for(const u of r)l?l=!1:a+=",",a+=`${u}:${zg(t.fields[u])}`;return a+"}"}(i.mapValue):Te(61005,{value:i})}function Md(i){switch(Ms(i)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Vf(i);return e?16+Md(e):16;case 5:return 2*i.stringValue.length;case 6:return Vr(i.bytesValue).approximateByteSize();case 7:return i.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((a,l)=>a+Md(l),0)}(i.arrayValue);case 10:case 11:return function(r){let a=0;return Bs(r.fields,(l,u)=>{a+=l.length+Md(u)}),a}(i.mapValue);default:throw Te(13486,{value:i})}}function xu(i,e){return{referenceValue:`projects/${i.projectId}/databases/${i.database}/documents/${e.path.canonicalString()}`}}function qg(i){return!!i&&"integerValue"in i}function Eu(i){return!!i&&"arrayValue"in i}function tE(i){return!!i&&"nullValue"in i}function nE(i){return!!i&&"doubleValue"in i&&isNaN(Number(i.doubleValue))}function jd(i){return!!i&&"mapValue"in i}function Of(i){return(i?.mapValue?.fields||{})[ky]?.stringValue===Ly}function ru(i){if(i.geoPointValue)return{geoPointValue:{...i.geoPointValue}};if(i.timestampValue&&typeof i.timestampValue=="object")return{timestampValue:{...i.timestampValue}};if(i.mapValue){const e={mapValue:{fields:{}}};return Bs(i.mapValue.fields,(t,r)=>e.mapValue.fields[t]=ru(r)),e}if(i.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(i.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=ru(i.arrayValue.values[t]);return e}return{...i}}function Zw(i){return(((i.mapValue||{}).fields||{}).__type__||{}).stringValue===Jw}const e1={mapValue:{fields:{[ky]:{stringValue:Ly},[ml]:{arrayValue:{}}}}};function fV(i){return"nullValue"in i?Od:"booleanValue"in i?{booleanValue:!1}:"integerValue"in i||"doubleValue"in i?{doubleValue:NaN}:"timestampValue"in i?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in i?{stringValue:""}:"bytesValue"in i?{bytesValue:""}:"referenceValue"in i?xu(Ba.empty(),_e.empty()):"geoPointValue"in i?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in i?{arrayValue:{}}:"mapValue"in i?Of(i)?e1:{mapValue:{}}:Te(35942,{value:i})}function mV(i){return"nullValue"in i?{booleanValue:!1}:"booleanValue"in i?{doubleValue:NaN}:"integerValue"in i||"doubleValue"in i?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in i?{stringValue:""}:"stringValue"in i?{bytesValue:""}:"bytesValue"in i?xu(Ba.empty(),_e.empty()):"referenceValue"in i?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in i?{arrayValue:{}}:"arrayValue"in i?e1:"mapValue"in i?Of(i)?{mapValue:{}}:As:Te(61959,{value:i})}function iE(i,e){const t=js(i.value,e.value);return t!==0?t:i.inclusive&&!e.inclusive?-1:!i.inclusive&&e.inclusive?1:0}function rE(i,e){const t=js(i.value,e.value);return t!==0?t:i.inclusive&&!e.inclusive?1:!i.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xn{constructor(e){this.value=e}static empty(){return new xn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!jd(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=ru(t)}setAll(e){let t=It.emptyPath(),r={},a=[];e.forEach((u,h)=>{if(!t.isImmediateParentOf(h)){const m=this.getFieldsMap(t);this.applyChanges(m,r,a),r={},a=[],t=h.popLast()}u?r[h.lastSegment()]=ru(u):a.push(h.lastSegment())});const l=this.getFieldsMap(t);this.applyChanges(l,r,a)}delete(e){const t=this.field(e.popLast());jd(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Xi(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let a=t.mapValue.fields[e.get(r)];jd(a)&&a.mapValue.fields||(a={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=a),t=a}return t.mapValue.fields}applyChanges(e,t,r){Bs(t,(a,l)=>e[a]=l);for(const a of r)delete e[a]}clone(){return new xn(ru(this.value))}}function t1(i){const e=[];return Bs(i.fields,(t,r)=>{const a=new It([t]);if(jd(r)){const l=t1(r.mapValue).fields;if(l.length===0)e.push(a);else for(const u of l)e.push(a.child(u))}else e.push(a)}),new Ln(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vt{constructor(e,t,r,a,l,u,h){this.key=e,this.documentType=t,this.version=r,this.readTime=a,this.createTime=l,this.data=u,this.documentState=h}static newInvalidDocument(e){return new Vt(e,0,Se.min(),Se.min(),Se.min(),xn.empty(),0)}static newFoundDocument(e,t,r,a){return new Vt(e,1,t,Se.min(),r,a,0)}static newNoDocument(e,t){return new Vt(e,2,t,Se.min(),Se.min(),xn.empty(),0)}static newUnknownDocument(e,t){return new Vt(e,3,t,Se.min(),Se.min(),xn.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Se.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=xn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=xn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Se.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Vt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Vt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gl{constructor(e,t){this.position=e,this.inclusive=t}}function sE(i,e,t){let r=0;for(let a=0;a<i.position.length;a++){const l=e[a],u=i.position[a];if(l.field.isKeyField()?r=_e.comparator(_e.fromName(u.referenceValue),t.key):r=js(u,t.data.field(l.field)),l.dir==="desc"&&(r*=-1),r!==0)break}return r}function aE(i,e){if(i===null)return e===null;if(e===null||i.inclusive!==e.inclusive||i.position.length!==e.position.length)return!1;for(let t=0;t<i.position.length;t++)if(!Xi(i.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sf{constructor(e,t="asc"){this.field=e,this.dir=t}}function pV(i,e){return i.dir===e.dir&&i.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n1{}class Ye extends n1{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new gV(e,t,r):t==="array-contains"?new _V(e,r):t==="in"?new l1(e,r):t==="not-in"?new bV(e,r):t==="array-contains-any"?new xV(e,r):new Ye(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new yV(e,r):new vV(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(js(t,this.value)):t!==null&&Ms(this.value)===Ms(t)&&this.matchesComparison(js(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Te(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ht extends n1{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new ht(e,t)}matches(e){return yl(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function yl(i){return i.op==="and"}function Bg(i){return i.op==="or"}function Fy(i){return i1(i)&&yl(i)}function i1(i){for(const e of i.filters)if(e instanceof ht)return!1;return!0}function Hg(i){if(i instanceof Ye)return i.field.canonicalString()+i.op.toString()+pl(i.value);if(Fy(i))return i.filters.map(e=>Hg(e)).join(",");{const e=i.filters.map(t=>Hg(t)).join(",");return`${i.op}(${e})`}}function r1(i,e){return i instanceof Ye?function(r,a){return a instanceof Ye&&r.op===a.op&&r.field.isEqual(a.field)&&Xi(r.value,a.value)}(i,e):i instanceof ht?function(r,a){return a instanceof ht&&r.op===a.op&&r.filters.length===a.filters.length?r.filters.reduce((l,u,h)=>l&&r1(u,a.filters[h]),!0):!1}(i,e):void Te(19439)}function s1(i,e){const t=i.filters.concat(e);return ht.create(t,i.op)}function a1(i){return i instanceof Ye?function(t){return`${t.field.canonicalString()} ${t.op} ${pl(t.value)}`}(i):i instanceof ht?function(t){return t.op.toString()+" {"+t.getFilters().map(a1).join(" ,")+"}"}(i):"Filter"}class gV extends Ye{constructor(e,t,r){super(e,t,r),this.key=_e.fromName(r.referenceValue)}matches(e){const t=_e.comparator(e.key,this.key);return this.matchesComparison(t)}}class yV extends Ye{constructor(e,t){super(e,"in",t),this.keys=o1("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class vV extends Ye{constructor(e,t){super(e,"not-in",t),this.keys=o1("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function o1(i,e){return(e.arrayValue?.values||[]).map(t=>_e.fromName(t.referenceValue))}class _V extends Ye{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Eu(t)&&bu(t.arrayValue,this.value)}}class l1 extends Ye{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&bu(this.value.arrayValue,t)}}class bV extends Ye{constructor(e,t){super(e,"not-in",t)}matches(e){if(bu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!bu(this.value.arrayValue,t)}}class xV extends Ye{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Eu(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>bu(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EV{constructor(e,t=null,r=[],a=[],l=null,u=null,h=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=a,this.limit=l,this.startAt=u,this.endAt=h,this.Te=null}}function Gg(i,e=null,t=[],r=[],a=null,l=null,u=null){return new EV(i,e,t,r,a,l,u)}function Ha(i){const e=Oe(i);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>Hg(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(l){return l.field.canonicalString()+l.dir}(r)).join(","),Nf(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>pl(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>pl(r)).join(",")),e.Te=t}return e.Te}function ju(i,e){if(i.limit!==e.limit||i.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<i.orderBy.length;t++)if(!pV(i.orderBy[t],e.orderBy[t]))return!1;if(i.filters.length!==e.filters.length)return!1;for(let t=0;t<i.filters.length;t++)if(!r1(i.filters[t],e.filters[t]))return!1;return i.collectionGroup===e.collectionGroup&&!!i.path.isEqual(e.path)&&!!aE(i.startAt,e.startAt)&&aE(i.endAt,e.endAt)}function af(i){return _e.isDocumentKey(i.path)&&i.collectionGroup===null&&i.filters.length===0}function of(i,e){return i.filters.filter(t=>t instanceof Ye&&t.field.isEqual(e))}function oE(i,e,t){let r=Od,a=!0;for(const l of of(i,e)){let u=Od,h=!0;switch(l.op){case"<":case"<=":u=fV(l.value);break;case"==":case"in":case">=":u=l.value;break;case">":u=l.value,h=!1;break;case"!=":case"not-in":u=Od}iE({value:r,inclusive:a},{value:u,inclusive:h})<0&&(r=u,a=h)}if(t!==null){for(let l=0;l<i.orderBy.length;++l)if(i.orderBy[l].field.isEqual(e)){const u=t.position[l];iE({value:r,inclusive:a},{value:u,inclusive:t.inclusive})<0&&(r=u,a=t.inclusive);break}}return{value:r,inclusive:a}}function lE(i,e,t){let r=As,a=!0;for(const l of of(i,e)){let u=As,h=!0;switch(l.op){case">=":case">":u=mV(l.value),h=!1;break;case"==":case"in":case"<=":u=l.value;break;case"<":u=l.value,h=!1;break;case"!=":case"not-in":u=As}rE({value:r,inclusive:a},{value:u,inclusive:h})>0&&(r=u,a=h)}if(t!==null){for(let l=0;l<i.orderBy.length;++l)if(i.orderBy[l].field.isEqual(e)){const u=t.position[l];rE({value:r,inclusive:a},{value:u,inclusive:t.inclusive})>0&&(r=u,a=t.inclusive);break}}return{value:r,inclusive:a}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ku{constructor(e,t=null,r=[],a=[],l=null,u="F",h=null,m=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=a,this.limit=l,this.limitType=u,this.startAt=h,this.endAt=m,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function TV(i,e,t,r,a,l,u,h){return new ku(i,e,t,r,a,l,u,h)}function Lu(i){return new ku(i)}function cE(i){return i.filters.length===0&&i.limit===null&&i.startAt==null&&i.endAt==null&&(i.explicitOrderBy.length===0||i.explicitOrderBy.length===1&&i.explicitOrderBy[0].field.isKeyField())}function c1(i){return i.collectionGroup!==null}function su(i){const e=Oe(i);if(e.Ie===null){e.Ie=[];const t=new Set;for(const l of e.explicitOrderBy)e.Ie.push(l),t.add(l.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(u){let h=new dt(It.comparator);return u.filters.forEach(m=>{m.getFlattenedFilters().forEach(y=>{y.isInequality()&&(h=h.add(y.field))})}),h})(e).forEach(l=>{t.has(l.canonicalString())||l.isKeyField()||e.Ie.push(new sf(l,r))}),t.has(It.keyField().canonicalString())||e.Ie.push(new sf(It.keyField(),r))}return e.Ie}function yi(i){const e=Oe(i);return e.Ee||(e.Ee=wV(e,su(i))),e.Ee}function wV(i,e){if(i.limitType==="F")return Gg(i.path,i.collectionGroup,e,i.filters,i.limit,i.startAt,i.endAt);{e=e.map(a=>{const l=a.dir==="desc"?"asc":"desc";return new sf(a.field,l)});const t=i.endAt?new gl(i.endAt.position,i.endAt.inclusive):null,r=i.startAt?new gl(i.startAt.position,i.startAt.inclusive):null;return Gg(i.path,i.collectionGroup,e,i.filters,i.limit,t,r)}}function Kg(i,e){const t=i.filters.concat([e]);return new ku(i.path,i.collectionGroup,i.explicitOrderBy.slice(),t,i.limit,i.limitType,i.startAt,i.endAt)}function Yg(i,e,t){return new ku(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),e,t,i.startAt,i.endAt)}function Mf(i,e){return ju(yi(i),yi(e))&&i.limitType===e.limitType}function u1(i){return`${Ha(yi(i))}|lt:${i.limitType}`}function Jo(i){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(a=>a1(a)).join(", ")}]`),Nf(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(a=>function(u){return`${u.field.canonicalString()} (${u.dir})`}(a)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(a=>pl(a)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(a=>pl(a)).join(",")),`Target(${r})`}(yi(i))}; limitType=${i.limitType})`}function Fu(i,e){return e.isFoundDocument()&&function(r,a){const l=a.key.path;return r.collectionGroup!==null?a.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(l):_e.isDocumentKey(r.path)?r.path.isEqual(l):r.path.isImmediateParentOf(l)}(i,e)&&function(r,a){for(const l of su(r))if(!l.field.isKeyField()&&a.data.field(l.field)===null)return!1;return!0}(i,e)&&function(r,a){for(const l of r.filters)if(!l.matches(a))return!1;return!0}(i,e)&&function(r,a){return!(r.startAt&&!function(u,h,m){const y=sE(u,h,m);return u.inclusive?y<=0:y<0}(r.startAt,su(r),a)||r.endAt&&!function(u,h,m){const y=sE(u,h,m);return u.inclusive?y>=0:y>0}(r.endAt,su(r),a))}(i,e)}function RV(i){return i.collectionGroup||(i.path.length%2==1?i.path.lastSegment():i.path.get(i.path.length-2))}function h1(i){return(e,t)=>{let r=!1;for(const a of su(i)){const l=SV(a,e,t);if(l!==0)return l;r=r||a.field.isKeyField()}return 0}}function SV(i,e,t){const r=i.field.isKeyField()?_e.comparator(e.key,t.key):function(l,u,h){const m=u.data.field(l),y=h.data.field(l);return m!==null&&y!==null?js(m,y):Te(42886)}(i.field,e,t);switch(i.dir){case"asc":return r;case"desc":return-1*r;default:return Te(19790,{direction:i.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ur{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[a,l]of r)if(this.equalsFn(a,e))return l}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),a=this.inner[r];if(a===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let l=0;l<a.length;l++)if(this.equalsFn(a[l][0],e))return void(a[l]=[e,t]);a.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let a=0;a<r.length;a++)if(this.equalsFn(r[a][0],e))return r.length===1?delete this.inner[t]:r.splice(a,1),this.innerSize--,!0;return!1}forEach(e){Bs(this.inner,(t,r)=>{for(const[a,l]of r)e(a,l)})}isEmpty(){return Kw(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AV=new St(_e.comparator);function Jn(){return AV}const d1=new St(_e.comparator);function Yc(...i){let e=d1;for(const t of i)e=e.insert(t.key,t);return e}function f1(i){let e=d1;return i.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function Gi(){return au()}function m1(){return au()}function au(){return new Ur(i=>i.toString(),(i,e)=>i.isEqual(e))}const IV=new St(_e.comparator),NV=new dt(_e.comparator);function Fe(...i){let e=NV;for(const t of i)e=e.add(t);return e}const CV=new dt(Ve);function PV(){return CV}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Uy(i,e){if(i.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:pu(e)?"-0":e}}function p1(i){return{integerValue:""+i}}function DV(i,e){return LD(e)?p1(e):Uy(i,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jf{constructor(){this._=void 0}}function VV(i,e,t){return i instanceof Tu?function(a,l){const u={fields:{[Qw]:{stringValue:$w},[Ww]:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}};return l&&jy(l)&&(l=Vf(l)),l&&(u.fields[Xw]=l),{mapValue:u}}(t,e):i instanceof vl?y1(i,e):i instanceof _l?v1(i,e):function(a,l){const u=g1(a,l),h=uE(u)+uE(a.Ae);return qg(u)&&qg(a.Ae)?p1(h):Uy(a.serializer,h)}(i,e)}function OV(i,e,t){return i instanceof vl?y1(i,e):i instanceof _l?v1(i,e):t}function g1(i,e){return i instanceof wu?function(r){return qg(r)||function(l){return!!l&&"doubleValue"in l}(r)}(e)?e:{integerValue:0}:null}class Tu extends jf{}class vl extends jf{constructor(e){super(),this.elements=e}}function y1(i,e){const t=_1(e);for(const r of i.elements)t.some(a=>Xi(a,r))||t.push(r);return{arrayValue:{values:t}}}class _l extends jf{constructor(e){super(),this.elements=e}}function v1(i,e){let t=_1(e);for(const r of i.elements)t=t.filter(a=>!Xi(a,r));return{arrayValue:{values:t}}}class wu extends jf{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function uE(i){return Rt(i.integerValue||i.doubleValue)}function _1(i){return Eu(i)&&i.arrayValue.values?i.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MV{constructor(e,t){this.field=e,this.transform=t}}function jV(i,e){return i.field.isEqual(e.field)&&function(r,a){return r instanceof vl&&a instanceof vl||r instanceof _l&&a instanceof _l?cl(r.elements,a.elements,Xi):r instanceof wu&&a instanceof wu?Xi(r.Ae,a.Ae):r instanceof Tu&&a instanceof Tu}(i.transform,e.transform)}class kV{constructor(e,t){this.version=e,this.transformResults=t}}class Pn{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Pn}static exists(e){return new Pn(void 0,e)}static updateTime(e){return new Pn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function kd(i,e){return i.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(i.updateTime):i.exists===void 0||i.exists===e.isFoundDocument()}class kf{}function b1(i,e){if(!i.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return i.isNoDocument()?new Lf(i.key,Pn.none()):new Al(i.key,i.data,Pn.none());{const t=i.data,r=xn.empty();let a=new dt(It.comparator);for(let l of e.fields)if(!a.has(l)){let u=t.field(l);u===null&&l.length>1&&(l=l.popLast(),u=t.field(l)),u===null?r.delete(l):r.set(l,u),a=a.add(l)}return new zr(i.key,r,new Ln(a.toArray()),Pn.none())}}function LV(i,e,t){i instanceof Al?function(a,l,u){const h=a.value.clone(),m=dE(a.fieldTransforms,l,u.transformResults);h.setAll(m),l.convertToFoundDocument(u.version,h).setHasCommittedMutations()}(i,e,t):i instanceof zr?function(a,l,u){if(!kd(a.precondition,l))return void l.convertToUnknownDocument(u.version);const h=dE(a.fieldTransforms,l,u.transformResults),m=l.data;m.setAll(x1(a)),m.setAll(h),l.convertToFoundDocument(u.version,m).setHasCommittedMutations()}(i,e,t):function(a,l,u){l.convertToNoDocument(u.version).setHasCommittedMutations()}(0,e,t)}function ou(i,e,t,r){return i instanceof Al?function(l,u,h,m){if(!kd(l.precondition,u))return h;const y=l.value.clone(),_=fE(l.fieldTransforms,m,u);return y.setAll(_),u.convertToFoundDocument(u.version,y).setHasLocalMutations(),null}(i,e,t,r):i instanceof zr?function(l,u,h,m){if(!kd(l.precondition,u))return h;const y=fE(l.fieldTransforms,m,u),_=u.data;return _.setAll(x1(l)),_.setAll(y),u.convertToFoundDocument(u.version,_).setHasLocalMutations(),h===null?null:h.unionWith(l.fieldMask.fields).unionWith(l.fieldTransforms.map(b=>b.field))}(i,e,t,r):function(l,u,h){return kd(l.precondition,u)?(u.convertToNoDocument(u.version).setHasLocalMutations(),null):h}(i,e,t)}function FV(i,e){let t=null;for(const r of i.fieldTransforms){const a=e.data.field(r.field),l=g1(r.transform,a||null);l!=null&&(t===null&&(t=xn.empty()),t.set(r.field,l))}return t||null}function hE(i,e){return i.type===e.type&&!!i.key.isEqual(e.key)&&!!i.precondition.isEqual(e.precondition)&&!!function(r,a){return r===void 0&&a===void 0||!(!r||!a)&&cl(r,a,(l,u)=>jV(l,u))}(i.fieldTransforms,e.fieldTransforms)&&(i.type===0?i.value.isEqual(e.value):i.type!==1||i.data.isEqual(e.data)&&i.fieldMask.isEqual(e.fieldMask))}class Al extends kf{constructor(e,t,r,a=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=a,this.type=0}getFieldMask(){return null}}class zr extends kf{constructor(e,t,r,a,l=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=a,this.fieldTransforms=l,this.type=1}getFieldMask(){return this.fieldMask}}function x1(i){const e=new Map;return i.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const r=i.data.field(t);e.set(t,r)}}),e}function dE(i,e,t){const r=new Map;we(i.length===t.length,32656,{Re:t.length,Ve:i.length});for(let a=0;a<t.length;a++){const l=i[a],u=l.transform,h=e.data.field(l.field);r.set(l.field,OV(u,h,t[a]))}return r}function fE(i,e,t){const r=new Map;for(const a of i){const l=a.transform,u=t.data.field(a.field);r.set(a.field,VV(l,u,e))}return r}class Lf extends kf{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class E1 extends kf{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zy{constructor(e,t,r,a){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=a}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let a=0;a<this.mutations.length;a++){const l=this.mutations[a];l.key.isEqual(e.key)&&LV(l,e,r[a])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=ou(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=ou(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=m1();return this.mutations.forEach(a=>{const l=e.get(a.key),u=l.overlayedDocument;let h=this.applyToLocalView(u,l.mutatedFields);h=t.has(a.key)?null:h;const m=b1(u,h);m!==null&&r.set(a.key,m),u.isValidDocument()||u.convertToNoDocument(Se.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),Fe())}isEqual(e){return this.batchId===e.batchId&&cl(this.mutations,e.mutations,(t,r)=>hE(t,r))&&cl(this.baseMutations,e.baseMutations,(t,r)=>hE(t,r))}}class qy{constructor(e,t,r,a){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=a}static from(e,t,r){we(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let a=function(){return IV}();const l=e.mutations;for(let u=0;u<l.length;u++)a=a.insert(l[u].key,r[u].version);return new qy(e,t,r,a)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class By{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UV{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Bt,et;function zV(i){switch(i){case oe.OK:return Te(64938);case oe.CANCELLED:case oe.UNKNOWN:case oe.DEADLINE_EXCEEDED:case oe.RESOURCE_EXHAUSTED:case oe.INTERNAL:case oe.UNAVAILABLE:case oe.UNAUTHENTICATED:return!1;case oe.INVALID_ARGUMENT:case oe.NOT_FOUND:case oe.ALREADY_EXISTS:case oe.PERMISSION_DENIED:case oe.FAILED_PRECONDITION:case oe.ABORTED:case oe.OUT_OF_RANGE:case oe.UNIMPLEMENTED:case oe.DATA_LOSS:return!0;default:return Te(15467,{code:i})}}function T1(i){if(i===void 0)return Nn("GRPC error has no .code"),oe.UNKNOWN;switch(i){case Bt.OK:return oe.OK;case Bt.CANCELLED:return oe.CANCELLED;case Bt.UNKNOWN:return oe.UNKNOWN;case Bt.DEADLINE_EXCEEDED:return oe.DEADLINE_EXCEEDED;case Bt.RESOURCE_EXHAUSTED:return oe.RESOURCE_EXHAUSTED;case Bt.INTERNAL:return oe.INTERNAL;case Bt.UNAVAILABLE:return oe.UNAVAILABLE;case Bt.UNAUTHENTICATED:return oe.UNAUTHENTICATED;case Bt.INVALID_ARGUMENT:return oe.INVALID_ARGUMENT;case Bt.NOT_FOUND:return oe.NOT_FOUND;case Bt.ALREADY_EXISTS:return oe.ALREADY_EXISTS;case Bt.PERMISSION_DENIED:return oe.PERMISSION_DENIED;case Bt.FAILED_PRECONDITION:return oe.FAILED_PRECONDITION;case Bt.ABORTED:return oe.ABORTED;case Bt.OUT_OF_RANGE:return oe.OUT_OF_RANGE;case Bt.UNIMPLEMENTED:return oe.UNIMPLEMENTED;case Bt.DATA_LOSS:return oe.DATA_LOSS;default:return Te(39323,{code:i})}}(et=Bt||(Bt={}))[et.OK=0]="OK",et[et.CANCELLED=1]="CANCELLED",et[et.UNKNOWN=2]="UNKNOWN",et[et.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",et[et.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",et[et.NOT_FOUND=5]="NOT_FOUND",et[et.ALREADY_EXISTS=6]="ALREADY_EXISTS",et[et.PERMISSION_DENIED=7]="PERMISSION_DENIED",et[et.UNAUTHENTICATED=16]="UNAUTHENTICATED",et[et.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",et[et.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",et[et.ABORTED=10]="ABORTED",et[et.OUT_OF_RANGE=11]="OUT_OF_RANGE",et[et.UNIMPLEMENTED=12]="UNIMPLEMENTED",et[et.INTERNAL=13]="INTERNAL",et[et.UNAVAILABLE=14]="UNAVAILABLE",et[et.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qV(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BV=new Ds([4294967295,4294967295],0);function mE(i){const e=qV().encode(i),t=new xw;return t.update(e),new Uint8Array(t.digest())}function pE(i){const e=new DataView(i.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),a=e.getUint32(8,!0),l=e.getUint32(12,!0);return[new Ds([t,r],0),new Ds([a,l],0)]}class Hy{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new $c(`Invalid padding: ${t}`);if(r<0)throw new $c(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new $c(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new $c(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=Ds.fromNumber(this.ge)}ye(e,t,r){let a=e.add(t.multiply(Ds.fromNumber(r)));return a.compare(BV)===1&&(a=new Ds([a.getBits(0),a.getBits(1)],0)),a.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=mE(e),[r,a]=pE(t);for(let l=0;l<this.hashCount;l++){const u=this.ye(r,a,l);if(!this.we(u))return!1}return!0}static create(e,t,r){const a=e%8==0?0:8-e%8,l=new Uint8Array(Math.ceil(e/8)),u=new Hy(l,a,t);return r.forEach(h=>u.insert(h)),u}insert(e){if(this.ge===0)return;const t=mE(e),[r,a]=pE(t);for(let l=0;l<this.hashCount;l++){const u=this.ye(r,a,l);this.Se(u)}}Se(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class $c extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ff{constructor(e,t,r,a,l){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=a,this.resolvedLimboDocuments=l}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const a=new Map;return a.set(e,Uu.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new Ff(Se.min(),a,new St(Ve),Jn(),Fe())}}class Uu{constructor(e,t,r,a,l){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=a,this.removedDocuments=l}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new Uu(r,t,Fe(),Fe(),Fe())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ld{constructor(e,t,r,a){this.be=e,this.removedTargetIds=t,this.key=r,this.De=a}}class w1{constructor(e,t){this.targetId=e,this.Ce=t}}class R1{constructor(e,t,r=Kt.EMPTY_BYTE_STRING,a=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=a}}class gE{constructor(){this.ve=0,this.Fe=yE(),this.Me=Kt.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Fe(),t=Fe(),r=Fe();return this.Fe.forEach((a,l)=>{switch(l){case 0:e=e.add(a);break;case 2:t=t.add(a);break;case 1:r=r.add(a);break;default:Te(38017,{changeType:l})}}),new Uu(this.Me,this.xe,e,t,r)}qe(){this.Oe=!1,this.Fe=yE()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,we(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class HV{constructor(e){this.Ge=e,this.ze=new Map,this.je=Jn(),this.Je=_d(),this.He=_d(),this.Ye=new St(Ve)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,t=>{const r=this.nt(t);switch(e.state){case 0:this.rt(t)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),r.Le(e.resumeToken));break;default:Te(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach((r,a)=>{this.rt(a)&&t(a)})}st(e){const t=e.targetId,r=e.Ce.count,a=this.ot(t);if(a){const l=a.target;if(af(l))if(r===0){const u=new _e(l.path);this.et(t,u,Vt.newNoDocument(u,Se.min()))}else we(r===1,20013,{expectedCount:r});else{const u=this._t(t);if(u!==r){const h=this.ut(e),m=h?this.ct(h,e,u):1;if(m!==0){this.it(t);const y=m===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,y)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:a=0},hashCount:l=0}=t;let u,h;try{u=Vr(r).toUint8Array()}catch(m){if(m instanceof Yw)return qa("Decoding the base64 bloom filter in existence filter failed ("+m.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw m}try{h=new Hy(u,a,l)}catch(m){return qa(m instanceof $c?"BloomFilter error: ":"Applying bloom filter failed: ",m),null}return h.ge===0?null:h}ct(e,t,r){return t.Ce.count===r-this.Pt(e,t.targetId)?0:2}Pt(e,t){const r=this.Ge.getRemoteKeysForTarget(t);let a=0;return r.forEach(l=>{const u=this.Ge.ht(),h=`projects/${u.projectId}/databases/${u.database}/documents/${l.path.canonicalString()}`;e.mightContain(h)||(this.et(t,l,null),a++)}),a}Tt(e){const t=new Map;this.ze.forEach((l,u)=>{const h=this.ot(u);if(h){if(l.current&&af(h.target)){const m=new _e(h.target.path);this.It(m).has(u)||this.Et(u,m)||this.et(u,m,Vt.newNoDocument(m,e))}l.Be&&(t.set(u,l.ke()),l.qe())}});let r=Fe();this.He.forEach((l,u)=>{let h=!0;u.forEachWhile(m=>{const y=this.ot(m);return!y||y.purpose==="TargetPurposeLimboResolution"||(h=!1,!1)}),h&&(r=r.add(l))}),this.je.forEach((l,u)=>u.setReadTime(e));const a=new Ff(e,t,this.Ye,this.je,r);return this.je=Jn(),this.Je=_d(),this.He=_d(),this.Ye=new St(Ve),a}Xe(e,t){if(!this.rt(e))return;const r=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,r),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,r){if(!this.rt(e))return;const a=this.nt(e);this.Et(e,t)?a.Qe(t,1):a.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),r&&(this.je=this.je.insert(t,r))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new gE,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new dt(Ve),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new dt(Ve),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||fe("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new gE),this.Ge.getRemoteKeysForTarget(e).forEach(t=>{this.et(e,t,null)})}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function _d(){return new St(_e.comparator)}function yE(){return new St(_e.comparator)}const GV={asc:"ASCENDING",desc:"DESCENDING"},KV={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},YV={and:"AND",or:"OR"};class $V{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function $g(i,e){return i.useProto3Json||Nf(e)?e:{value:e}}function bl(i,e){return i.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function S1(i,e){return i.useProto3Json?e.toBase64():e.toUint8Array()}function QV(i,e){return bl(i,e.toTimestamp())}function Dn(i){return we(!!i,49232),Se.fromTimestamp(function(t){const r=Dr(t);return new ut(r.seconds,r.nanos)}(i))}function Gy(i,e){return Qg(i,e).canonicalString()}function Qg(i,e){const t=function(a){return new at(["projects",a.projectId,"databases",a.database])}(i).child("documents");return e===void 0?t:t.child(e)}function A1(i){const e=at.fromString(i);return we(j1(e),10190,{key:e.toString()}),e}function lf(i,e){return Gy(i.databaseId,e.path)}function Oa(i,e){const t=A1(e);if(t.get(1)!==i.databaseId.projectId)throw new ye(oe.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+i.databaseId.projectId);if(t.get(3)!==i.databaseId.database)throw new ye(oe.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+i.databaseId.database);return new _e(C1(t))}function I1(i,e){return Gy(i.databaseId,e)}function N1(i){const e=A1(i);return e.length===4?at.emptyPath():C1(e)}function Xg(i){return new at(["projects",i.databaseId.projectId,"databases",i.databaseId.database]).canonicalString()}function C1(i){return we(i.length>4&&i.get(4)==="documents",29091,{key:i.toString()}),i.popFirst(5)}function vE(i,e,t){return{name:lf(i,e),fields:t.value.mapValue.fields}}function XV(i,e,t){const r=Oa(i,e.name),a=Dn(e.updateTime),l=e.createTime?Dn(e.createTime):Se.min(),u=new xn({mapValue:{fields:e.fields}}),h=Vt.newFoundDocument(r,a,l,u);return t&&h.setHasCommittedMutations(),t?h.setHasCommittedMutations():h}function WV(i,e){let t;if("targetChange"in e){e.targetChange;const r=function(y){return y==="NO_CHANGE"?0:y==="ADD"?1:y==="REMOVE"?2:y==="CURRENT"?3:y==="RESET"?4:Te(39313,{state:y})}(e.targetChange.targetChangeType||"NO_CHANGE"),a=e.targetChange.targetIds||[],l=function(y,_){return y.useProto3Json?(we(_===void 0||typeof _=="string",58123),Kt.fromBase64String(_||"")):(we(_===void 0||_ instanceof Buffer||_ instanceof Uint8Array,16193),Kt.fromUint8Array(_||new Uint8Array))}(i,e.targetChange.resumeToken),u=e.targetChange.cause,h=u&&function(y){const _=y.code===void 0?oe.UNKNOWN:T1(y.code);return new ye(_,y.message||"")}(u);t=new R1(r,a,l,h||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const a=Oa(i,r.document.name),l=Dn(r.document.updateTime),u=r.document.createTime?Dn(r.document.createTime):Se.min(),h=new xn({mapValue:{fields:r.document.fields}}),m=Vt.newFoundDocument(a,l,u,h),y=r.targetIds||[],_=r.removedTargetIds||[];t=new Ld(y,_,m.key,m)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const a=Oa(i,r.document),l=r.readTime?Dn(r.readTime):Se.min(),u=Vt.newNoDocument(a,l),h=r.removedTargetIds||[];t=new Ld([],h,u.key,u)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const a=Oa(i,r.document),l=r.removedTargetIds||[];t=new Ld([],l,a,null)}else{if(!("filter"in e))return Te(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:a=0,unchangedNames:l}=r,u=new UV(a,l),h=r.targetId;t=new w1(h,u)}}return t}function cf(i,e){let t;if(e instanceof Al)t={update:vE(i,e.key,e.value)};else if(e instanceof Lf)t={delete:lf(i,e.key)};else if(e instanceof zr)t={update:vE(i,e.key,e.data),updateMask:iO(e.fieldMask)};else{if(!(e instanceof E1))return Te(16599,{Vt:e.type});t={verify:lf(i,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(l,u){const h=u.transform;if(h instanceof Tu)return{fieldPath:u.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(h instanceof vl)return{fieldPath:u.field.canonicalString(),appendMissingElements:{values:h.elements}};if(h instanceof _l)return{fieldPath:u.field.canonicalString(),removeAllFromArray:{values:h.elements}};if(h instanceof wu)return{fieldPath:u.field.canonicalString(),increment:h.Ae};throw Te(20930,{transform:u.transform})}(0,r))),e.precondition.isNone||(t.currentDocument=function(a,l){return l.updateTime!==void 0?{updateTime:QV(a,l.updateTime)}:l.exists!==void 0?{exists:l.exists}:Te(27497)}(i,e.precondition)),t}function Wg(i,e){const t=e.currentDocument?function(l){return l.updateTime!==void 0?Pn.updateTime(Dn(l.updateTime)):l.exists!==void 0?Pn.exists(l.exists):Pn.none()}(e.currentDocument):Pn.none(),r=e.updateTransforms?e.updateTransforms.map(a=>function(u,h){let m=null;if("setToServerValue"in h)we(h.setToServerValue==="REQUEST_TIME",16630,{proto:h}),m=new Tu;else if("appendMissingElements"in h){const _=h.appendMissingElements.values||[];m=new vl(_)}else if("removeAllFromArray"in h){const _=h.removeAllFromArray.values||[];m=new _l(_)}else"increment"in h?m=new wu(u,h.increment):Te(16584,{proto:h});const y=It.fromServerFormat(h.fieldPath);return new MV(y,m)}(i,a)):[];if(e.update){e.update.name;const a=Oa(i,e.update.name),l=new xn({mapValue:{fields:e.update.fields}});if(e.updateMask){const u=function(m){const y=m.fieldPaths||[];return new Ln(y.map(_=>It.fromServerFormat(_)))}(e.updateMask);return new zr(a,l,u,t,r)}return new Al(a,l,t,r)}if(e.delete){const a=Oa(i,e.delete);return new Lf(a,t)}if(e.verify){const a=Oa(i,e.verify);return new E1(a,t)}return Te(1463,{proto:e})}function JV(i,e){return i&&i.length>0?(we(e!==void 0,14353),i.map(t=>function(a,l){let u=a.updateTime?Dn(a.updateTime):Dn(l);return u.isEqual(Se.min())&&(u=Dn(l)),new kV(u,a.transformResults||[])}(t,e))):[]}function P1(i,e){return{documents:[I1(i,e.path)]}}function D1(i,e){const t={structuredQuery:{}},r=e.path;let a;e.collectionGroup!==null?(a=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(a=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=I1(i,a);const l=function(y){if(y.length!==0)return M1(ht.create(y,"and"))}(e.filters);l&&(t.structuredQuery.where=l);const u=function(y){if(y.length!==0)return y.map(_=>function(T){return{field:Zo(T.field),direction:eO(T.dir)}}(_))}(e.orderBy);u&&(t.structuredQuery.orderBy=u);const h=$g(i,e.limit);return h!==null&&(t.structuredQuery.limit=h),e.startAt&&(t.structuredQuery.startAt=function(y){return{before:y.inclusive,values:y.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(y){return{before:!y.inclusive,values:y.position}}(e.endAt)),{ft:t,parent:a}}function V1(i){let e=N1(i.parent);const t=i.structuredQuery,r=t.from?t.from.length:0;let a=null;if(r>0){we(r===1,65062);const _=t.from[0];_.allDescendants?a=_.collectionId:e=e.child(_.collectionId)}let l=[];t.where&&(l=function(b){const T=O1(b);return T instanceof ht&&Fy(T)?T.getFilters():[T]}(t.where));let u=[];t.orderBy&&(u=function(b){return b.map(T=>function(V){return new sf(el(V.field),function(O){switch(O){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(V.direction))}(T))}(t.orderBy));let h=null;t.limit&&(h=function(b){let T;return T=typeof b=="object"?b.value:b,Nf(T)?null:T}(t.limit));let m=null;t.startAt&&(m=function(b){const T=!!b.before,I=b.values||[];return new gl(I,T)}(t.startAt));let y=null;return t.endAt&&(y=function(b){const T=!b.before,I=b.values||[];return new gl(I,T)}(t.endAt)),TV(e,a,u,l,h,"F",m,y)}function ZV(i,e){const t=function(a){switch(a){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Te(28987,{purpose:a})}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function O1(i){return i.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=el(t.unaryFilter.field);return Ye.create(r,"==",{doubleValue:NaN});case"IS_NULL":const a=el(t.unaryFilter.field);return Ye.create(a,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const l=el(t.unaryFilter.field);return Ye.create(l,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const u=el(t.unaryFilter.field);return Ye.create(u,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Te(61313);default:return Te(60726)}}(i):i.fieldFilter!==void 0?function(t){return Ye.create(el(t.fieldFilter.field),function(a){switch(a){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Te(58110);default:return Te(50506)}}(t.fieldFilter.op),t.fieldFilter.value)}(i):i.compositeFilter!==void 0?function(t){return ht.create(t.compositeFilter.filters.map(r=>O1(r)),function(a){switch(a){case"AND":return"and";case"OR":return"or";default:return Te(1026)}}(t.compositeFilter.op))}(i):Te(30097,{filter:i})}function eO(i){return GV[i]}function tO(i){return KV[i]}function nO(i){return YV[i]}function Zo(i){return{fieldPath:i.canonicalString()}}function el(i){return It.fromServerFormat(i.fieldPath)}function M1(i){return i instanceof Ye?function(t){if(t.op==="=="){if(nE(t.value))return{unaryFilter:{field:Zo(t.field),op:"IS_NAN"}};if(tE(t.value))return{unaryFilter:{field:Zo(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(nE(t.value))return{unaryFilter:{field:Zo(t.field),op:"IS_NOT_NAN"}};if(tE(t.value))return{unaryFilter:{field:Zo(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Zo(t.field),op:tO(t.op),value:t.value}}}(i):i instanceof ht?function(t){const r=t.getFilters().map(a=>M1(a));return r.length===1?r[0]:{compositeFilter:{op:nO(t.op),filters:r}}}(i):Te(54877,{filter:i})}function iO(i){const e=[];return i.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function j1(i){return i.length>=4&&i.get(0)==="projects"&&i.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ir{constructor(e,t,r,a,l=Se.min(),u=Se.min(),h=Kt.EMPTY_BYTE_STRING,m=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=a,this.snapshotVersion=l,this.lastLimboFreeSnapshotVersion=u,this.resumeToken=h,this.expectedCount=m}withSequenceNumber(e){return new Ir(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Ir(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Ir(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Ir(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k1{constructor(e){this.yt=e}}function rO(i,e){let t;if(e.document)t=XV(i.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=_e.fromSegments(e.noDocument.path),a=Ka(e.noDocument.readTime);t=Vt.newNoDocument(r,a),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return Te(56709);{const r=_e.fromSegments(e.unknownDocument.path),a=Ka(e.unknownDocument.version);t=Vt.newUnknownDocument(r,a)}}return e.readTime&&t.setReadTime(function(a){const l=new ut(a[0],a[1]);return Se.fromTimestamp(l)}(e.readTime)),t}function _E(i,e){const t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:uf(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(l,u){return{name:lf(l,u.key),fields:u.data.value.mapValue.fields,updateTime:bl(l,u.version.toTimestamp()),createTime:bl(l,u.createTime.toTimestamp())}}(i.yt,e);else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:Ga(e.version)};else{if(!e.isUnknownDocument())return Te(57904,{document:e});r.unknownDocument={path:t.path.toArray(),version:Ga(e.version)}}return r}function uf(i){const e=i.toTimestamp();return[e.seconds,e.nanoseconds]}function Ga(i){const e=i.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Ka(i){const e=new ut(i.seconds,i.nanoseconds);return Se.fromTimestamp(e)}function Aa(i,e){const t=(e.baseMutations||[]).map(l=>Wg(i.yt,l));for(let l=0;l<e.mutations.length-1;++l){const u=e.mutations[l];if(l+1<e.mutations.length&&e.mutations[l+1].transform!==void 0){const h=e.mutations[l+1];u.updateTransforms=h.transform.fieldTransforms,e.mutations.splice(l+1,1),++l}}const r=e.mutations.map(l=>Wg(i.yt,l)),a=ut.fromMillis(e.localWriteTimeMs);return new zy(e.batchId,a,t,r)}function Qc(i){const e=Ka(i.readTime),t=i.lastLimboFreeSnapshotVersion!==void 0?Ka(i.lastLimboFreeSnapshotVersion):Se.min();let r;return r=function(l){return l.documents!==void 0}(i.query)?function(l){const u=l.documents.length;return we(u===1,1966,{count:u}),yi(Lu(N1(l.documents[0])))}(i.query):function(l){return yi(V1(l))}(i.query),new Ir(r,i.targetId,"TargetPurposeListen",i.lastListenSequenceNumber,e,t,Kt.fromBase64String(i.resumeToken))}function L1(i,e){const t=Ga(e.snapshotVersion),r=Ga(e.lastLimboFreeSnapshotVersion);let a;a=af(e.target)?P1(i.yt,e.target):D1(i.yt,e.target).ft;const l=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Ha(e.target),readTime:t,resumeToken:l,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:a}}function F1(i){const e=V1({parent:i.parent,structuredQuery:i.structuredQuery});return i.limitType==="LAST"?Yg(e,e.limit,"L"):e}function cg(i,e){return new By(e.largestBatchId,Wg(i.yt,e.overlayMutation))}function bE(i,e){const t=e.path.lastSegment();return[i,En(e.path.popLast()),t]}function xE(i,e,t,r){return{indexId:i,uid:e,sequenceNumber:t,readTime:Ga(r.readTime),documentKey:En(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sO{getBundleMetadata(e,t){return EE(e).get(t).next(r=>{if(r)return function(l){return{id:l.bundleId,createTime:Ka(l.createTime),version:l.version}}(r)})}saveBundleMetadata(e,t){return EE(e).put(function(a){return{bundleId:a.id,createTime:Ga(Dn(a.createTime)),version:a.version}}(t))}getNamedQuery(e,t){return TE(e).get(t).next(r=>{if(r)return function(l){return{name:l.name,query:F1(l.bundledQuery),readTime:Ka(l.readTime)}}(r)})}saveNamedQuery(e,t){return TE(e).put(function(a){return{name:a.name,readTime:Ga(Dn(a.readTime)),bundledQuery:a.bundledQuery}}(t))}}function EE(i){return tn(i,Cf)}function TE(i){return tn(i,Pf)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uf{constructor(e,t){this.serializer=e,this.userId=t}static wt(e,t){const r=t.uid||"";return new Uf(e,r)}getOverlay(e,t){return Lc(e).get(bE(this.userId,t)).next(r=>r?cg(this.serializer,r):null)}getOverlays(e,t){const r=Gi();return Y.forEach(t,a=>this.getOverlay(e,a).next(l=>{l!==null&&r.set(a,l)})).next(()=>r)}saveOverlays(e,t,r){const a=[];return r.forEach((l,u)=>{const h=new By(t,u);a.push(this.St(e,h))}),Y.waitFor(a)}removeOverlaysForBatchId(e,t,r){const a=new Set;t.forEach(u=>a.add(En(u.getCollectionPath())));const l=[];return a.forEach(u=>{const h=IDBKeyRange.bound([this.userId,u,r],[this.userId,u,r+1],!1,!0);l.push(Lc(e).Z(Fg,h))}),Y.waitFor(l)}getOverlaysForCollection(e,t,r){const a=Gi(),l=En(t),u=IDBKeyRange.bound([this.userId,l,r],[this.userId,l,Number.POSITIVE_INFINITY],!0);return Lc(e).J(Fg,u).next(h=>{for(const m of h){const y=cg(this.serializer,m);a.set(y.getKey(),y)}return a})}getOverlaysForCollectionGroup(e,t,r,a){const l=Gi();let u;const h=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Lc(e).ee({index:zw,range:h},(m,y,_)=>{const b=cg(this.serializer,y);l.size()<a||b.largestBatchId===u?(l.set(b.getKey(),b),u=b.largestBatchId):_.done()}).next(()=>l)}St(e,t){return Lc(e).put(function(a,l,u){const[h,m,y]=bE(l,u.mutation.key);return{userId:l,collectionPath:m,documentId:y,collectionGroup:u.mutation.key.getCollectionGroup(),largestBatchId:u.largestBatchId,overlayMutation:cf(a.yt,u.mutation)}}(this.serializer,this.userId,t))}}function Lc(i){return tn(i,Df)}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aO{bt(e){return tn(e,Oy)}getSessionToken(e){return this.bt(e).get("sessionToken").next(t=>{const r=t?.value;return r?Kt.fromUint8Array(r):Kt.EMPTY_BYTE_STRING})}setSessionToken(e,t){return this.bt(e).put({name:"sessionToken",value:t.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ia{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(Rt(e.integerValue));else if("doubleValue"in e){const r=Rt(e.doubleValue);isNaN(r)?this.Ft(t,13):(this.Ft(t,15),pu(r)?t.Mt(0):t.Mt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ft(t,20),typeof r=="string"&&(r=Dr(r)),t.xt(`${r.seconds||""}`),t.Mt(r.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(Vr(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const r=e.geoPointValue;this.Ft(t,45),t.Mt(r.latitude||0),t.Mt(r.longitude||0)}else"mapValue"in e?Zw(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):Of(e)?this.kt(e.mapValue,t):(this.qt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.Qt(e.arrayValue,t),this.Nt(t)):Te(19022,{$t:e})}Ot(e,t){this.Ft(t,25),this.Ut(e,t)}Ut(e,t){t.xt(e)}qt(e,t){const r=e.fields||{};this.Ft(t,55);for(const a of Object.keys(r))this.Ot(a,t),this.Ct(r[a],t)}kt(e,t){const r=e.fields||{};this.Ft(t,53);const a=ml,l=r[a].arrayValue?.values?.length||0;this.Ft(t,15),t.Mt(Rt(l)),this.Ot(a,t),this.Ct(r[a],t)}Qt(e,t){const r=e.values||[];this.Ft(t,50);for(const a of r)this.Ct(a,t)}Lt(e,t){this.Ft(t,37),_e.fromName(e).path.forEach(r=>{this.Ft(t,60),this.Ut(r,t)})}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}Ia.Kt=new Ia;/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law | agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES | CONDITIONS OF ANY KIND, either express | implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yo=255;function oO(i){if(i===0)return 8;let e=0;return i>>4||(e+=4,i<<=4),i>>6||(e+=2,i<<=2),i>>7||(e+=1),e}function wE(i){const e=64-function(r){let a=0;for(let l=0;l<8;++l){const u=oO(255&r[l]);if(a+=u,u!==8)break}return a}(i);return Math.ceil(e/8)}class lO{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Gt(r.value),r=t.next();this.zt()}jt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Jt(r.value),r=t.next();this.Ht()}Yt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Gt(r);else if(r<2048)this.Gt(960|r>>>6),this.Gt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Gt(480|r>>>12),this.Gt(128|63&r>>>6),this.Gt(128|63&r);else{const a=t.codePointAt(0);this.Gt(240|a>>>18),this.Gt(128|63&a>>>12),this.Gt(128|63&a>>>6),this.Gt(128|63&a)}}this.zt()}Zt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Jt(r);else if(r<2048)this.Jt(960|r>>>6),this.Jt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Jt(480|r>>>12),this.Jt(128|63&r>>>6),this.Jt(128|63&r);else{const a=t.codePointAt(0);this.Jt(240|a>>>18),this.Jt(128|63&a>>>12),this.Jt(128|63&a>>>6),this.Jt(128|63&a)}}this.Ht()}Xt(e){const t=this.en(e),r=wE(t);this.tn(1+r),this.buffer[this.position++]=255&r;for(let a=t.length-r;a<t.length;++a)this.buffer[this.position++]=255&t[a]}nn(e){const t=this.en(e),r=wE(t);this.tn(1+r),this.buffer[this.position++]=~(255&r);for(let a=t.length-r;a<t.length;++a)this.buffer[this.position++]=~(255&t[a])}rn(){this.sn(Yo),this.sn(255)}_n(){this.an(Yo),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const t=function(l){const u=new DataView(new ArrayBuffer(8));return u.setFloat64(0,l,!1),new Uint8Array(u.buffer)}(e),r=!!(128&t[0]);t[0]^=r?255:128;for(let a=1;a<t.length;++a)t[a]^=r?255:0;return t}Gt(e){const t=255&e;t===0?(this.sn(0),this.sn(255)):t===Yo?(this.sn(Yo),this.sn(0)):this.sn(t)}Jt(e){const t=255&e;t===0?(this.an(0),this.an(255)):t===Yo?(this.an(Yo),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);const a=new Uint8Array(r);a.set(this.buffer),this.buffer=a}}class cO{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}}class uO{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class Fc{constructor(){this.cn=new lO,this.ln=new cO(this.cn),this.hn=new uO(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return e===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Na{constructor(e,t,r,a){this.Tn=e,this.In=t,this.En=r,this.dn=a}An(){const e=this.dn.length,t=e===0||this.dn[e-1]===255?e+1:e,r=new Uint8Array(t);return r.set(this.dn,0),t!==e?r.set([0],this.dn.length):++r[r.length-1],new Na(this.Tn,this.In,this.En,r)}Rn(e,t,r){return{indexId:this.Tn,uid:e,arrayValue:Fd(this.En),directionalValue:Fd(this.dn),orderedDocumentKey:Fd(t),documentKey:r.path.toArray()}}Vn(e,t,r){const a=this.Rn(e,t,r);return[a.indexId,a.uid,a.arrayValue,a.directionalValue,a.orderedDocumentKey,a.documentKey]}}function vs(i,e){let t=i.Tn-e.Tn;return t!==0?t:(t=RE(i.En,e.En),t!==0?t:(t=RE(i.dn,e.dn),t!==0?t:_e.comparator(i.In,e.In)))}function RE(i,e){for(let t=0;t<i.length&&t<e.length;++t){const r=i[t]-e[t];if(r!==0)return r}return i.length-e.length}function Fd(i){return VT()?function(t){let r="";for(let a=0;a<t.length;a++)r+=String.fromCharCode(t[a]);return r}(i):i}function SE(i){return typeof i!="string"?i:function(t){const r=new Uint8Array(t.length);for(let a=0;a<t.length;a++)r[a]=t.charCodeAt(a);return r}(i)}class AE{constructor(e){this.mn=new dt((t,r)=>It.comparator(t.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(const t of e.filters){const r=t;r.isInequality()?this.mn=this.mn.add(r):this.gn.push(r)}}get pn(){return this.mn.size>1}yn(e){if(we(e.collectionGroup===this.collectionId,49279),this.pn)return!1;const t=jg(e);if(t!==void 0&&!this.wn(t))return!1;const r=wa(e);let a=new Set,l=0,u=0;for(;l<r.length&&this.wn(r[l]);++l)a=a.add(r[l].fieldPath.canonicalString());if(l===r.length)return!0;if(this.mn.size>0){const h=this.mn.getIterator().getNext();if(!a.has(h.field.canonicalString())){const m=r[l];if(!this.Sn(h,m)||!this.bn(this.fn[u++],m))return!1}++l}for(;l<r.length;++l){const h=r[l];if(u>=this.fn.length||!this.bn(this.fn[u++],h))return!1}return!0}Dn(){if(this.pn)return null;let e=new dt(It.comparator);const t=[];for(const r of this.gn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")t.push(new Pd(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new Pd(r.field,0))}for(const r of this.fn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new Pd(r.field,r.dir==="asc"?0:1)));return new Zd(Zd.UNKNOWN_ID,this.collectionId,t,mu.empty())}wn(e){for(const t of this.gn)if(this.Sn(t,e))return!0;return!1}Sn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===r}bn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function U1(i){if(we(i instanceof Ye||i instanceof ht,20012),i instanceof Ye){if(i instanceof l1){const t=i.value.arrayValue?.values?.map(r=>Ye.create(i.field,"==",r))||[];return ht.create(t,"or")}return i}const e=i.filters.map(t=>U1(t));return ht.create(e,i.op)}function hO(i){if(i.getFilters().length===0)return[];const e=ey(U1(i));return we(z1(e),7391),Jg(e)||Zg(e)?[e]:e.getFilters()}function Jg(i){return i instanceof Ye}function Zg(i){return i instanceof ht&&Fy(i)}function z1(i){return Jg(i)||Zg(i)||function(t){if(t instanceof ht&&Bg(t)){for(const r of t.getFilters())if(!Jg(r)&&!Zg(r))return!1;return!0}return!1}(i)}function ey(i){if(we(i instanceof Ye||i instanceof ht,34018),i instanceof Ye)return i;if(i.filters.length===1)return ey(i.filters[0]);const e=i.filters.map(r=>ey(r));let t=ht.create(e,i.op);return t=hf(t),z1(t)?t:(we(t instanceof ht,64498),we(yl(t),40251),we(t.filters.length>1,57927),t.filters.reduce((r,a)=>Ky(r,a)))}function Ky(i,e){let t;return we(i instanceof Ye||i instanceof ht,38388),we(e instanceof Ye||e instanceof ht,25473),t=i instanceof Ye?e instanceof Ye?function(a,l){return ht.create([a,l],"and")}(i,e):IE(i,e):e instanceof Ye?IE(e,i):function(a,l){if(we(a.filters.length>0&&l.filters.length>0,48005),yl(a)&&yl(l))return s1(a,l.getFilters());const u=Bg(a)?a:l,h=Bg(a)?l:a,m=u.filters.map(y=>Ky(y,h));return ht.create(m,"or")}(i,e),hf(t)}function IE(i,e){if(yl(e))return s1(e,i.getFilters());{const t=e.filters.map(r=>Ky(i,r));return ht.create(t,"or")}}function hf(i){if(we(i instanceof Ye||i instanceof ht,11850),i instanceof Ye)return i;const e=i.getFilters();if(e.length===1)return hf(e[0]);if(i1(i))return i;const t=e.map(a=>hf(a)),r=[];return t.forEach(a=>{a instanceof Ye?r.push(a):a instanceof ht&&(a.op===i.op?r.push(...a.filters):r.push(a))}),r.length===1?r[0]:ht.create(r,i.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dO{constructor(){this.Cn=new Yy}addToCollectionParentIndex(e,t){return this.Cn.add(t),Y.resolve()}getCollectionParents(e,t){return Y.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return Y.resolve()}deleteFieldIndex(e,t){return Y.resolve()}deleteAllFieldIndexes(e){return Y.resolve()}createTargetIndexes(e,t){return Y.resolve()}getDocumentsMatchingTarget(e,t){return Y.resolve(null)}getIndexType(e,t){return Y.resolve(0)}getFieldIndexes(e,t){return Y.resolve([])}getNextCollectionGroupToUpdate(e){return Y.resolve(null)}getMinOffset(e,t){return Y.resolve(ti.min())}getMinOffsetFromCollectionGroup(e,t){return Y.resolve(ti.min())}updateCollectionGroup(e,t,r){return Y.resolve()}updateIndexEntries(e,t){return Y.resolve()}}class Yy{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),a=this.index[t]||new dt(at.comparator),l=!a.has(r);return this.index[t]=a.add(r),l}has(e){const t=e.lastSegment(),r=e.popLast(),a=this.index[t];return a&&a.has(r)}getEntries(e){return(this.index[e]||new dt(at.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NE="IndexedDbIndexManager",bd=new Uint8Array(0);class fO{constructor(e,t){this.databaseId=t,this.vn=new Yy,this.Fn=new Ur(r=>Ha(r),(r,a)=>ju(r,a)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.vn.has(t)){const r=t.lastSegment(),a=t.popLast();e.addOnCommittedListener(()=>{this.vn.add(t)});const l={collectionId:r,parent:En(a)};return CE(e).put(l)}return Y.resolve()}getCollectionParents(e,t){const r=[],a=IDBKeyRange.bound([t,""],[Nw(t),""],!1,!0);return CE(e).J(a).next(l=>{for(const u of l){if(u.collectionId!==t)break;r.push(Hi(u.parent))}return r})}addFieldIndex(e,t){const r=Uc(e),a=function(h){return{indexId:h.indexId,collectionGroup:h.collectionGroup,fields:h.fields.map(m=>[m.fieldPath.canonicalString(),m.kind])}}(t);delete a.indexId;const l=r.add(a);if(t.indexState){const u=Qo(e);return l.next(h=>{u.put(xE(h,this.uid,t.indexState.sequenceNumber,t.indexState.offset))})}return l.next()}deleteFieldIndex(e,t){const r=Uc(e),a=Qo(e),l=$o(e);return r.delete(t.indexId).next(()=>a.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>l.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const t=Uc(e),r=$o(e),a=Qo(e);return t.Z().next(()=>r.Z()).next(()=>a.Z())}createTargetIndexes(e,t){return Y.forEach(this.Mn(t),r=>this.getIndexType(e,r).next(a=>{if(a===0||a===1){const l=new AE(r).Dn();if(l!=null)return this.addFieldIndex(e,l)}}))}getDocumentsMatchingTarget(e,t){const r=$o(e);let a=!0;const l=new Map;return Y.forEach(this.Mn(t),u=>this.xn(e,u).next(h=>{a&&(a=!!h),l.set(u,h)})).next(()=>{if(a){let u=Fe();const h=[];return Y.forEach(l,(m,y)=>{fe(NE,`Using index ${function(G){return`id=${G.indexId}|cg=${G.collectionGroup}|f=${G.fields.map(ne=>`${ne.fieldPath}:${ne.kind}`).join(",")}`}(m)} to execute ${Ha(t)}`);const _=function(G,ne){const B=jg(ne);if(B===void 0)return null;for(const re of of(G,B.fieldPath))switch(re.op){case"array-contains-any":return re.value.arrayValue.values||[];case"array-contains":return[re.value]}return null}(y,m),b=function(G,ne){const B=new Map;for(const re of wa(ne))for(const P of of(G,re.fieldPath))switch(P.op){case"==":case"in":B.set(re.fieldPath.canonicalString(),P.value);break;case"not-in":case"!=":return B.set(re.fieldPath.canonicalString(),P.value),Array.from(B.values())}return null}(y,m),T=function(G,ne){const B=[];let re=!0;for(const P of wa(ne)){const S=P.kind===0?oE(G,P.fieldPath,G.startAt):lE(G,P.fieldPath,G.startAt);B.push(S.value),re&&(re=S.inclusive)}return new gl(B,re)}(y,m),I=function(G,ne){const B=[];let re=!0;for(const P of wa(ne)){const S=P.kind===0?lE(G,P.fieldPath,G.endAt):oE(G,P.fieldPath,G.endAt);B.push(S.value),re&&(re=S.inclusive)}return new gl(B,re)}(y,m),V=this.On(m,y,T),L=this.On(m,y,I),O=this.Nn(m,y,b),Z=this.Bn(m.indexId,_,V,T.inclusive,L,I.inclusive,O);return Y.forEach(Z,se=>r.Y(se,t.limit).next(G=>{G.forEach(ne=>{const B=_e.fromSegments(ne.documentKey);u.has(B)||(u=u.add(B),h.push(B))})}))}).next(()=>h)}return Y.resolve(null)})}Mn(e){let t=this.Fn.get(e);return t||(e.filters.length===0?t=[e]:t=hO(ht.create(e.filters,"and")).map(r=>Gg(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.Fn.set(e,t),t)}Bn(e,t,r,a,l,u,h){const m=(t!=null?t.length:1)*Math.max(r.length,l.length),y=m/(t!=null?t.length:1),_=[];for(let b=0;b<m;++b){const T=t?this.Ln(t[b/y]):bd,I=this.kn(e,T,r[b%y],a),V=this.qn(e,T,l[b%y],u),L=h.map(O=>this.kn(e,T,O,!0));_.push(...this.createRange(I,V,L))}return _}kn(e,t,r,a){const l=new Na(e,_e.empty(),t,r);return a?l:l.An()}qn(e,t,r,a){const l=new Na(e,_e.empty(),t,r);return a?l.An():l}xn(e,t){const r=new AE(t),a=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,a).next(l=>{let u=null;for(const h of l)r.yn(h)&&(!u||h.fields.length>u.fields.length)&&(u=h);return u})}getIndexType(e,t){let r=2;const a=this.Mn(t);return Y.forEach(a,l=>this.xn(e,l).next(u=>{u?r!==0&&u.fields.length<function(m){let y=new dt(It.comparator),_=!1;for(const b of m.filters)for(const T of b.getFlattenedFilters())T.field.isKeyField()||(T.op==="array-contains"||T.op==="array-contains-any"?_=!0:y=y.add(T.field));for(const b of m.orderBy)b.field.isKeyField()||(y=y.add(b.field));return y.size+(_?1:0)}(l)&&(r=1):r=0})).next(()=>function(u){return u.limit!==null}(t)&&a.length>1&&r===2?1:r)}Qn(e,t){const r=new Fc;for(const a of wa(e)){const l=t.data.field(a.fieldPath);if(l==null)return null;const u=r.Pn(a.kind);Ia.Kt.Dt(l,u)}return r.un()}Ln(e){const t=new Fc;return Ia.Kt.Dt(e,t.Pn(0)),t.un()}$n(e,t){const r=new Fc;return Ia.Kt.Dt(xu(this.databaseId,t),r.Pn(function(l){const u=wa(l);return u.length===0?0:u[u.length-1].kind}(e))),r.un()}Nn(e,t,r){if(r===null)return[];let a=[];a.push(new Fc);let l=0;for(const u of wa(e)){const h=r[l++];for(const m of a)if(this.Un(t,u.fieldPath)&&Eu(h))a=this.Kn(a,u,h);else{const y=m.Pn(u.kind);Ia.Kt.Dt(h,y)}}return this.Wn(a)}On(e,t,r){return this.Nn(e,t,r.position)}Wn(e){const t=[];for(let r=0;r<e.length;++r)t[r]=e[r].un();return t}Kn(e,t,r){const a=[...e],l=[];for(const u of r.arrayValue.values||[])for(const h of a){const m=new Fc;m.seed(h.un()),Ia.Kt.Dt(u,m.Pn(t.kind)),l.push(m)}return l}Un(e,t){return!!e.filters.find(r=>r instanceof Ye&&r.field.isEqual(t)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,t){const r=Uc(e),a=Qo(e);return(t?r.J(Lg,IDBKeyRange.bound(t,t)):r.J()).next(l=>{const u=[];return Y.forEach(l,h=>a.get([h.indexId,this.uid]).next(m=>{u.push(function(_,b){const T=b?new mu(b.sequenceNumber,new ti(Ka(b.readTime),new _e(Hi(b.documentKey)),b.largestBatchId)):mu.empty(),I=_.fields.map(([V,L])=>new Pd(It.fromServerFormat(V),L));return new Zd(_.indexId,_.collectionGroup,I,T)}(h,m))})).next(()=>u)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>t.length===0?null:(t.sort((r,a)=>{const l=r.indexState.sequenceNumber-a.indexState.sequenceNumber;return l!==0?l:Ve(r.collectionGroup,a.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,r){const a=Uc(e),l=Qo(e);return this.Gn(e).next(u=>a.J(Lg,IDBKeyRange.bound(t,t)).next(h=>Y.forEach(h,m=>l.put(xE(m.indexId,this.uid,u,r)))))}updateIndexEntries(e,t){const r=new Map;return Y.forEach(t,(a,l)=>{const u=r.get(a.collectionGroup);return(u?Y.resolve(u):this.getFieldIndexes(e,a.collectionGroup)).next(h=>(r.set(a.collectionGroup,h),Y.forEach(h,m=>this.zn(e,a,m).next(y=>{const _=this.jn(l,m);return y.isEqual(_)?Y.resolve():this.Jn(e,l,m,y,_)}))))})}Hn(e,t,r,a){return $o(e).put(a.Rn(this.uid,this.$n(r,t.key),t.key))}Yn(e,t,r,a){return $o(e).delete(a.Vn(this.uid,this.$n(r,t.key),t.key))}zn(e,t,r){const a=$o(e);let l=new dt(vs);return a.ee({index:Uw,range:IDBKeyRange.only([r.indexId,this.uid,Fd(this.$n(r,t))])},(u,h)=>{l=l.add(new Na(r.indexId,t,SE(h.arrayValue),SE(h.directionalValue)))}).next(()=>l)}jn(e,t){let r=new dt(vs);const a=this.Qn(t,e);if(a==null)return r;const l=jg(t);if(l!=null){const u=e.data.field(l.fieldPath);if(Eu(u))for(const h of u.arrayValue.values||[])r=r.add(new Na(t.indexId,e.key,this.Ln(h),a))}else r=r.add(new Na(t.indexId,e.key,bd,a));return r}Jn(e,t,r,a,l){fe(NE,"Updating index entries for document '%s'",t.key);const u=[];return function(m,y,_,b,T){const I=m.getIterator(),V=y.getIterator();let L=Ko(I),O=Ko(V);for(;L||O;){let Z=!1,se=!1;if(L&&O){const G=_(L,O);G<0?se=!0:G>0&&(Z=!0)}else L!=null?se=!0:Z=!0;Z?(b(O),O=Ko(V)):se?(T(L),L=Ko(I)):(L=Ko(I),O=Ko(V))}}(a,l,vs,h=>{u.push(this.Hn(e,t,r,h))},h=>{u.push(this.Yn(e,t,r,h))}),Y.waitFor(u)}Gn(e){let t=1;return Qo(e).ee({index:Fw,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,a,l)=>{l.done(),t=a.sequenceNumber+1}).next(()=>t)}createRange(e,t,r){r=r.sort((u,h)=>vs(u,h)).filter((u,h,m)=>!h||vs(u,m[h-1])!==0);const a=[];a.push(e);for(const u of r){const h=vs(u,e),m=vs(u,t);if(h===0)a[0]=e.An();else if(h>0&&m<0)a.push(u),a.push(u.An());else if(m>0)break}a.push(t);const l=[];for(let u=0;u<a.length;u+=2){if(this.Zn(a[u],a[u+1]))return[];const h=a[u].Vn(this.uid,bd,_e.empty()),m=a[u+1].Vn(this.uid,bd,_e.empty());l.push(IDBKeyRange.bound(h,m))}return l}Zn(e,t){return vs(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(PE)}getMinOffset(e,t){return Y.mapArray(this.Mn(t),r=>this.xn(e,r).next(a=>a||Te(44426))).next(PE)}}function CE(i){return tn(i,vu)}function $o(i){return tn(i,iu)}function Uc(i){return tn(i,Vy)}function Qo(i){return tn(i,nu)}function PE(i){we(i.length!==0,28825);let e=i[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<i.length;r++){const a=i[r].indexState.offset;Cy(a,e)<0&&(e=a),t<a.largestBatchId&&(t=a.largestBatchId)}return new ti(e.readTime,e.documentKey,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DE={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},q1=41943040;class bn{static withCacheSize(e){return new bn(e,bn.DEFAULT_COLLECTION_PERCENTILE,bn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function B1(i,e,t){const r=i.store(wi),a=i.store(ul),l=[],u=IDBKeyRange.only(t.batchId);let h=0;const m=r.ee({range:u},(_,b,T)=>(h++,T.delete()));l.push(m.next(()=>{we(h===1,47070,{batchId:t.batchId})}));const y=[];for(const _ of t.mutations){const b=jw(e,_.key.path,t.batchId);l.push(a.delete(b)),y.push(_.key)}return Y.waitFor(l).next(()=>y)}function df(i){if(!i)return 0;let e;if(i.document)e=i.document;else if(i.unknownDocument)e=i.unknownDocument;else{if(!i.noDocument)throw Te(14731);e=i.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */bn.DEFAULT_COLLECTION_PERCENTILE=10,bn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,bn.DEFAULT=new bn(q1,bn.DEFAULT_COLLECTION_PERCENTILE,bn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),bn.DISABLED=new bn(-1,0,0);class zf{constructor(e,t,r,a){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=a,this.Xn={}}static wt(e,t,r,a){we(e.uid!=="",64387);const l=e.isAuthenticated()?e.uid:"";return new zf(l,t,r,a)}checkEmpty(e){let t=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return _s(e).ee({index:Pa,range:r},(a,l,u)=>{t=!1,u.done()}).next(()=>t)}addMutationBatch(e,t,r,a){const l=tl(e),u=_s(e);return u.add({}).next(h=>{we(typeof h=="number",49019);const m=new zy(h,t,r,a),y=function(I,V,L){const O=L.baseMutations.map(se=>cf(I.yt,se)),Z=L.mutations.map(se=>cf(I.yt,se));return{userId:V,batchId:L.batchId,localWriteTimeMs:L.localWriteTime.toMillis(),baseMutations:O,mutations:Z}}(this.serializer,this.userId,m),_=[];let b=new dt((T,I)=>Ve(T.canonicalString(),I.canonicalString()));for(const T of a){const I=jw(this.userId,T.key.path,h);b=b.add(T.key.path.popLast()),_.push(u.put(y)),_.push(l.put(I,zD))}return b.forEach(T=>{_.push(this.indexManager.addToCollectionParentIndex(e,T))}),e.addOnCommittedListener(()=>{this.Xn[h]=m.keys()}),Y.waitFor(_).next(()=>m)})}lookupMutationBatch(e,t){return _s(e).get(t).next(r=>r?(we(r.userId===this.userId,48,"Unexpected user for mutation batch",{userId:r.userId,batchId:t}),Aa(this.serializer,r)):null)}er(e,t){return this.Xn[t]?Y.resolve(this.Xn[t]):this.lookupMutationBatch(e,t).next(r=>{if(r){const a=r.keys();return this.Xn[t]=a,a}return null})}getNextMutationBatchAfterBatchId(e,t){const r=t+1,a=IDBKeyRange.lowerBound([this.userId,r]);let l=null;return _s(e).ee({index:Pa,range:a},(u,h,m)=>{h.userId===this.userId&&(we(h.batchId>=r,47524,{tr:r}),l=Aa(this.serializer,h)),m.done()}).next(()=>l)}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=Da;return _s(e).ee({index:Pa,range:t,reverse:!0},(a,l,u)=>{r=l.batchId,u.done()}).next(()=>r)}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,Da],[this.userId,Number.POSITIVE_INFINITY]);return _s(e).J(Pa,t).next(r=>r.map(a=>Aa(this.serializer,a)))}getAllMutationBatchesAffectingDocumentKey(e,t){const r=Dd(this.userId,t.path),a=IDBKeyRange.lowerBound(r),l=[];return tl(e).ee({range:a},(u,h,m)=>{const[y,_,b]=u,T=Hi(_);if(y===this.userId&&t.path.isEqual(T))return _s(e).get(b).next(I=>{if(!I)throw Te(61480,{nr:u,batchId:b});we(I.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:I.userId,batchId:b}),l.push(Aa(this.serializer,I))});m.done()}).next(()=>l)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new dt(Ve);const a=[];return t.forEach(l=>{const u=Dd(this.userId,l.path),h=IDBKeyRange.lowerBound(u),m=tl(e).ee({range:h},(y,_,b)=>{const[T,I,V]=y,L=Hi(I);T===this.userId&&l.path.isEqual(L)?r=r.add(V):b.done()});a.push(m)}),Y.waitFor(a).next(()=>this.rr(e,r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,a=r.length+1,l=Dd(this.userId,r),u=IDBKeyRange.lowerBound(l);let h=new dt(Ve);return tl(e).ee({range:u},(m,y,_)=>{const[b,T,I]=m,V=Hi(T);b===this.userId&&r.isPrefixOf(V)?V.length===a&&(h=h.add(I)):_.done()}).next(()=>this.rr(e,h))}rr(e,t){const r=[],a=[];return t.forEach(l=>{a.push(_s(e).get(l).next(u=>{if(u===null)throw Te(35274,{batchId:l});we(u.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:u.userId,batchId:l}),r.push(Aa(this.serializer,u))}))}),Y.waitFor(a).next(()=>r)}removeMutationBatch(e,t){return B1(e.le,this.userId,t).next(r=>(e.addOnCommittedListener(()=>{this.ir(t.batchId)}),Y.forEach(r,a=>this.referenceDelegate.markPotentiallyOrphaned(e,a))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return Y.resolve();const r=IDBKeyRange.lowerBound(function(u){return[u]}(this.userId)),a=[];return tl(e).ee({range:r},(l,u,h)=>{if(l[0]===this.userId){const m=Hi(l[1]);a.push(m)}else h.done()}).next(()=>{we(a.length===0,56720,{sr:a.map(l=>l.canonicalString())})})})}containsKey(e,t){return H1(e,this.userId,t)}_r(e){return G1(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:Da,lastStreamToken:""})}}function H1(i,e,t){const r=Dd(e,t.path),a=r[1],l=IDBKeyRange.lowerBound(r);let u=!1;return tl(i).ee({range:l,X:!0},(h,m,y)=>{const[_,b,T]=h;_===e&&b===a&&(u=!0),y.done()}).next(()=>u)}function _s(i){return tn(i,wi)}function tl(i){return tn(i,ul)}function G1(i){return tn(i,gu)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ya{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Ya(0)}static cr(){return new Ya(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mO{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.lr(e).next(t=>{const r=new Ya(t.highestTargetId);return t.highestTargetId=r.next(),this.hr(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.lr(e).next(t=>Se.fromTimestamp(new ut(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.lr(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,r){return this.lr(e).next(a=>(a.highestListenSequenceNumber=t,r&&(a.lastRemoteSnapshotVersion=r.toTimestamp()),t>a.highestListenSequenceNumber&&(a.highestListenSequenceNumber=t),this.hr(e,a)))}addTargetData(e,t){return this.Pr(e,t).next(()=>this.lr(e).next(r=>(r.targetCount+=1,this.Tr(t,r),this.hr(e,r))))}updateTargetData(e,t){return this.Pr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>Xo(e).delete(t.targetId)).next(()=>this.lr(e)).next(r=>(we(r.targetCount>0,8065),r.targetCount-=1,this.hr(e,r)))}removeTargets(e,t,r){let a=0;const l=[];return Xo(e).ee((u,h)=>{const m=Qc(h);m.sequenceNumber<=t&&r.get(m.targetId)===null&&(a++,l.push(this.removeTargetData(e,m)))}).next(()=>Y.waitFor(l)).next(()=>a)}forEachTarget(e,t){return Xo(e).ee((r,a)=>{const l=Qc(a);t(l)})}lr(e){return VE(e).get(nf).next(t=>(we(t!==null,2888),t))}hr(e,t){return VE(e).put(nf,t)}Pr(e,t){return Xo(e).put(L1(this.serializer,t))}Tr(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.lr(e).next(t=>t.targetCount)}getTargetData(e,t){const r=Ha(t),a=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let l=null;return Xo(e).ee({range:a,index:Lw},(u,h,m)=>{const y=Qc(h);ju(t,y.target)&&(l=y,m.done())}).next(()=>l)}addMatchingKeys(e,t,r){const a=[],l=ws(e);return t.forEach(u=>{const h=En(u.path);a.push(l.put({targetId:r,path:h})),a.push(this.referenceDelegate.addReference(e,r,u))}),Y.waitFor(a)}removeMatchingKeys(e,t,r){const a=ws(e);return Y.forEach(t,l=>{const u=En(l.path);return Y.waitFor([a.delete([r,u]),this.referenceDelegate.removeReference(e,r,l)])})}removeMatchingKeysForTargetId(e,t){const r=ws(e),a=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(a)}getMatchingKeysForTargetId(e,t){const r=IDBKeyRange.bound([t],[t+1],!1,!0),a=ws(e);let l=Fe();return a.ee({range:r,X:!0},(u,h,m)=>{const y=Hi(u[1]),_=new _e(y);l=l.add(_)}).next(()=>l)}containsKey(e,t){const r=En(t.path),a=IDBKeyRange.bound([r],[Nw(r)],!1,!0);let l=0;return ws(e).ee({index:Dy,X:!0,range:a},([u,h],m,y)=>{u!==0&&(l++,y.done())}).next(()=>l>0)}At(e,t){return Xo(e).get(t).next(r=>r?Qc(r):null)}}function Xo(i){return tn(i,hl)}function VE(i){return tn(i,Va)}function ws(i){return tn(i,dl)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OE="LruGarbageCollector",pO=1048576;function ME([i,e],[t,r]){const a=Ve(i,t);return a===0?Ve(e,r):a}class gO{constructor(e){this.Ir=e,this.buffer=new dt(ME),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();ME(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class K1{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){fe(OE,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){qs(t)?fe(OE,"Ignoring IndexedDB error during garbage collection: ",t):await Xa(t)}await this.Vr(3e5)})}}class yO{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(t===0)return Y.resolve(gi.ce);const r=new gO(t);return this.mr.forEachTarget(e,a=>r.Ar(a.sequenceNumber)).next(()=>this.mr.pr(e,a=>r.Ar(a))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.mr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(fe("LruGarbageCollector","Garbage collection skipped; disabled"),Y.resolve(DE)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(fe("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),DE):this.yr(e,t))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let r,a,l,u,h,m,y;const _=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(b=>(b>this.params.maximumSequenceNumbersToCollect?(fe("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${b}`),a=this.params.maximumSequenceNumbersToCollect):a=b,u=Date.now(),this.nthSequenceNumber(e,a))).next(b=>(r=b,h=Date.now(),this.removeTargets(e,r,t))).next(b=>(l=b,m=Date.now(),this.removeOrphanedDocuments(e,r))).next(b=>(y=Date.now(),Wo()<=Ge.DEBUG&&fe("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${u-_}ms
	Determined least recently used ${a} in `+(h-u)+`ms
	Removed ${l} targets in `+(m-h)+`ms
	Removed ${b} documents in `+(y-m)+`ms
Total Duration: ${y-_}ms`),Y.resolve({didRun:!0,sequenceNumbersCollected:a,targetsRemoved:l,documentsRemoved:b})))}}function Y1(i,e){return new yO(i,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vO{constructor(e,t){this.db=e,this.garbageCollector=Y1(this,t)}gr(e){const t=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next(r=>t.next(a=>r+a))}wr(e){let t=0;return this.pr(e,r=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}pr(e,t){return this.Sr(e,(r,a)=>t(a))}addReference(e,t,r){return xd(e,r)}removeReference(e,t,r){return xd(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return xd(e,t)}br(e,t){return function(a,l){let u=!1;return G1(a).te(h=>H1(a,h,l).next(m=>(m&&(u=!0),Y.resolve(!m)))).next(()=>u)}(e,t)}removeOrphanedDocuments(e,t){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),a=[];let l=0;return this.Sr(e,(u,h)=>{if(h<=t){const m=this.br(e,u).next(y=>{if(!y)return l++,r.getEntry(e,u).next(()=>(r.removeEntry(u,Se.min()),ws(e).delete(function(b){return[0,En(b.path)]}(u))))});a.push(m)}}).next(()=>Y.waitFor(a)).next(()=>r.apply(e)).next(()=>l)}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return xd(e,t)}Sr(e,t){const r=ws(e);let a,l=gi.ce;return r.ee({index:Dy},([u,h],{path:m,sequenceNumber:y})=>{u===0?(l!==gi.ce&&t(new _e(Hi(a)),l),l=y,a=m):l=gi.ce}).next(()=>{l!==gi.ce&&t(new _e(Hi(a)),l)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function xd(i,e){return ws(i).put(function(r,a){return{targetId:0,path:En(r.path),sequenceNumber:a}}(e,i.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $1{constructor(){this.changes=new Ur(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Vt.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?Y.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _O{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return xa(e).put(r)}removeEntry(e,t,r){return xa(e).delete(function(l,u){const h=l.path.toArray();return[h.slice(0,h.length-2),h[h.length-2],uf(u),h[h.length-1]]}(t,r))}updateMetadata(e,t){return this.getMetadata(e).next(r=>(r.byteSize+=t,this.Dr(e,r)))}getEntry(e,t){let r=Vt.newInvalidDocument(t);return xa(e).ee({index:Vd,range:IDBKeyRange.only(zc(t))},(a,l)=>{r=this.Cr(t,l)}).next(()=>r)}vr(e,t){let r={size:0,document:Vt.newInvalidDocument(t)};return xa(e).ee({index:Vd,range:IDBKeyRange.only(zc(t))},(a,l)=>{r={document:this.Cr(t,l),size:df(l)}}).next(()=>r)}getEntries(e,t){let r=Jn();return this.Fr(e,t,(a,l)=>{const u=this.Cr(a,l);r=r.insert(a,u)}).next(()=>r)}Mr(e,t){let r=Jn(),a=new St(_e.comparator);return this.Fr(e,t,(l,u)=>{const h=this.Cr(l,u);r=r.insert(l,h),a=a.insert(l,df(u))}).next(()=>({documents:r,Or:a}))}Fr(e,t,r){if(t.isEmpty())return Y.resolve();let a=new dt(LE);t.forEach(m=>a=a.add(m));const l=IDBKeyRange.bound(zc(a.first()),zc(a.last())),u=a.getIterator();let h=u.getNext();return xa(e).ee({index:Vd,range:l},(m,y,_)=>{const b=_e.fromSegments([...y.prefixPath,y.collectionGroup,y.documentId]);for(;h&&LE(h,b)<0;)r(h,null),h=u.getNext();h&&h.isEqual(b)&&(r(h,y),h=u.hasNext()?u.getNext():null),h?_.j(zc(h)):_.done()}).next(()=>{for(;h;)r(h,null),h=u.hasNext()?u.getNext():null})}getDocumentsMatchingQuery(e,t,r,a,l){const u=t.path,h=[u.popLast().toArray(),u.lastSegment(),uf(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],m=[u.popLast().toArray(),u.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return xa(e).J(IDBKeyRange.bound(h,m,!0)).next(y=>{l?.incrementDocumentReadCount(y.length);let _=Jn();for(const b of y){const T=this.Cr(_e.fromSegments(b.prefixPath.concat(b.collectionGroup,b.documentId)),b);T.isFoundDocument()&&(Fu(t,T)||a.has(T.key))&&(_=_.insert(T.key,T))}return _})}getAllFromCollectionGroup(e,t,r,a){let l=Jn();const u=kE(t,r),h=kE(t,ti.max());return xa(e).ee({index:kw,range:IDBKeyRange.bound(u,h,!0)},(m,y,_)=>{const b=this.Cr(_e.fromSegments(y.prefixPath.concat(y.collectionGroup,y.documentId)),y);l=l.insert(b.key,b),l.size===a&&_.done()}).next(()=>l)}newChangeBuffer(e){return new bO(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return jE(e).get(kg).next(t=>(we(!!t,20021),t))}Dr(e,t){return jE(e).put(kg,t)}Cr(e,t){if(t){const r=rO(this.serializer,t);if(!(r.isNoDocument()&&r.version.isEqual(Se.min())))return r}return Vt.newInvalidDocument(e)}}function Q1(i){return new _O(i)}class bO extends $1{constructor(e,t){super(),this.Nr=e,this.trackRemovals=t,this.Br=new Ur(r=>r.toString(),(r,a)=>r.isEqual(a))}applyChanges(e){const t=[];let r=0,a=new dt((l,u)=>Ve(l.canonicalString(),u.canonicalString()));return this.changes.forEach((l,u)=>{const h=this.Br.get(l);if(t.push(this.Nr.removeEntry(e,l,h.readTime)),u.isValidDocument()){const m=_E(this.Nr.serializer,u);a=a.add(l.path.popLast());const y=df(m);r+=y-h.size,t.push(this.Nr.addEntry(e,l,m))}else if(r-=h.size,this.trackRemovals){const m=_E(this.Nr.serializer,u.convertToNoDocument(Se.min()));t.push(this.Nr.addEntry(e,l,m))}}),a.forEach(l=>{t.push(this.Nr.indexManager.addToCollectionParentIndex(e,l))}),t.push(this.Nr.updateMetadata(e,r)),Y.waitFor(t)}getFromCache(e,t){return this.Nr.vr(e,t).next(r=>(this.Br.set(t,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,t){return this.Nr.Mr(e,t).next(({documents:r,Or:a})=>(a.forEach((l,u)=>{this.Br.set(l,{size:u,readTime:r.get(l).readTime})}),r))}}function jE(i){return tn(i,yu)}function xa(i){return tn(i,tf)}function zc(i){const e=i.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function kE(i,e){const t=e.documentKey.path.toArray();return[i,uf(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function LE(i,e){const t=i.path.toArray(),r=e.path.toArray();let a=0;for(let l=0;l<t.length-2&&l<r.length-2;++l)if(a=Ve(t[l],r[l]),a)return a;return a=Ve(t.length,r.length),a||(a=Ve(t[t.length-2],r[r.length-2]),a||Ve(t[t.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xO{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X1{constructor(e,t,r,a){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=a}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(a=>(r=a,this.remoteDocumentCache.getEntry(e,t))).next(a=>(r!==null&&ou(r.mutation,a,Ln.empty(),ut.now()),a))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,Fe()).next(()=>r))}getLocalViewOfDocuments(e,t,r=Fe()){const a=Gi();return this.populateOverlays(e,a,t).next(()=>this.computeViews(e,t,a,r).next(l=>{let u=Yc();return l.forEach((h,m)=>{u=u.insert(h,m.overlayedDocument)}),u}))}getOverlayedDocuments(e,t){const r=Gi();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,Fe()))}populateOverlays(e,t,r){const a=[];return r.forEach(l=>{t.has(l)||a.push(l)}),this.documentOverlayCache.getOverlays(e,a).next(l=>{l.forEach((u,h)=>{t.set(u,h)})})}computeViews(e,t,r,a){let l=Jn();const u=au(),h=function(){return au()}();return t.forEach((m,y)=>{const _=r.get(y.key);a.has(y.key)&&(_===void 0||_.mutation instanceof zr)?l=l.insert(y.key,y):_!==void 0?(u.set(y.key,_.mutation.getFieldMask()),ou(_.mutation,y,_.mutation.getFieldMask(),ut.now())):u.set(y.key,Ln.empty())}),this.recalculateAndSaveOverlays(e,l).next(m=>(m.forEach((y,_)=>u.set(y,_)),t.forEach((y,_)=>h.set(y,new xO(_,u.get(y)??null))),h))}recalculateAndSaveOverlays(e,t){const r=au();let a=new St((u,h)=>u-h),l=Fe();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(u=>{for(const h of u)h.keys().forEach(m=>{const y=t.get(m);if(y===null)return;let _=r.get(m)||Ln.empty();_=h.applyToLocalView(y,_),r.set(m,_);const b=(a.get(h.batchId)||Fe()).add(m);a=a.insert(h.batchId,b)})}).next(()=>{const u=[],h=a.getReverseIterator();for(;h.hasNext();){const m=h.getNext(),y=m.key,_=m.value,b=m1();_.forEach(T=>{if(!l.has(T)){const I=b1(t.get(T),r.get(T));I!==null&&b.set(T,I),l=l.add(T)}}),u.push(this.documentOverlayCache.saveOverlays(e,y,b))}return Y.waitFor(u)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,a){return function(u){return _e.isDocumentKey(u.path)&&u.collectionGroup===null&&u.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):c1(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,a):this.getDocumentsMatchingCollectionQuery(e,t,r,a)}getNextDocuments(e,t,r,a){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,a).next(l=>{const u=a-l.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,a-l.size):Y.resolve(Gi());let h=fu,m=l;return u.next(y=>Y.forEach(y,(_,b)=>(h<b.largestBatchId&&(h=b.largestBatchId),l.get(_)?Y.resolve():this.remoteDocumentCache.getEntry(e,_).next(T=>{m=m.insert(_,T)}))).next(()=>this.populateOverlays(e,y,l)).next(()=>this.computeViews(e,m,y,Fe())).next(_=>({batchId:h,changes:f1(_)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new _e(t)).next(r=>{let a=Yc();return r.isFoundDocument()&&(a=a.insert(r.key,r)),a})}getDocumentsMatchingCollectionGroupQuery(e,t,r,a){const l=t.collectionGroup;let u=Yc();return this.indexManager.getCollectionParents(e,l).next(h=>Y.forEach(h,m=>{const y=function(b,T){return new ku(T,null,b.explicitOrderBy.slice(),b.filters.slice(),b.limit,b.limitType,b.startAt,b.endAt)}(t,m.child(l));return this.getDocumentsMatchingCollectionQuery(e,y,r,a).next(_=>{_.forEach((b,T)=>{u=u.insert(b,T)})})}).next(()=>u))}getDocumentsMatchingCollectionQuery(e,t,r,a){let l;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(u=>(l=u,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,l,a))).next(u=>{l.forEach((m,y)=>{const _=y.getKey();u.get(_)===null&&(u=u.insert(_,Vt.newInvalidDocument(_)))});let h=Yc();return u.forEach((m,y)=>{const _=l.get(m);_!==void 0&&ou(_.mutation,y,Ln.empty(),ut.now()),Fu(t,y)&&(h=h.insert(m,y))}),h})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EO{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return Y.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,function(a){return{id:a.id,version:a.version,createTime:Dn(a.createTime)}}(t)),Y.resolve()}getNamedQuery(e,t){return Y.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,function(a){return{name:a.name,query:F1(a.bundledQuery),readTime:Dn(a.readTime)}}(t)),Y.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TO{constructor(){this.overlays=new St(_e.comparator),this.qr=new Map}getOverlay(e,t){return Y.resolve(this.overlays.get(t))}getOverlays(e,t){const r=Gi();return Y.forEach(t,a=>this.getOverlay(e,a).next(l=>{l!==null&&r.set(a,l)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((a,l)=>{this.St(e,t,l)}),Y.resolve()}removeOverlaysForBatchId(e,t,r){const a=this.qr.get(r);return a!==void 0&&(a.forEach(l=>this.overlays=this.overlays.remove(l)),this.qr.delete(r)),Y.resolve()}getOverlaysForCollection(e,t,r){const a=Gi(),l=t.length+1,u=new _e(t.child("")),h=this.overlays.getIteratorFrom(u);for(;h.hasNext();){const m=h.getNext().value,y=m.getKey();if(!t.isPrefixOf(y.path))break;y.path.length===l&&m.largestBatchId>r&&a.set(m.getKey(),m)}return Y.resolve(a)}getOverlaysForCollectionGroup(e,t,r,a){let l=new St((y,_)=>y-_);const u=this.overlays.getIterator();for(;u.hasNext();){const y=u.getNext().value;if(y.getKey().getCollectionGroup()===t&&y.largestBatchId>r){let _=l.get(y.largestBatchId);_===null&&(_=Gi(),l=l.insert(y.largestBatchId,_)),_.set(y.getKey(),y)}}const h=Gi(),m=l.getIterator();for(;m.hasNext()&&(m.getNext().value.forEach((y,_)=>h.set(y,_)),!(h.size()>=a)););return Y.resolve(h)}St(e,t,r){const a=this.overlays.get(r.key);if(a!==null){const u=this.qr.get(a.largestBatchId).delete(r.key);this.qr.set(a.largestBatchId,u)}this.overlays=this.overlays.insert(r.key,new By(t,r));let l=this.qr.get(t);l===void 0&&(l=Fe(),this.qr.set(t,l)),this.qr.set(t,l.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wO{constructor(){this.sessionToken=Kt.EMPTY_BYTE_STRING}getSessionToken(e){return Y.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,Y.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $y{constructor(){this.Qr=new dt(ln.$r),this.Ur=new dt(ln.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const r=new ln(e,t);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Gr(new ln(e,t))}zr(e,t){e.forEach(r=>this.removeReference(r,t))}jr(e){const t=new _e(new at([])),r=new ln(t,e),a=new ln(t,e+1),l=[];return this.Ur.forEachInRange([r,a],u=>{this.Gr(u),l.push(u.key)}),l}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new _e(new at([])),r=new ln(t,e),a=new ln(t,e+1);let l=Fe();return this.Ur.forEachInRange([r,a],u=>{l=l.add(u.key)}),l}containsKey(e){const t=new ln(e,0),r=this.Qr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class ln{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return _e.comparator(e.key,t.key)||Ve(e.Yr,t.Yr)}static Kr(e,t){return Ve(e.Yr,t.Yr)||_e.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RO{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new dt(ln.$r)}checkEmpty(e){return Y.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,a){const l=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const u=new zy(l,t,r,a);this.mutationQueue.push(u);for(const h of a)this.Zr=this.Zr.add(new ln(h.key,l)),this.indexManager.addToCollectionParentIndex(e,h.key.path.popLast());return Y.resolve(u)}lookupMutationBatch(e,t){return Y.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,a=this.ei(r),l=a<0?0:a;return Y.resolve(this.mutationQueue.length>l?this.mutationQueue[l]:null)}getHighestUnacknowledgedBatchId(){return Y.resolve(this.mutationQueue.length===0?Da:this.tr-1)}getAllMutationBatches(e){return Y.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new ln(t,0),a=new ln(t,Number.POSITIVE_INFINITY),l=[];return this.Zr.forEachInRange([r,a],u=>{const h=this.Xr(u.Yr);l.push(h)}),Y.resolve(l)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new dt(Ve);return t.forEach(a=>{const l=new ln(a,0),u=new ln(a,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([l,u],h=>{r=r.add(h.Yr)})}),Y.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,a=r.length+1;let l=r;_e.isDocumentKey(l)||(l=l.child(""));const u=new ln(new _e(l),0);let h=new dt(Ve);return this.Zr.forEachWhile(m=>{const y=m.key.path;return!!r.isPrefixOf(y)&&(y.length===a&&(h=h.add(m.Yr)),!0)},u),Y.resolve(this.ti(h))}ti(e){const t=[];return e.forEach(r=>{const a=this.Xr(r);a!==null&&t.push(a)}),t}removeMutationBatch(e,t){we(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return Y.forEach(t.mutations,a=>{const l=new ln(a.key,t.batchId);return r=r.delete(l),this.referenceDelegate.markPotentiallyOrphaned(e,a.key)}).next(()=>{this.Zr=r})}ir(e){}containsKey(e,t){const r=new ln(t,0),a=this.Zr.firstAfterOrEqual(r);return Y.resolve(t.isEqual(a&&a.key))}performConsistencyCheck(e){return this.mutationQueue.length,Y.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SO{constructor(e){this.ri=e,this.docs=function(){return new St(_e.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,a=this.docs.get(r),l=a?a.size:0,u=this.ri(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:u}),this.size+=u-l,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return Y.resolve(r?r.document.mutableCopy():Vt.newInvalidDocument(t))}getEntries(e,t){let r=Jn();return t.forEach(a=>{const l=this.docs.get(a);r=r.insert(a,l?l.document.mutableCopy():Vt.newInvalidDocument(a))}),Y.resolve(r)}getDocumentsMatchingQuery(e,t,r,a){let l=Jn();const u=t.path,h=new _e(u.child("__id-9223372036854775808__")),m=this.docs.getIteratorFrom(h);for(;m.hasNext();){const{key:y,value:{document:_}}=m.getNext();if(!u.isPrefixOf(y.path))break;y.path.length>u.length+1||Cy(Dw(_),r)<=0||(a.has(_.key)||Fu(t,_))&&(l=l.insert(_.key,_.mutableCopy()))}return Y.resolve(l)}getAllFromCollectionGroup(e,t,r,a){Te(9500)}ii(e,t){return Y.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new AO(this)}getSize(e){return Y.resolve(this.size)}}class AO extends $1{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach((r,a)=>{a.isValidDocument()?t.push(this.Nr.addEntry(e,a)):this.Nr.removeEntry(r)}),Y.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IO{constructor(e){this.persistence=e,this.si=new Ur(t=>Ha(t),ju),this.lastRemoteSnapshotVersion=Se.min(),this.highestTargetId=0,this.oi=0,this._i=new $y,this.targetCount=0,this.ai=Ya.ur()}forEachTarget(e,t){return this.si.forEach((r,a)=>t(a)),Y.resolve()}getLastRemoteSnapshotVersion(e){return Y.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Y.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),Y.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.oi&&(this.oi=t),Y.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new Ya(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,Y.resolve()}updateTargetData(e,t){return this.Pr(t),Y.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,Y.resolve()}removeTargets(e,t,r){let a=0;const l=[];return this.si.forEach((u,h)=>{h.sequenceNumber<=t&&r.get(h.targetId)===null&&(this.si.delete(u),l.push(this.removeMatchingKeysForTargetId(e,h.targetId)),a++)}),Y.waitFor(l).next(()=>a)}getTargetCount(e){return Y.resolve(this.targetCount)}getTargetData(e,t){const r=this.si.get(t)||null;return Y.resolve(r)}addMatchingKeys(e,t,r){return this._i.Wr(t,r),Y.resolve()}removeMatchingKeys(e,t,r){this._i.zr(t,r);const a=this.persistence.referenceDelegate,l=[];return a&&t.forEach(u=>{l.push(a.markPotentiallyOrphaned(e,u))}),Y.waitFor(l)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),Y.resolve()}getMatchingKeysForTargetId(e,t){const r=this._i.Hr(t);return Y.resolve(r)}containsKey(e,t){return Y.resolve(this._i.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qy{constructor(e,t){this.ui={},this.overlays={},this.ci=new gi(0),this.li=!1,this.li=!0,this.hi=new wO,this.referenceDelegate=e(this),this.Pi=new IO(this),this.indexManager=new dO,this.remoteDocumentCache=function(a){return new SO(a)}(r=>this.referenceDelegate.Ti(r)),this.serializer=new k1(t),this.Ii=new EO(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new TO,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.ui[e.toKey()];return r||(r=new RO(t,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,r){fe("MemoryPersistence","Starting transaction:",e);const a=new NO(this.ci.next());return this.referenceDelegate.Ei(),r(a).next(l=>this.referenceDelegate.di(a).next(()=>l)).toPromise().then(l=>(a.raiseOnCommittedEvent(),l))}Ai(e,t){return Y.or(Object.values(this.ui).map(r=>()=>r.containsKey(e,t)))}}class NO extends Ow{constructor(e){super(),this.currentSequenceNumber=e}}class qf{constructor(e){this.persistence=e,this.Ri=new $y,this.Vi=null}static mi(e){return new qf(e)}get fi(){if(this.Vi)return this.Vi;throw Te(60996)}addReference(e,t,r){return this.Ri.addReference(r,t),this.fi.delete(r.toString()),Y.resolve()}removeReference(e,t,r){return this.Ri.removeReference(r,t),this.fi.add(r.toString()),Y.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),Y.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach(a=>this.fi.add(a.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(a=>{a.forEach(l=>this.fi.add(l.toString()))}).next(()=>r.removeTargetData(e,t))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Y.forEach(this.fi,r=>{const a=_e.fromPath(r);return this.gi(e,a).next(l=>{l||t.removeEntry(a,Se.min())})}).next(()=>(this.Vi=null,t.apply(e)))}updateLimboDocument(e,t){return this.gi(e,t).next(r=>{r?this.fi.delete(t.toString()):this.fi.add(t.toString())})}Ti(e){return 0}gi(e,t){return Y.or([()=>Y.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class ff{constructor(e,t){this.persistence=e,this.pi=new Ur(r=>En(r.path),(r,a)=>r.isEqual(a)),this.garbageCollector=Y1(this,t)}static mi(e,t){return new ff(e,t)}Ei(){}di(e){return Y.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>t.next(a=>r+a))}wr(e){let t=0;return this.pr(e,r=>{t++}).next(()=>t)}pr(e,t){return Y.forEach(this.pi,(r,a)=>this.br(e,r,a).next(l=>l?Y.resolve():t(a)))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0;const a=this.persistence.getRemoteDocumentCache(),l=a.newChangeBuffer();return a.ii(e,u=>this.br(e,u,t).next(h=>{h||(r++,l.removeEntry(u,Se.min()))})).next(()=>l.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),Y.resolve()}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),Y.resolve()}removeReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),Y.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),Y.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Md(e.data.value)),t}br(e,t,r){return Y.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const a=this.pi.get(t);return Y.resolve(a!==void 0&&a>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CO{constructor(e){this.serializer=e}k(e,t,r,a){const l=new If("createOrUpgrade",t);r<1&&a>=1&&(function(m){m.createObjectStore(Mu)}(e),function(m){m.createObjectStore(gu,{keyPath:UD}),m.createObjectStore(wi,{keyPath:Qx,autoIncrement:!0}).createIndex(Pa,Xx,{unique:!0}),m.createObjectStore(ul)}(e),FE(e),function(m){m.createObjectStore(Ra)}(e));let u=Y.resolve();return r<3&&a>=3&&(r!==0&&(function(m){m.deleteObjectStore(dl),m.deleteObjectStore(hl),m.deleteObjectStore(Va)}(e),FE(e)),u=u.next(()=>function(m){const y=m.store(Va),_={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Se.min().toTimestamp(),targetCount:0};return y.put(nf,_)}(l))),r<4&&a>=4&&(r!==0&&(u=u.next(()=>function(m,y){return y.store(wi).J().next(b=>{m.deleteObjectStore(wi),m.createObjectStore(wi,{keyPath:Qx,autoIncrement:!0}).createIndex(Pa,Xx,{unique:!0});const T=y.store(wi),I=b.map(V=>T.put(V));return Y.waitFor(I)})}(e,l))),u=u.next(()=>{(function(m){m.createObjectStore(fl,{keyPath:QD})})(e)})),r<5&&a>=5&&(u=u.next(()=>this.yi(l))),r<6&&a>=6&&(u=u.next(()=>(function(m){m.createObjectStore(yu)}(e),this.wi(l)))),r<7&&a>=7&&(u=u.next(()=>this.Si(l))),r<8&&a>=8&&(u=u.next(()=>this.bi(e,l))),r<9&&a>=9&&(u=u.next(()=>{(function(m){m.objectStoreNames.contains("remoteDocumentChanges")&&m.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&a>=10&&(u=u.next(()=>this.Di(l))),r<11&&a>=11&&(u=u.next(()=>{(function(m){m.createObjectStore(Cf,{keyPath:XD})})(e),function(m){m.createObjectStore(Pf,{keyPath:WD})}(e)})),r<12&&a>=12&&(u=u.next(()=>{(function(m){const y=m.createObjectStore(Df,{keyPath:rV});y.createIndex(Fg,sV,{unique:!1}),y.createIndex(zw,aV,{unique:!1})})(e)})),r<13&&a>=13&&(u=u.next(()=>function(m){const y=m.createObjectStore(tf,{keyPath:qD});y.createIndex(Vd,BD),y.createIndex(kw,HD)}(e)).next(()=>this.Ci(e,l)).next(()=>e.deleteObjectStore(Ra))),r<14&&a>=14&&(u=u.next(()=>this.Fi(e,l))),r<15&&a>=15&&(u=u.next(()=>function(m){m.createObjectStore(Vy,{keyPath:JD,autoIncrement:!0}).createIndex(Lg,ZD,{unique:!1}),m.createObjectStore(nu,{keyPath:eV}).createIndex(Fw,tV,{unique:!1}),m.createObjectStore(iu,{keyPath:nV}).createIndex(Uw,iV,{unique:!1})}(e))),r<16&&a>=16&&(u=u.next(()=>{t.objectStore(nu).clear()}).next(()=>{t.objectStore(iu).clear()})),r<17&&a>=17&&(u=u.next(()=>{(function(m){m.createObjectStore(Oy,{keyPath:oV})})(e)})),r<18&&a>=18&&VT()&&(u=u.next(()=>{t.objectStore(nu).clear()}).next(()=>{t.objectStore(iu).clear()})),u}wi(e){let t=0;return e.store(Ra).ee((r,a)=>{t+=df(a)}).next(()=>{const r={byteSize:t};return e.store(yu).put(kg,r)})}yi(e){const t=e.store(gu),r=e.store(wi);return t.J().next(a=>Y.forEach(a,l=>{const u=IDBKeyRange.bound([l.userId,Da],[l.userId,l.lastAcknowledgedBatchId]);return r.J(Pa,u).next(h=>Y.forEach(h,m=>{we(m.userId===l.userId,18650,"Cannot process batch from unexpected user",{batchId:m.batchId});const y=Aa(this.serializer,m);return B1(e,l.userId,y).next(()=>{})}))}))}Si(e){const t=e.store(dl),r=e.store(Ra);return e.store(Va).get(nf).next(a=>{const l=[];return r.ee((u,h)=>{const m=new at(u),y=function(b){return[0,En(b)]}(m);l.push(t.get(y).next(_=>_?Y.resolve():(b=>t.put({targetId:0,path:En(b),sequenceNumber:a.highestListenSequenceNumber}))(m)))}).next(()=>Y.waitFor(l))})}bi(e,t){e.createObjectStore(vu,{keyPath:$D});const r=t.store(vu),a=new Yy,l=u=>{if(a.add(u)){const h=u.lastSegment(),m=u.popLast();return r.put({collectionId:h,parent:En(m)})}};return t.store(Ra).ee({X:!0},(u,h)=>{const m=new at(u);return l(m.popLast())}).next(()=>t.store(ul).ee({X:!0},([u,h,m],y)=>{const _=Hi(h);return l(_.popLast())}))}Di(e){const t=e.store(hl);return t.ee((r,a)=>{const l=Qc(a),u=L1(this.serializer,l);return t.put(u)})}Ci(e,t){const r=t.store(Ra),a=[];return r.ee((l,u)=>{const h=t.store(tf),m=function(b){return b.document?new _e(at.fromString(b.document.name).popFirst(5)):b.noDocument?_e.fromSegments(b.noDocument.path):b.unknownDocument?_e.fromSegments(b.unknownDocument.path):Te(36783)}(u).path.toArray(),y={prefixPath:m.slice(0,m.length-2),collectionGroup:m[m.length-2],documentId:m[m.length-1],readTime:u.readTime||[0,0],unknownDocument:u.unknownDocument,noDocument:u.noDocument,document:u.document,hasCommittedMutations:!!u.hasCommittedMutations};a.push(h.put(y))}).next(()=>Y.waitFor(a))}Fi(e,t){const r=t.store(wi),a=Q1(this.serializer),l=new Qy(qf.mi,this.serializer.yt);return r.J().next(u=>{const h=new Map;return u.forEach(m=>{let y=h.get(m.userId)??Fe();Aa(this.serializer,m).keys().forEach(_=>y=y.add(_)),h.set(m.userId,y)}),Y.forEach(h,(m,y)=>{const _=new pn(y),b=Uf.wt(this.serializer,_),T=l.getIndexManager(_),I=zf.wt(_,this.serializer,T,l.referenceDelegate);return new X1(a,I,b,T).recalculateAndSaveOverlaysForDocumentKeys(new Ug(t,gi.ce),m).next()})})}}function FE(i){i.createObjectStore(dl,{keyPath:KD}).createIndex(Dy,YD,{unique:!0}),i.createObjectStore(hl,{keyPath:"targetId"}).createIndex(Lw,GD,{unique:!0}),i.createObjectStore(Va)}const bs="IndexedDbPersistence",ug=18e5,hg=5e3,dg="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",PO="main";class Xy{constructor(e,t,r,a,l,u,h,m,y,_,b=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.Mi=l,this.window=u,this.document=h,this.xi=y,this.Oi=_,this.Ni=b,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=T=>Promise.resolve(),!Xy.v())throw new ye(oe.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new vO(this,a),this.$i=t+PO,this.serializer=new k1(m),this.Ui=new Vs(this.$i,this.Ni,new CO(this.serializer)),this.hi=new aO,this.Pi=new mO(this.referenceDelegate,this.serializer),this.remoteDocumentCache=Q1(this.serializer),this.Ii=new sO,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,_===!1&&Nn(bs,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new ye(oe.FAILED_PRECONDITION,dg);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Pi.getHighestSequenceNumber(e))}).then(e=>{this.ci=new gi(e,this.xi)}).then(()=>{this.li=!0}).catch(e=>(this.Ui&&this.Ui.close(),Promise.reject(e)))}Ji(e){return this.Qi=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$(async t=>{t.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget(async()=>{this.started&&await this.Wi()}))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Ed(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.Hi(e).next(t=>{t||(this.isPrimary=!1,this.Mi.enqueueRetryable(()=>this.Qi(!1)))})}).next(()=>this.Yi(e)).next(t=>this.isPrimary&&!t?this.Zi(e).next(()=>!1):!!t&&this.Xi(e).next(()=>!0))).catch(e=>{if(qs(e))return fe(bs,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return fe(bs,"Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable(()=>this.Qi(e)),this.isPrimary=e})}Hi(e){return qc(e).get(Go).next(t=>Y.resolve(this.es(t)))}ts(e){return Ed(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,ug)){this.qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",t=>{const r=tn(t,fl);return r.J().next(a=>{const l=this.ss(a,ug),u=a.filter(h=>l.indexOf(h)===-1);return Y.forEach(u,h=>r.delete(h.clientId)).next(()=>u)})}).catch(()=>[]);if(this.Ki)for(const t of e)this.Ki.removeItem(this._s(t.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Wi().then(()=>this.ns()).then(()=>this.ji()))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?Y.resolve(!0):qc(e).get(Go).next(t=>{if(t!==null&&this.rs(t.leaseTimestampMs,hg)&&!this.us(t.ownerId)){if(this.es(t)&&this.networkEnabled)return!0;if(!this.es(t)){if(!t.allowTabSynchronization)throw new ye(oe.FAILED_PRECONDITION,dg);return!1}}return!(!this.networkEnabled||!this.inForeground)||Ed(e).J().next(r=>this.ss(r,hg).find(a=>{if(this.clientId!==a.clientId){const l=!this.networkEnabled&&a.networkEnabled,u=!this.inForeground&&a.inForeground,h=this.networkEnabled===a.networkEnabled;if(l||u&&h)return!0}return!1})===void 0)}).next(t=>(this.isPrimary!==t&&fe(bs,`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[Mu,fl],e=>{const t=new Ug(e,gi.ce);return this.Zi(t).next(()=>this.ts(t))}),this.Ui.close(),this.Ps()}ss(e,t){return e.filter(r=>this.rs(r.updateTimeMs,t)&&!this.us(r.clientId))}Ts(){return this.runTransaction("getActiveClients","readonly",e=>Ed(e).J().next(t=>this.ss(t,ug).map(r=>r.clientId)))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,t){return zf.wt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new fO(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return Uf.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,t,r){fe(bs,"Starting transaction:",e);const a=t==="readonly"?"readonly":"readwrite",l=function(m){return m===18?uV:m===17?Gw:m===16?cV:m===15?My:m===14?Hw:m===13?Bw:m===12?lV:m===11?qw:void Te(60245)}(this.Ni);let u;return this.Ui.runTransaction(e,a,l,h=>(u=new Ug(h,this.ci?this.ci.next():gi.ce),t==="readwrite-primary"?this.Hi(u).next(m=>!!m||this.Yi(u)).next(m=>{if(!m)throw Nn(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable(()=>this.Qi(!1)),new ye(oe.FAILED_PRECONDITION,Vw);return r(u)}).next(m=>this.Xi(u).next(()=>m)):this.Is(u).next(()=>r(u)))).then(h=>(u.raiseOnCommittedEvent(),h))}Is(e){return qc(e).get(Go).next(t=>{if(t!==null&&this.rs(t.leaseTimestampMs,hg)&&!this.us(t.ownerId)&&!this.es(t)&&!(this.Oi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new ye(oe.FAILED_PRECONDITION,dg)})}Xi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return qc(e).put(Go,t)}static v(){return Vs.v()}Zi(e){const t=qc(e);return t.get(Go).next(r=>this.es(r)?(fe(bs,"Releasing primary lease."),t.delete(Go)):Y.resolve())}rs(e,t){const r=Date.now();return!(e<r-t)&&(!(e>r)||(Nn(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi()))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){typeof this.window?.addEventListener=="function"&&(this.Bi=()=>{this.cs();const e=/(?:Version|Mobile)\/1[456]/;DT()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){try{const t=this.Ki?.getItem(this._s(e))!==null;return fe(bs,`Client '${e}' ${t?"is":"is not"} zombied in LocalStorage`),t}catch(t){return Nn(bs,"Failed to get zombied client id.",t),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){Nn("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function qc(i){return tn(i,Mu)}function Ed(i){return tn(i,fl)}function DO(i,e){let t=i.projectId;return i.isDefaultDatabase||(t+="."+i.database),"firestore/"+e+"/"+t+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wy{constructor(e,t,r,a){this.targetId=e,this.fromCache=t,this.Es=r,this.ds=a}static As(e,t){let r=Fe(),a=Fe();for(const l of t.docChanges)switch(l.type){case 0:r=r.add(l.doc.key);break;case 1:a=a.add(l.doc.key)}return new Wy(e,t.fromCache,r,a)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VO{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W1{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return DT()?8:Mw(en())>0?6:4}()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,r,a){const l={result:null};return this.ys(e,t).next(u=>{l.result=u}).next(()=>{if(!l.result)return this.ws(e,t,a,r).next(u=>{l.result=u})}).next(()=>{if(l.result)return;const u=new VO;return this.Ss(e,t,u).next(h=>{if(l.result=h,this.Vs)return this.bs(e,t,u,h.size)})}).next(()=>l.result)}bs(e,t,r,a){return r.documentReadCount<this.fs?(Wo()<=Ge.DEBUG&&fe("QueryEngine","SDK will not create cache indexes for query:",Jo(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),Y.resolve()):(Wo()<=Ge.DEBUG&&fe("QueryEngine","Query:",Jo(t),"scans",r.documentReadCount,"local documents and returns",a,"documents as results."),r.documentReadCount>this.gs*a?(Wo()<=Ge.DEBUG&&fe("QueryEngine","The SDK decides to create cache indexes for query:",Jo(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,yi(t))):Y.resolve())}ys(e,t){if(cE(t))return Y.resolve(null);let r=yi(t);return this.indexManager.getIndexType(e,r).next(a=>a===0?null:(t.limit!==null&&a===1&&(t=Yg(t,null,"F"),r=yi(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(l=>{const u=Fe(...l);return this.ps.getDocuments(e,u).next(h=>this.indexManager.getMinOffset(e,r).next(m=>{const y=this.Ds(t,h);return this.Cs(t,y,u,m.readTime)?this.ys(e,Yg(t,null,"F")):this.vs(e,y,t,m)}))})))}ws(e,t,r,a){return cE(t)||a.isEqual(Se.min())?Y.resolve(null):this.ps.getDocuments(e,r).next(l=>{const u=this.Ds(t,l);return this.Cs(t,u,r,a)?Y.resolve(null):(Wo()<=Ge.DEBUG&&fe("QueryEngine","Re-using previous result from %s to execute query: %s",a.toString(),Jo(t)),this.vs(e,u,t,VD(a,fu)).next(h=>h))})}Ds(e,t){let r=new dt(h1(e));return t.forEach((a,l)=>{Fu(e,l)&&(r=r.add(l))}),r}Cs(e,t,r,a){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const l=e.limitType==="F"?t.last():t.first();return!!l&&(l.hasPendingWrites||l.version.compareTo(a)>0)}Ss(e,t,r){return Wo()<=Ge.DEBUG&&fe("QueryEngine","Using full collection scan to execute query:",Jo(t)),this.ps.getDocumentsMatchingQuery(e,t,ti.min(),r)}vs(e,t,r,a){return this.ps.getDocumentsMatchingQuery(e,r,a).next(l=>(t.forEach(u=>{l=l.insert(u.key,u)}),l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jy="LocalStore",OO=3e8;class MO{constructor(e,t,r,a){this.persistence=e,this.Fs=t,this.serializer=a,this.Ms=new St(Ve),this.xs=new Ur(l=>Ha(l),ju),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new X1(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ms))}}function J1(i,e,t,r){return new MO(i,e,t,r)}async function Z1(i,e){const t=Oe(i);return await t.persistence.runTransaction("Handle user change","readonly",r=>{let a;return t.mutationQueue.getAllMutationBatches(r).next(l=>(a=l,t.Bs(e),t.mutationQueue.getAllMutationBatches(r))).next(l=>{const u=[],h=[];let m=Fe();for(const y of a){u.push(y.batchId);for(const _ of y.mutations)m=m.add(_.key)}for(const y of l){h.push(y.batchId);for(const _ of y.mutations)m=m.add(_.key)}return t.localDocuments.getDocuments(r,m).next(y=>({Ls:y,removedBatchIds:u,addedBatchIds:h}))})})}function jO(i,e){const t=Oe(i);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const a=e.batch.keys(),l=t.Ns.newChangeBuffer({trackRemovals:!0});return function(h,m,y,_){const b=y.batch,T=b.keys();let I=Y.resolve();return T.forEach(V=>{I=I.next(()=>_.getEntry(m,V)).next(L=>{const O=y.docVersions.get(V);we(O!==null,48541),L.version.compareTo(O)<0&&(b.applyToRemoteDocument(L,y),L.isValidDocument()&&(L.setReadTime(y.commitVersion),_.addEntry(L)))})}),I.next(()=>h.mutationQueue.removeMutationBatch(m,b))}(t,r,e,l).next(()=>l.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,a,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(h){let m=Fe();for(let y=0;y<h.mutationResults.length;++y)h.mutationResults[y].transformResults.length>0&&(m=m.add(h.batch.mutations[y].key));return m}(e))).next(()=>t.localDocuments.getDocuments(r,a))})}function eR(i){const e=Oe(i);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Pi.getLastRemoteSnapshotVersion(t))}function kO(i,e){const t=Oe(i),r=e.snapshotVersion;let a=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",l=>{const u=t.Ns.newChangeBuffer({trackRemovals:!0});a=t.Ms;const h=[];e.targetChanges.forEach((_,b)=>{const T=a.get(b);if(!T)return;h.push(t.Pi.removeMatchingKeys(l,_.removedDocuments,b).next(()=>t.Pi.addMatchingKeys(l,_.addedDocuments,b)));let I=T.withSequenceNumber(l.currentSequenceNumber);e.targetMismatches.get(b)!==null?I=I.withResumeToken(Kt.EMPTY_BYTE_STRING,Se.min()).withLastLimboFreeSnapshotVersion(Se.min()):_.resumeToken.approximateByteSize()>0&&(I=I.withResumeToken(_.resumeToken,r)),a=a.insert(b,I),function(L,O,Z){return L.resumeToken.approximateByteSize()===0||O.snapshotVersion.toMicroseconds()-L.snapshotVersion.toMicroseconds()>=OO?!0:Z.addedDocuments.size+Z.modifiedDocuments.size+Z.removedDocuments.size>0}(T,I,_)&&h.push(t.Pi.updateTargetData(l,I))});let m=Jn(),y=Fe();if(e.documentUpdates.forEach(_=>{e.resolvedLimboDocuments.has(_)&&h.push(t.persistence.referenceDelegate.updateLimboDocument(l,_))}),h.push(LO(l,u,e.documentUpdates).next(_=>{m=_.ks,y=_.qs})),!r.isEqual(Se.min())){const _=t.Pi.getLastRemoteSnapshotVersion(l).next(b=>t.Pi.setTargetsMetadata(l,l.currentSequenceNumber,r));h.push(_)}return Y.waitFor(h).next(()=>u.apply(l)).next(()=>t.localDocuments.getLocalViewOfDocuments(l,m,y)).next(()=>m)}).then(l=>(t.Ms=a,l))}function LO(i,e,t){let r=Fe(),a=Fe();return t.forEach(l=>r=r.add(l)),e.getEntries(i,r).next(l=>{let u=Jn();return t.forEach((h,m)=>{const y=l.get(h);m.isFoundDocument()!==y.isFoundDocument()&&(a=a.add(h)),m.isNoDocument()&&m.version.isEqual(Se.min())?(e.removeEntry(h,m.readTime),u=u.insert(h,m)):!y.isValidDocument()||m.version.compareTo(y.version)>0||m.version.compareTo(y.version)===0&&y.hasPendingWrites?(e.addEntry(m),u=u.insert(h,m)):fe(Jy,"Ignoring outdated watch update for ",h,". Current version:",y.version," Watch version:",m.version)}),{ks:u,qs:a}})}function FO(i,e){const t=Oe(i);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=Da),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function UO(i,e){const t=Oe(i);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let a;return t.Pi.getTargetData(r,e).next(l=>l?(a=l,Y.resolve(a)):t.Pi.allocateTargetId(r).next(u=>(a=new Ir(e,u,"TargetPurposeListen",r.currentSequenceNumber),t.Pi.addTargetData(r,a).next(()=>a))))}).then(r=>{const a=t.Ms.get(r.targetId);return(a===null||r.snapshotVersion.compareTo(a.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(r.targetId,r),t.xs.set(e,r.targetId)),r})}async function ty(i,e,t){const r=Oe(i),a=r.Ms.get(e),l=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",l,u=>r.persistence.referenceDelegate.removeTarget(u,a))}catch(u){if(!qs(u))throw u;fe(Jy,`Failed to update sequence numbers for target ${e}: ${u}`)}r.Ms=r.Ms.remove(e),r.xs.delete(a.target)}function UE(i,e,t){const r=Oe(i);let a=Se.min(),l=Fe();return r.persistence.runTransaction("Execute query","readwrite",u=>function(m,y,_){const b=Oe(m),T=b.xs.get(_);return T!==void 0?Y.resolve(b.Ms.get(T)):b.Pi.getTargetData(y,_)}(r,u,yi(e)).next(h=>{if(h)return a=h.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(u,h.targetId).next(m=>{l=m})}).next(()=>r.Fs.getDocumentsMatchingQuery(u,e,t?a:Se.min(),t?l:Fe())).next(h=>(zO(r,RV(e),h),{documents:h,Qs:l})))}function zO(i,e,t){let r=i.Os.get(e)||Se.min();t.forEach((a,l)=>{l.readTime.compareTo(r)>0&&(r=l.readTime)}),i.Os.set(e,r)}class zE{constructor(){this.activeTargetIds=PV()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class tR{constructor(){this.Mo=new zE,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,r){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new zE,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qO{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qE="ConnectivityMonitor";class BE{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){fe(qE,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){fe(qE,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Td=null;function ny(){return Td===null?Td=function(){return 268435456+Math.round(2147483648*Math.random())}():Td++,"0x"+Td.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fg="RestConnection",BO={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class HO{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),a=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${r}/databases/${a}`,this.Wo=this.databaseId.database===rf?`project_id=${r}`:`project_id=${r}&database_id=${a}`}Go(e,t,r,a,l){const u=ny(),h=this.zo(e,t.toUriEncodedString());fe(fg,`Sending RPC '${e}' ${u}:`,h,r);const m={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(m,a,l);const{host:y}=new URL(h),_=Tl(y);return this.Jo(e,h,m,r,_).then(b=>(fe(fg,`Received RPC '${e}' ${u}: `,b),b),b=>{throw qa(fg,`RPC '${e}' ${u} failed with error: `,b,"url: ",h,"request:",r),b})}Ho(e,t,r,a,l,u){return this.Go(e,t,r,a,l)}jo(e,t,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Sl}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((a,l)=>e[l]=a),r&&r.headers.forEach((a,l)=>e[l]=a)}zo(e,t){const r=BO[e];return`${this.Uo}/v1/${t}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GO{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _n="WebChannelConnection";class KO extends HO{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,r,a,l){const u=ny();return new Promise((h,m)=>{const y=new Ew;y.setWithCredentials(!0),y.listenOnce(Tw.COMPLETE,()=>{try{switch(y.getLastErrorCode()){case Cd.NO_ERROR:const b=y.getResponseJson();fe(_n,`XHR for RPC '${e}' ${u} received:`,JSON.stringify(b)),h(b);break;case Cd.TIMEOUT:fe(_n,`RPC '${e}' ${u} timed out`),m(new ye(oe.DEADLINE_EXCEEDED,"Request time out"));break;case Cd.HTTP_ERROR:const T=y.getStatus();if(fe(_n,`RPC '${e}' ${u} failed with status:`,T,"response text:",y.getResponseText()),T>0){let I=y.getResponseJson();Array.isArray(I)&&(I=I[0]);const V=I?.error;if(V&&V.status&&V.message){const L=function(Z){const se=Z.toLowerCase().replace(/_/g,"-");return Object.values(oe).indexOf(se)>=0?se:oe.UNKNOWN}(V.status);m(new ye(L,V.message))}else m(new ye(oe.UNKNOWN,"Server responded with status "+y.getStatus()))}else m(new ye(oe.UNAVAILABLE,"Connection failed."));break;default:Te(9055,{l_:e,streamId:u,h_:y.getLastErrorCode(),P_:y.getLastError()})}}finally{fe(_n,`RPC '${e}' ${u} completed.`)}});const _=JSON.stringify(a);fe(_n,`RPC '${e}' ${u} sending request:`,a),y.send(t,"POST",_,r,15)})}T_(e,t,r){const a=ny(),l=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],u=Sw(),h=Rw(),m={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},y=this.longPollingOptions.timeoutSeconds;y!==void 0&&(m.longPollingTimeout=Math.round(1e3*y)),this.useFetchStreams&&(m.useFetchStreams=!0),this.jo(m.initMessageHeaders,t,r),m.encodeInitMessageHeaders=!0;const _=l.join("");fe(_n,`Creating RPC '${e}' stream ${a}: ${_}`,m);const b=u.createWebChannel(_,m);this.I_(b);let T=!1,I=!1;const V=new GO({Yo:O=>{I?fe(_n,`Not sending because RPC '${e}' stream ${a} is closed:`,O):(T||(fe(_n,`Opening RPC '${e}' stream ${a} transport.`),b.open(),T=!0),fe(_n,`RPC '${e}' stream ${a} sending:`,O),b.send(O))},Zo:()=>b.close()}),L=(O,Z,se)=>{O.listen(Z,G=>{try{se(G)}catch(ne){setTimeout(()=>{throw ne},0)}})};return L(b,Kc.EventType.OPEN,()=>{I||(fe(_n,`RPC '${e}' stream ${a} transport opened.`),V.o_())}),L(b,Kc.EventType.CLOSE,()=>{I||(I=!0,fe(_n,`RPC '${e}' stream ${a} transport closed`),V.a_(),this.E_(b))}),L(b,Kc.EventType.ERROR,O=>{I||(I=!0,qa(_n,`RPC '${e}' stream ${a} transport errored. Name:`,O.name,"Message:",O.message),V.a_(new ye(oe.UNAVAILABLE,"The operation could not be completed")))}),L(b,Kc.EventType.MESSAGE,O=>{if(!I){const Z=O.data[0];we(!!Z,16349);const se=Z,G=se?.error||se[0]?.error;if(G){fe(_n,`RPC '${e}' stream ${a} received error:`,G);const ne=G.status;let B=function(S){const A=Bt[S];if(A!==void 0)return T1(A)}(ne),re=G.message;B===void 0&&(B=oe.INTERNAL,re="Unknown error status: "+ne+" with message "+G.message),I=!0,V.a_(new ye(B,re)),b.close()}else fe(_n,`RPC '${e}' stream ${a} received:`,Z),V.u_(Z)}}),L(h,ww.STAT_EVENT,O=>{O.stat===Og.PROXY?fe(_n,`RPC '${e}' stream ${a} detected buffering proxy`):O.stat===Og.NOPROXY&&fe(_n,`RPC '${e}' stream ${a} detected no buffering proxy`)}),setTimeout(()=>{V.__()},0),V}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(t=>t===e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YO(){return typeof window<"u"?window:null}function Ud(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bf(i){return new $V(i,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nR{constructor(e,t,r=1e3,a=1.5,l=6e4){this.Mi=e,this.timerId=t,this.d_=r,this.A_=a,this.R_=l,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),a=Math.max(0,t-r);a>0&&fe("ExponentialBackoff",`Backing off for ${a} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,a,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HE="PersistentStream";class iR{constructor(e,t,r,a,l,u,h,m){this.Mi=e,this.S_=r,this.b_=a,this.connection=l,this.authCredentialsProvider=u,this.appCheckCredentialsProvider=h,this.listener=m,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new nR(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===oe.RESOURCE_EXHAUSTED?(Nn(t.toString()),Nn("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===oe.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,a])=>{this.D_===t&&this.G_(r,a)},r=>{e(()=>{const a=new ye(oe.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(a)})})}G_(e,t){const r=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo(()=>{r(()=>this.listener.Xo())}),this.stream.t_(()=>{r(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(a=>{r(()=>this.z_(a))}),this.stream.onMessage(a=>{r(()=>++this.F_==1?this.J_(a):this.onNext(a))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return fe(HE,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget(()=>this.D_===e?t():(fe(HE,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class $O extends iR{constructor(e,t,r,a,l,u){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,a,u),this.serializer=l}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=WV(this.serializer,e),r=function(l){if(!("targetChange"in l))return Se.min();const u=l.targetChange;return u.targetIds&&u.targetIds.length?Se.min():u.readTime?Dn(u.readTime):Se.min()}(e);return this.listener.H_(t,r)}Y_(e){const t={};t.database=Xg(this.serializer),t.addTarget=function(l,u){let h;const m=u.target;if(h=af(m)?{documents:P1(l,m)}:{query:D1(l,m).ft},h.targetId=u.targetId,u.resumeToken.approximateByteSize()>0){h.resumeToken=S1(l,u.resumeToken);const y=$g(l,u.expectedCount);y!==null&&(h.expectedCount=y)}else if(u.snapshotVersion.compareTo(Se.min())>0){h.readTime=bl(l,u.snapshotVersion.toTimestamp());const y=$g(l,u.expectedCount);y!==null&&(h.expectedCount=y)}return h}(this.serializer,e);const r=ZV(this.serializer,e);r&&(t.labels=r),this.q_(t)}Z_(e){const t={};t.database=Xg(this.serializer),t.removeTarget=e,this.q_(t)}}class QO extends iR{constructor(e,t,r,a,l,u){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,a,u),this.serializer=l}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return we(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,we(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){we(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=JV(e.writeResults,e.commitTime),r=Dn(e.commitTime);return this.listener.na(r,t)}ra(){const e={};e.database=Xg(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map(r=>cf(this.serializer,r))};this.q_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XO{}class WO extends XO{constructor(e,t,r,a){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=a,this.ia=!1}sa(){if(this.ia)throw new ye(oe.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,r,a){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([l,u])=>this.connection.Go(e,Qg(t,r),a,l,u)).catch(l=>{throw l.name==="FirebaseError"?(l.code===oe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new ye(oe.UNKNOWN,l.toString())})}Ho(e,t,r,a,l){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([u,h])=>this.connection.Ho(e,Qg(t,r),a,u,h,l)).catch(u=>{throw u.name==="FirebaseError"?(u.code===oe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),u):new ye(oe.UNKNOWN,u.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class JO{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Nn(t),this.aa=!1):fe("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $a="RemoteStore";class ZO{constructor(e,t,r,a,l){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=l,this.Aa.Oo(u=>{r.enqueueAndForget(async()=>{Wa(this)&&(fe($a,"Restarting streams for network reachability change."),await async function(m){const y=Oe(m);y.Ea.add(4),await zu(y),y.Ra.set("Unknown"),y.Ea.delete(4),await Hf(y)}(this))})}),this.Ra=new JO(r,a)}}async function Hf(i){if(Wa(i))for(const e of i.da)await e(!0)}async function zu(i){for(const e of i.da)await e(!1)}function rR(i,e){const t=Oe(i);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),nv(t)?tv(t):Il(t).O_()&&ev(t,e))}function Zy(i,e){const t=Oe(i),r=Il(t);t.Ia.delete(e),r.O_()&&sR(t,e),t.Ia.size===0&&(r.O_()?r.L_():Wa(t)&&t.Ra.set("Unknown"))}function ev(i,e){if(i.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Se.min())>0){const t=i.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Il(i).Y_(e)}function sR(i,e){i.Va.Ue(e),Il(i).Z_(e)}function tv(i){i.Va=new HV({getRemoteKeysForTarget:e=>i.remoteSyncer.getRemoteKeysForTarget(e),At:e=>i.Ia.get(e)||null,ht:()=>i.datastore.serializer.databaseId}),Il(i).start(),i.Ra.ua()}function nv(i){return Wa(i)&&!Il(i).x_()&&i.Ia.size>0}function Wa(i){return Oe(i).Ea.size===0}function aR(i){i.Va=void 0}async function eM(i){i.Ra.set("Online")}async function tM(i){i.Ia.forEach((e,t)=>{ev(i,e)})}async function nM(i,e){aR(i),nv(i)?(i.Ra.ha(e),tv(i)):i.Ra.set("Unknown")}async function iM(i,e,t){if(i.Ra.set("Online"),e instanceof R1&&e.state===2&&e.cause)try{await async function(a,l){const u=l.cause;for(const h of l.targetIds)a.Ia.has(h)&&(await a.remoteSyncer.rejectListen(h,u),a.Ia.delete(h),a.Va.removeTarget(h))}(i,e)}catch(r){fe($a,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await mf(i,r)}else if(e instanceof Ld?i.Va.Ze(e):e instanceof w1?i.Va.st(e):i.Va.tt(e),!t.isEqual(Se.min()))try{const r=await eR(i.localStore);t.compareTo(r)>=0&&await function(l,u){const h=l.Va.Tt(u);return h.targetChanges.forEach((m,y)=>{if(m.resumeToken.approximateByteSize()>0){const _=l.Ia.get(y);_&&l.Ia.set(y,_.withResumeToken(m.resumeToken,u))}}),h.targetMismatches.forEach((m,y)=>{const _=l.Ia.get(m);if(!_)return;l.Ia.set(m,_.withResumeToken(Kt.EMPTY_BYTE_STRING,_.snapshotVersion)),sR(l,m);const b=new Ir(_.target,m,y,_.sequenceNumber);ev(l,b)}),l.remoteSyncer.applyRemoteEvent(h)}(i,t)}catch(r){fe($a,"Failed to raise snapshot:",r),await mf(i,r)}}async function mf(i,e,t){if(!qs(e))throw e;i.Ea.add(1),await zu(i),i.Ra.set("Offline"),t||(t=()=>eR(i.localStore)),i.asyncQueue.enqueueRetryable(async()=>{fe($a,"Retrying IndexedDB access"),await t(),i.Ea.delete(1),await Hf(i)})}function oR(i,e){return e().catch(t=>mf(i,t,e))}async function qu(i){const e=Oe(i),t=ks(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Da;for(;rM(e);)try{const a=await FO(e.localStore,r);if(a===null){e.Ta.length===0&&t.L_();break}r=a.batchId,sM(e,a)}catch(a){await mf(e,a)}lR(e)&&cR(e)}function rM(i){return Wa(i)&&i.Ta.length<10}function sM(i,e){i.Ta.push(e);const t=ks(i);t.O_()&&t.X_&&t.ea(e.mutations)}function lR(i){return Wa(i)&&!ks(i).x_()&&i.Ta.length>0}function cR(i){ks(i).start()}async function aM(i){ks(i).ra()}async function oM(i){const e=ks(i);for(const t of i.Ta)e.ea(t.mutations)}async function lM(i,e,t){const r=i.Ta.shift(),a=qy.from(r,e,t);await oR(i,()=>i.remoteSyncer.applySuccessfulWrite(a)),await qu(i)}async function cM(i,e){e&&ks(i).X_&&await async function(r,a){if(function(u){return zV(u)&&u!==oe.ABORTED}(a.code)){const l=r.Ta.shift();ks(r).B_(),await oR(r,()=>r.remoteSyncer.rejectFailedWrite(l.batchId,a)),await qu(r)}}(i,e),lR(i)&&cR(i)}async function GE(i,e){const t=Oe(i);t.asyncQueue.verifyOperationInProgress(),fe($a,"RemoteStore received new credentials");const r=Wa(t);t.Ea.add(3),await zu(t),r&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await Hf(t)}async function uM(i,e){const t=Oe(i);e?(t.Ea.delete(2),await Hf(t)):e||(t.Ea.add(2),await zu(t),t.Ra.set("Unknown"))}function Il(i){return i.ma||(i.ma=function(t,r,a){const l=Oe(t);return l.sa(),new $O(r,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,a)}(i.datastore,i.asyncQueue,{Xo:eM.bind(null,i),t_:tM.bind(null,i),r_:nM.bind(null,i),H_:iM.bind(null,i)}),i.da.push(async e=>{e?(i.ma.B_(),nv(i)?tv(i):i.Ra.set("Unknown")):(await i.ma.stop(),aR(i))})),i.ma}function ks(i){return i.fa||(i.fa=function(t,r,a){const l=Oe(t);return l.sa(),new QO(r,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,a)}(i.datastore,i.asyncQueue,{Xo:()=>Promise.resolve(),t_:aM.bind(null,i),r_:cM.bind(null,i),ta:oM.bind(null,i),na:lM.bind(null,i)}),i.da.push(async e=>{e?(i.fa.B_(),await qu(i)):(await i.fa.stop(),i.Ta.length>0&&(fe($a,`Stopping write stream with ${i.Ta.length} pending writes`),i.Ta=[]))})),i.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iv{constructor(e,t,r,a,l){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=a,this.removalCallback=l,this.deferred=new Yi,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(u=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,a,l){const u=Date.now()+r,h=new iv(e,t,u,a,l);return h.start(r),h}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new ye(oe.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function rv(i,e){if(Nn("AsyncQueue",`${e}: ${i}`),qs(i))return new ye(oe.UNAVAILABLE,`${e}: ${i}`);throw i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ol{static emptySet(e){return new ol(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||_e.comparator(t.key,r.key):(t,r)=>_e.comparator(t.key,r.key),this.keyedMap=Yc(),this.sortedSet=new St(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof ol)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const a=t.getNext().key,l=r.getNext().key;if(!a.isEqual(l))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new ol;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KE{constructor(){this.ga=new St(_e.comparator)}track(e){const t=e.doc.key,r=this.ga.get(t);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(t,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(t):e.type===1&&r.type===2?this.ga=this.ga.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):Te(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal((t,r)=>{e.push(r)}),e}}class xl{constructor(e,t,r,a,l,u,h,m,y){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=a,this.mutatedKeys=l,this.fromCache=u,this.syncStateChanged=h,this.excludesMetadataChanges=m,this.hasCachedResults=y}static fromInitialDocuments(e,t,r,a,l){const u=[];return t.forEach(h=>{u.push({type:0,doc:h})}),new xl(e,t,ol.emptySet(t),u,r,a,!0,!1,l)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Mf(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let a=0;a<t.length;a++)if(t[a].type!==r[a].type||!t[a].doc.isEqual(r[a].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hM{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class dM{constructor(){this.queries=YE(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,r){const a=Oe(t),l=a.queries;a.queries=YE(),l.forEach((u,h)=>{for(const m of h.Sa)m.onError(r)})})(this,new ye(oe.ABORTED,"Firestore shutting down"))}}function YE(){return new Ur(i=>u1(i),Mf)}async function sv(i,e){const t=Oe(i);let r=3;const a=e.query;let l=t.queries.get(a);l?!l.ba()&&e.Da()&&(r=2):(l=new hM,r=e.Da()?0:1);try{switch(r){case 0:l.wa=await t.onListen(a,!0);break;case 1:l.wa=await t.onListen(a,!1);break;case 2:await t.onFirstRemoteStoreListen(a)}}catch(u){const h=rv(u,`Initialization of query '${Jo(e.query)}' failed`);return void e.onError(h)}t.queries.set(a,l),l.Sa.push(e),e.va(t.onlineState),l.wa&&e.Fa(l.wa)&&ov(t)}async function av(i,e){const t=Oe(i),r=e.query;let a=3;const l=t.queries.get(r);if(l){const u=l.Sa.indexOf(e);u>=0&&(l.Sa.splice(u,1),l.Sa.length===0?a=e.Da()?0:1:!l.ba()&&e.Da()&&(a=2))}switch(a){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function fM(i,e){const t=Oe(i);let r=!1;for(const a of e){const l=a.query,u=t.queries.get(l);if(u){for(const h of u.Sa)h.Fa(a)&&(r=!0);u.wa=a}}r&&ov(t)}function mM(i,e,t){const r=Oe(i),a=r.queries.get(e);if(a)for(const l of a.Sa)l.onError(t);r.queries.delete(e)}function ov(i){i.Ca.forEach(e=>{e.next()})}var iy,$E;($E=iy||(iy={})).Ma="default",$E.Cache="cache";class lv{constructor(e,t,r){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const a of e.docChanges)a.type!==3&&r.push(a);e=new xl(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const r=t!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=xl.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==iy.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uR{constructor(e){this.key=e}}class hR{constructor(e){this.key=e}}class pM{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Fe(),this.mutatedKeys=Fe(),this.eu=h1(e),this.tu=new ol(this.eu)}get nu(){return this.Ya}ru(e,t){const r=t?t.iu:new KE,a=t?t.tu:this.tu;let l=t?t.mutatedKeys:this.mutatedKeys,u=a,h=!1;const m=this.query.limitType==="F"&&a.size===this.query.limit?a.last():null,y=this.query.limitType==="L"&&a.size===this.query.limit?a.first():null;if(e.inorderTraversal((_,b)=>{const T=a.get(_),I=Fu(this.query,b)?b:null,V=!!T&&this.mutatedKeys.has(T.key),L=!!I&&(I.hasLocalMutations||this.mutatedKeys.has(I.key)&&I.hasCommittedMutations);let O=!1;T&&I?T.data.isEqual(I.data)?V!==L&&(r.track({type:3,doc:I}),O=!0):this.su(T,I)||(r.track({type:2,doc:I}),O=!0,(m&&this.eu(I,m)>0||y&&this.eu(I,y)<0)&&(h=!0)):!T&&I?(r.track({type:0,doc:I}),O=!0):T&&!I&&(r.track({type:1,doc:T}),O=!0,(m||y)&&(h=!0)),O&&(I?(u=u.add(I),l=L?l.add(_):l.delete(_)):(u=u.delete(_),l=l.delete(_)))}),this.query.limit!==null)for(;u.size>this.query.limit;){const _=this.query.limitType==="F"?u.last():u.first();u=u.delete(_.key),l=l.delete(_.key),r.track({type:1,doc:_})}return{tu:u,iu:r,Cs:h,mutatedKeys:l}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,a){const l=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const u=e.iu.ya();u.sort((_,b)=>function(I,V){const L=O=>{switch(O){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Te(20277,{Rt:O})}};return L(I)-L(V)}(_.type,b.type)||this.eu(_.doc,b.doc)),this.ou(r),a=a??!1;const h=t&&!a?this._u():[],m=this.Xa.size===0&&this.current&&!a?1:0,y=m!==this.Za;return this.Za=m,u.length!==0||y?{snapshot:new xl(this.query,e.tu,l,u,e.mutatedKeys,m===0,y,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:h}:{au:h}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new KE,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(t=>this.Ya=this.Ya.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ya=this.Ya.delete(t)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Fe(),this.tu.forEach(r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))});const t=[];return e.forEach(r=>{this.Xa.has(r)||t.push(new hR(r))}),this.Xa.forEach(r=>{e.has(r)||t.push(new uR(r))}),t}cu(e){this.Ya=e.Qs,this.Xa=Fe();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return xl.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const cv="SyncEngine";class gM{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class yM{constructor(e){this.key=e,this.hu=!1}}class vM{constructor(e,t,r,a,l,u){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=a,this.currentUser=l,this.maxConcurrentLimboResolutions=u,this.Pu={},this.Tu=new Ur(h=>u1(h),Mf),this.Iu=new Map,this.Eu=new Set,this.du=new St(_e.comparator),this.Au=new Map,this.Ru=new $y,this.Vu={},this.mu=new Map,this.fu=Ya.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function _M(i,e,t=!0){const r=yR(i);let a;const l=r.Tu.get(e);return l?(r.sharedClientState.addLocalQueryTarget(l.targetId),a=l.view.lu()):a=await dR(r,e,t,!0),a}async function bM(i,e){const t=yR(i);await dR(t,e,!0,!1)}async function dR(i,e,t,r){const a=await UO(i.localStore,yi(e)),l=a.targetId,u=i.sharedClientState.addLocalQueryTarget(l,t);let h;return r&&(h=await xM(i,e,l,u==="current",a.resumeToken)),i.isPrimaryClient&&t&&rR(i.remoteStore,a),h}async function xM(i,e,t,r,a){i.pu=(b,T,I)=>async function(L,O,Z,se){let G=O.view.ru(Z);G.Cs&&(G=await UE(L.localStore,O.query,!1).then(({documents:P})=>O.view.ru(P,G)));const ne=se&&se.targetChanges.get(O.targetId),B=se&&se.targetMismatches.get(O.targetId)!=null,re=O.view.applyChanges(G,L.isPrimaryClient,ne,B);return XE(L,O.targetId,re.au),re.snapshot}(i,b,T,I);const l=await UE(i.localStore,e,!0),u=new pM(e,l.Qs),h=u.ru(l.documents),m=Uu.createSynthesizedTargetChangeForCurrentChange(t,r&&i.onlineState!=="Offline",a),y=u.applyChanges(h,i.isPrimaryClient,m);XE(i,t,y.au);const _=new gM(e,t,u);return i.Tu.set(e,_),i.Iu.has(t)?i.Iu.get(t).push(e):i.Iu.set(t,[e]),y.snapshot}async function EM(i,e,t){const r=Oe(i),a=r.Tu.get(e),l=r.Iu.get(a.targetId);if(l.length>1)return r.Iu.set(a.targetId,l.filter(u=>!Mf(u,e))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(a.targetId),r.sharedClientState.isActiveQueryTarget(a.targetId)||await ty(r.localStore,a.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(a.targetId),t&&Zy(r.remoteStore,a.targetId),ry(r,a.targetId)}).catch(Xa)):(ry(r,a.targetId),await ty(r.localStore,a.targetId,!0))}async function TM(i,e){const t=Oe(i),r=t.Tu.get(e),a=t.Iu.get(r.targetId);t.isPrimaryClient&&a.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),Zy(t.remoteStore,r.targetId))}async function wM(i,e,t){const r=vR(i);try{const a=await function(u,h){const m=Oe(u),y=ut.now(),_=h.reduce((I,V)=>I.add(V.key),Fe());let b,T;return m.persistence.runTransaction("Locally write mutations","readwrite",I=>{let V=Jn(),L=Fe();return m.Ns.getEntries(I,_).next(O=>{V=O,V.forEach((Z,se)=>{se.isValidDocument()||(L=L.add(Z))})}).next(()=>m.localDocuments.getOverlayedDocuments(I,V)).next(O=>{b=O;const Z=[];for(const se of h){const G=FV(se,b.get(se.key).overlayedDocument);G!=null&&Z.push(new zr(se.key,G,t1(G.value.mapValue),Pn.exists(!0)))}return m.mutationQueue.addMutationBatch(I,y,Z,h)}).next(O=>{T=O;const Z=O.applyToLocalDocumentSet(b,L);return m.documentOverlayCache.saveOverlays(I,O.batchId,Z)})}).then(()=>({batchId:T.batchId,changes:f1(b)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(a.batchId),function(u,h,m){let y=u.Vu[u.currentUser.toKey()];y||(y=new St(Ve)),y=y.insert(h,m),u.Vu[u.currentUser.toKey()]=y}(r,a.batchId,t),await Bu(r,a.changes),await qu(r.remoteStore)}catch(a){const l=rv(a,"Failed to persist write");t.reject(l)}}async function fR(i,e){const t=Oe(i);try{const r=await kO(t.localStore,e);e.targetChanges.forEach((a,l)=>{const u=t.Au.get(l);u&&(we(a.addedDocuments.size+a.modifiedDocuments.size+a.removedDocuments.size<=1,22616),a.addedDocuments.size>0?u.hu=!0:a.modifiedDocuments.size>0?we(u.hu,14607):a.removedDocuments.size>0&&(we(u.hu,42227),u.hu=!1))}),await Bu(t,r,e)}catch(r){await Xa(r)}}function QE(i,e,t){const r=Oe(i);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const a=[];r.Tu.forEach((l,u)=>{const h=u.view.va(e);h.snapshot&&a.push(h.snapshot)}),function(u,h){const m=Oe(u);m.onlineState=h;let y=!1;m.queries.forEach((_,b)=>{for(const T of b.Sa)T.va(h)&&(y=!0)}),y&&ov(m)}(r.eventManager,e),a.length&&r.Pu.H_(a),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function RM(i,e,t){const r=Oe(i);r.sharedClientState.updateQueryState(e,"rejected",t);const a=r.Au.get(e),l=a&&a.key;if(l){let u=new St(_e.comparator);u=u.insert(l,Vt.newNoDocument(l,Se.min()));const h=Fe().add(l),m=new Ff(Se.min(),new Map,new St(Ve),u,h);await fR(r,m),r.du=r.du.remove(l),r.Au.delete(e),uv(r)}else await ty(r.localStore,e,!1).then(()=>ry(r,e,t)).catch(Xa)}async function SM(i,e){const t=Oe(i),r=e.batch.batchId;try{const a=await jO(t.localStore,e);pR(t,r,null),mR(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await Bu(t,a)}catch(a){await Xa(a)}}async function AM(i,e,t){const r=Oe(i);try{const a=await function(u,h){const m=Oe(u);return m.persistence.runTransaction("Reject batch","readwrite-primary",y=>{let _;return m.mutationQueue.lookupMutationBatch(y,h).next(b=>(we(b!==null,37113),_=b.keys(),m.mutationQueue.removeMutationBatch(y,b))).next(()=>m.mutationQueue.performConsistencyCheck(y)).next(()=>m.documentOverlayCache.removeOverlaysForBatchId(y,_,h)).next(()=>m.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(y,_)).next(()=>m.localDocuments.getDocuments(y,_))})}(r.localStore,e);pR(r,e,t),mR(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await Bu(r,a)}catch(a){await Xa(a)}}function mR(i,e){(i.mu.get(e)||[]).forEach(t=>{t.resolve()}),i.mu.delete(e)}function pR(i,e,t){const r=Oe(i);let a=r.Vu[r.currentUser.toKey()];if(a){const l=a.get(e);l&&(t?l.reject(t):l.resolve(),a=a.remove(e)),r.Vu[r.currentUser.toKey()]=a}}function ry(i,e,t=null){i.sharedClientState.removeLocalQueryTarget(e);for(const r of i.Iu.get(e))i.Tu.delete(r),t&&i.Pu.yu(r,t);i.Iu.delete(e),i.isPrimaryClient&&i.Ru.jr(e).forEach(r=>{i.Ru.containsKey(r)||gR(i,r)})}function gR(i,e){i.Eu.delete(e.path.canonicalString());const t=i.du.get(e);t!==null&&(Zy(i.remoteStore,t),i.du=i.du.remove(e),i.Au.delete(t),uv(i))}function XE(i,e,t){for(const r of t)r instanceof uR?(i.Ru.addReference(r.key,e),IM(i,r)):r instanceof hR?(fe(cv,"Document no longer in limbo: "+r.key),i.Ru.removeReference(r.key,e),i.Ru.containsKey(r.key)||gR(i,r.key)):Te(19791,{wu:r})}function IM(i,e){const t=e.key,r=t.path.canonicalString();i.du.get(t)||i.Eu.has(r)||(fe(cv,"New document in limbo: "+t),i.Eu.add(r),uv(i))}function uv(i){for(;i.Eu.size>0&&i.du.size<i.maxConcurrentLimboResolutions;){const e=i.Eu.values().next().value;i.Eu.delete(e);const t=new _e(at.fromString(e)),r=i.fu.next();i.Au.set(r,new yM(t)),i.du=i.du.insert(t,r),rR(i.remoteStore,new Ir(yi(Lu(t.path)),r,"TargetPurposeLimboResolution",gi.ce))}}async function Bu(i,e,t){const r=Oe(i),a=[],l=[],u=[];r.Tu.isEmpty()||(r.Tu.forEach((h,m)=>{u.push(r.pu(m,e,t).then(y=>{if((y||t)&&r.isPrimaryClient){const _=y?!y.fromCache:t?.targetChanges.get(m.targetId)?.current;r.sharedClientState.updateQueryState(m.targetId,_?"current":"not-current")}if(y){a.push(y);const _=Wy.As(m.targetId,y);l.push(_)}}))}),await Promise.all(u),r.Pu.H_(a),await async function(m,y){const _=Oe(m);try{await _.persistence.runTransaction("notifyLocalViewChanges","readwrite",b=>Y.forEach(y,T=>Y.forEach(T.Es,I=>_.persistence.referenceDelegate.addReference(b,T.targetId,I)).next(()=>Y.forEach(T.ds,I=>_.persistence.referenceDelegate.removeReference(b,T.targetId,I)))))}catch(b){if(!qs(b))throw b;fe(Jy,"Failed to update sequence numbers: "+b)}for(const b of y){const T=b.targetId;if(!b.fromCache){const I=_.Ms.get(T),V=I.snapshotVersion,L=I.withLastLimboFreeSnapshotVersion(V);_.Ms=_.Ms.insert(T,L)}}}(r.localStore,l))}async function NM(i,e){const t=Oe(i);if(!t.currentUser.isEqual(e)){fe(cv,"User change. New user:",e.toKey());const r=await Z1(t.localStore,e);t.currentUser=e,function(l,u){l.mu.forEach(h=>{h.forEach(m=>{m.reject(new ye(oe.CANCELLED,u))})}),l.mu.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Bu(t,r.Ls)}}function CM(i,e){const t=Oe(i),r=t.Au.get(e);if(r&&r.hu)return Fe().add(r.key);{let a=Fe();const l=t.Iu.get(e);if(!l)return a;for(const u of l){const h=t.Tu.get(u);a=a.unionWith(h.view.nu)}return a}}function yR(i){const e=Oe(i);return e.remoteStore.remoteSyncer.applyRemoteEvent=fR.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=CM.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=RM.bind(null,e),e.Pu.H_=fM.bind(null,e.eventManager),e.Pu.yu=mM.bind(null,e.eventManager),e}function vR(i){const e=Oe(i);return e.remoteStore.remoteSyncer.applySuccessfulWrite=SM.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=AM.bind(null,e),e}class Ru{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Bf(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return J1(this.persistence,new W1,e.initialUser,this.serializer)}Cu(e){return new Qy(qf.mi,this.serializer)}Du(e){return new tR}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Ru.provider={build:()=>new Ru};class PM extends Ru{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){we(this.persistence.referenceDelegate instanceof ff,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new K1(r,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?bn.withCacheSize(this.cacheSizeBytes):bn.DEFAULT;return new Qy(r=>ff.mi(r,t),this.serializer)}}class DM extends Ru{constructor(e,t,r){super(),this.xu=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await vR(this.xu.syncEngine),await qu(this.xu.remoteStore),await this.persistence.Ji(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}vu(e){return J1(this.persistence,new W1,e.initialUser,this.serializer)}Fu(e,t){const r=this.persistence.referenceDelegate.garbageCollector;return new K1(r,e.asyncQueue,t)}Mu(e,t){const r=new kD(t,this.persistence);return new jD(e.asyncQueue,r)}Cu(e){const t=DO(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?bn.withCacheSize(this.cacheSizeBytes):bn.DEFAULT;return new Xy(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,YO(),Ud(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new tR}}class pf{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>QE(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=NM.bind(null,this.syncEngine),await uM(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new dM}()}createDatastore(e){const t=Bf(e.databaseInfo.databaseId),r=function(l){return new KO(l)}(e.databaseInfo);return function(l,u,h,m){return new WO(l,u,h,m)}(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return function(r,a,l,u,h){return new ZO(r,a,l,u,h)}(this.localStore,this.datastore,e.asyncQueue,t=>QE(this.syncEngine,t,0),function(){return BE.v()?new BE:new qO}())}createSyncEngine(e,t){return function(a,l,u,h,m,y,_){const b=new vM(a,l,u,h,m,y);return _&&(b.gu=!0),b}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await async function(t){const r=Oe(t);fe($a,"RemoteStore shutting down."),r.Ea.add(5),await zu(r),r.Aa.shutdown(),r.Ra.set("Unknown")}(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}pf.provider={build:()=>new pf};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hv{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Nn("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ls="FirestoreClient";class VM{constructor(e,t,r,a,l){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=a,this.user=pn.UNAUTHENTICATED,this.clientId=Ny.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=l,this.authCredentials.start(r,async u=>{fe(Ls,"Received user=",u.uid),await this.authCredentialListener(u),this.user=u}),this.appCheckCredentials.start(r,u=>(fe(Ls,"Received new app check token=",u),this.appCheckCredentialListener(u,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Yi;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=rv(t,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function mg(i,e){i.asyncQueue.verifyOperationInProgress(),fe(Ls,"Initializing OfflineComponentProvider");const t=i.configuration;await e.initialize(t);let r=t.initialUser;i.setCredentialChangeListener(async a=>{r.isEqual(a)||(await Z1(e.localStore,a),r=a)}),e.persistence.setDatabaseDeletedListener(()=>i.terminate()),i._offlineComponents=e}async function WE(i,e){i.asyncQueue.verifyOperationInProgress();const t=await OM(i);fe(Ls,"Initializing OnlineComponentProvider"),await e.initialize(t,i.configuration),i.setCredentialChangeListener(r=>GE(e.remoteStore,r)),i.setAppCheckTokenChangeListener((r,a)=>GE(e.remoteStore,a)),i._onlineComponents=e}async function OM(i){if(!i._offlineComponents)if(i._uninitializedComponentsProvider){fe(Ls,"Using user provided OfflineComponentProvider");try{await mg(i,i._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function(a){return a.name==="FirebaseError"?a.code===oe.FAILED_PRECONDITION||a.code===oe.UNIMPLEMENTED:!(typeof DOMException<"u"&&a instanceof DOMException)||a.code===22||a.code===20||a.code===11}(t))throw t;qa("Error using user provided cache. Falling back to memory cache: "+t),await mg(i,new Ru)}}else fe(Ls,"Using default OfflineComponentProvider"),await mg(i,new PM(void 0));return i._offlineComponents}async function _R(i){return i._onlineComponents||(i._uninitializedComponentsProvider?(fe(Ls,"Using user provided OnlineComponentProvider"),await WE(i,i._uninitializedComponentsProvider._online)):(fe(Ls,"Using default OnlineComponentProvider"),await WE(i,new pf))),i._onlineComponents}function MM(i){return _R(i).then(e=>e.syncEngine)}async function gf(i){const e=await _R(i),t=e.eventManager;return t.onListen=_M.bind(null,e.syncEngine),t.onUnlisten=EM.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=bM.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=TM.bind(null,e.syncEngine),t}function jM(i,e,t={}){const r=new Yi;return i.asyncQueue.enqueueAndForget(async()=>function(l,u,h,m,y){const _=new hv({next:T=>{_.Nu(),u.enqueueAndForget(()=>av(l,b));const I=T.docs.has(h);!I&&T.fromCache?y.reject(new ye(oe.UNAVAILABLE,"Failed to get document because the client is offline.")):I&&T.fromCache&&m&&m.source==="server"?y.reject(new ye(oe.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):y.resolve(T)},error:T=>y.reject(T)}),b=new lv(Lu(h.path),_,{includeMetadataChanges:!0,qa:!0});return sv(l,b)}(await gf(i),i.asyncQueue,e,t,r)),r.promise}function kM(i,e,t={}){const r=new Yi;return i.asyncQueue.enqueueAndForget(async()=>function(l,u,h,m,y){const _=new hv({next:T=>{_.Nu(),u.enqueueAndForget(()=>av(l,b)),T.fromCache&&m.source==="server"?y.reject(new ye(oe.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):y.resolve(T)},error:T=>y.reject(T)}),b=new lv(h,_,{includeMetadataChanges:!0,qa:!0});return sv(l,b)}(await gf(i),i.asyncQueue,e,t,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bR(i){const e={};return i.timeoutSeconds!==void 0&&(e.timeoutSeconds=i.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JE=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xR="firestore.googleapis.com",ZE=!0;class eT{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new ye(oe.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=xR,this.ssl=ZE}else this.host=e.host,this.ssl=e.ssl??ZE;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=q1;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<pO)throw new ye(oe.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}DD("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=bR(e.experimentalLongPollingOptions??{}),function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new ye(oe.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new ye(oe.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new ye(oe.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,a){return r.timeoutSeconds===a.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Gf{constructor(e,t,r,a){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=a,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new eT({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ye(oe.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new ye(oe.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new eT(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new ED;switch(r.type){case"firstParty":return new SD(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new ye(oe.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const r=JE.get(t);r&&(fe("ComponentProvider","Removing Datastore"),JE.delete(t),r.terminate())}(this),Promise.resolve()}}function LM(i,e,t,r={}){i=Zn(i,Gf);const a=Tl(e),l=i._getSettings(),u={...l,emulatorOptions:i._getEmulatorOptions()},h=`${e}:${t}`;a&&(NT(`https://${h}`),CT("Firestore",!0)),l.host!==xR&&l.host!==h&&qa("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const m={...l,host:h,ssl:a,emulatorOptions:r};if(!ka(m,u)&&(i._setSettings(m),r.mockUserToken)){let y,_;if(typeof r.mockUserToken=="string")y=r.mockUserToken,_=pn.MOCK_USER;else{y=PN(r.mockUserToken,i._app?.options.projectId);const b=r.mockUserToken.sub||r.mockUserToken.user_id;if(!b)throw new ye(oe.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");_=new pn(b)}i._authCredentials=new TD(new Iw(y,_))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ja{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Ja(this.firestore,e,this._query)}}class kt{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Os(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new kt(this.firestore,e,this._key)}toJSON(){return{type:kt._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(Ou(t,kt._jsonSchema))return new kt(e,r||null,new _e(at.fromString(t.referencePath)))}}kt._jsonSchemaVersion="firestore/documentReference/1.0",kt._jsonSchema={type:Ht("string",kt._jsonSchemaVersion),referencePath:Ht("string")};class Os extends Ja{constructor(e,t,r){super(e,t,Lu(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new kt(this.firestore,null,new _e(e))}withConverter(e){return new Os(this.firestore,e,this._path)}}function Hu(i,e,...t){if(i=Gt(i),Cw("collection","path",e),i instanceof Gf){const r=at.fromString(e,...t);return Hx(r),new Os(i,null,r)}{if(!(i instanceof kt||i instanceof Os))throw new ye(oe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=i._path.child(at.fromString(e,...t));return Hx(r),new Os(i.firestore,null,r)}}function Fs(i,e,...t){if(i=Gt(i),arguments.length===1&&(e=Ny.newId()),Cw("doc","path",e),i instanceof Gf){const r=at.fromString(e,...t);return Bx(r),new kt(i,null,new _e(r))}{if(!(i instanceof kt||i instanceof Os))throw new ye(oe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=i._path.child(at.fromString(e,...t));return Bx(r),new kt(i.firestore,i instanceof Os?i.converter:null,new _e(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tT="AsyncQueue";class nT{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new nR(this,"async_queue_retry"),this._c=()=>{const r=Ud();r&&fe(tT,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const t=Ud();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=Ud();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const t=new Yi;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!qs(e))throw e;fe(tT,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const t=this.ac.then(()=>(this.rc=!0,e().catch(r=>{throw this.nc=r,this.rc=!1,Nn("INTERNAL UNHANDLED ERROR: ",iT(r)),r}).then(r=>(this.rc=!1,r))));return this.ac=t,t}enqueueAfterDelay(e,t,r){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const a=iv.createAndSchedule(this,e,t,r,l=>this.hc(l));return this.tc.push(a),a}uc(){this.nc&&Te(47125,{Pc:iT(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function iT(i){let e=i.message||"";return i.stack&&(e=i.stack.includes(i.message)?i.stack:i.message+`
`+i.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rT(i){return function(t,r){if(typeof t!="object"||t===null)return!1;const a=t;for(const l of r)if(l in a&&typeof a[l]=="function")return!0;return!1}(i,["next","error","complete"])}class Or extends Gf{constructor(e,t,r,a){super(e,t,r,a),this.type="firestore",this._queue=new nT,this._persistenceKey=a?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new nT(e),this._firestoreClient=void 0,await e}}}function FM(i,e){const t=typeof i=="object"?i:LT(),r=typeof i=="string"?i:rf,a=yy(t,"firestore").getImmediate({identifier:r});if(!a._initialized){const l=NN("firestore");l&&LM(a,...l)}return a}function Kf(i){if(i._terminated)throw new ye(oe.FAILED_PRECONDITION,"The client has already been terminated.");return i._firestoreClient||ER(i),i._firestoreClient}function ER(i){const e=i._freezeSettings(),t=function(a,l,u,h){return new dV(a,l,u,h.host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,bR(h.experimentalLongPollingOptions),h.useFetchStreams,h.isUsingEmulator)}(i._databaseId,i._app?.options.appId||"",i._persistenceKey,e);i._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(i._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),i._firestoreClient=new VM(i._authCredentials,i._appCheckCredentials,i._queue,t,i._componentsProvider&&function(a){const l=a?._online.build();return{_offline:a?._offline.build(l),_online:l}}(i._componentsProvider))}function UM(i,e){qa("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=i._freezeSettings();return zM(i,pf.provider,{build:r=>new DM(r,t.cacheSizeBytes,e?.forceOwnership)}),Promise.resolve()}function zM(i,e,t){if((i=Zn(i,Or))._firestoreClient||i._terminated)throw new ye(oe.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(i._componentsProvider||i._getSettings().localCache)throw new ye(oe.FAILED_PRECONDITION,"SDK cache is already specified.");i._componentsProvider={_online:e,_offline:t},ER(i)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pi{constructor(e){this._byteString=e}static fromBase64String(e){try{return new pi(Kt.fromBase64String(e))}catch(t){throw new ye(oe.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new pi(Kt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:pi._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Ou(e,pi._jsonSchema))return pi.fromBase64String(e.bytes)}}pi._jsonSchemaVersion="firestore/bytes/1.0",pi._jsonSchema={type:Ht("string",pi._jsonSchemaVersion),bytes:Ht("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yf{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new ye(oe.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new It(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dv{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $i{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new ye(oe.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new ye(oe.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Ve(this._lat,e._lat)||Ve(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:$i._jsonSchemaVersion}}static fromJSON(e){if(Ou(e,$i._jsonSchema))return new $i(e.latitude,e.longitude)}}$i._jsonSchemaVersion="firestore/geoPoint/1.0",$i._jsonSchema={type:Ht("string",$i._jsonSchemaVersion),latitude:Ht("number"),longitude:Ht("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qi{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,a){if(r.length!==a.length)return!1;for(let l=0;l<r.length;++l)if(r[l]!==a[l])return!1;return!0}(this._values,e._values)}toJSON(){return{type:Qi._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Ou(e,Qi._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(t=>typeof t=="number"))return new Qi(e.vectorValues);throw new ye(oe.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Qi._jsonSchemaVersion="firestore/vectorValue/1.0",Qi._jsonSchema={type:Ht("string",Qi._jsonSchemaVersion),vectorValues:Ht("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qM=/^__.*__$/;class BM{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new zr(e,this.data,this.fieldMask,t,this.fieldTransforms):new Al(e,this.data,t,this.fieldTransforms)}}class TR{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new zr(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function wR(i){switch(i){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Te(40011,{Ac:i})}}class fv{constructor(e,t,r,a,l,u){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=a,l===void 0&&this.Rc(),this.fieldTransforms=l||[],this.fieldMask=u||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new fv({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const t=this.path?.child(e),r=this.Vc({path:t,fc:!1});return r.gc(e),r}yc(e){const t=this.path?.child(e),r=this.Vc({path:t,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return yf(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(wR(this.Ac)&&qM.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class HM{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||Bf(e)}Cc(e,t,r,a=!1){return new fv({Ac:e,methodName:t,Dc:r,path:It.emptyPath(),fc:!1,bc:a},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function mv(i){const e=i._freezeSettings(),t=Bf(i._databaseId);return new HM(i._databaseId,!!e.ignoreUndefinedProperties,t)}function GM(i,e,t,r,a,l={}){const u=i.Cc(l.merge||l.mergeFields?2:0,e,t,a);pv("Data must be an object, but it was:",u,r);const h=RR(r,u);let m,y;if(l.merge)m=new Ln(u.fieldMask),y=u.fieldTransforms;else if(l.mergeFields){const _=[];for(const b of l.mergeFields){const T=sy(e,b,t);if(!u.contains(T))throw new ye(oe.INVALID_ARGUMENT,`Field '${T}' is specified in your field mask but missing from your input data.`);AR(_,T)||_.push(T)}m=new Ln(_),y=u.fieldTransforms.filter(b=>m.covers(b.field))}else m=null,y=u.fieldTransforms;return new BM(new xn(h),m,y)}class $f extends dv{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof $f}}function KM(i,e,t,r){const a=i.Cc(1,e,t);pv("Data must be an object, but it was:",a,r);const l=[],u=xn.empty();Bs(r,(m,y)=>{const _=gv(e,m,t);y=Gt(y);const b=a.yc(_);if(y instanceof $f)l.push(_);else{const T=Gu(y,b);T!=null&&(l.push(_),u.set(_,T))}});const h=new Ln(l);return new TR(u,h,a.fieldTransforms)}function YM(i,e,t,r,a,l){const u=i.Cc(1,e,t),h=[sy(e,r,t)],m=[a];if(l.length%2!=0)throw new ye(oe.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let T=0;T<l.length;T+=2)h.push(sy(e,l[T])),m.push(l[T+1]);const y=[],_=xn.empty();for(let T=h.length-1;T>=0;--T)if(!AR(y,h[T])){const I=h[T];let V=m[T];V=Gt(V);const L=u.yc(I);if(V instanceof $f)y.push(I);else{const O=Gu(V,L);O!=null&&(y.push(I),_.set(I,O))}}const b=new Ln(y);return new TR(_,b,u.fieldTransforms)}function $M(i,e,t,r=!1){return Gu(t,i.Cc(r?4:3,e))}function Gu(i,e){if(SR(i=Gt(i)))return pv("Unsupported field value:",e,i),RR(i,e);if(i instanceof dv)return function(r,a){if(!wR(a.Ac))throw a.Sc(`${r._methodName}() can only be used with update() and set()`);if(!a.path)throw a.Sc(`${r._methodName}() is not currently supported inside arrays`);const l=r._toFieldTransform(a);l&&a.fieldTransforms.push(l)}(i,e),null;if(i===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),i instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(r,a){const l=[];let u=0;for(const h of r){let m=Gu(h,a.wc(u));m==null&&(m={nullValue:"NULL_VALUE"}),l.push(m),u++}return{arrayValue:{values:l}}}(i,e)}return function(r,a){if((r=Gt(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return DV(a.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const l=ut.fromDate(r);return{timestampValue:bl(a.serializer,l)}}if(r instanceof ut){const l=new ut(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:bl(a.serializer,l)}}if(r instanceof $i)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof pi)return{bytesValue:S1(a.serializer,r._byteString)};if(r instanceof kt){const l=a.databaseId,u=r.firestore._databaseId;if(!u.isEqual(l))throw a.Sc(`Document reference is for database ${u.projectId}/${u.database} but should be for database ${l.projectId}/${l.database}`);return{referenceValue:Gy(r.firestore._databaseId||a.databaseId,r._key.path)}}if(r instanceof Qi)return function(u,h){return{mapValue:{fields:{[ky]:{stringValue:Ly},[ml]:{arrayValue:{values:u.toArray().map(y=>{if(typeof y!="number")throw h.Sc("VectorValues must only contain numeric values.");return Uy(h.serializer,y)})}}}}}}(r,a);throw a.Sc(`Unsupported field value: ${Af(r)}`)}(i,e)}function RR(i,e){const t={};return Kw(i)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Bs(i,(r,a)=>{const l=Gu(a,e.mc(r));l!=null&&(t[r]=l)}),{mapValue:{fields:t}}}function SR(i){return!(typeof i!="object"||i===null||i instanceof Array||i instanceof Date||i instanceof ut||i instanceof $i||i instanceof pi||i instanceof kt||i instanceof dv||i instanceof Qi)}function pv(i,e,t){if(!SR(t)||!Pw(t)){const r=Af(t);throw r==="an object"?e.Sc(i+" a custom object"):e.Sc(i+" "+r)}}function sy(i,e,t){if((e=Gt(e))instanceof Yf)return e._internalPath;if(typeof e=="string")return gv(i,e);throw yf("Field path arguments must be of type string or ",i,!1,void 0,t)}const QM=new RegExp("[~\\*/\\[\\]]");function gv(i,e,t){if(e.search(QM)>=0)throw yf(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,i,!1,void 0,t);try{return new Yf(...e.split("."))._internalPath}catch{throw yf(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,i,!1,void 0,t)}}function yf(i,e,t,r,a){const l=r&&!r.isEmpty(),u=a!==void 0;let h=`Function ${e}() called with invalid data`;t&&(h+=" (via `toFirestore()`)"),h+=". ";let m="";return(l||u)&&(m+=" (found",l&&(m+=` in field ${r}`),u&&(m+=` in document ${a}`),m+=")"),new ye(oe.INVALID_ARGUMENT,h+i+m)}function AR(i,e){return i.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IR{constructor(e,t,r,a,l){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=a,this._converter=l}get id(){return this._key.path.lastSegment()}get ref(){return new kt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new XM(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(yv("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class XM extends IR{data(){return super.data()}}function yv(i,e){return typeof e=="string"?gv(i,e):e instanceof Yf?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NR(i){if(i.limitType==="L"&&i.explicitOrderBy.length===0)throw new ye(oe.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class vv{}class WM extends vv{}function CR(i,e,...t){let r=[];e instanceof vv&&r.push(e),r=r.concat(t),function(l){const u=l.filter(m=>m instanceof _v).length,h=l.filter(m=>m instanceof Qf).length;if(u>1||u>0&&h>0)throw new ye(oe.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const a of r)i=a._apply(i);return i}class Qf extends WM{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new Qf(e,t,r)}_apply(e){const t=this._parse(e);return DR(e._query,t),new Ja(e.firestore,e.converter,Kg(e._query,t))}_parse(e){const t=mv(e.firestore);return function(l,u,h,m,y,_,b){let T;if(y.isKeyField()){if(_==="array-contains"||_==="array-contains-any")throw new ye(oe.INVALID_ARGUMENT,`Invalid Query. You can't perform '${_}' queries on documentId().`);if(_==="in"||_==="not-in"){aT(b,_);const V=[];for(const L of b)V.push(sT(m,l,L));T={arrayValue:{values:V}}}else T=sT(m,l,b)}else _!=="in"&&_!=="not-in"&&_!=="array-contains-any"||aT(b,_),T=$M(h,u,b,_==="in"||_==="not-in");return Ye.create(y,_,T)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function PR(i,e,t){const r=e,a=yv("where",i);return Qf._create(a,r,t)}class _v extends vv{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new _v(e,t)}_parse(e){const t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:ht.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:(function(a,l){let u=a;const h=l.getFlattenedFilters();for(const m of h)DR(u,m),u=Kg(u,m)}(e._query,t),new Ja(e.firestore,e.converter,Kg(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function sT(i,e,t){if(typeof(t=Gt(t))=="string"){if(t==="")throw new ye(oe.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!c1(e)&&t.indexOf("/")!==-1)throw new ye(oe.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(at.fromString(t));if(!_e.isDocumentKey(r))throw new ye(oe.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return xu(i,new _e(r))}if(t instanceof kt)return xu(i,t._key);throw new ye(oe.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Af(t)}.`)}function aT(i,e){if(!Array.isArray(i)||i.length===0)throw new ye(oe.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function DR(i,e){const t=function(a,l){for(const u of a)for(const h of u.getFlattenedFilters())if(l.indexOf(h.op)>=0)return h.op;return null}(i.filters,function(a){switch(a){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new ye(oe.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new ye(oe.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class JM{convertValue(e,t="none"){switch(Ms(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Rt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Vr(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Te(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return Bs(e,(a,l)=>{r[a]=this.convertValue(l,t)}),r}convertVectorValue(e){const t=e.fields?.[ml].arrayValue?.values?.map(r=>Rt(r.doubleValue));return new Qi(t)}convertGeoPoint(e){return new $i(Rt(e.latitude),Rt(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":const r=Vf(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(_u(e));default:return null}}convertTimestamp(e){const t=Dr(e);return new ut(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=at.fromString(e);we(j1(r),9688,{name:e});const a=new Ba(r.get(1),r.get(3)),l=new _e(r.popFirst(5));return a.isEqual(t)||Nn(`Document ${l} contains a document reference within a different database (${a.projectId}/${a.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZM(i,e,t){let r;return r=i?i.toFirestore(e):e,r}class Xc{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Ma extends IR{constructor(e,t,r,a,l,u){super(e,t,r,a,u),this._firestore=e,this._firestoreImpl=e,this.metadata=l}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new zd(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(yv("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new ye(oe.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Ma._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}Ma._jsonSchemaVersion="firestore/documentSnapshot/1.0",Ma._jsonSchema={type:Ht("string",Ma._jsonSchemaVersion),bundleSource:Ht("string","DocumentSnapshot"),bundleName:Ht("string"),bundle:Ht("string")};class zd extends Ma{data(e={}){return super.data(e)}}class ja{constructor(e,t,r,a){this._firestore=e,this._userDataWriter=t,this._snapshot=a,this.metadata=new Xc(a.hasPendingWrites,a.fromCache),this.query=r}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new zd(this._firestore,this._userDataWriter,r.key,r,new Xc(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new ye(oe.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(a,l){if(a._snapshot.oldDocs.isEmpty()){let u=0;return a._snapshot.docChanges.map(h=>{const m=new zd(a._firestore,a._userDataWriter,h.doc.key,h.doc,new Xc(a._snapshot.mutatedKeys.has(h.doc.key),a._snapshot.fromCache),a.query.converter);return h.doc,{type:"added",doc:m,oldIndex:-1,newIndex:u++}})}{let u=a._snapshot.oldDocs;return a._snapshot.docChanges.filter(h=>l||h.type!==3).map(h=>{const m=new zd(a._firestore,a._userDataWriter,h.doc.key,h.doc,new Xc(a._snapshot.mutatedKeys.has(h.doc.key),a._snapshot.fromCache),a.query.converter);let y=-1,_=-1;return h.type!==0&&(y=u.indexOf(h.doc.key),u=u.delete(h.doc.key)),h.type!==1&&(u=u.add(h.doc),_=u.indexOf(h.doc.key)),{type:ej(h.type),doc:m,oldIndex:y,newIndex:_}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new ye(oe.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=ja._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Ny.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],r=[],a=[];return this.docs.forEach(l=>{l._document!==null&&(t.push(l._document),r.push(this._userDataWriter.convertObjectMap(l._document.data.value.mapValue.fields,"previous")),a.push(l.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function ej(i){switch(i){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Te(61501,{type:i})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tj(i){i=Zn(i,kt);const e=Zn(i.firestore,Or);return jM(Kf(e),i._key).then(t=>OR(e,i,t))}ja._jsonSchemaVersion="firestore/querySnapshot/1.0",ja._jsonSchema={type:Ht("string",ja._jsonSchemaVersion),bundleSource:Ht("string","QuerySnapshot"),bundleName:Ht("string"),bundle:Ht("string")};class bv extends JM{constructor(e){super(),this.firestore=e}convertBytes(e){return new pi(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new kt(this.firestore,null,t)}}function nj(i){i=Zn(i,Ja);const e=Zn(i.firestore,Or),t=Kf(e),r=new bv(e);return NR(i._query),kM(t,i._query).then(a=>new ja(e,r,i,a))}function xv(i,e,t,...r){i=Zn(i,kt);const a=Zn(i.firestore,Or),l=mv(a);let u;return u=typeof(e=Gt(e))=="string"||e instanceof Yf?YM(l,"updateDoc",i._key,e,t,r):KM(l,"updateDoc",i._key,e),wv(a,[u.toMutation(i._key,Pn.exists(!0))])}function Ev(i){return wv(Zn(i.firestore,Or),[new Lf(i._key,Pn.none())])}function Tv(i,e){const t=Zn(i.firestore,Or),r=Fs(i),a=ZM(i.converter,e);return wv(t,[GM(mv(i.firestore),"addDoc",r._key,a,i.converter!==null,{}).toMutation(r._key,Pn.exists(!1))]).then(()=>r)}function VR(i,...e){i=Gt(i);let t={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||rT(e[r])||(t=e[r++]);const a={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(rT(e[r])){const m=e[r];e[r]=m.next?.bind(m),e[r+1]=m.error?.bind(m),e[r+2]=m.complete?.bind(m)}let l,u,h;if(i instanceof kt)u=Zn(i.firestore,Or),h=Lu(i._key.path),l={next:m=>{e[r]&&e[r](OR(u,i,m))},error:e[r+1],complete:e[r+2]};else{const m=Zn(i,Ja);u=Zn(m.firestore,Or),h=m._query;const y=new bv(u);l={next:_=>{e[r]&&e[r](new ja(u,y,m,_))},error:e[r+1],complete:e[r+2]},NR(i._query)}return function(y,_,b,T){const I=new hv(T),V=new lv(_,I,b);return y.asyncQueue.enqueueAndForget(async()=>sv(await gf(y),V)),()=>{I.Nu(),y.asyncQueue.enqueueAndForget(async()=>av(await gf(y),V))}}(Kf(u),h,a,l)}function wv(i,e){return function(r,a){const l=new Yi;return r.asyncQueue.enqueueAndForget(async()=>wM(await MM(r),a,l)),l.promise}(Kf(i),e)}function OR(i,e,t){const r=t.docs.get(e._key),a=new bv(i);return new Ma(i,a,e._key,r,new Xc(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){(function(a){Sl=a})(wl),ll(new La("firestore",(r,{instanceIdentifier:a,options:l})=>{const u=r.getProvider("app").getImmediate(),h=new Or(new wD(r.getProvider("auth-internal")),new AD(u,r.getProvider("app-check-internal")),function(y,_){if(!Object.prototype.hasOwnProperty.apply(y.options,["projectId"]))throw new ye(oe.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ba(y.options.projectId,_)}(u,a),u);return l={useFetchStreams:t,...l},h._setSettings(l),h},"PUBLIC").setMultipleInstances(!0)),Ps(Fx,Ux,e),Ps(Fx,Ux,"esm2020")})();const ij={apiKey:"AIzaSyAF1wo4_rCRgtFUJatYiGJ3tU8GGsjtQuI",authDomain:"blocxpert-a4f09.firebaseapp.com",projectId:"blocxpert-a4f09",storageBucket:"blocxpert-a4f09.firebasestorage.app",messagingSenderId:"943428807330",appId:"1:943428807330:web:f92383f550620a091e85fb"},MR=kT(ij),Ea=bD(MR),rj=new Rr,ei=FM(MR);UM(ei).catch(i=>{console.error("Failed to enable persistence",i)});const jR="offlineQueue",kR=()=>JSON.parse(localStorage.getItem(jR)||"[]"),LR=i=>localStorage.setItem(jR,JSON.stringify(i)),Rv=i=>{const e=kR();e.push(i),LR(e)},FR=async()=>{if(!navigator.onLine)return;const i=kR();for(const e of i)try{e.type==="add"?await Tv(Hu(ei,"properties"),e.data):e.type==="update"?await xv(Fs(ei,"properties",e.id),e.data):e.type==="delete"&&await Ev(Fs(ei,"properties",e.id))}catch(t){console.error("Failed to process queued operation",t)}LR([])};window.addEventListener("online",FR);navigator.onLine&&FR();const sj=i=>{const{id:e,title:t,...r}=i;return{...r,title:t?`${t} (copie)`:"Copie"}},UR=Hu(ei,"properties"),zR=async i=>navigator.onLine?(await Tv(UR,i)).id:(Rv({type:"add",data:i}),null),aj=(i,e)=>{const t=CR(UR,PR("uid","==",i));return VR(t,r=>{const a=r.docs.map(l=>({id:l.id,...l.data()}));e(a)})},oj=async(i,e)=>{if(!navigator.onLine){Rv({type:"update",id:i,data:e});return}const t=Fs(ei,"properties",i);await xv(t,e)},lj=async i=>{if(!navigator.onLine){Rv({type:"delete",id:i});return}const e=Fs(ei,"properties",i);await Ev(e)},Nl=async(i,e)=>{const t=Hu(ei,"properties",i,"scenarios");return(await Tv(t,e)).id},Ku=(i,e,t=null)=>{const r=Hu(ei,"properties",i,"scenarios"),a=t!=null?CR(r,PR("parentScenarioId","==",t)):r;return VR(a,l=>{const u=l.docs.map(h=>({id:h.id,...h.data()}));e(u)})},Yu=async(i,e,t)=>{const r=Fs(ei,"properties",i,"scenarios",e);await xv(r,t)},cj=async(i,e)=>{const t=sj(e);return{id:await Nl(i,t),...t}},uj=async(i,e)=>{const t=Fs(ei,"properties",i,"scenarios",e);await Ev(t)},hj=async i=>{const e=Fs(ei,"properties",i),t=await tj(e);if(!t.exists())return null;const r={id:t.id,...t.data()},a=Hu(ei,"properties",i,"scenarios"),u=(await nj(a)).docs.map(h=>({id:h.id,...h.data()}));return{property:r,scenarios:u}},dj=async(i,e)=>{const{property:t,scenarios:r}=i,{id:a,uid:l,...u}=t,h=await zR({...u,uid:e}),m={};for(const y of r||[]){const{id:_,parentScenarioId:b,...T}=y,I=await Nl(h,T);m[_]={newId:I,parentOldId:b}}for(const{newId:y,parentOldId:_}of Object.values(m))_&&m[_]&&await Yu(h,y,{parentScenarioId:m[_].newId});return h};function qR({propertyId:i,onEdit:e,onView:t,excludeTypes:r=[],parentScenarioId:a=null}){const{t:l}=ft(),[u,h]=q.useState([]),m={initialFinancing:l("scenario.initialFinancing"),refinancing:l("scenario.refinancing"),renewal:l("scenario.renewal"),optimization:l("scenario.optimization"),other:l("scenario.other")},y=({label:V,icon:L,onClick:O,className:Z})=>p.jsxs("button",{onClick:O,className:`p-2 rounded hover:bg-gray-100 ${Z}`,"aria-label":V,title:V,children:[p.jsx(L,{className:"w-5 h-5"}),p.jsx("span",{className:"sr-only",children:V})]});q.useEffect(()=>{if(!i)return;const V=Ku(i,h,a);return()=>V&&V()},[i,a]);const _=async V=>{await cj(i,V)},b=async V=>{await uj(i,V),h(L=>L.filter(O=>O.id!==V))},T=u.filter(V=>!(r.includes(V.type||"other")||a!=null&&V.parentScenarioId!==a));if(r.includes("initialFinancing")){const V=T.reduce((L,O)=>{const Z=O.type||"other";return L[Z]||(L[Z]=[]),L[Z].push(O),L},{});return p.jsx("div",{className:"space-y-6",children:Object.entries(V).map(([L,O])=>p.jsxs("div",{children:[p.jsx("h3",{className:"text-lg font-semibold mb-2",children:m[L]||L}),p.jsx("div",{className:"space-y-2",children:O.map(Z=>p.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-2 p-2 bg-white rounded shadow",children:[p.jsx("span",{children:Z.title||l("propertyReport.untitled")}),p.jsxs("div",{className:"flex gap-2",children:[t&&p.jsx(y,{label:l("scenarioList.viewReport"),icon:nl,onClick:()=>t(Z),className:"text-indigo-600 hover:text-indigo-800"}),p.jsx(y,{label:l("scenarioList.edit"),icon:il,onClick:()=>e&&e(Z),className:"text-blue-600 hover:text-blue-800"}),p.jsx(y,{label:l("scenarioList.duplicate"),icon:eg,onClick:()=>_(Z),className:"text-green-600 hover:text-green-800"}),p.jsx(y,{label:l("scenarioList.delete"),icon:Rd,onClick:()=>b(Z.id),className:"text-red-600 hover:text-red-800"})]})]},Z.id))})]},L))})}const I=T.filter(V=>V.type==="initialFinancing");return p.jsx("div",{className:"space-y-6",children:I.map(V=>{const L=T.filter(O=>O.parentScenarioId===V.id&&O.id!==V.id);return p.jsxs("div",{className:"space-y-2",children:[p.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-2 p-2 bg-white rounded shadow",children:[p.jsx("span",{children:V.title||l("propertyReport.untitled")}),p.jsxs("div",{className:"flex gap-2",children:[t&&p.jsx(y,{label:l("scenarioList.viewReport"),icon:nl,onClick:()=>t(V),className:"text-indigo-600 hover:text-indigo-800"}),p.jsx(y,{label:l("scenarioList.edit"),icon:il,onClick:()=>e&&e(V),className:"text-blue-600 hover:text-blue-800"}),p.jsx(y,{label:l("scenarioList.duplicate"),icon:eg,onClick:()=>_(V),className:"text-green-600 hover:text-green-800"}),p.jsx(y,{label:l("scenarioList.delete"),icon:Rd,onClick:()=>b(V.id),className:"text-red-600 hover:text-red-800"})]})]}),L.length>0&&p.jsx("div",{className:"sm:pl-4 space-y-2",children:L.map(O=>p.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-2 p-2 bg-gray-50 rounded shadow",children:[p.jsxs("span",{children:[O.title||l("propertyReport.untitled")," (",m[O.type]||O.type,")"]}),p.jsxs("div",{className:"flex gap-2",children:[t&&p.jsx(y,{label:l("scenarioList.viewReport"),icon:nl,onClick:()=>t(O),className:"text-indigo-600 hover:text-indigo-800"}),p.jsx(y,{label:l("scenarioList.edit"),icon:il,onClick:()=>e&&e(O),className:"text-blue-600 hover:text-blue-800"}),p.jsx(y,{label:l("scenarioList.duplicate"),icon:eg,onClick:()=>_(O),className:"text-green-600 hover:text-green-800"}),p.jsx(y,{label:l("scenarioList.delete"),icon:Rd,onClick:()=>b(O.id),className:"text-red-600 hover:text-red-800"})]})]},O.id))})]},V.id)})})}function Sv({financing:i={},onChange:e,lockedFields:t={}}){const{t:r}=ft(),a=(l,u)=>{e({...i,[l]:u},l)};return p.jsxs("div",{className:"border rounded-lg p-6",children:[p.jsxs("h2",{className:"text-lg font-semibold mb-4 text-purple-600 flex items-center",children:[p.jsx(wg,{className:"w-5 h-5 mr-2"}),r("financing.title")]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium mb-1",children:r("financing.type")}),p.jsxs("select",{value:i.financingType||"conventional",onChange:l=>a("financingType",l.target.value),className:"w-full border rounded p-2",children:[p.jsx("option",{value:"conventional",children:r("financing.type.conventional")}),p.jsx("option",{value:"cmhc",children:r("financing.type.cmhc")}),p.jsx("option",{value:"cmhc_aph",children:r("financing.type.cmhc_aph")}),p.jsx("option",{value:"private",children:r("financing.type.private")})]})]}),i.financingType==="cmhc_aph"&&p.jsxs("div",{className:"mt-4",children:[p.jsx("label",{className:"block text-sm font-medium mb-1",children:r("financing.aphPoints")}),p.jsx(Ke,{value:i.aphPoints||"",onChange:l=>a("aphPoints",l),className:"w-full border rounded p-2",placeholder:"0"})]}),p.jsxs("div",{className:"grid grid-cols-3 gap-4 mt-4",children:[p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium mb-1",children:r("financing.mortgageRate")}),p.jsx(Ke,{value:i.mortgageRate||"",onChange:l=>a("mortgageRate",l),className:"w-full border rounded p-2",placeholder:"5.5",type:"percentage"})]}),i.financingType==="private"?p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium mb-1",children:r("financing.ltvRatio")}),p.jsx(Ke,{value:i.ltvRatio||"",onChange:l=>a("ltvRatio",l),className:"w-full border rounded p-2",placeholder:"60",type:"percentage"})]}):p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium mb-1",children:r("financing.amortization")}),p.jsx(Ke,{value:i.amortization||"",onChange:l=>a("amortization",l),className:"w-full border rounded p-2",placeholder:"25"})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium mb-1",children:r("financing.term")}),p.jsxs("select",{value:i.term||"",onChange:l=>a("term",l.target.value),className:"w-full border rounded p-2",children:[p.jsx("option",{value:"1",children:"1 an"}),p.jsx("option",{value:"2",children:"2 ans"}),p.jsx("option",{value:"3",children:"3 ans"}),p.jsx("option",{value:"5",children:"5 ans"}),p.jsx("option",{value:"10",children:"10 ans"})]})]})]}),i.financingType==="private"&&p.jsxs("div",{className:"mt-4",children:[p.jsx("label",{className:"block text-sm font-medium mb-1",children:r("financing.originationFee")}),p.jsxs("div",{className:"flex",children:[p.jsx(Ke,{value:i.originationFee||"",onChange:l=>a("originationFee",l),className:"w-full border rounded p-2",placeholder:"0",type:i.originationFeeType==="currency"?"currency":"percentage"}),p.jsxs("select",{value:i.originationFeeType||"percentage",onChange:l=>a("originationFeeType",l.target.value),className:"ml-2 border rounded p-2",children:[p.jsx("option",{value:"percentage",children:"%"}),p.jsx("option",{value:"currency",children:"$"})]})]})]}),i.financingType!=="private"&&p.jsxs("div",{className:"grid grid-cols-2 gap-4 mt-4",children:[p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium mb-1",children:r("financing.qualificationRate")}),p.jsx(Ke,{value:i.qualificationRate||"",onChange:l=>a("qualificationRate",l),className:"w-full border rounded p-2",placeholder:"6.0",type:"percentage"})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium mb-1",children:r("financing.debtCoverageRatio")}),p.jsx(Ke,{value:i.debtCoverageRatio||"",onChange:l=>a("debtCoverageRatio",l),className:"w-full border rounded p-2",placeholder:"1.15"})]})]})]})}function BR({fees:i={},onChange:e,analysis:t={},isCMHC:r=!1,includeWorkCost:a=!1}){const{t:l}=ft(),u=(_,b)=>{e({...i,[_]:b})},h=[{field:"environmental1",label:l("financingFees.environmental1")},{field:"appraiser",label:l("financingFees.appraiser")},...r?[{field:"cmhcAnalysis",label:l("financingFees.cmhcAnalysis"),locked:!0},{field:"cmhcTax",label:l("financingFees.cmhcTax"),locked:!0}]:[],{field:"otherFees",label:l("financingFees.otherFees")},{field:"notary",label:l("financingFees.notary")},...a?[{field:"workCost",label:l("financingFees.workCost")}]:[]],m=l(a?"financingFees.sectionTitleWithWork":"financingFees.sectionTitle"),y=l(a?"financingFees.totalWithWork":"financingFees.total");return p.jsxs("div",{className:"border rounded-lg p-6",children:[p.jsxs("h2",{className:"text-lg font-semibold mb-4 text-orange-600 flex items-center",children:[p.jsx(Tg,{className:"w-5 h-5 mr-2"}),m]}),p.jsx("div",{className:"grid grid-cols-2 gap-4",children:h.map(({field:_,label:b,locked:T})=>p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium mb-1",children:b}),p.jsx(Ke,{value:i[_]||"",onChange:I=>u(_,I),className:"w-full border rounded p-2",placeholder:"0",type:"currency",disabled:T})]},_))}),p.jsxs("div",{className:"mt-4",children:[p.jsx("label",{className:"block text-sm font-medium mb-1",children:y}),p.jsx(Ke,{value:t.financingFees?.toString()||"",onChange:()=>{},className:"w-full border rounded p-2 bg-gray-50",placeholder:"0",disabled:!0,type:"currency"})]})]})}const Su=(i=0)=>i>=100?.95:i>=70?.9:.85,Wi=(i,e,{initialLoanAmount:t=0}={})=>{const r=parseFloat(i.purchasePrice)||0,a=parseInt(i.numberOfUnits)||1,l=i.province,u=i.structureType||"woodFrame",m=(parseFloat(i.annualRent)||0)+(parseFloat(i.parkingRevenue)||0)+(parseFloat(i.internetRevenue)||0)+(parseFloat(i.storageRevenue)||0)+(parseFloat(i.otherRevenue)||0),y=m*((parseFloat(i.vacancyRate)||0)/100),_=m-y,b=l?fy[l]:null;let T;b&&(u==="woodFrame"?T=b.woodFrame[a<=11?"small":"large"]:T=b.concrete.any);const I=T?.otherCostRate||0,V=_*I/100,L=T?.replacementReserve||{},O=(parseInt(i.numHeatPumps)||0)*(L.heatPump||0)+(parseInt(i.numFridges)||0)*(L.appliance||0)+(parseInt(i.numStoves)||0)*(L.appliance||0)+(parseInt(i.numDishwashers)||0)*(L.appliance||0)+(parseInt(i.numWashers)||0)*(L.appliance||0)+(parseInt(i.numDryers)||0)*(L.appliance||0)+(parseInt(i.numElevators)||0)*(L.elevator||0)*12;let Z=0,se=0;if(e){const Xe=(parseFloat(i.municipalTaxes)||0)+(parseFloat(i.schoolTaxes)||0)+(parseFloat(i.heating)||0)+(parseFloat(i.electricity)||0)+(parseFloat(i.insurance)||0)+a*(parseFloat(i.maintenance)||0)+_*(parseFloat(i.managementRate)||0)/100+a*(parseFloat(i.concierge)||0),tt=(parseFloat(i.landscaping)||0)+(parseFloat(i.snowRemoval)||0)+(parseFloat(i.extermination)||0)+(parseFloat(i.fireInspection)||0)+(parseFloat(i.advertising)||0)+(parseFloat(i.legal)||0)+(parseFloat(i.accounting)||0)+(parseFloat(i.elevator)||0)+(parseFloat(i.cableInternet)||0)+(parseFloat(i.appliances)||0)+(parseFloat(i.garbage)||0)+(parseFloat(i.washerDryer)||0)+(parseFloat(i.hotWater)||0),Qe=Math.max(I>0?V:0,tt,y);Z=Xe+Qe+(parseFloat(i.otherExpenses)||0)+O,se=Xe+tt+(parseFloat(i.otherExpenses)||0)+O}else Z=(parseFloat(i.municipalTaxes)||0)+(parseFloat(i.schoolTaxes)||0)+(parseFloat(i.insurance)||0)+a*(parseFloat(i.maintenance)||0)+_*(parseFloat(i.managementRate)||0)/100+a*(parseFloat(i.concierge)||0)+(parseFloat(i.electricityHeating)||0)+(parseFloat(i.otherExpenses)||0)+O,se=Z;const G=e?Z:Z+y,ne=se+y,B=m-G,re=m-ne,P=(parseFloat(i.mortgageRate)||5.5)/100;let S=0,A=0,M=0,D=Math.pow(1+P/2,1/6)-1,k=parseInt(i.amortization)||25,N=k*12,ue=.8;if(i.financingType==="private")ue=(parseFloat(i.ltvRatio)||0)/100,S=r*ue,D=P/12,M=S*P/12,A=M*12;else{const Xe=parseFloat(i.debtCoverageRatio)||1.15;A=B/Xe;const ke=(parseFloat(i.qualificationRate)||6)/100,tt=Math.pow(1+ke/2,1/6)-1;N=k*12;const Qe=tt>0?A/12*((Math.pow(1+tt,N)-1)/(tt*Math.pow(1+tt,N))):0;if(i.financingType==="cmhc")ue=.85;else if(i.financingType==="cmhc_aph"){const Tn=parseInt(i.aphPoints)||0;ue=Su(Tn)}const ni=r*ue;S=i.ignoreLTV?Qe:Math.min(Qe,ni)}const de=ue>0?S/ue:0,z={standard:[{ltv:65,rate:.026},{ltv:70,rate:.0285},{ltv:75,rate:.0335},{ltv:80,rate:.0435},{ltv:85,rate:.0535}],select:[{ltv:90,rate:.059},{ltv:100,rate:.0615}],surcharge:.0025};let X=0,ae=0;if(["cmhc","cmhc_aph"].includes(i.financingType)){const Xe=r>0?S/r*100:0,ke=parseInt(i.aphPoints)||0,tt=i.financingType==="cmhc_aph"?Math.min(Xe,Su(ke)*100):Xe;let Qe=0;if(i.financingType==="cmhc_aph"&&tt>85?Qe=tt<=90?z.select[0].rate:z.select[1].rate:Qe=z.standard.find(mt=>tt<=mt.ltv)?.rate||z.standard.at(-1).rate,k>25&&(Qe+=(k-25)/5*z.surcharge),i.financingType==="cmhc_aph"){const Tn=ke>=100?.3:ke>=70?.2:ke>=50?.1:0;Qe=Qe*(1-Tn)}X=Math.max(S-t,0)*Qe,ae=X*.09}let me=0;if(i.financingType==="private"){const Xe=parseFloat(i.originationFee)||0;me=(i.originationFeeType||"percentage")==="currency"?Xe:S*Xe/100}const C=S+X;i.financingType!=="private"&&(M=C>0&&D>0?C*(D*Math.pow(1+D,N))/(Math.pow(1+D,N)-1):0);const U=r-S,ee=M*12,ie=re-ee,ge=e?["inspection","environmental1","environmental2","environmental3","otherFees","appraiser","notary","renovations","cmhcAnalysis","cmhcTax"]:["expertises","notary","renovations","cmhcAnalysis","cmhcTax","otherFees"];i.workCost!==void 0&&ge.push("workCost"),i.ignoreLTV||ge.push("welcomeTax");const xe=ge.reduce((Xe,ke)=>Xe+(parseFloat(i[ke])||0),0)+me,be=U+xe,$e=r/a,ve=r>0?B/r*100:0,Ne=be>0?ie/be*100:0,je=ee>0?re/ee:0,De=m>0?r/m:0,Ue=B>0?r/B:0;let He=0;if(M>0){let Xe=C;for(let ke=0;ke<12;ke++){const tt=Xe*D,Qe=M-tt;He+=Qe,Xe-=Qe}}const nt=U>0?He/be*100:0,Yt=.03,cn=U>0?r*Yt/be*100:0,Et=r>0?S/r*100:0,Vn=Ne+nt+cn,On=ie+He+r*Yt;return{totalGrossRevenue:m,effectiveGrossRevenue:_,vacancyAmount:y,operatingExpensesSCHL:Z,operatingExpensesTotal:se,totalExpenses:ne,netOperatingIncome:B,effectiveNetIncome:re,maxLoanAmount:S,cmhcPremium:X,cmhcTax:ae,totalLoanAmount:C,downPayment:U,economicValue:de,monthlyPayment:M,annualDebtService:ee,maxDebtService:A,cashFlow:ie,acquisitionCosts:xe,totalInvestment:be,pricePerUnit:$e,capRate:ve,cashOnCashReturn:Ne,actualDebtCoverageRatio:je,grossRentMultiplier:De,netIncomeMultiplier:Ue,loanPaydownReturn:nt,appreciationReturn:cn,loanValueRatio:Et,mortgageRate:P*100,totalReturn:Vn,valueGeneratedYear1:On,originationFee:me}},fj=Object.freeze(Object.defineProperty({__proto__:null,default:Wi},Symbol.toStringTag,{value:"Module"}));function Dt(i){return i==null?"":typeof i=="number"?i.toString():i.toString().replace(/[\s$%]/g,"").replace(",",".")}const Au={address:"",city:"",province:"",postalCode:"",askingPrice:"",purchasePrice:"",municipalEvaluation:"",numberOfUnits:"",structureType:"woodFrame",annualRent:"",parkingRevenue:"",internetRevenue:"",storageRevenue:"",otherRevenue:"",municipalTaxes:"",schoolTaxes:"",insurance:"",electricityHeating:"",maintenance:"610",concierge:"365",managementRate:"5",operatingExpenses:"",otherExpenses:"",vacancyRate:"3",heating:"",electricity:"",landscaping:"",snowRemoval:"",extermination:"",fireInspection:"",advertising:"",legal:"",accounting:"",elevator:"",cableInternet:"",appliances:"",garbage:"",washerDryer:"",hotWater:"",numFridges:"",numStoves:"",numDishwashers:"",numWashers:"",numDryers:"",numHeatPumps:"",numElevators:"",financingType:"conventional",aphPoints:"",debtCoverageRatio:"1.15",qualificationRate:"6.0",mortgageRate:"5.5",amortization:"25",term:"5",inspection:"",environmental1:"",environmental2:"",environmental3:"",otherTests:"",appraiser:"",expertises:"",notary:"",renovations:"",cmhcAnalysis:"150",cmhcTax:"",welcomeTax:"",appreciationRate:2.5,rentIncreaseRate:2,expenseIncreaseRate:2.5},mj=/^-?[\d\s.,$()%]+$/;function pg(i,e,{removeEmpty:t=!1}={}){return Object.entries(e||{}).forEach(([r,a])=>{if(a==null){t||(i[r]=a);return}if(typeof a=="number"){i[r]=a;return}if(typeof a=="string"){const l=a.trim();if(l===""){t||(i[r]="");return}if(mj.test(l)){const u=Dt(a).replace(/[()]/g,"");if(u===""){t||(i[r]="");return}const h=l.startsWith("(")&&l.endsWith(")"),m=Number(u);if(!Number.isNaN(m)){i[r]=h?-m:m;return}}i[r]=a;return}i[r]=a}),i}function pj(i,e,t,r=!1){if(!e)return{analysisProperty:null,analysis:null,equityWithdrawal:0};const a=(parseFloat(Dt(i.revenueGrowthPct))||0)/100,l=(parseFloat(Dt(i.expenseGrowthPct))||0)/100,u=(parseFloat(Dt(i.valueAppreciationPct))||0)/100,h=parseFloat(Dt(i.refinanceYears))||0,m=Math.max(h,0)+1,y=Math.pow(1+a,m),_=Math.pow(1+l,m),b=Number(Dt(e.purchasePrice))||0,T=parseFloat(Dt(i.marketValue))||b*Math.pow(1+u,Math.max(h,0)),I=["annualRent","parkingRevenue","internetRevenue","storageRevenue","otherRevenue"],V=["municipalTaxes","schoolTaxes","insurance","electricityHeating","maintenance","concierge","operatingExpenses","otherExpenses","heating","electricity","landscaping","snowRemoval","extermination","fireInspection","advertising","legal","accounting","elevator","cableInternet","appliances","garbage","washerDryer","hotWater"],L={};I.forEach(ue=>{const de=Dt(e[ue]);if(de==="")return;const z=Number(de);Number.isNaN(z)||(L[ue]=z*y)}),V.forEach(ue=>{const de=Dt(e[ue]);if(de==="")return;const z=Number(de);Number.isNaN(z)||(L[ue]=z*_)});const O=["inspection","environmental1","environmental2","environmental3","otherFees","appraiser","notary","renovations","cmhcAnalysis","cmhcTax","welcomeTax","expertises"],Z={...e};O.forEach(ue=>{delete Z[ue]});const se=pg({},Z),G=Number(Dt(e.numberOfUnits)),ne={...Au,...se,numberOfUnits:se.numberOfUnits??(Number.isNaN(G)?e.numberOfUnits:G),...L,purchasePrice:T},B=pg({},i.financing,{removeEmpty:!0}),re=pg({},i.financingFees,{removeEmpty:!0}),P={...ne,...B,...re,ignoreLTV:!0},S=t?{...e,...t.financing,...t.acquisitionCosts}:e,A=S?Wi(S,r):null;let M=0;if(A){const ue=A.maxLoanAmount||0;let de=0;if(["cmhc","cmhc_aph"].includes(S?.financingType)){const ee=parseFloat(S?.purchasePrice)||0,ie=ee>0?ue/ee*100:0,ge=[{ltv:65,rate:.026},{ltv:70,rate:.0285},{ltv:75,rate:.0335},{ltv:80,rate:.0435},{ltv:85,rate:.0535}],xe=parseInt(S?.aphPoints)||0,be=S.financingType==="cmhc_aph"?Math.min(ie,Su(xe)*100):ie;let $e=0;S.financingType==="cmhc_aph"&&be>85?$e=be<=90?.059:.0615:$e=ge.find(je=>be<=je.ltv)?.rate||ge.at(-1).rate;const ve=parseInt(S?.amortization)||25;if(ve>25&&($e+=(ve-25)/5*.0025),S.financingType==="cmhc_aph"){const Ne=xe>=100?.3:xe>=70?.2:xe>=50?.1:0;$e*=1-Ne}de=ue*$e}const z=ue+de,X=(parseFloat(S?.mortgageRate)||0)/100,ae=Math.pow(1+X/2,1/6)-1,C=(parseInt(S?.amortization)||25)*12,U=Math.min((parseFloat(Dt(i.refinanceYears))||0)*12,C);ae<=0?M=z:M=z*(Math.pow(1+ae,C)-Math.pow(1+ae,U))/(Math.pow(1+ae,C)-1)}const D=Wi(P,r,{initialLoanAmount:["cmhc","cmhc_aph"].includes(S?.financingType)?M:0}),k=Object.values(i.financingFees||{}).reduce((ue,de)=>ue+Number(Dt(de)||0),0),N=D.maxLoanAmount-M-k;return{analysisProperty:ne,analysis:D,equityWithdrawal:N}}function gj({onBack:i,onSaved:e,propertyId:t,initialScenario:r={},type:a="refinancing",property:l,advancedExpenses:u}){const[h,m]=q.useState({title:"",refinanceYears:"",marketValue:"",revenueGrowthPct:"2",expenseGrowthPct:"2.5",valueAppreciationPct:"3",financing:{},financingFees:{},parentScenarioId:"",...r}),[y,_]=q.useState({debtCoverage:!0}),[b,T]=q.useState(null),I=q.useRef(""),[V,L]=q.useState(!!r.id),{t:O}=ft();q.useEffect(()=>{if(!t)return;const ue=Ku(t,de=>{const z=h.parentScenarioId,X=z?de.find(ae=>ae.id===z):de.find(ae=>ae.type==="initialFinancing");T(X)});return()=>ue&&ue()},[t,h.parentScenarioId]),q.useEffect(()=>{m({title:"",refinanceYears:"",marketValue:"",revenueGrowthPct:"2",expenseGrowthPct:"2.5",valueAppreciationPct:"3",financing:{},financingFees:{},parentScenarioId:"",...r}),I.current=Cn(r.marketValue)||"",L(!!r.id)},[r.id]);const Z=(ue,de)=>{de==="debtCoverageRatio"?_(z=>({...z,debtCoverage:!1})):de==="financingType"&&_(z=>({...z,debtCoverage:!0})),m(z=>({...z,financing:ue}))},se=ue=>{m(de=>({...de,financingFees:ue}))},G=(ue,de)=>{m(z=>({...z,[ue]:de}))},ne=()=>Object.values(h.financingFees).reduce((ue,de)=>ue+Number(Cn(de)||0),0);q.useEffect(()=>{if(!l?.purchasePrice)return;const ue=Math.max(parseFloat(Cn(h.refinanceYears))||0,0);if(!ue)return;const de=parseFloat(l.purchasePrice)||0,z=(parseFloat(Cn(h.valueAppreciationPct))||0)/100,X=Math.round(de*Math.pow(1+z,ue)).toString();(!h.marketValue||h.marketValue===I.current)&&m(ae=>({...ae,marketValue:X})),I.current=X},[h.refinanceYears,l?.purchasePrice,h.valueAppreciationPct]);const{analysisProperty:B,analysis:re,equityWithdrawal:P}=q.useMemo(()=>pj(h,l,b,u),[h,l,b,u]);q.useEffect(()=>{const ue=h.financing.financingType,de=parseInt(l?.numberOfUnits)||0;if(["cmhc","cmhc_aph"].includes(ue)&&de>0){const z=(de*150).toString();h.financingFees.cmhcAnalysis!==z&&m(X=>({...X,financingFees:{...X.financingFees,cmhcAnalysis:z}}))}else h.financingFees.cmhcAnalysis&&m(z=>({...z,financingFees:{...z.financingFees,cmhcAnalysis:""}}))},[h.financing.financingType,l?.numberOfUnits,h.financingFees.cmhcAnalysis]),q.useEffect(()=>{const ue=h.financing.financingType;if(["cmhc","cmhc_aph"].includes(ue)){const de=re?.cmhcTax?Math.round(re.cmhcTax).toString():"";h.financingFees.cmhcTax!==de&&m(z=>({...z,financingFees:{...z.financingFees,cmhcTax:de}}))}else h.financingFees.cmhcTax&&m(de=>({...de,financingFees:{...de.financingFees,cmhcTax:""}}))},[re?.cmhcTax,h.financing.financingType,h.financingFees.cmhcTax]);const S=P<0,A=q.useMemo(()=>a==="refinancing"?["coc","loanPaydownReturn","appreciationReturn","totalReturn"]:[],[a]);q.useEffect(()=>{if(!y.debtCoverage)return;const ue=h.financing.financingType,de=parseInt(l?.numberOfUnits)||1;let z="1.15";ue==="cmhc"?z=de>=7?"1.3":"1.1":ue==="cmhc_aph"&&(z="1.1"),h.financing.debtCoverageRatio!==z&&m(X=>({...X,financing:{...X.financing,debtCoverageRatio:z}}))},[h.financing.financingType,l?.numberOfUnits,y.debtCoverage]);const M=async()=>{const{id:ue,...de}=h,z={...de,type:a};if(ue)await Yu(t,ue,z),e&&e({id:ue,...z});else{const X=await Nl(t,z);e&&e({id:X,...z})}},D={refinancing:O("scenarioForm.refinancing.title")}[a]||O("scenarioForm.genericTitle"),k=!!(r.id||h.id),N=()=>p.jsxs(p.Fragment,{children:[p.jsx(Sv,{financing:h.financing,onChange:Z}),p.jsx(BR,{fees:h.financingFees,onChange:se,analysis:{financingFees:ne()},isCMHC:["cmhc","cmhc_aph"].includes(h.financing.financingType)})]});return p.jsx("div",{className:"min-h-screen bg-gray-50 p-4",children:p.jsx("div",{className:"max-w-4xl mx-auto",children:p.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[p.jsxs("div",{className:"flex justify-between items-center mb-6",children:[p.jsx("h2",{className:"text-2xl font-semibold",children:D}),p.jsxs("div",{className:"flex items-center gap-2",children:[k&&p.jsx("button",{onClick:()=>L(ue=>!ue),className:"flex items-center gap-2 px-3 py-2 text-sm border border-gray-200 rounded text-gray-600 hover:text-gray-800 hover:border-gray-300",children:V?p.jsxs(p.Fragment,{children:[p.jsx(il,{className:"w-4 h-4"}),O("scenarioForm.editScenario")]}):p.jsxs(p.Fragment,{children:[p.jsx(nl,{className:"w-4 h-4"}),O("scenarioForm.viewSummary")]})}),i&&p.jsxs("button",{onClick:i,className:"text-gray-600 hover:text-gray-800",children:["← ",O("back")]})]})]}),p.jsxs("div",{className:"space-y-8",children:[V&&h.title&&p.jsxs("div",{className:"border rounded-lg p-4 bg-gray-50",children:[p.jsx("div",{className:"text-sm text-gray-500",children:O("scenarioForm.titleLabel")}),p.jsx("div",{className:"text-lg font-semibold text-gray-900",children:h.title})]}),!V&&p.jsxs("div",{className:"border rounded-lg p-6",children:[p.jsx("h2",{className:"text-lg font-semibold mb-4 text-gray-700",children:O("scenarioForm.parameters")}),p.jsxs("div",{className:"grid md:grid-cols-3 gap-4",children:[p.jsxs("div",{className:"md:col-span-3",children:[p.jsx("label",{className:"block text-sm font-medium mb-1",children:O("scenarioForm.titleLabel")}),p.jsx("input",{type:"text",value:h.title,onChange:ue=>G("title",ue.target.value),className:"w-full border rounded p-2",placeholder:O("scenarioForm.titlePlaceholder")})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium mb-1",children:O("scenarioForm.revenueGrowthPct")}),p.jsx(Ke,{value:h.revenueGrowthPct||"",onChange:ue=>G("revenueGrowthPct",ue),className:"w-full border rounded p-2",type:"percentage"})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium mb-1",children:O("scenarioForm.expenseGrowthPct")}),p.jsx(Ke,{value:h.expenseGrowthPct||"",onChange:ue=>G("expenseGrowthPct",ue),className:"w-full border rounded p-2",type:"percentage"})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium mb-1",children:O("scenarioForm.valueAppreciationPct")}),p.jsx(Ke,{value:h.valueAppreciationPct||"",onChange:ue=>G("valueAppreciationPct",ue),className:"w-full border rounded p-2",type:"percentage"})]})]}),p.jsxs("div",{className:"grid md:grid-cols-2 gap-4 mt-4",children:[p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium mb-1",children:O("scenarioForm.refinanceYears")}),p.jsx(Ke,{value:h.refinanceYears||"",onChange:ue=>G("refinanceYears",ue),className:"w-full border rounded p-2"})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium mb-1",children:O("scenarioForm.marketValue")}),p.jsx(Ke,{value:h.marketValue||"",onChange:ue=>G("marketValue",ue),className:"w-full border rounded p-2",type:"currency"})]})]})]}),!V&&N(),re&&p.jsxs(p.Fragment,{children:[p.jsx(bf,{analysis:re,variant:"future",exclude:A}),p.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[p.jsx(xf,{analysis:re,advancedExpenses:u}),p.jsx(Ef,{analysis:re,currentProperty:B,equityAmount:P})]})]}),S&&p.jsx("div",{className:"text-red-600 text-sm text-right",children:O("scenarioForm.notPossible")}),!V&&p.jsx("div",{className:"flex justify-end",children:e&&p.jsx("button",{onClick:M,disabled:S,className:`px-6 py-2 text-white rounded-lg hover:bg-blue-700 ${S?"bg-blue-300 cursor-not-allowed":"bg-blue-600"}`,children:O("save")})})]})]})})})}function yj(i,e,t,r=!1){if(!e)return{analysisProperty:null,combinedFinancing:null,analysis:null};const a=t?{...e,...t.financing,...t.acquisitionCosts}:e,l=a?Wi(a,r):null;let u=0,h=0;if(l){const De=l.maxLoanAmount||0,Ue=l.totalLoanAmount||De,He=(parseFloat(a?.mortgageRate)||0)/100,nt=Math.pow(1+He/2,1/6)-1,cn=(parseInt(a?.amortization)||25)*12,Et=Math.min((parseInt(a?.term)||0)*12,cn);if(nt<=0)u=Ue,h=De;else{const Vn=Ue*(Math.pow(1+nt,cn)-Math.pow(1+nt,Et))/(Math.pow(1+nt,cn)-1),On=Vn/Ue;u=Vn,h=De*On}}const m=(()=>{const De=parseInt(a?.amortization)||25,Ue=parseInt(a?.term)||0;return Math.max(De-Ue,0)})(),y=(parseFloat(Dt(i.revenueGrowthPct))||0)/100,_=(parseFloat(Dt(i.expenseGrowthPct))||0)/100,b=(parseFloat(Dt(i.valueAppreciationPct))||0)/100,T=parseInt(t?.financing?.term)||0,I=Math.pow(1+y,Math.max(T,0)),V=Math.pow(1+_,Math.max(T,0)),O=(parseFloat(e.purchasePrice)||0)*Math.pow(1+b,Math.max(T,0)),Z=["annualRent","parkingRevenue","internetRevenue","storageRevenue","otherRevenue"],se=["municipalTaxes","schoolTaxes","insurance","electricityHeating","maintenance","concierge","operatingExpenses","otherExpenses","heating","electricity","landscaping","snowRemoval","extermination","fireInspection","advertising","legal","accounting","elevator","cableInternet","appliances","garbage","washerDryer","hotWater"],G={};Z.forEach(De=>{const Ue=parseFloat(e[De]);isNaN(Ue)||(G[De]=Ue*I)}),se.forEach(De=>{const Ue=parseFloat(e[De]);isNaN(Ue)||(G[De]=Ue*V)});const ne=["inspection","environmental1","environmental2","environmental3","otherFees","appraiser","notary","renovations","cmhcAnalysis","cmhcTax","welcomeTax","expertises"],B={...e};ne.forEach(De=>{delete B[De]});const re={...B,...G,purchasePrice:O},P=t?.financing||{},S=i.financing.mortgageRate||P.mortgageRate||"",A={...P,...i.financing,mortgageRate:S,qualificationRate:S,amortization:m.toString()},M={...re,...A},D=Wi(M,r,{initialLoanAmount:["cmhc","cmhc_aph"].includes(a?.financingType)?u:0}),k=(parseFloat(A.mortgageRate)||0)/100,N=Math.pow(1+k/2,1/6)-1,ue=(parseInt(A.amortization)||0)*12,de=u,z=de>0&&N>0?de*(N*Math.pow(1+N,ue))/(Math.pow(1+N,ue)-1):0,X=z*12,ae=D.effectiveNetIncome-X,me=parseFloat(re?.purchasePrice)||0,C=me-u,U=C+D.acquisitionCosts;let ee=0;if(z>0){let De=de;for(let Ue=0;Ue<12;Ue++){const He=De*N,nt=z-He;ee+=nt,De-=nt}}const ie=U>0?ee/U*100:0,ge=(parseFloat(Dt(i.valueAppreciationPct))||0)/100,xe=U>0?me*ge/U*100:0,be=U>0?ae/U*100:0,$e=be+ie+xe,ve=ae+ee+me*ge,Ne=me>0?de/me*100:0,je={...D,maxLoanAmount:h,totalLoanAmount:de,cmhcPremium:0,monthlyPayment:z,annualDebtService:X,cashFlow:ae,downPayment:C,totalInvestment:U,loanValueRatio:Ne,cashOnCashReturn:be,loanPaydownReturn:ie,appreciationReturn:xe,totalReturn:$e,valueGeneratedYear1:ve};return{analysisProperty:re,combinedFinancing:A,analysis:je}}function vj({onBack:i,onSaved:e,propertyId:t,initialScenario:r={},property:a,advancedExpenses:l}){const[u,h]=q.useState({title:"",revenueGrowthPct:"2",expenseGrowthPct:"2.5",valueAppreciationPct:"3",financing:{},parentScenarioId:"",...r}),[m,y]=q.useState(null),[_,b]=q.useState(!!r.id),{t:T}=ft();q.useEffect(()=>{if(!t)return;const B=Ku(t,re=>{const P=u.parentScenarioId,S=P?re.find(A=>A.id===P):re.find(A=>A.type==="initialFinancing");y(S)});return()=>B&&B()},[t,u.parentScenarioId]),q.useEffect(()=>{h({title:"",revenueGrowthPct:"2",expenseGrowthPct:"2.5",valueAppreciationPct:"3",financing:{},parentScenarioId:"",...r}),b(!!r.id)},[r.id]);const I=B=>{h(re=>({...re,financing:B}))},V=(B,re)=>{h(P=>({...P,[B]:re}))};q.useEffect(()=>{const{term:B,mortgageRate:re}=u.financing,P=B?`${B} ans`:"(nouveau terme)",S=re?Rg(re):"(nouveau taux d'intérêt)",A=`Renouvellement ${P} à ${S}`;u.title!==A&&h(M=>({...M,title:A}))},[u.financing.term,u.financing.mortgageRate]);const{analysisProperty:L,combinedFinancing:O,analysis:Z}=q.useMemo(()=>yj(u,a,m,l),[u,a,m,l]),se=async()=>{const{id:B,marketValue:re,netIncomeIncreasePct:P,...S}=u,A={...S,type:"renewal",financing:O};if(B)await Yu(t,B,A),e&&e({id:B,...A});else{const M=await Nl(t,A);e&&e({id:M,...A})}},G=T("scenarioForm.renewal.title"),ne=!!(r.id||u.id);return p.jsx("div",{className:"min-h-screen bg-gray-50 p-4",children:p.jsx("div",{className:"max-w-4xl mx-auto",children:p.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[p.jsxs("div",{className:"flex justify-between items-center mb-6",children:[p.jsx("h2",{className:"text-2xl font-semibold",children:G}),p.jsxs("div",{className:"flex items-center gap-2",children:[ne&&p.jsx("button",{onClick:()=>b(B=>!B),className:"flex items-center gap-2 px-3 py-2 text-sm border border-gray-200 rounded text-gray-600 hover:text-gray-800 hover:border-gray-300",children:_?p.jsxs(p.Fragment,{children:[p.jsx(il,{className:"w-4 h-4"}),T("scenarioForm.editScenario")]}):p.jsxs(p.Fragment,{children:[p.jsx(nl,{className:"w-4 h-4"}),T("scenarioForm.viewSummary")]})}),i&&p.jsxs("button",{onClick:i,className:"text-gray-600 hover:text-gray-800",children:["← ",T("back")]})]})]}),p.jsxs("div",{className:"space-y-8",children:[_&&u.title&&p.jsxs("div",{className:"border rounded-lg p-4 bg-gray-50",children:[p.jsx("div",{className:"text-sm text-gray-500",children:T("scenarioForm.titleLabel")}),p.jsx("div",{className:"text-lg font-semibold text-gray-900",children:u.title})]}),!_&&p.jsxs("div",{className:"border rounded-lg p-6",children:[p.jsx("h2",{className:"text-lg font-semibold mb-4 text-gray-700",children:T("scenarioForm.parameters")}),p.jsxs("div",{className:"grid md:grid-cols-3 gap-4",children:[p.jsxs("div",{className:"md:col-span-3",children:[p.jsx("label",{className:"block text-sm font-medium mb-1",children:T("scenarioForm.titleLabel")}),p.jsx("input",{type:"text",value:u.title,readOnly:!0,className:"w-full border rounded p-2 bg-gray-100"})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium mb-1",children:T("scenarioForm.revenueGrowthPct")}),p.jsx(Ke,{value:u.revenueGrowthPct||"",onChange:B=>V("revenueGrowthPct",B),className:"w-full border rounded p-2",type:"percentage"})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium mb-1",children:T("scenarioForm.expenseGrowthPct")}),p.jsx(Ke,{value:u.expenseGrowthPct||"",onChange:B=>V("expenseGrowthPct",B),className:"w-full border rounded p-2",type:"percentage"})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium mb-1",children:T("scenarioForm.valueAppreciationPct")}),p.jsx(Ke,{value:u.valueAppreciationPct||"",onChange:B=>V("valueAppreciationPct",B),className:"w-full border rounded p-2",type:"percentage"})]})]})]}),!_&&p.jsxs("div",{className:"border rounded-lg p-6",children:[p.jsx("h2",{className:"text-lg font-semibold mb-4 text-purple-600",children:T("financing.title")}),p.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium mb-1",children:T("scenarioForm.newInterestRate")}),p.jsx(Ke,{value:u.financing.mortgageRate||"",onChange:B=>I({...u.financing,mortgageRate:B}),className:"w-full border rounded p-2",type:"percentage"})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium mb-1",children:T("financing.term")}),p.jsxs("select",{value:u.financing.term||"",onChange:B=>I({...u.financing,term:B.target.value}),className:"w-full border rounded p-2",children:[p.jsx("option",{value:"1",children:"1 an"}),p.jsx("option",{value:"2",children:"2 ans"}),p.jsx("option",{value:"3",children:"3 ans"}),p.jsx("option",{value:"5",children:"5 ans"}),p.jsx("option",{value:"10",children:"10 ans"})]})]})]})]}),Z&&p.jsxs(p.Fragment,{children:[p.jsx(bf,{analysis:Z,variant:"future"}),p.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[p.jsx(xf,{analysis:Z,advancedExpenses:l}),p.jsx(Ef,{analysis:Z,currentProperty:L,financing:O,scenarioType:"renewal"})]})]}),!_&&p.jsx("div",{className:"flex justify-end",children:e&&p.jsx("button",{onClick:se,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:T("save")})})]})]})})})}const _j=/^-?[\d\s.,$()%]+$/;function wd(i,e,{removeEmpty:t=!1}={}){return Object.entries(e||{}).forEach(([r,a])=>{if(a==null){t||(i[r]=a);return}if(typeof a=="number"){i[r]=a;return}if(typeof a=="string"){const l=a.trim();if(l===""){t||(i[r]="");return}if(_j.test(l)){const u=Dt(a).replace(/[()]/g,"");if(u===""){t||(i[r]="");return}const h=l.startsWith("(")&&l.endsWith(")"),m=Number(u);if(!Number.isNaN(m)){i[r]=h?-m:m;return}}i[r]=a;return}i[r]=a}),i}function HR(i,e,t,r=!1){if(!e)return{analysisProperty:null,analysis:null,equityWithdrawal:0};const a=wd({},{...i.revenue,...i.operatingExpenses},{removeEmpty:!0}),l=parseFloat(Dt(i.marketValue))||0,u=["inspection","environmental1","environmental2","environmental3","otherFees","appraiser","notary","renovations","cmhcAnalysis","cmhcTax","welcomeTax","expertises","workCost"],h={...e};u.forEach(A=>{delete h[A]});const m=wd({},h),y=Number(Dt(e.numberOfUnits)),_={...Au,...m,numberOfUnits:a.numberOfUnits??m.numberOfUnits??(Number.isNaN(y)?e.numberOfUnits:y),purchasePrice:l,...a},b=wd({},i.financing,{removeEmpty:!0}),T=wd({},i.financingFees,{removeEmpty:!0}),I={..._,...b,...T,ignoreLTV:!0},V=t?{...e,...t.financing,...t.acquisitionCosts}:e,L=V?Wi(V,r):null;let O=0,Z=0;if(L){const A=L.maxLoanAmount||0;Z=A;let M=0;if(["cmhc","cmhc_aph"].includes(V?.financingType)){const X=parseFloat(V?.purchasePrice)||0,ae=X>0?A/X*100:0,me=[{ltv:65,rate:.026},{ltv:70,rate:.0285},{ltv:75,rate:.0335},{ltv:80,rate:.0435},{ltv:85,rate:.0535}],C=parseInt(V?.aphPoints)||0,U=V.financingType==="cmhc_aph"?Math.min(ae,Su(C)*100):ae;let ee=0;V.financingType==="cmhc_aph"&&U>85?ee=U<=90?.059:.0615:ee=me.find(xe=>U<=xe.ltv)?.rate||me.at(-1).rate;const ie=parseInt(V?.amortization)||25;if(ie>25&&(ee+=(ie-25)/5*.0025),V.financingType==="cmhc_aph"){const ge=C>=100?.3:C>=70?.2:C>=50?.1:0;ee*=1-ge}M=A*ee}const D=A+M,k=(parseFloat(V?.mortgageRate)||0)/100,N=Math.pow(1+k/2,1/6)-1,de=(parseInt(V?.amortization)||25)*12,z=Math.min((parseFloat(Dt(i.refinanceYears))||0)*12,de);N<=0?O=D:O=D*(Math.pow(1+N,de)-Math.pow(1+N,z))/(Math.pow(1+N,de)-1)}const se=I?.financingType,G=Wi(I,r,{initialLoanAmount:["cmhc","cmhc_aph"].includes(se)?Z:0}),ne=Object.values(i.financingFees||{}).reduce((A,M)=>A+Number(Dt(M)||0),0),B=G.maxLoanAmount-O-ne;let re=G;if(G&&typeof G.economicValue=="number"&&typeof G.totalLoanAmount=="number"){const A=G.economicValue-G.totalLoanAmount;re={...G,downPayment:A}}const P=Number(Dt(i.financingFees?.workCost||0))||0,S=L&&re?{base:{totalGrossRevenue:L.totalGrossRevenue??null,totalExpenses:L.totalExpenses??null,netOperatingIncome:L.netOperatingIncome??null,capRate:L.capRate??null,cashOnCashReturn:L.cashOnCashReturn??null},optimized:{totalGrossRevenue:re.totalGrossRevenue??null,totalExpenses:re.totalExpenses??null,netOperatingIncome:re.netOperatingIncome??null,capRate:re.capRate??null,cashOnCashReturn:re.cashOnCashReturn??null},workCost:P,noiIncrease:(re.netOperatingIncome??0)-(L.netOperatingIncome??0)}:null;return{analysisProperty:_,analysis:re&&{...re,optimizationComparison:S},equityWithdrawal:B}}const gg={title:"",refinanceYears:"",marketValue:"",financing:{},financingFees:{},revenue:{},operatingExpenses:{vacancyRate:Au.vacancyRate,maintenance:"",managementRate:"",concierge:""},parentScenarioId:""};function bj({onBack:i,onSaved:e,propertyId:t,initialScenario:r={},type:a="optimization",property:l,advancedExpenses:u}){const h=(X={})=>{const ae=xe=>xe==null||xe===""?"":typeof xe=="number"?xe.toString():xe,me=parseInt(l?.numberOfUnits)||0,C=l?.province,U=l?.structureType||"woodFrame",ee=C?fy[C]:null;let ie;ee&&(U==="woodFrame"?ie=ee.woodFrame[me<=11?"small":"large"]:ie=ee.concrete.any);const ge={vacancyRate:ae(l?.vacancyRate)||gg.operatingExpenses.vacancyRate,maintenance:ie?ie.maintenance.toString():ae(l?.maintenance),managementRate:ie?ie.managementRate.toString():ae(l?.managementRate),concierge:ie?ie.salaries.toString():ae(l?.concierge),province:C||"",structureType:U};return{...gg,...X,operatingExpenses:{...gg.operatingExpenses,...ge,...X.operatingExpenses||{}}}},[m,y]=q.useState(h(r)),[_,b]=q.useState({debtCoverage:!0}),[T,I]=q.useState(null),V=q.useRef(""),[L,O]=q.useState(!!r.id),{t:Z}=ft();q.useEffect(()=>{if(!t)return;const X=Ku(t,ae=>{const me=m.parentScenarioId,C=me?ae.find(U=>U.id===me):ae.find(U=>U.type==="initialFinancing");I(C)});return()=>X&&X()},[t,m.parentScenarioId]),q.useEffect(()=>{y(h(r)),V.current=Cn(r.marketValue)||"",O(!!r.id)},[r.id]);const se=(X,ae)=>{ae==="debtCoverageRatio"?b(me=>({...me,debtCoverage:!1})):ae==="financingType"&&b(me=>({...me,debtCoverage:!0})),y(me=>({...me,financing:X}))},G=X=>{y(ae=>({...ae,financingFees:X}))},ne=X=>{y(ae=>({...ae,revenue:X}))},B=X=>{y(ae=>{const me={numberOfUnits:l?.numberOfUnits,...ae.revenue,...ae.operatingExpenses},C=typeof X=="function"?X(me):X,U=["annualRent","parkingRevenue","internetRevenue","storageRevenue","otherRevenue"],ee={},ie={};return Object.entries(C).forEach(([ge,xe])=>{U.includes(ge)?ee[ge]=xe:ge!=="numberOfUnits"&&(ie[ge]=xe)}),{...ae,revenue:{...ae.revenue,...ee},operatingExpenses:ie}})},re=(X,ae)=>{y(me=>({...me,[X]:ae}))},P=()=>Object.values(m.financingFees).reduce((X,ae)=>X+Number(Cn(ae)||0),0);q.useEffect(()=>{if(!l?.purchasePrice)return;const X=Math.max(parseFloat(Cn(m.refinanceYears))||0,0);if(!X||!l?.purchasePrice||!m.refinanceYears)return;const ae=parseFloat(l.purchasePrice)||0,me=Math.round(ae*Math.pow(1+.03,X)).toString();(!m.marketValue||m.marketValue===V.current)&&y(C=>({...C,marketValue:me})),V.current=me},[m.refinanceYears,l?.purchasePrice]);const{analysisProperty:S,analysis:A,equityWithdrawal:M}=q.useMemo(()=>HR(m,l,T,u),[m,l,T,u]);q.useEffect(()=>{const X=m.financing.financingType,ae=parseInt(l?.numberOfUnits)||0;if(["cmhc","cmhc_aph"].includes(X)&&ae>0){const me=(ae*150).toString();m.financingFees.cmhcAnalysis!==me&&y(C=>({...C,financingFees:{...C.financingFees,cmhcAnalysis:me}}))}else m.financingFees.cmhcAnalysis&&y(me=>({...me,financingFees:{...me.financingFees,cmhcAnalysis:""}}))},[m.financing.financingType,l?.numberOfUnits,m.financingFees.cmhcAnalysis]),q.useEffect(()=>{const X=m.financing.financingType;if(["cmhc","cmhc_aph"].includes(X)){const ae=A?.cmhcTax?Math.round(A.cmhcTax).toString():"";m.financingFees.cmhcTax!==ae&&y(me=>({...me,financingFees:{...me.financingFees,cmhcTax:ae}}))}else m.financingFees.cmhcTax&&y(ae=>({...ae,financingFees:{...ae.financingFees,cmhcTax:""}}))},[A?.cmhcTax,m.financing.financingType,m.financingFees.cmhcTax]);const D=M<0,k=q.useMemo(()=>["coc","loanPaydownReturn","appreciationReturn","totalReturn","investmentEfficiency","paybackPeriod"],[]);q.useEffect(()=>{if(!_.debtCoverage)return;const X=m.financing.financingType,ae=parseInt(l?.numberOfUnits)||1;let me="1.15";X==="cmhc"?me=ae>=7?"1.3":"1.1":X==="cmhc_aph"&&(me="1.1"),m.financing.debtCoverageRatio!==me&&y(C=>({...C,financing:{...C.financing,debtCoverageRatio:me}}))},[m.financing.financingType,l?.numberOfUnits,_.debtCoverage]);const N=async()=>{const{id:X,...ae}=m,me={...ae,type:a};if(X)await Yu(t,X,me),e&&e({id:X,...me});else{const C=await Nl(t,me);e&&e({id:C,...me})}},ue=Z("scenarioForm.optimization.title"),de=!!(r.id||m.id),z=()=>p.jsxs(p.Fragment,{children:[p.jsx(dy,{revenue:m.revenue,onChange:ne,advancedExpenses:u}),p.jsx(my,{expenses:{numberOfUnits:l?.numberOfUnits,province:l?.province,structureType:l?.structureType,...m.revenue,...m.operatingExpenses},onChange:B,advancedExpenses:u}),p.jsx(Sv,{financing:m.financing,onChange:se}),p.jsx(BR,{fees:m.financingFees,onChange:G,analysis:{financingFees:P()},isCMHC:["cmhc","cmhc_aph"].includes(m.financing.financingType),includeWorkCost:!0})]});return p.jsx("div",{className:"min-h-screen bg-gray-50 p-4",children:p.jsx("div",{className:"max-w-4xl mx-auto",children:p.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[p.jsxs("div",{className:"flex justify-between items-center mb-6",children:[p.jsx("h2",{className:"text-2xl font-semibold",children:ue}),p.jsxs("div",{className:"flex items-center gap-2",children:[de&&p.jsx("button",{onClick:()=>O(X=>!X),className:"flex items-center gap-2 px-3 py-2 text-sm border border-gray-200 rounded text-gray-600 hover:text-gray-800 hover:border-gray-300",children:L?p.jsxs(p.Fragment,{children:[p.jsx(il,{className:"w-4 h-4"}),Z("scenarioForm.editScenario")]}):p.jsxs(p.Fragment,{children:[p.jsx(nl,{className:"w-4 h-4"}),Z("scenarioForm.viewSummary")]})}),i&&p.jsxs("button",{onClick:i,className:"text-gray-600 hover:text-gray-800",children:["← ",Z("back")]})]})]}),p.jsxs("div",{className:"space-y-8",children:[L&&m.title&&p.jsxs("div",{className:"border rounded-lg p-4 bg-gray-50",children:[p.jsx("div",{className:"text-sm text-gray-500",children:Z("scenarioForm.titleLabel")}),p.jsx("div",{className:"text-lg font-semibold text-gray-900",children:m.title})]}),!L&&p.jsxs("div",{className:"border rounded-lg p-6",children:[p.jsx("h2",{className:"text-lg font-semibold mb-4 text-gray-700",children:Z("scenarioForm.parameters")}),p.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium mb-1",children:Z("scenarioForm.titleLabel")}),p.jsx("input",{type:"text",value:m.title,onChange:X=>re("title",X.target.value),className:"w-full border rounded p-2",placeholder:Z("scenarioForm.titlePlaceholder")})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium mb-1",children:Z("scenarioForm.refinanceYears")}),p.jsx(Ke,{value:m.refinanceYears||"",onChange:X=>re("refinanceYears",X),className:"w-full border rounded p-2"})]})]})]}),!L&&z(),A&&p.jsxs(p.Fragment,{children:[p.jsx(bf,{analysis:A,variant:"optimization",exclude:k}),p.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[p.jsx(xf,{analysis:A,advancedExpenses:u}),p.jsx(Ef,{analysis:A,currentProperty:S,equityAmount:M,scenarioType:a})]})]}),D&&p.jsx("div",{className:"text-red-600 text-sm text-right",children:Z("scenarioForm.notPossible")}),!L&&p.jsx("div",{className:"flex justify-end",children:e&&p.jsx("button",{onClick:N,disabled:D,className:`px-6 py-2 text-white rounded-lg hover:bg-blue-700 ${D?"bg-blue-300 cursor-not-allowed":"bg-blue-600"}`,children:Z("save")})})]})]})})})}function xj(i){const e=m=>i.reduce((y,_,b)=>y+_/Math.pow(1+m,b),0);let t=-.9999,r=1,a=e(t),l=e(r);const u=1024;for(;a*l>0&&r<u;)r*=2,l=e(r);if(a*l>0)return 0;let h=0;for(let m=0;m<1e3;m++){h=(t+r)/2;const y=e(h);if(Math.abs(y)<1e-7)break;y*a<0?(r=h,l=y):(t=h,a=y)}return h}function Ej(i,e,t,r=.02,a=.025,l=.03,u=null,h=null){const m=parseInt(t,10);if(!e||!i||!m||m<=0)return{totalReturn:0,annualizedReturn:0,internalRateOfReturn:0,valueGenerated:0};const y=e.effectiveGrossRevenue||0,_=e.operatingExpensesTotal||0,b=e.annualDebtService||0,T=e.totalInvestment||0,I=parseFloat(i.purchasePrice)||0,V=(parseFloat(i.mortgageRate)||5.5)/100;parseInt(i.amortization);let L=Math.pow(1+V/2,1/6)-1;i.financingType==="private"&&(L=V/12);const O=e.monthlyPayment||0,Z=e.totalLoanAmount||0,se=u&&parseFloat(u.refinanceYears)||0,G=u&&u.financing?(parseFloat(u.financing.mortgageRate)||0)/100:V;let ne=Math.pow(1+G/2,1/6)-1;u&&u.financing?.financingType==="private"&&(ne=G/12);const B=u?h?.monthlyPayment??0:O,re=u?h?.annualDebtService??B*12:b,P=h?.effectiveGrossRevenue??null,S=h?.operatingExpensesTotal??null,A=P!=null||S!=null;let M=y,D=_,k=0;const N=[-T];let ue=Z,de=0,z=!1;for(let be=1;be<=m;be++){const $e=u&&be>se;let ve=!1,Ne=!1;$e&&!z&&A&&(P!=null&&(M=P,ve=!0),S!=null&&(D=S,Ne=!0),z=!0),be>1&&(ve||(M*=1+r),Ne||(D*=1+a));const je=M-D-($e?re:b);k+=je,N.push(je);const De=$e?ne:L,Ue=$e?B:O;for(let He=0;He<12&&ue>0;He++){const nt=ue*De,Yt=Math.min(Ue-nt,ue);de+=Yt,ue-=Yt}if(be===se&&h&&m>se){const He=h.totalLoanAmount||0,nt=He-ue;k+=nt,N[be]+=nt,ue=He,de=0}}const X=I*Math.pow(1+l,m),ae=X-I,me=k+de+ae,C=T>0?me/T*100:0,U=C>-100&&m>0?(Math.pow(1+C/100,1/m)-1)*100:0,ge=(u&&h?.economicValue!=null&&m>se?h.economicValue:X)-ue;N.length>1&&(N[m]+=ge);const xe=T>0?xj(N)*100:0;return{totalReturn:C,annualizedReturn:U,internalRateOfReturn:xe,valueGenerated:me}}const yg=2,vg=2.5,_g=3,Tj=({currentProperty:i,setCurrentStep:e,analysis:t,onSave:r,advancedExpenses:a,scenario:l,onViewAmortization:u})=>{const{t:h}=ft(),m={refinancing:h("scenario.refinancing"),renewal:h("scenario.renewal"),optimization:h("scenario.optimization"),other:h("scenario.other")},y=ve=>new Intl.NumberFormat("fr-CA",{style:"currency",currency:"CAD",minimumFractionDigits:0,maximumFractionDigits:0}).format(ve||0),_=ve=>`${new Intl.NumberFormat("fr-CA",{minimumFractionDigits:2,maximumFractionDigits:2}).format(ve||0)}%`,b=q.useMemo(()=>l?{...i,...l.financing,...l.acquisitionCosts}:i,[i,l]),T=[b.address,b.city,b.province,b.postalCode].filter(Boolean).join(", "),I=q.useMemo(()=>l?Wi(b,a):t,[l,b,a,t]),V=(parseFloat(b.annualRent)||0)/(parseInt(b.numberOfUnits)||1)/12,[L,O]=q.useState(5),[Z,se]=q.useState(yg),[G,ne]=q.useState(vg),[B,re]=q.useState(_g),[P,S]=q.useState([]),[A,M]=q.useState(""),D=q.useMemo(()=>P.find(ve=>ve.id===A),[P,A]),k=q.useRef({income:yg,expense:vg,value:_g}),N=q.useRef(null),ue=q.useMemo(()=>{if(!D)return null;if(D.type==="refinancing"){const ve=parseFloat(D.refinanceYears)||0,Ne=Math.pow(1+(parseFloat(D.revenueGrowthPct)||0)/100,ve),je=Math.pow(1+(parseFloat(D.expenseGrowthPct)||0)/100,ve),De=(parseFloat(D.valueAppreciationPct)||0)/100,Ue=parseFloat(i.purchasePrice)||0,He=parseFloat(D.marketValue)||Ue*Math.pow(1+De,ve),nt=["annualRent","parkingRevenue","internetRevenue","storageRevenue","otherRevenue"],Yt=["municipalTaxes","schoolTaxes","insurance","electricityHeating","maintenance","concierge","operatingExpenses","otherExpenses","heating","electricity","landscaping","snowRemoval","extermination","fireInspection","advertising","legal","accounting","elevator","cableInternet","appliances","garbage","washerDryer","hotWater"],cn=["inspection","environmental1","environmental2","environmental3","otherFees","appraiser","notary","renovations","cmhcAnalysis","cmhcTax","welcomeTax","expertises"],Et={...i};cn.forEach(tt=>delete Et[tt]);const Vn={};nt.forEach(tt=>{const Qe=parseFloat(Et[tt]);isNaN(Qe)||(Vn[tt]=Qe*Ne)}),Yt.forEach(tt=>{const Qe=parseFloat(Et[tt]);isNaN(Qe)||(Vn[tt]=Qe*je)});const On={...Et,...Vn,purchasePrice:He,...D.financing,...D.financingFees,ignoreLTV:!0};let Xe=parseFloat(D.financing?.existingLoanBalance)||0;const ke=I?.maxLoanAmount||0;if(Xe===0&&["cmhc","cmhc_aph"].includes(i.financingType)){const tt=Ue>0?ke/Ue*100:0,Qe=parseInt(i.aphPoints)||0,ni=i.financingType==="cmhc_aph"?Math.min(tt,Su(Qe)*100):tt;let Tn=0;if(i.financingType==="cmhc_aph"&&ni>85)Tn=ni<=90?.059:.0615;else{const Fn=[{ltv:65,rate:.026},{ltv:70,rate:.0285},{ltv:75,rate:.0335},{ltv:80,rate:.0435},{ltv:85,rate:.0535}];Tn=Fn.find(Un=>ni<=Un.ltv)?.rate||Fn.at(-1).rate}const mt=parseInt(i.amortization)||25;if(mt>25&&(Tn+=(mt-25)/5*.0025),i.financingType==="cmhc_aph"){const Fn=Qe>=100?.3:Qe>=70?.2:Qe>=50?.1:0;Tn*=1-Fn}const rt=ke*Tn,wn=ke+rt,$t=(parseFloat(i.mortgageRate)||0)/100;let Ji=i.financingType==="private"?$t/12:Math.pow(1+$t/2,1/6)-1;const Hs=mt*12,Zi=Math.min(ve*12,Hs);Ji>0?Xe=wn*(Math.pow(1+Ji,Hs)-Math.pow(1+Ji,Zi))/(Math.pow(1+Ji,Hs)-1):Xe=ke}return Wi(On,a,{initialLoanAmount:Xe})}else if(D.type==="optimization"){const ve=l&&(l.id===D.parentScenarioId||l.parentScenarioId===D.parentScenarioId)?l:P.find(je=>je.id===D.parentScenarioId),{analysis:Ne}=HR(D,i,ve,a);return Ne}return null},[D,i,I,a,l,P]),[de,z]=q.useState(!1),{totalReturn:X,annualizedReturn:ae,internalRateOfReturn:me}=q.useMemo(()=>Ej(b,I,L,Z/100,G/100,B/100,D,ue),[b,I,L,Z,G,B,D,ue]),[C,U]=q.useState(null),ee=q.useRef(null),ie=l?l.parentScenarioId||l.id:null;q.useEffect(()=>{if(!i?.id)return;const ve=Ku(i.id,Ne=>{const je=ie?Ne.filter(De=>De.parentScenarioId===ie&&De.type!=="renewal"):Ne.filter(De=>De.type!=="renewal");S(je),M(De=>je.some(Ue=>Ue.id===De)?De:"")});return()=>ve&&ve()},[i?.id,ie]),q.useEffect(()=>{const ve=N.current,Ne=Number.isFinite(k.current.income)?k.current.income:yg,je=Number.isFinite(k.current.expense)?k.current.expense:vg,De=Number.isFinite(k.current.value)?k.current.value:_g;if(D?.type==="refinancing"){const Ue=parseFloat(D.revenueGrowthPct),He=parseFloat(D.expenseGrowthPct),nt=parseFloat(D.valueAppreciationPct);se(Number.isFinite(Ue)?Ue:0),ne(Number.isFinite(He)?He:0),re(Number.isFinite(nt)?nt:0)}else(D?.type==="optimization"||!D&&ve)&&(se(Ne),ne(je),re(De));!D&&ve&&(k.current={income:Ne,expense:je,value:De}),N.current=D},[D]);const ge=D?.type==="refinancing",xe=D?.type==="optimization",be=async()=>{if(!ee.current){console.error("Référence du rapport introuvable");return}try{console.log("Début de la génération PDF...");const Ne=ee.current.cloneNode(!0);Ne.querySelectorAll("button, .no-print").forEach(ke=>ke.remove());const De=`
      <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { 
          font-family: Arial, sans-serif; 
          line-height: 1.4; 
          color: #333; 
          padding: 20px;
        }
        .text-gray-600 { color: #4b5563; }
        .text-green-600 { color: #16a34a; }
        .text-red-600 { color: #dc2626; }
        .font-semibold { font-weight: 600; }
        .text-xl { font-size: 1.25rem; }
        .p-4 { padding: 1rem; }
        .mb-4 { margin-bottom: 1rem; }
        .border { border: 1px solid #e5e7eb; }
        .rounded-lg { border-radius: 0.5rem; }
        .grid { display: grid; gap: 1rem; }
        .grid-cols-2 { grid-template-columns: 1fr 1fr; }
      </style>
      <div>${Ne.innerHTML}</div>
    `;console.log("HTML préparé, taille:",De.length);const Ue="http://localhost:3001/api/generate-pdf";console.log("URL du serveur PDF:",Ue);const He=await fetch(Ue,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/pdf"},body:JSON.stringify({html:De})});console.log("Réponse reçue, status:",He.status),console.log("Content-Type:",He.headers.get("Content-Type"));const nt=He.headers.get("Content-Type")||"";if(nt.includes("application/json")){const ke=await He.json();console.error("Erreur serveur (JSON):",ke);const tt=ke.error||ke.message||"Erreur serveur inconnue";throw new Error(`Erreur serveur: ${tt}`)}if(!He.ok){const ke=await He.text();throw console.error("Erreur HTTP:",He.status,ke),new Error(`Erreur HTTP ${He.status}: ${ke.substring(0,100)}`)}nt.includes("application/pdf")||console.warn(`Type de contenu inattendu: ${nt}`),console.log("Récupération du PDF...");const Yt=await He.arrayBuffer();if(console.log("ArrayBuffer reçu, taille:",Yt.byteLength),Yt.byteLength===0)throw new Error("Le fichier PDF reçu est vide");const cn=new Uint8Array(Yt),Et=String.fromCharCode(...cn.slice(0,4));if(console.log("En-tête PDF:",JSON.stringify(Et)),Et!=="%PDF"){const ke=String.fromCharCode(...cn.slice(0,20));if(console.error("Premiers 20 caractères:",JSON.stringify(ke)),ke.startsWith("{"))try{const tt=new TextDecoder().decode(cn),Qe=JSON.parse(tt);throw new Error(`Le serveur a renvoyé une erreur: ${Qe.error||Qe.message||"Erreur inconnue"}`)}catch{throw new Error(`Réponse invalide du serveur (pas un PDF): ${ke}`)}throw new Error(`En-tête PDF invalide: "${Et}" (reçu: ${JSON.stringify(ke)})`)}const Vn=new Blob([Yt],{type:"application/pdf"}),On=URL.createObjectURL(Vn),Xe=document.createElement("a");Xe.href=On,Xe.download=`rapport-${new Date().toISOString().split("T")[0]}.pdf`,Xe.style.display="none",document.body.appendChild(Xe),Xe.click(),document.body.removeChild(Xe),setTimeout(()=>URL.revokeObjectURL(On),1e3),console.log("PDF téléchargé avec succès"),alert("PDF généré avec succès !")}catch(ve){console.error("Erreur complète:",ve);let Ne=ve.message;Ne.includes("En-tête PDF invalide")&&(Ne+=`

Cela indique que le serveur PDF a rencontré une erreur. Vérifiez les logs du serveur.`),alert(`Erreur lors de la génération du PDF:
${Ne}`)}},$e=()=>{if(!C)return null;if(!C.type)return p.jsxs("div",{className:"mt-8",children:[p.jsx("h3",{className:"text-lg font-semibold mb-4",children:h("propertyReport.chooseScenarioType")}),p.jsxs("div",{className:"flex gap-4",children:[p.jsx("button",{onClick:()=>U({...C,type:"refinancing"}),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:h("scenario.refinancing")}),p.jsx("button",{onClick:()=>U({...C,type:"renewal"}),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:h("scenario.renewal")}),p.jsx("button",{onClick:()=>U({...C,type:"optimization"}),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:h("scenario.optimization")})]})]});const ve={propertyId:i.id,property:i,advancedExpenses:a,onSaved:()=>U(null),initialScenario:C},je={refinancing:gj,renewal:vj,optimization:bj}[C.type];return p.jsx(je,{...ve,type:C.type})};return p.jsx("div",{className:"min-h-screen bg-gray-50 p-4",children:p.jsx("div",{className:"max-w-6xl mx-auto",children:p.jsxs("div",{ref:ee,className:"bg-white rounded-lg shadow-lg p-4 sm:p-6",children:[p.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center mb-6 gap-4",children:[p.jsx("h2",{className:"text-xl sm:text-2xl font-semibold",children:h("propertyReport.title")}),p.jsxs("div",{className:"flex items-center gap-2 sm:gap-4 self-end sm:self-auto",children:[p.jsx("button",{onClick:()=>e("scenario"),className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:h("edit")}),l?p.jsxs("button",{onClick:()=>e("dashboard"),className:"text-gray-600 hover:text-gray-800",children:["← ",h("back")]}):p.jsx("button",{onClick:r,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:h("save")})]})]}),p.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-green-50 rounded-lg p-4 sm:p-6 mb-6",children:[p.jsx("h3",{className:"text-xl font-semibold mb-2",children:T||h("propertyReport.analyzingProperty")}),a?p.jsxs("div",{className:"space-y-4 text-sm",children:[p.jsx("div",{children:p.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-4",children:[p.jsxs("div",{children:[p.jsxs("span",{className:"text-gray-600",children:[h("propertyReport.askingPrice"),":"]}),p.jsx("div",{className:"font-semibold",children:y(parseFloat(b.askingPrice)||0)})]}),p.jsxs("div",{children:[p.jsxs("span",{className:"text-gray-600",children:[h("propertyReport.purchasePrice"),":"]}),p.jsx("div",{className:"font-semibold",children:y(parseFloat(b.purchasePrice)||0)})]}),p.jsxs("div",{children:[p.jsxs("span",{className:"text-gray-600",children:[h("propertyReport.numberOfUnits"),":"]}),p.jsx("div",{className:"font-semibold",children:b.numberOfUnits||"N/A"})]}),p.jsxs("div",{children:[p.jsxs("span",{className:"text-gray-600",children:[h("propertyReport.pricePerDoor"),":"]}),p.jsx("div",{className:"font-semibold",children:y(Math.round(I.pricePerUnit||0))})]})]})}),p.jsx("div",{children:p.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-4",children:[b.financingType!=="private"&&p.jsxs("div",{children:[p.jsxs("span",{className:"text-gray-600",children:[h("propertyReport.totalRevenue"),":"]}),p.jsx("div",{className:"font-semibold",children:y(I.totalGrossRevenue)})]}),b.financingType!=="private"&&p.jsxs("div",{children:[p.jsxs("span",{className:"text-gray-600",children:[h("propertyReport.totalExpenses"),":"]}),p.jsx("div",{className:"font-semibold text-red-600",children:y(I.totalExpenses)})]}),b.financingType!=="private"&&p.jsxs("div",{children:[p.jsxs("span",{className:"text-gray-600",children:[h("propertyReport.debtServiceYear1"),":"]}),p.jsx("div",{className:"font-semibold text-red-600",children:y(I.annualDebtService)})]}),b.financingType!=="private"&&p.jsxs("div",{children:[p.jsxs("span",{className:"text-gray-600",children:[h("propertyReport.cashFlow"),":"]}),p.jsx("div",{className:`font-semibold ${I.cashFlow>=0?"text-green-600":"text-red-600"}`,children:y(I.cashFlow)})]})]})}),p.jsx("div",{children:p.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-4",children:[b.financingType!=="private"&&p.jsxs("div",{children:[p.jsxs("span",{className:"text-gray-600",children:[h("propertyReport.financing"),":"]}),p.jsxs("div",{className:"font-semibold",children:[b.financingType==="conventional"&&h("propertyReport.financingType.conventional"),b.financingType==="cmhc"&&h("propertyReport.financingType.cmhc"),b.financingType==="cmhc_aph"&&`${h("propertyReport.financingType.cmhc_aph")} (${b.aphPoints} pts)`]})]}),b.financingType!=="private"&&p.jsxs("div",{children:[p.jsxs("span",{className:"text-gray-600",children:[h("propertyReport.maxLoan"),":"]}),p.jsx("div",{className:"font-semibold",children:y(I.maxLoanAmount)})]}),b.financingType==="private"&&p.jsxs("div",{children:[p.jsxs("span",{className:"text-gray-600",children:[h("propertyReport.loanGranted"),":"]}),p.jsx("div",{className:"font-semibold",children:y(I.maxLoanAmount)})]}),b.financingType==="private"&&p.jsxs("div",{children:[p.jsxs("span",{className:"text-gray-600",children:[h("propertyReport.ltv"),":"]}),p.jsx("div",{className:"font-semibold",children:_(I.loanValueRatio)})]}),p.jsxs("div",{children:[p.jsxs("span",{className:"text-gray-600",children:[h("propertyReport.downPayment"),":"]}),p.jsx("div",{className:"font-semibold",children:y(I.downPayment)})]}),p.jsxs("div",{children:[p.jsxs("span",{className:"text-gray-600",children:[h("propertyReport.totalInvestment"),":"]}),p.jsx("div",{className:"font-semibold",children:y(I.totalInvestment)})]})]})})]}):p.jsxs("div",{className:"space-y-4 text-sm",children:[p.jsx("div",{children:p.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-4",children:[p.jsxs("div",{children:[p.jsxs("span",{className:"text-gray-600",children:[h("propertyReport.purchasePrice"),":"]}),p.jsx("div",{className:"font-semibold",children:y(parseFloat(b.purchasePrice)||0)})]}),p.jsxs("div",{children:[p.jsxs("span",{className:"text-gray-600",children:[h("propertyReport.numberOfUnits"),":"]}),p.jsx("div",{className:"font-semibold",children:b.numberOfUnits||"N/A"})]}),p.jsxs("div",{children:[p.jsxs("span",{className:"text-gray-600",children:[h("propertyReport.pricePerDoor"),":"]}),p.jsx("div",{className:"font-semibold",children:y(Math.round(I.pricePerUnit||0))})]}),p.jsxs("div",{children:[p.jsxs("span",{className:"text-gray-600",children:[h("propertyReport.averageRentPerDoor"),":"]}),p.jsx("div",{className:"font-semibold",children:y(V)})]})]})}),p.jsx("div",{children:p.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-4",children:[b.financingType!=="private"&&p.jsxs("div",{children:[p.jsxs("span",{className:"text-gray-600",children:[h("propertyReport.financing"),":"]}),p.jsxs("div",{className:"font-semibold",children:[b.financingType==="conventional"&&h("propertyReport.financingType.conventional"),b.financingType==="cmhc"&&h("propertyReport.financingType.cmhc"),b.financingType==="cmhc_aph"&&`${h("propertyReport.financingType.cmhc_aph")} (${b.aphPoints} pts)`]})]}),p.jsxs("div",{children:[p.jsxs("span",{className:"text-gray-600",children:[h("propertyReport.maxLoan"),":"]}),p.jsx("div",{className:"font-semibold",children:y(I.maxLoanAmount)})]}),b.financingType==="private"&&p.jsxs("div",{children:[p.jsxs("span",{className:"text-gray-600",children:[h("propertyReport.ltv"),":"]}),p.jsx("div",{className:"font-semibold",children:_(I.loanValueRatio)})]}),p.jsxs("div",{children:[p.jsxs("span",{className:"text-gray-600",children:[h("propertyReport.downPayment"),":"]}),p.jsx("div",{className:"font-semibold",children:y(I.downPayment)})]}),p.jsxs("div",{children:[p.jsxs("span",{className:"text-gray-600",children:[h("propertyReport.totalInvestment"),":"]}),p.jsx("div",{className:"font-semibold",children:y(I.totalInvestment)})]})]})})]})]}),p.jsx(bf,{analysis:I,variant:b.financingType==="private"?"private":"acquisition"}),p.jsxs("div",{className:"grid md:grid-cols-2 gap-8 mb-8",children:[p.jsx(xf,{analysis:I,advancedExpenses:a}),p.jsx(Ef,{analysis:I,currentProperty:b,scenarioType:"initialFinancing"})]}),p.jsxs("div",{className:"mb-8",children:[p.jsx("h3",{className:"text-lg font-medium text-gray-700 mb-1",children:h("propertyReport.futureReturns.title")}),p.jsxs("p",{className:"text-sm text-gray-500 mb-4",children:[h("propertyReport.futureReturns.desc1")," ",L," ",h("propertyReport.futureReturns.desc2")]}),p.jsxs("div",{className:"mb-4",children:[p.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:h("propertyReport.subScenario")}),p.jsxs("select",{value:A,onChange:ve=>M(ve.target.value),className:"w-full px-2 py-1 border rounded",children:[p.jsx("option",{value:"",children:h("propertyReport.none")}),P.map(ve=>p.jsxs("option",{value:ve.id,children:[ve.title||h("propertyReport.untitled")," (",m[ve.type]||ve.type,")"]},ve.id))]})]}),p.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-4 mb-4",children:[p.jsxs("div",{children:[p.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:h("propertyReport.years")}),p.jsx("input",{type:"number",min:"1",value:L,onChange:ve=>O(parseInt(ve.target.value)||0),className:"w-full px-2 py-1 border rounded"})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:h("propertyReport.incomeGrowth")}),p.jsx("input",{type:"number",step:"0.1",value:Z??"",onChange:ve=>{const Ne=parseFloat(ve.target.value),je=Number.isFinite(Ne)?Ne:0;se(je),D||(k.current={...k.current,income:je})},disabled:ge||xe,className:"w-full px-2 py-1 border rounded"})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:h("propertyReport.expenseGrowth")}),p.jsx("input",{type:"number",step:"0.1",value:G??"",onChange:ve=>{const Ne=parseFloat(ve.target.value),je=Number.isFinite(Ne)?Ne:0;ne(je),D||(k.current={...k.current,expense:je})},disabled:ge||xe,className:"w-full px-2 py-1 border rounded"})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:h("propertyReport.valueAppreciation")}),p.jsx("input",{type:"number",step:"0.1",value:B??"",onChange:ve=>{const Ne=parseFloat(ve.target.value),je=Number.isFinite(Ne)?Ne:0;re(je),D||(k.current={...k.current,value:je})},disabled:ge||xe,className:"w-full px-2 py-1 border rounded"})]})]}),p.jsxs("div",{className:"flex items-center justify-center gap-6",children:[p.jsxs("div",{className:"text-center",children:[p.jsxs("p",{className:"text-sm text-gray-500",children:[h("propertyReport.globalReturn.prefix")," ",L," ",h("propertyReport.globalReturn.suffix")]}),p.jsx("p",{className:"font-semibold",children:_(X)})]}),p.jsxs("div",{className:"text-center",children:[p.jsx("p",{className:"text-sm text-gray-500",children:h("propertyReport.annualizedReturn")}),p.jsx("p",{className:"font-semibold",children:_(ae)})]}),p.jsxs("div",{className:"text-center relative",children:[p.jsxs("button",{type:"button",onClick:()=>z(!de),className:"text-sm text-gray-500 underline cursor-pointer",children:[h("propertyReport.irrAtYear.prefix")," ",L,h("propertyReport.irrAtYear.suffix")]}),de&&p.jsx("div",{className:"absolute z-10 left-1/2 -translate-x-1/2 mt-2 w-64 p-2 bg-white border rounded shadow-lg text-xs text-gray-700",children:h("propertyReport.irrInfo")}),p.jsx("p",{className:"font-semibold",children:_(me)})]})]})]}),p.jsxs("div",{className:"flex justify-center gap-4 mb-8",children:[p.jsx("button",{onClick:()=>u({...b,appreciationRate:B/100},I,D,ue),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:h("propertyReport.amortization")}),p.jsx("button",{onClick:()=>U({parentScenarioId:ie}),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:h("propertyReport.newScenario")}),p.jsx("button",{onClick:be,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:h("propertyReport.generatePdf")})]}),p.jsx("div",{className:"mb-8",children:p.jsx(qR,{propertyId:i.id,onEdit:ve=>U(ve),excludeTypes:["initialFinancing"],parentScenarioId:ie})}),$e(),p.jsx(bN,{analysis:I,currentProperty:b}),p.jsx(xN,{analysis:I,currentProperty:b})]})})})},wj=()=>{const{t:i}=ft(),[e,t]=q.useState(null),[r,a]=q.useState(!1);q.useEffect(()=>{const u=async()=>{const m=async y=>{for(let _=1;_<=7;_++){const b=new Date;b.setDate(b.getDate()-_);const T=b.toISOString().split("T")[0],I=`https://www.bankofcanada.ca/valet/observations/BD.CDN.${y}YR.DQ.YLD/json?start_date=${T}&end_date=${T}`;try{const V=await fetch(I);if(!V.ok){if(V.status===404){console.warn(`Series BD.CDN.${y}YR.DQ.YLD not found`);return}continue}const O=(await V.json())?.observations?.[0];if(O){const Z=`BD.CDN.${y}YR.DQ.YLD`;return O[Z]?.v}}catch(V){console.error(`Error fetching ${y}YR for date ${T}:`,V)}}};try{const[y,_,b]=await Promise.all([m("2"),m("5"),m("10")]);console.log("Results from Promise.all:",{two:y,five:_,ten:b}),t({two:y,five:_,ten:b}),a(!1)}catch(y){console.error("Failed to fetch CMB rates",y),a(!0)}};u();const h=setInterval(u,3600*1e3);return()=>clearInterval(h)},[]);const l=u=>u!==void 0?parseFloat(u).toFixed(2):"N/A";return r?p.jsx("div",{className:"text-center text-sm text-red-500 mt-2",children:i("home.cmb.error")}):e?p.jsxs("div",{className:"text-center text-sm text-gray-500 mt-2",children:[p.jsx("h3",{className:"font-medium",children:i("home.cmb.title")}),p.jsxs("p",{children:[i("home.cmb.twoYear"),": ",l(e.two),"% |"," ",i("home.cmb.fiveYear"),": ",l(e.five),"% |"," ",i("home.cmb.tenYear"),": ",l(e.ten),"%"]})]}):p.jsx("div",{className:"text-center text-sm text-gray-500 mt-2",children:i("loading")})},Rj=({properties:i,onNew:e,onSelect:t,onDelete:r,onShare:a,onAbout:l})=>{const{t:u}=ft();return p.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-green-50 p-4",children:p.jsxs("div",{className:"max-w-6xl mx-auto",children:[p.jsxs("div",{className:"text-center py-8",children:[p.jsx("img",{src:"/rentalyzer-logo.png",alt:"Rentalyzer logo",width:200,className:"inline-block"}),p.jsx("h1",{className:"text-4xl font-bold text-gray-800 mb-4 flex items-center justify-center",children:u("home.title")}),p.jsx("p",{className:"text-xl text-gray-600 mb-8",children:u("home.subtitle")})]}),i.length===0?p.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-8 mb-8",children:[p.jsx("h2",{className:"text-2xl font-semibold mb-6 text-center",children:u("home.empty.title")}),p.jsxs("div",{className:"grid md:grid-cols-3 gap-6 mb-8",children:[p.jsxs("div",{className:"text-center",children:[p.jsx("div",{className:"bg-blue-100 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4",children:p.jsx(wg,{className:"w-8 h-8 text-blue-600"})}),p.jsx("h3",{className:"font-semibold mb-2",children:u("home.step1.title")}),p.jsx("p",{className:"text-gray-600 text-sm",children:u("home.step1.text")})]}),p.jsxs("div",{className:"text-center",children:[p.jsx("div",{className:"bg-green-100 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4",children:p.jsx(Ss,{className:"w-8 h-8 text-green-600"})}),p.jsx("h3",{className:"font-semibold mb-2",children:u("home.step2.title")}),p.jsx("p",{className:"text-gray-600 text-sm",children:u("home.step2.text")})]}),p.jsxs("div",{className:"text-center",children:[p.jsx("div",{className:"bg-purple-100 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4",children:p.jsx(ZI,{className:"w-8 h-8 text-purple-600"})}),p.jsx("h3",{className:"font-semibold mb-2",children:u("home.step3.title")}),p.jsx("p",{className:"text-gray-600 text-sm",children:u("home.step3.text")})]})]}),p.jsx("div",{className:"text-center",children:p.jsxs("button",{onClick:e,className:"bg-blue-600 text-white px-8 py-3 rounded-lg font-semibold text-lg hover:bg-blue-700 transition-colors",children:[p.jsx(ox,{className:"inline-block mr-2"}),u("home.new.button")]})})]}):p.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 mb-8",children:[p.jsxs("div",{className:"flex flex-col items-center mb-6 md:flex-row md:justify-between md:items-center",children:[p.jsx("h2",{className:"text-2xl font-semibold mb-4 md:mb-0",children:u("home.existing.title")}),p.jsxs("button",{onClick:e,className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:[p.jsx(ox,{className:"inline-block mr-1"}),u("home.existing.new")]})]}),p.jsx("div",{className:"grid gap-4 md:grid-cols-2",children:i.map((h,m)=>{const y=[h.address,h.city,h.province,h.postalCode].filter(Boolean).join(", ");return p.jsxs("div",{className:"relative border rounded-lg p-4 bg-gray-50 hover:shadow-md transition-shadow cursor-pointer",onClick:()=>t(h),children:[p.jsx("button",{onClick:_=>{_.stopPropagation(),a?.(h.id)},className:"absolute top-2 right-10 text-blue-600 hover:text-blue-800","aria-label":u("home.share"),children:p.jsx(lN,{size:16})}),p.jsx("button",{onClick:_=>{_.stopPropagation(),r?.(h.id)},className:"absolute top-2 right-2 text-red-600 hover:text-red-800","aria-label":u("home.delete"),children:p.jsx(Rd,{size:16})}),p.jsx("h3",{className:"font-semibold text-lg mb-3",children:y||u("home.address.unset")}),p.jsxs("div",{className:"flex flex-wrap text-sm text-gray-600 gap-y-1 mb-2",children:[p.jsxs("div",{className:"w-1/2 flex items-center",children:[p.jsx(_T,{className:"w-4 h-4 mr-1 text-blue-600"}),h.numberOfUnits," ",u("home.units")]}),p.jsxs("div",{className:"w-1/2 flex items-center",children:[p.jsx(Xn,{className:"w-4 h-4 mr-1 text-green-600"}),Number(h.purchasePrice).toLocaleString("fr-CA"),"$"]}),p.jsxs("div",{className:"w-1/2 flex items-center",children:[p.jsx(wg,{className:"w-4 h-4 mr-1 text-purple-600"}),(h.purchasePrice/h.numberOfUnits).toLocaleString("fr-CA"),u("home.pricePerDoor")]})]}),p.jsxs("div",{className:`mt-2 inline-block px-2 py-1 text-sm font-medium rounded ${h.effectiveNetIncome>=0?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:[h.effectiveNetIncome>=0?"+":"",Math.round(h.effectiveNetIncome).toLocaleString("fr-CA"),u("home.perYear")]})]},m)})})]}),p.jsxs("div",{className:"text-center text-sm text-gray-500 mt-8",children:[p.jsx("button",{onClick:l,className:"hover:underline",children:u("home.about")}),p.jsx(wj,{})]})]})})},Sj=({analysis:i,currentProperty:e,setCurrentStep:t,scenario:r,scenarioAnalysis:a})=>{const{t:l}=ft(),u=i.totalLoanAmount||0,h=i.monthlyPayment||0,m=parseFloat(e.mortgageRate)||0,y=parseInt(e.amortization)||0,_=e.financingType==="private"?m/100/12:Math.pow(1+m/100/2,1/6)-1;let b=u,T=0;const I=parseFloat(e.appreciationRate)||.03,V=parseFloat(e.purchasePrice)||0,L=Math.pow(1+I,1/12);let O=V;const Z=i.acquisitionCosts||0,se=a?.acquisitionCosts||0,G=Math.max(se-Z,0);let ne=Z;const B=[],re=r?(parseFloat(r.refinanceYears)||0)*12:0,P=a?.totalLoanAmount||0,S=a?.economicValue||0,A=a?.monthlyPayment||0,M=parseFloat(r?.financing?.mortgageRate)||0,D=parseInt(r?.financing?.amortization)||0,k=r?.financing?.financingType==="private"?M/100/12:Math.pow(1+M/100/2,1/6)-1,N=r?re+D*12:y*12;r&&re===0&&(S>O||P>O)&&(O=Math.max(S,P),ne+=G);for(let de=1;de<=N;de++){O*=L,r&&de===re&&((S>O||P>O)&&(O=Math.max(S,P)),ne+=G);const z=r&&de>re;r&&de===re+1&&(b=P);const X=z?k:_,ae=z?A:h,me=b*X,C=Math.min(ae-me,b);b-=C,T+=C;const U=O-b-ne;B.push({month:de,balance:b,interest:me,principal:C,cumulativePrincipal:T,propertyValue:O,equity:U})}const ue=de=>new Intl.NumberFormat("fr-CA",{style:"currency",currency:"CAD",minimumFractionDigits:0,maximumFractionDigits:0}).format(de||0);return B.length===0?p.jsx("div",{className:"min-h-screen bg-gray-50 p-4",children:p.jsxs("div",{className:"max-w-4xl mx-auto bg-white rounded-lg shadow-lg p-6",children:[p.jsxs("div",{className:"flex justify-between items-center mb-4",children:[p.jsx("h2",{className:"text-2xl font-semibold",children:l("amortization.title")}),p.jsx("button",{onClick:()=>t("report"),className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:l("back")})]}),p.jsx("p",{className:"text-center text-gray-600",children:l("amortization.noData")})]})}):p.jsx("div",{className:"min-h-screen bg-gray-50 p-4",children:p.jsxs("div",{className:"max-w-4xl mx-auto bg-white rounded-lg shadow-lg p-6",children:[p.jsxs("div",{className:"flex justify-between items-center mb-4",children:[p.jsx("h2",{className:"text-2xl font-semibold",children:l("amortization.title")}),p.jsx("button",{onClick:()=>t("report"),className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:l("back")})]}),p.jsx("div",{className:"overflow-x-auto",children:p.jsxs("table",{className:"min-w-full text-sm",children:[p.jsx("thead",{children:p.jsxs("tr",{className:"bg-gray-100",children:[p.jsx("th",{className:"px-2 py-1 text-center",children:l("amortization.period")}),p.jsx("th",{className:"px-2 py-1 text-center",children:l("amortization.loanBalance")}),p.jsx("th",{className:"px-2 py-1 text-center",children:l("amortization.interestPayment")}),p.jsx("th",{className:"px-2 py-1 text-center",children:l("amortization.principalPayment")}),p.jsx("th",{className:"px-2 py-1 text-center",children:l("amortization.cumulativePrincipal")}),p.jsx("th",{className:"px-2 py-1 text-center",children:l("amortization.propertyValue")}),p.jsx("th",{className:"px-2 py-1 text-center",children:l("amortization.equity")})]})}),p.jsx("tbody",{children:B.map(de=>p.jsxs("tr",{className:r&&de.month===re?"border-t bg-green-200":de.month%12===0?"border-t bg-gray-200":"border-t",children:[p.jsx("td",{className:"px-2 py-1 text-center",children:de.month}),p.jsx("td",{className:"px-2 py-1 text-center",children:ue(de.balance)}),p.jsx("td",{className:"px-2 py-1 text-center",children:ue(de.interest)}),p.jsx("td",{className:"px-2 py-1 text-center",children:ue(de.principal)}),p.jsx("td",{className:"px-2 py-1 text-center",children:ue(de.cumulativePrincipal)}),p.jsx("td",{className:"px-2 py-1 text-center",children:ue(de.propertyValue)}),p.jsx("td",{className:"px-2 py-1 text-center",children:ue(de.equity)})]},de.month))})]})})]})})},Aj=({property:i,onCreateScenario:e,onEditScenario:t,onViewScenario:r,onEditProperty:a,onBack:l})=>{const{t:u}=ft(),h=T=>new Intl.NumberFormat("fr-CA",{style:"currency",currency:"CAD",minimumFractionDigits:0,maximumFractionDigits:0}).format(T||0),m=T=>T||T===0?`${T.toFixed(1)}%`:"—",y=i.numberOfUnits&&i.purchasePrice?Number(i.purchasePrice)/Number(i.numberOfUnits):null,_=[{label:u("building.purchasePrice"),value:h(Number(i.purchasePrice)),icon:p.jsx(Xn,{className:"w-6 h-6 text-emerald-600"})},{label:u("building.numberOfUnits"),value:i.numberOfUnits||"—",icon:p.jsx(zI,{className:"w-6 h-6 text-gray-600"})},{label:u("building.pricePerDoor"),value:y?h(y):"N/A",icon:p.jsx(Xn,{className:"w-6 h-6 text-indigo-600"})},{label:u("building.grossIncome"),value:h(i.totalGrossRevenue),icon:p.jsx(Xn,{className:"w-6 h-6 text-green-600"})},{label:u("building.totalExpenses"),value:h(i.totalExpenses),icon:p.jsx(Xn,{className:"w-6 h-6 text-red-600"})},{label:u("building.netIncome"),value:h(i.netOperatingIncome),icon:p.jsx(Xn,{className:"w-6 h-6 text-purple-600"})},{label:u("building.grm"),value:i.grossRentMultiplier?i.grossRentMultiplier.toFixed(1):"—",icon:p.jsx(Wc,{className:"w-6 h-6 text-blue-600"})},{label:u("building.nim"),value:i.netIncomeMultiplier?i.netIncomeMultiplier.toFixed(1):"—",icon:p.jsx(Wc,{className:"w-6 h-6 text-purple-600"})},{label:u("building.capRate"),value:m(i.capRate),icon:p.jsx(Ss,{className:"w-6 h-6 text-orange-600"})}],b=[i.address,i.city,i.province,i.postalCode].filter(Boolean).join(", ");return p.jsx("div",{className:"min-h-screen bg-gray-50 p-4",children:p.jsx("div",{className:"max-w-5xl mx-auto",children:p.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-4 sm:p-6",children:[p.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center mb-6 gap-4",children:[p.jsx("h2",{className:"text-xl sm:text-2xl font-semibold",children:u("building.dashboard.title")}),p.jsxs("div",{className:"flex items-center gap-2 sm:gap-4 self-end sm:self-auto",children:[p.jsx("button",{onClick:a,className:"px-4 py-2 border rounded-lg hover:bg-gray-50 text-sm sm:text-base",children:u("edit")}),p.jsxs("button",{onClick:l,className:"text-gray-600 hover:text-gray-800 text-sm sm:text-base",children:["← ",u("back")]})]})]}),p.jsx("div",{className:"mb-6",children:p.jsx("h3",{className:"text-xl font-semibold",children:b||u("home.address.unset")})}),p.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 mb-6",children:_.map(({label:T,value:I,icon:V})=>p.jsxs("div",{className:"flex items-center gap-4 bg-gray-50 p-4 rounded-lg border border-gray-200",children:[V,p.jsxs("div",{children:[p.jsx("p",{className:"text-sm text-gray-500",children:T}),p.jsx("p",{className:"text-lg font-semibold",children:I})]})]},T))}),p.jsx("div",{className:"flex justify-center mb-6",children:p.jsx("button",{onClick:e,className:"w-full sm:w-auto bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700",children:u("building.createScenario")})}),p.jsx(qR,{propertyId:i.id,onEdit:t,onView:r,excludeTypes:["refinancing","renewal","optimization","other"]})]})})})};function Ij({costs:i={},onChange:e,lockedFields:t={},advancedExpenses:r,analysis:a={},financingType:l}){const{t:u}=ft(),h=(_,b)=>{e({...i,[_]:b})},m=["cmhc","cmhc_aph"].includes(l);if(!r){const _=[{field:"expertises",label:u("acquisitionCosts.expertises"),info:u("acquisitionCosts.expertisesInfo")},{field:"notary",label:u("acquisitionCosts.notary"),info:u("acquisitionCosts.notaryInfo")},...m?[{field:"cmhcAnalysis",label:u("acquisitionCosts.cmhcAnalysis"),info:u("acquisitionCosts.cmhcAnalysisInfo"),locked:!0},{field:"cmhcTax",label:u("acquisitionCosts.cmhcTax"),info:u("acquisitionCosts.cmhcTaxInfo"),locked:!0}]:[],{field:"welcomeTax",label:u("acquisitionCosts.welcomeTax"),info:u("acquisitionCosts.welcomeTaxInfo"),locked:t?.welcomeTax},{field:"otherFees",label:u("acquisitionCosts.otherFees"),info:u("acquisitionCosts.otherFeesInfo")}];return p.jsxs("div",{className:"border rounded-lg p-6",children:[p.jsxs("h2",{className:"text-lg font-semibold mb-4 text-orange-600 flex items-center",children:[p.jsx(Tg,{className:"w-5 h-5 mr-2"}),u("acquisitionCosts.title")]}),p.jsx("div",{className:"grid grid-cols-2 gap-4",children:_.map(({field:b,label:T,info:I,locked:V})=>p.jsxs("div",{children:[p.jsxs("label",{className:"block text-sm font-medium mb-1",children:[T,I&&p.jsx(nN,{className:"inline w-4 h-4 text-gray-400 ml-1",title:I})]}),p.jsx(Ke,{value:i[b]||"",onChange:L=>h(b,L),className:"w-full border rounded p-2",placeholder:"0",disabled:V,type:"currency"})]},b))}),p.jsxs("div",{className:"mt-4",children:[p.jsx("label",{className:"block text-sm font-medium mb-1",children:u("acquisitionCosts.total")}),p.jsx(Ke,{value:a.acquisitionCosts?.toString()||"",onChange:()=>{},className:"w-full border rounded p-2 bg-gray-50",placeholder:"0",disabled:!0,type:"currency"})]})]})}const y=[{field:"inspection",label:u("acquisitionCosts.inspection")},{field:"environmental1",label:u("acquisitionCosts.environmental1")},{field:"environmental2",label:u("acquisitionCosts.environmental2")},{field:"environmental3",label:u("acquisitionCosts.environmental3")},{field:"appraiser",label:u("acquisitionCosts.appraiser")},...m?[{field:"cmhcAnalysis",label:u("acquisitionCosts.cmhcAnalysis"),locked:!0},{field:"cmhcTax",label:u("acquisitionCosts.cmhcTax"),locked:!0}]:[],{field:"otherFees",label:u("acquisitionCosts.otherFees")},{field:"notary",label:u("acquisitionCosts.notary")},{field:"welcomeTax",label:u("acquisitionCosts.welcomeTax"),locked:t?.welcomeTax},{field:"renovations",label:u("acquisitionCosts.renovations")}];return p.jsxs("div",{className:"border rounded-lg p-6",children:[p.jsxs("h2",{className:"text-lg font-semibold mb-4 text-orange-600 flex items-center",children:[p.jsx(Tg,{className:"w-5 h-5 mr-2"}),u("acquisitionCosts.title")]}),p.jsx("div",{className:"grid grid-cols-2 gap-4",children:y.map(({field:_,label:b,locked:T})=>p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium mb-1",children:b}),p.jsx(Ke,{value:i[_]||"",onChange:I=>h(_,I),className:"w-full border rounded p-2",placeholder:"0",disabled:T,type:"currency"})]},_))}),p.jsxs("div",{className:"mt-4",children:[p.jsx("label",{className:"block text-sm font-medium mb-1",children:u("acquisitionCosts.total")}),p.jsx(Ke,{value:a.acquisitionCosts?.toString()||"",onChange:()=>{},className:"w-full border rounded p-2 bg-gray-50",placeholder:"0",disabled:!0,type:"currency"})]})]})}const GR=i=>{const e=[{min:0,max:61500,rate:.005},{min:61500,max:307800,rate:.01},{min:307800,max:601525,rate:.015},{min:601525,max:1/0,rate:.03}];let t=0,r=i;for(const a of e){if(r<=0)break;const l=Math.min(r,a.max-a.min);t+=l*a.rate,r-=l}return t};function Nj({onBack:i,onSaved:e,propertyId:t,initialScenario:r={},type:a="initialFinancing",property:l,advancedExpenses:u}){const[h,m]=q.useState({title:"",financing:{},acquisitionCosts:{},...r}),[y,_]=q.useState({debtCoverage:!0,welcomeTax:!0}),{t:b}=ft();q.useEffect(()=>{m({title:"",financing:{},acquisitionCosts:{},...r})},[r.id]);const T=(G,ne)=>{ne==="debtCoverageRatio"?_(B=>({...B,debtCoverage:!1})):ne==="financingType"&&_(B=>({...B,debtCoverage:!0})),m(B=>({...B,financing:G}))},I=G=>{m(ne=>({...ne,acquisitionCosts:G}))},V=(G,ne)=>{m(B=>({...B,[G]:ne}))},L=()=>{let ne=(u?["inspection","environmental1","environmental2","environmental3","otherFees","appraiser","notary","renovations","cmhcAnalysis","cmhcTax","welcomeTax"]:["expertises","notary","renovations","cmhcAnalysis","cmhcTax","otherFees","welcomeTax"]).reduce((B,re)=>B+Number(Cn(h.acquisitionCosts[re])||0),0);if(h.financing.financingType==="private"){const B=Number(Cn(h.financing.originationFee)||0),re=O?.maxLoanAmount||0,P=(h.financing.originationFeeType||"percentage")==="currency"?B:re*B/100;ne+=P}return ne},O=q.useMemo(()=>{if(!l)return null;const G={...l,...h.financing};return Wi(G,u)},[l,h.financing,u]);q.useEffect(()=>{if(!y.welcomeTax)return;const G=parseFloat(l?.purchasePrice)||0;if(G>0){const ne=Math.round(GR(G)).toString();h.acquisitionCosts.welcomeTax!==ne&&m(B=>({...B,acquisitionCosts:{...B.acquisitionCosts,welcomeTax:ne}}))}},[l?.purchasePrice,y.welcomeTax,h.acquisitionCosts.welcomeTax]),q.useEffect(()=>{const G=h.financing.financingType,ne=parseInt(l?.numberOfUnits)||0;if(["cmhc","cmhc_aph"].includes(G)&&ne>0){const B=(ne*150).toString();h.acquisitionCosts.cmhcAnalysis!==B&&m(re=>({...re,acquisitionCosts:{...re.acquisitionCosts,cmhcAnalysis:B}}))}else h.acquisitionCosts.cmhcAnalysis&&m(B=>({...B,acquisitionCosts:{...B.acquisitionCosts,cmhcAnalysis:""}}))},[h.financing.financingType,l?.numberOfUnits,h.acquisitionCosts.cmhcAnalysis]),q.useEffect(()=>{const G=h.financing.financingType;if(["cmhc","cmhc_aph"].includes(G)){const ne=O?.cmhcTax?Math.round(O.cmhcTax).toString():"";h.acquisitionCosts.cmhcTax!==ne&&m(B=>({...B,acquisitionCosts:{...B.acquisitionCosts,cmhcTax:ne}}))}else h.acquisitionCosts.cmhcTax&&m(ne=>({...ne,acquisitionCosts:{...ne.acquisitionCosts,cmhcTax:""}}))},[O?.cmhcTax,h.financing.financingType,h.acquisitionCosts.cmhcTax]),q.useEffect(()=>{if(!y.debtCoverage)return;const G=h.financing.financingType,ne=parseInt(l?.numberOfUnits)||1;let B="";G==="cmhc"?B=ne>=7?"1.3":"1.1":G==="cmhc_aph"?B="1.1":G&&G!=="private"&&(B="1.15"),h.financing.debtCoverageRatio!==B&&m(re=>({...re,financing:{...re.financing,debtCoverageRatio:B}}))},[h.financing.financingType,l?.numberOfUnits,y.debtCoverage]);const Z=async()=>{const{id:G,...ne}=h,B={...ne,type:a};if(G)await Yu(t,G,B),e&&e({id:G,...B});else{const re=await Nl(t,B);e&&e({id:re,...B})}},se=b("scenarioForm.financing.title");return p.jsx("div",{className:"min-h-screen bg-gray-50 p-4",children:p.jsx("div",{className:"max-w-4xl mx-auto",children:p.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[p.jsxs("div",{className:"flex justify-between items-center mb-6",children:[p.jsx("h2",{className:"text-2xl font-semibold",children:se}),i&&p.jsxs("button",{onClick:i,className:"text-gray-600 hover:text-gray-800",children:["← ",b("back")]})]}),p.jsxs("div",{className:"space-y-8",children:[p.jsxs("div",{className:"border rounded-lg p-6",children:[p.jsx("h2",{className:"text-lg font-semibold mb-4 text-gray-700",children:b("scenarioForm.titleLabel")}),p.jsx("input",{type:"text",value:h.title,onChange:G=>V("title",G.target.value),className:"w-full border rounded p-2",placeholder:b("scenarioForm.titlePlaceholder")})]}),l&&p.jsxs(p.Fragment,{children:[p.jsx(xT,{property:l,onChange:()=>{},advancedExpenses:u,readOnly:!0,disablePlaceAutocomplete:!0}),p.jsx(dy,{revenue:l,onChange:()=>{},advancedExpenses:u,readOnly:!0}),p.jsx(my,{expenses:l,onChange:()=>{},advancedExpenses:u,readOnly:!0})]}),p.jsx(Sv,{financing:h.financing,onChange:T,lockedFields:y}),p.jsx(Ij,{costs:h.acquisitionCosts,onChange:I,advancedExpenses:u,analysis:{acquisitionCosts:L()},lockedFields:y,financingType:h.financing.financingType}),p.jsx("div",{className:"flex justify-end",children:e&&p.jsx("button",{onClick:Z,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:b("save")})})]})]})})})}const Cj=({onBack:i})=>{const{t:e}=ft();return p.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-green-50 p-4",children:p.jsxs("div",{className:"max-w-3xl mx-auto bg-white rounded-lg shadow-lg p-8",children:[p.jsxs("button",{onClick:i,className:"flex items-center text-blue-600 mb-6 hover:text-blue-800",children:[p.jsx(LI,{className:"w-4 h-4 mr-2"}),e("about.back")]}),p.jsxs("div",{className:"text-center mb-8",children:[p.jsx("div",{className:"w-32 h-32 mx-auto rounded-full overflow-hidden bg-gray-200 mb-4",children:p.jsx("img",{src:"/src/profile.jpg",alt:e("about.photoAlt"),className:"w-full h-full object-cover"})}),p.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Michael Marceau"}),p.jsx("h2",{className:"text-xl text-gray-600 mb-4",children:e("about.tagline")}),p.jsx("p",{className:"text-gray-700",children:e("about.intro")})]}),p.jsxs("div",{className:"space-y-8 text-gray-700",children:[p.jsxs("section",{children:[p.jsx("h3",{className:"text-2xl font-semibold mb-3",children:e("about.mvvTitle")}),p.jsx("p",{className:"mb-2",children:e("about.mvv1")}),p.jsx("p",{className:"mb-2",children:e("about.mvv2")}),p.jsxs("p",{children:[p.jsxs("strong",{children:[e("about.valuesLabel"),": "]}),e("about.valuesList")]})]}),p.jsxs("section",{children:[p.jsx("h3",{className:"text-2xl font-semibold mb-3",children:e("about.backgroundTitle")}),p.jsxs("ul",{className:"list-disc pl-5 space-y-1",children:[p.jsx("li",{children:e("about.education")}),p.jsx("li",{children:e("about.entrepreneur")}),p.jsx("li",{children:e("about.investor")}),p.jsx("li",{children:e("about.lender")})]})]}),p.jsxs("section",{children:[p.jsx("h3",{className:"text-2xl font-semibold mb-3",children:e("about.contactTitle")}),p.jsxs("ul",{className:"space-y-2",children:[p.jsxs("li",{children:[e("about.email"),": ",p.jsx("a",{href:"mailto:mmarceau@dmii.ca",className:"text-blue-600 hover:underline",children:"mmarceau@dmii.ca"})]}),p.jsxs("li",{children:[e("about.phone"),": ",p.jsx("a",{href:"tel:+15145001255",className:"text-blue-600 hover:underline",children:"514-500-1255"})]}),p.jsxs("li",{children:[e("about.linkedin"),": ",p.jsx("a",{href:"https://www.linkedin.com/in/michael-marceau-23a6b570/",className:"text-blue-600 hover:underline",children:"linkedin.com/in/michael-marceau-23a6b570/"})]})]})]})]})]})})},Pj="modulepreload",Dj=function(i){return"/"+i},oT={},Vj=function(e,t,r){let a=Promise.resolve();if(t&&t.length>0){let y=function(_){return Promise.all(_.map(b=>Promise.resolve(b).then(T=>({status:"fulfilled",value:T}),T=>({status:"rejected",reason:T}))))};var u=y;document.getElementsByTagName("link");const h=document.querySelector("meta[property=csp-nonce]"),m=h?.nonce||h?.getAttribute("nonce");a=y(t.map(_=>{if(_=Dj(_),_ in oT)return;oT[_]=!0;const b=_.endsWith(".css"),T=b?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${_}"]${T}`))return;const I=document.createElement("link");if(I.rel=b?"stylesheet":Pj,b||(I.as="script"),I.crossOrigin="",I.href=_,m&&I.setAttribute("nonce",m),document.head.appendChild(I),b)return new Promise((V,L)=>{I.addEventListener("load",V),I.addEventListener("error",()=>L(new Error(`Unable to preload CSS for ${_}`)))})}))}function l(h){const m=new Event("vite:preloadError",{cancelable:!0});if(m.payload=h,window.dispatchEvent(m),!m.defaultPrevented)throw h}return a.then(h=>{for(const m of h||[])m.status==="rejected"&&l(m.reason);return e().catch(l)})},Oj=(i,e,t,r)=>{const[a,l]=q.useState({}),u=q.useMemo(()=>JSON.stringify(i),[i]),h=q.useMemo(()=>JSON.stringify(e),[e]);return q.useEffect(()=>{const m=parseFloat(i.purchasePrice)||0,y=parseInt(i.numberOfUnits)||1;if(t.welcomeTax&&m>0){const _=Math.round(GR(m)).toString();i.welcomeTax!==_&&r(b=>({...b,welcomeTax:_}))}if(t.debtCoverage){let _="1.15";i.financingType==="cmhc"?_=y>=7?"1.3":"1.1":i.financingType==="cmhc_aph"&&(_="1.1"),i.debtCoverageRatio!==_&&r(b=>({...b,debtCoverageRatio:_}))}if(["cmhc","cmhc_aph"].includes(i.financingType)&&y>0){const _=(y*150).toString();i.cmhcAnalysis!==_&&r(b=>({...b,cmhcAnalysis:_}))}else(i.cmhcAnalysis||i.cmhcTax)&&r(_=>({..._,cmhcAnalysis:"",cmhcTax:""}))},[i,t,r]),q.useEffect(()=>{if(["cmhc","cmhc_aph"].includes(i.financingType)){const m=a.cmhcTax?Math.round(a.cmhcTax).toString():"";i.cmhcTax!==m&&r(y=>({...y,cmhcTax:m}))}},[a.cmhcTax,i.financingType,i.cmhcTax,r]),q.useEffect(()=>{(async()=>{const y=(await Vj(async()=>{const{default:b}=await Promise.resolve().then(()=>fj);return{default:b}},void 0)).default,_=y(i,e);l(b=>JSON.stringify(b)===JSON.stringify(_)?b:_)})()},[u,h]),a},KR=q.createContext();function Cl(){return q.useContext(KR)}function Mj({children:i}){const[e,t]=q.useState(null),[r,a]=q.useState(!0),[l,u]=q.useState([]),[h,m]=q.useState(!0);q.useEffect(()=>(aP(Ea,hw).catch(O=>{console.error("Error setting auth persistence:",O)}),cP(Ea,O=>{t(O),a(!1)})),[]),q.useEffect(()=>{let L;return e?(m(!0),L=aj(e.uid,O=>{u(O),m(!1)})):(u([]),m(!1)),L},[e]);const V={currentUser:e,loading:r,properties:l,propertiesLoading:h,signup:(L,O)=>rP(Ea,L,O),login:(L,O)=>sP(Ea,L,O),logout:()=>uP(Ea),loginWithGoogle:()=>NP(Ea,rj),resetPassword:L=>iP(Ea,L)};return p.jsx(KR.Provider,{value:V,children:i})}const jj=()=>{const{currentUser:i,logout:e}=Cl(),{t}=ft();return i?p.jsxs("header",{className:"p-4 flex justify-between items-center bg-white shadow",children:[p.jsx("img",{src:"/rentalyzer-logo.png",alt:"Rentalyzer logo",className:"h-12"}),p.jsxs("div",{className:"flex items-center gap-2",children:[i.photoURL&&p.jsx("img",{src:i.photoURL,alt:"avatar",className:"w-8 h-8 rounded-full"}),p.jsx("span",{className:"text-sm text-gray-700",children:i.displayName||i.email}),p.jsx("button",{onClick:e,className:"text-sm text-blue-600 hover:underline",children:t("auth.logout")})]})]}):null},kj=()=>{const{currentUser:i,properties:e,propertiesLoading:t}=Cl(),{t:r}=ft(),[a,l]=q.useState("home"),[u,h]=q.useState(Au),[m,y]=q.useState(!1),[_,b]=q.useState(null),[T,I]=q.useState(null),[V]=q.useState({debtCoverage:!0,welcomeTax:!0}),L=Oj(u,m,V,h);q.useEffect(()=>{(async()=>{const B=new URLSearchParams(window.location.search),re=B.get("share");if(re&&i)try{const P=JSON.parse(decodeURIComponent(atob(re)));await dj(P,i.uid),alert(r("property.import.success"))}catch(P){console.error("Import error",P)}finally{B.delete("share");const P=`${window.location.pathname}${B.toString()?`?${B.toString()}`:""}`;window.history.replaceState({},"",P)}})()},[i]);const O=async ne=>{try{const B=await hj(ne),re=btoa(encodeURIComponent(JSON.stringify(B))),P=`${window.location.origin}/?share=${re}`;await navigator.clipboard.writeText(P),alert(r("share.link.copied"))}catch(B){console.error(r("share.error"),B)}},Z=async()=>{const ne=["address","city","province","postalCode","askingPrice","purchasePrice","municipalEvaluation","numberOfUnits","annualRent","parkingRevenue","internetRevenue","storageRevenue","otherRevenue","vacancyRate","insurance","municipalTaxes","schoolTaxes","electricityHeating","heating","electricity","maintenance","managementRate","concierge","landscaping","snowRemoval","extermination","fireInspection","advertising","legal","accounting","elevator","cableInternet","appliances","garbage","washerDryer","hotWater","operatingExpenses","otherExpenses","structureType","numFridges","numStoves","numDishwashers","numWashers","numDryers","numHeatPumps","numElevators","cmhcAnalysis","cmhcTax","welcomeTax"],B={structureType:"woodFrame",...u},P={...ne.reduce((A,M)=>{const D=B[M];return D!==void 0&&(A[M]=D),A},{}),advancedExpenses:m,...L,uid:i.uid},S=Object.fromEntries(Object.entries(P).filter(([,A])=>A!==void 0));if(u.id)await oj(u.id,S),h({...u,...S});else{const A=await zR(S);h({...S,id:A})}l("dashboard")},se=(ne,B,re,P)=>{I({property:ne,analysis:B,scenario:re,scenarioAnalysis:P}),l("amortization")},G=()=>{h(Au),y(!1),l("form")};return p.jsxs("div",{className:"min-h-screen bg-gray-50",children:[p.jsx(jj,{}),t?p.jsx("div",{className:"flex items-center justify-center py-10",children:p.jsx("span",{className:"text-gray-700",children:r("loading")})}):p.jsxs(p.Fragment,{children:[a==="home"&&p.jsx(Rj,{properties:e,onNew:G,onSelect:ne=>{h(ne),y(ne.advancedExpenses||!1),l("dashboard")},onDelete:lj,onShare:O,onAbout:()=>l("about")}),a==="form"&&p.jsx(_N,{currentProperty:u,setCurrentProperty:h,setCurrentStep:l,advancedExpenses:m,setAdvancedExpenses:y,onSave:Z}),a==="dashboard"&&p.jsx(Aj,{property:u,onCreateScenario:()=>{b(null),l("scenario")},onEditScenario:ne=>{b(ne),l("scenario")},onViewScenario:ne=>{b(ne),l("report")},onEditProperty:()=>l("form"),onBack:()=>l("home")}),a==="scenario"&&p.jsx(Nj,{propertyId:u.id,property:u,advancedExpenses:m,initialScenario:_||{},onSaved:ne=>{b(ne),l("report")},onBack:()=>l("dashboard")}),a==="report"&&p.jsx(Tj,{currentProperty:u,setCurrentStep:l,analysis:L,onSave:Z,advancedExpenses:m,scenario:_,onViewAmortization:se}),a==="amortization"&&p.jsx(Sj,{analysis:T?.analysis||L,currentProperty:T?.property||u,scenario:T?.scenario,scenarioAnalysis:T?.scenarioAnalysis,setCurrentStep:l}),a==="about"&&p.jsx(Cj,{onBack:()=>l("home")})]})]})},Lj=()=>{const[i,e]=q.useState(""),[t,r]=q.useState(""),[a,l]=q.useState(""),{login:u,loginWithGoogle:h}=Cl(),{t:m}=ft(),y=_f(),_=Mr(),b=async I=>{I.preventDefault(),l("");try{await u(i,t),y(`/${_.search}`)}catch{l(m("auth.login.error"))}},T=async()=>{l("");try{await h(),y(`/${_.search}`)}catch{l(m("auth.google.error"))}};return p.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-100",children:p.jsxs("div",{className:"w-full max-w-md p-8 space-y-6 bg-white rounded shadow",children:[p.jsx("h2",{className:"text-2xl font-bold text-center",children:m("auth.login.title")}),a&&p.jsx("div",{className:"p-2 text-red-600 bg-red-100 rounded",children:a}),p.jsxs("form",{onSubmit:b,className:"space-y-4",children:[p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium",children:m("auth.email")}),p.jsx("input",{type:"email",value:i,onChange:I=>e(I.target.value),className:"w-full px-3 py-2 border rounded",required:!0})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium",children:m("auth.password")}),p.jsx("input",{type:"password",value:t,onChange:I=>r(I.target.value),className:"w-full px-3 py-2 border rounded",required:!0})]}),p.jsx("button",{type:"submit",className:"w-full py-2 text-white bg-blue-600 rounded hover:bg-blue-700",children:m("auth.login.submit")})]}),p.jsx("button",{type:"button",onClick:T,className:"w-full py-2 text-white bg-red-500 rounded hover:bg-red-600",children:m("auth.google")}),p.jsxs("div",{className:"flex justify-between text-sm",children:[p.jsx(Bd,{to:`/reset-password${_.search}`,className:"text-blue-600 hover:underline",children:m("auth.forgotPassword")}),p.jsx(Bd,{to:`/signup${_.search}`,className:"text-blue-600 hover:underline",children:m("auth.createAccount")})]})]})})},Fj=()=>{const[i,e]=q.useState(""),[t,r]=q.useState(""),[a,l]=q.useState(""),{signup:u,loginWithGoogle:h}=Cl(),{t:m}=ft(),y=_f(),_=Mr(),b=async I=>{I.preventDefault(),l("");try{await u(i,t),y(`/${_.search}`)}catch{l(m("auth.signup.error"))}},T=async()=>{l("");try{await h(),y(`/${_.search}`)}catch{l(m("auth.google.error"))}};return p.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-100",children:p.jsxs("div",{className:"w-full max-w-md p-8 space-y-6 bg-white rounded shadow",children:[p.jsx("h2",{className:"text-2xl font-bold text-center",children:m("auth.signup.title")}),a&&p.jsx("div",{className:"p-2 text-red-600 bg-red-100 rounded",children:a}),p.jsxs("form",{onSubmit:b,className:"space-y-4",children:[p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium",children:m("auth.email")}),p.jsx("input",{type:"email",value:i,onChange:I=>e(I.target.value),className:"w-full px-3 py-2 border rounded",required:!0})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium",children:m("auth.password")}),p.jsx("input",{type:"password",value:t,onChange:I=>r(I.target.value),className:"w-full px-3 py-2 border rounded",required:!0})]}),p.jsx("button",{type:"submit",className:"w-full py-2 text-white bg-blue-600 rounded hover:bg-blue-700",children:m("auth.signup.submit")})]}),p.jsx("button",{type:"button",onClick:T,className:"w-full py-2 text-white bg-red-500 rounded hover:bg-red-600",children:m("auth.google")}),p.jsxs("div",{className:"text-sm text-center",children:[m("auth.haveAccount")," ",p.jsx(Bd,{to:`/login${_.search}`,className:"text-blue-600 hover:underline",children:m("auth.login.link")})]})]})})},Uj=()=>{const[i,e]=q.useState(""),[t,r]=q.useState(""),[a,l]=q.useState(""),{resetPassword:u}=Cl(),{t:h}=ft(),m=Mr(),y=async _=>{_.preventDefault(),r(""),l("");try{await u(i),r(h("auth.reset.success"))}catch{l(h("auth.reset.error"))}};return p.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-100",children:p.jsxs("div",{className:"w-full max-w-md p-8 space-y-6 bg-white rounded shadow",children:[p.jsx("h2",{className:"text-2xl font-bold text-center",children:h("auth.reset.title")}),a&&p.jsx("div",{className:"p-2 text-red-600 bg-red-100 rounded",children:a}),t&&p.jsx("div",{className:"p-2 text-green-600 bg-green-100 rounded",children:t}),p.jsxs("form",{onSubmit:y,className:"space-y-4",children:[p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium",children:h("auth.email")}),p.jsx("input",{type:"email",value:i,onChange:_=>e(_.target.value),className:"w-full px-3 py-2 border rounded",required:!0})]}),p.jsx("button",{type:"submit",className:"w-full py-2 text-white bg-blue-600 rounded hover:bg-blue-700",children:h("auth.reset.submit")})]}),p.jsx("div",{className:"text-sm text-center",children:p.jsx(Bd,{to:`/login${m.search}`,className:"text-blue-600 hover:underline",children:h("auth.backToLogin")})})]})})},zj=({children:i})=>{const{currentUser:e,loading:t}=Cl(),r=Mr();return t?null:e?i:p.jsx(_I,{to:`/login${r.search}`,replace:!0})},qj=()=>{const[i,e]=q.useState(navigator.onLine);return q.useEffect(()=>{const t=()=>e(navigator.onLine);return window.addEventListener("online",t),window.addEventListener("offline",t),()=>{window.removeEventListener("online",t),window.removeEventListener("offline",t)}},[]),i},Bj=()=>{const i=qj(),{t:e}=ft(),t=i?"bg-green-500":"bg-red-500",r=e(i?"network.online":"network.offline");return p.jsx("div",{className:`fixed top-7 left-20 px-2 py-1 rounded text-white text-sm ${t}`,children:r})};function Hj(){return p.jsxs(p.Fragment,{children:[p.jsx(Bj,{}),p.jsxs(xI,{children:[p.jsx(Bc,{path:"/",element:p.jsx(zj,{children:p.jsx(kj,{})})}),p.jsx(Bc,{path:"/login",element:p.jsx(Lj,{})}),p.jsx(Bc,{path:"/signup",element:p.jsx(Fj,{})}),p.jsx(Bc,{path:"/reset-password",element:p.jsx(Uj,{})})]})]})}NA.createRoot(document.getElementById("root")).render(p.jsx(q.StrictMode,{children:p.jsx(pN,{children:p.jsx(Mj,{children:p.jsx(II,{children:p.jsx(Hj,{})})})})}));
//# sourceMappingURL=index-RMMqY6-9.js.map
