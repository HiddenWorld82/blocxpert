rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    // Seul le propriétaire peut voir/modifier ses immeubles et scénarios.
    match /buildings/{buildingId} {
      allow read, write: if request.auth.uid == resource.data.userId;
      match /scenarios/{scenarioId} {
        allow read, write: if request.auth.uid == get(/databases/$(database)/documents/buildings/$(buildingId)).data.userId;
      }
    }
  }
}
